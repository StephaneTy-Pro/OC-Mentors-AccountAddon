// ==UserScript==
// @name         Facturier (alpha)
// @namespace    http://tampermonkey.net/
// @version      1.10.0003
// @description  Un addon pour vous aider dans votre facturation
// @author       Stéphane TORCHY
// @updateURL    https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @downloadURL  https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @match        https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history*

// Start at document start https://www.tampermonkey.net/documentation.php#_run_at
// @run-at document-start   

// @grant        unsafeWindow
// @grant        GM_addStyle
// @grant        GM_getResourceText
// @grant        GM_registerMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        GM.xmlHttpRequest
// @grant        GM_notification

// @require      https://cdn.jsdelivr.net/npm/lodash@4.17.19/lodash.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/low.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/LocalStorage.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/dayjs.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/locale/fr.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isBetween.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrBefore.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrAfter.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/customParseFormat.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/localeData.min.js


// GM_Config
// require      https://openuserjs.org/src/libs/sizzle/GM_config.js (cassé ce jour 28/08/2020);
// @require      https://raw.githubusercontent.com/sizzlemctwizzle/GM_config/master/gm_config.js

// sweetalert 2
// require      https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.all.min.js
// @require      https://cdn.jsdelivr.net/npm/sweetalert2@10

// draggabilly
// @require      https://cdnjs.cloudflare.com/ajax/libs/draggabilly/2.2.0/draggabilly.pkgd.min.js

// toastify
// @require     https://cdn.jsdelivr.net/npm/toastify-js@1.8.0/src/toastify.min.js
// @resource    toastifycss https://raw.githubusercontent.com/apvarun/toastify-js/master/src/toastify.css

// https://github.com/uzairfarooq/arrive --> included manually
// require     https://raw.githubusercontent.com/uzairfarooq/arrive/master/minified/arrive.min.js

// simple-datatables
// @require     https://cdn.jsdelivr.net/npm/simple-datatables@latest
// @resource    simpledatatablecss https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css

// require https://raw.githubusercontent.com/anywhichway/nano-memoize/master/dist/nano-memoize.min.js
// @require https://cdn.jsdelivr.net/npm/moize@5.4.7/dist/moize.min.js

// FETCH INJECT --> included manually
// require https://cdn.jsdelivr.net/npm/fetch-inject

// PARSER MKDOWN
// @require 	 https://cdn.jsdelivr.net/npm/showdown@1.9.1/dist/showdown.min.js

// PDF https://pdf-lib.js.org/docs/api/
// @require      https://unpkg.com/pdf-lib@1.9.0/dist/pdf-lib.min.js
// @require      https://unpkg.com/downloadjs@1.4.7/download.js

// HTMX https://htmx.org
// @require https://unpkg.com/htmx.org@1.1.0/dist/htmx.min.js

// ALPINE JS
// @require https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js


// ProgressBar 
// https://loading.io/progress/
// require https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.js
// resource loading_barcss https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.css
// @require https://loadingio.github.io/loading-bar/dist/loading-bar.js
// @resource loading_barcss https://loadingio.github.io/loading-bar/dist/loading-bar.min.css

// https://www.cssscript.com/demo/text-progress-bar-ascii-loader/
// https://github.com/kimmobrunfeldt/progressbar.js - fonctionne mais probleme avec le easing dans mon popup progress bar
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.min.js
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.js
// https://pvdlg.github.io/uprogress/js-api/#UProgress+start
// https://ricostacruz.com/nprogress

// semble cassé
// https://github.com/webosorg/Process
// https://unpkg.com/@webos/process@0.2.0/dist/process.js
// https://cdn.jsdelivr.net/npm/@webos/process@0.2.0/dist/process.min.js
// bof ... je ne parviens pas à faire fonctionner l'exemple
// https://cdn.jsdelivr.net/npm/worker-function@2.0.1/WorkerFunction.min.js
// Threading 
// @require  https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/Thread.js
// @require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadPool.js
// @require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadQueue.js
// semble cassé
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// https://unpkg.com/paralleljs@1.0/lib/parallel.js
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// Freelancer
// https://github.com/Wildhoney/Freelancer
// fonctionne require https://raw.githubusercontent.com/arqex/worker-function/master/WorkerFunction.js
// ne fonctonne pas https://raw.githubusercontent.com/duart38/Thread/master/Thread.bundle.js
// require      https://cdn.jsdelivr.net/npm/paralleljs@1.0.1/lib/parallel.min.js


/*
 * History
 * cf https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/blob/master/CHANGELOG.md
 */
// ==/UserScript==
(()=>{var kt=Object.defineProperty,Rn=Object.prototype.hasOwnProperty,rn=(t,s)=>()=>(s||(s={exports:{}},t(s.exports,s)),s.exports),sn=t=>kt(t,"__esModule",{value:!0}),Hn=(t,s)=>{sn(t);for(var n in s)kt(t,n,{get:s[n],enumerable:!0})},Un=(t,s)=>{if(sn(t),typeof s=="object"||typeof s=="function")for(let n in s)!Rn.call(t,n)&&n!=="default"&&kt(t,n,{get:()=>s[n],enumerable:!0});return t},Fe=t=>t&&t.__esModule?t:Un(kt({},"default",{value:t,enumerable:!0}),t);var an=rn((Qt,Vt)=>{!function(t,s){typeof define=="function"&&define.amd?define([],s):typeof Vt=="object"&&typeof Qt!="undefined"?Vt.exports=s():t.Papa=s()}(Qt,function t(){"use strict";var s=typeof self!="undefined"?self:typeof window!="undefined"?window:s!==void 0?s:{},n=!s.document&&!!s.postMessage,a=n&&/blob:/i.test((s.location||{}).protocol),e={},o=0,l={parse:function(c,u){var m=(u=u||{}).dynamicTyping||!1;if(C(m)&&(u.dynamicTypingFunction=m,m={}),u.dynamicTyping=m,u.transform=!!C(u.transform)&&u.transform,u.worker&&l.WORKERS_SUPPORTED){var A=function(){if(!l.WORKERS_SUPPORTED)return!1;var V=(S=s.URL||s.webkitURL||null,x=t.toString(),l.BLOB_URL||(l.BLOB_URL=S.createObjectURL(new Blob(["(",x,")();"],{type:"text/javascript"})))),M=new s.Worker(V),S,x;return M.onmessage=y,M.id=o++,e[M.id]=M}();return A.userStep=u.step,A.userChunk=u.chunk,A.userComplete=u.complete,A.userError=u.error,u.step=C(u.step),u.chunk=C(u.chunk),u.complete=C(u.complete),u.error=C(u.error),delete u.worker,void A.postMessage({input:c,config:u,workerId:A.id})}var L=null;return l.NODE_STREAM_INPUT,typeof c=="string"?L=u.download?new d(u):new w(u):c.readable===!0&&C(c.read)&&C(c.on)?L=new T(u):(s.File&&c instanceof File||c instanceof Object)&&(L=new i(u)),L.stream(c)},unparse:function(c,u){var m=!1,A=!0,L=",",V=`\r
`,M='"',S=M+M,x=!1,D=null,j=!1;!function(){if(typeof u!="object")return;if(typeof u.delimiter!="string"||l.BAD_DELIMITERS.filter(function(N){return u.delimiter.indexOf(N)!==-1}).length||(L=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(m=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(x=u.skipEmptyLines),typeof u.newline=="string"&&(V=u.newline),typeof u.quoteChar=="string"&&(M=u.quoteChar),typeof u.header=="boolean"&&(A=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");D=u.columns}u.escapeChar!==void 0&&(S=u.escapeChar+M),typeof u.escapeFormulae=="boolean"&&(j=u.escapeFormulae)}();var z=new RegExp(b(M),"g");if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return I(null,c,x);if(typeof c[0]=="object")return I(D||F(c[0]),c,x)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:F(c.data[0])),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),I(c.fields||[],c.data||[],x);throw new Error("Unable to serialize unrecognized input");function F(N){if(typeof N!="object")return[];var ae=[];for(var ge in N)ae.push(ge);return ae}function I(N,ae,ge){var ce="";typeof N=="string"&&(N=JSON.parse(N)),typeof ae=="string"&&(ae=JSON.parse(ae));var fe=Array.isArray(N)&&0<N.length,be=!Array.isArray(ae[0]);if(fe&&A){for(var oe=0;oe<N.length;oe++)0<oe&&(ce+=L),ce+=Y(N[oe],oe);0<ae.length&&(ce+=V)}for(var ie=0;ie<ae.length;ie++){var pe=fe?N.length:ae[ie].length,le=!1,re=fe?Object.keys(ae[ie]).length===0:ae[ie].length===0;if(ge&&!fe&&(le=ge==="greedy"?ae[ie].join("").trim()==="":ae[ie].length===1&&ae[ie][0].length===0),ge==="greedy"&&fe){for(var se=[],ne=0;ne<pe;ne++){var W=be?N[ne]:ne;se.push(ae[ie][W])}le=se.join("").trim()===""}if(!le){for(var ue=0;ue<pe;ue++){0<ue&&!re&&(ce+=L);var ve=fe&&be?N[ue]:ue;ce+=Y(ae[ie][ve],ue)}ie<ae.length-1&&(!ge||0<pe&&!re)&&(ce+=V)}}return ce}function Y(N,ae){if(N==null)return"";if(N.constructor===Date)return JSON.stringify(N).slice(1,25);j===!0&&typeof N=="string"&&N.match(/^[=+\-@].*$/)!==null&&(N="'"+N);var ge=N.toString().replace(z,S),ce=typeof m=="boolean"&&m||typeof m=="function"&&m(N,ae)||Array.isArray(m)&&m[ae]||function(fe,be){for(var oe=0;oe<be.length;oe++)if(-1<fe.indexOf(be[oe]))return!0;return!1}(ge,l.BAD_DELIMITERS)||-1<ge.indexOf(L)||ge.charAt(0)===" "||ge.charAt(ge.length-1)===" ";return ce?M+ge+M:ge}}};if(l.RECORD_SEP=String.fromCharCode(30),l.UNIT_SEP=String.fromCharCode(31),l.BYTE_ORDER_MARK="﻿",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!n&&!!s.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=v,l.ParserHandle=h,l.NetworkStreamer=d,l.FileStreamer=i,l.StringStreamer=w,l.ReadableStreamStreamer=T,s.jQuery){var p=s.jQuery;p.fn.parse=function(c){var u=c.config||{},m=[];return this.each(function(V){if(!(p(this).prop("tagName").toUpperCase()==="INPUT"&&p(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var M=0;M<this.files.length;M++)m.push({file:this.files[M],inputElem:this,instanceConfig:p.extend({},u)})}),A(),this;function A(){if(m.length!==0){var V,M,S,x,D=m[0];if(C(c.before)){var j=c.before(D.file,D.inputElem);if(typeof j=="object"){if(j.action==="abort")return V="AbortError",M=D.file,S=D.inputElem,x=j.reason,void(C(c.error)&&c.error({name:V},M,S,x));if(j.action==="skip")return void L();typeof j.config=="object"&&(D.instanceConfig=p.extend(D.instanceConfig,j.config))}else if(j==="skip")return void L()}var z=D.instanceConfig.complete;D.instanceConfig.complete=function(F){C(z)&&z(F,D.file,D.inputElem),L()},l.parse(D.file,D.instanceConfig)}else C(c.complete)&&c.complete()}function L(){m.splice(0,1),A()}}}function f(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(u){var m=$(u);m.chunkSize=parseInt(m.chunkSize),u.step||u.chunk||(m.chunkSize=null),this._handle=new h(m),(this._handle.streamer=this)._config=m}.call(this,c),this.parseChunk=function(u,m){if(this.isFirstChunk&&C(this._config.beforeFirstChunk)){var A=this._config.beforeFirstChunk(u);A!==void 0&&(u=A)}this.isFirstChunk=!1,this._halted=!1;var L=this._partialLine+u;this._partialLine="";var V=this._handle.parse(L,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var M=V.meta.cursor;this._finished||(this._partialLine=L.substring(M-this._baseIndex),this._baseIndex=M),V&&V.data&&(this._rowCount+=V.data.length);var S=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(a)s.postMessage({results:V,workerId:l.WORKER_ID,finished:S});else if(C(this._config.chunk)&&!m){if(this._config.chunk(V,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);V=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(V.data),this._completeResults.errors=this._completeResults.errors.concat(V.errors),this._completeResults.meta=V.meta),this._completed||!S||!C(this._config.complete)||V&&V.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),S||V&&V.meta.paused||this._nextChunk(),V}this._halted=!0},this._sendError=function(u){C(this._config.error)?this._config.error(u):a&&this._config.error&&s.postMessage({workerId:l.WORKER_ID,error:u,finished:!1})}}function d(c){var u;(c=c||{}).chunkSize||(c.chunkSize=l.RemoteChunkSize),f.call(this,c),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(m){this._input=m,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),n||(u.onload=g(this._chunkLoaded,this),u.onerror=g(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var m=this._config.downloadRequestHeaders;for(var A in m)u.setRequestHeader(A,m[A])}if(this._config.chunkSize){var L=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+L)}try{u.send(this._config.downloadRequestBody)}catch(V){this._chunkError(V.message)}n&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(m){var A=m.getResponseHeader("Content-Range");return A===null?-1:parseInt(A.substring(A.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(m){var A=u.statusText||m;this._sendError(new Error(A))}}function i(c){var u,m;(c=c||{}).chunkSize||(c.chunkSize=l.LocalChunkSize),f.call(this,c);var A=typeof FileReader!="undefined";this.stream=function(L){this._input=L,m=L.slice||L.webkitSlice||L.mozSlice,A?((u=new FileReader).onload=g(this._chunkLoaded,this),u.onerror=g(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var L=this._input;if(this._config.chunkSize){var V=Math.min(this._start+this._config.chunkSize,this._input.size);L=m.call(L,this._start,V)}var M=u.readAsText(L,this._config.encoding);A||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(L){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(L.target.result)},this._chunkError=function(){this._sendError(u.error)}}function w(c){var u;f.call(this,c=c||{}),this.stream=function(m){return u=m,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var m,A=this._config.chunkSize;return A?(m=u.substring(0,A),u=u.substring(A)):(m=u,u=""),this._finished=!u,this.parseChunk(m)}}}function T(c){f.call(this,c=c||{});var u=[],m=!0,A=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(L){this._input=L,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):m=!0},this._streamData=g(function(L){try{u.push(typeof L=="string"?L:L.toString(this._config.encoding)),m&&(m=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(V){this._streamError(V)}},this),this._streamError=g(function(L){this._streamCleanUp(),this._sendError(L)},this),this._streamEnd=g(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=g(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(c){var u,m,A,L=Math.pow(2,53),V=-L,M=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,S=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,x=this,D=0,j=0,z=!1,F=!1,I=[],Y={data:[],errors:[],meta:{}};if(C(c.step)){var N=c.step;c.step=function(oe){if(Y=oe,ce())ge();else{if(ge(),Y.data.length===0)return;D+=oe.data.length,c.preview&&D>c.preview?m.abort():(Y.data=Y.data[0],N(Y,x))}}}function ae(oe){return c.skipEmptyLines==="greedy"?oe.join("").trim()==="":oe.length===1&&oe[0].length===0}function ge(){if(Y&&A&&(be("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),A=!1),c.skipEmptyLines)for(var oe=0;oe<Y.data.length;oe++)ae(Y.data[oe])&&Y.data.splice(oe--,1);return ce()&&function(){if(!Y)return;function ie(le,re){C(c.transformHeader)&&(le=c.transformHeader(le,re)),I.push(le)}if(Array.isArray(Y.data[0])){for(var pe=0;ce()&&pe<Y.data.length;pe++)Y.data[pe].forEach(ie);Y.data.splice(0,1)}else Y.data.forEach(ie)}(),function(){if(!Y||!c.header&&!c.dynamicTyping&&!c.transform)return Y;function ie(le,re){var se,ne=c.header?{}:[];for(se=0;se<le.length;se++){var W=se,ue=le[se];c.header&&(W=se>=I.length?"__parsed_extra":I[se]),c.transform&&(ue=c.transform(ue,W)),ue=fe(W,ue),W==="__parsed_extra"?(ne[W]=ne[W]||[],ne[W].push(ue)):ne[W]=ue}return c.header&&(se>I.length?be("FieldMismatch","TooManyFields","Too many fields: expected "+I.length+" fields but parsed "+se,j+re):se<I.length&&be("FieldMismatch","TooFewFields","Too few fields: expected "+I.length+" fields but parsed "+se,j+re)),ne}var pe=1;return!Y.data.length||Array.isArray(Y.data[0])?(Y.data=Y.data.map(ie),pe=Y.data.length):Y.data=ie(Y.data,0),c.header&&Y.meta&&(Y.meta.fields=I),j+=pe,Y}()}function ce(){return c.header&&I.length===0}function fe(oe,ie){return pe=oe,c.dynamicTypingFunction&&c.dynamicTyping[pe]===void 0&&(c.dynamicTyping[pe]=c.dynamicTypingFunction(pe)),(c.dynamicTyping[pe]||c.dynamicTyping)===!0?ie==="true"||ie==="TRUE"||ie!=="false"&&ie!=="FALSE"&&(function(le){if(M.test(le)){var re=parseFloat(le);if(V<re&&re<L)return!0}return!1}(ie)?parseFloat(ie):S.test(ie)?new Date(ie):ie===""?null:ie):ie;var pe}function be(oe,ie,pe,le){var re={type:oe,code:ie,message:pe};le!==void 0&&(re.row=le),Y.errors.push(re)}this.parse=function(oe,ie,pe){var le=c.quoteChar||'"';if(c.newline||(c.newline=function(ne,W){ne=ne.substring(0,1048576);var ue=new RegExp(b(W)+"([^]*?)"+b(W),"gm"),ve=(ne=ne.replace(ue,"")).split("\r"),ke=ne.split(`
`),$e=1<ke.length&&ke[0].length<ve[0].length;if(ve.length===1||$e)return`
`;for(var Pe=0,xe=0;xe<ve.length;xe++)ve[xe][0]===`
`&&Pe++;return Pe>=ve.length/2?`\r
`:"\r"}(oe,le)),A=!1,c.delimiter)C(c.delimiter)&&(c.delimiter=c.delimiter(oe),Y.meta.delimiter=c.delimiter);else{var re=function(ne,W,ue,ve,ke){var $e,Pe,xe,Ie;ke=ke||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var Ae=0;Ae<ke.length;Ae++){var at=ke[Ae],gt=0,ye=0,ze=0;xe=void 0;for(var Ye=new v({comments:ve,delimiter:at,newline:W,preview:10}).parse(ne),We=0;We<Ye.data.length;We++)if(ue&&ae(Ye.data[We]))ze++;else{var je=Ye.data[We].length;ye+=je,xe!==void 0?0<je&&(gt+=Math.abs(je-xe),xe=je):xe=je}0<Ye.data.length&&(ye/=Ye.data.length-ze),(Pe===void 0||gt<=Pe)&&(Ie===void 0||Ie<ye)&&1.99<ye&&(Pe=gt,$e=at,Ie=ye)}return{successful:!!(c.delimiter=$e),bestDelimiter:$e}}(oe,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess);re.successful?c.delimiter=re.bestDelimiter:(A=!0,c.delimiter=l.DefaultDelimiter),Y.meta.delimiter=c.delimiter}var se=$(c);return c.preview&&c.header&&se.preview++,u=oe,m=new v(se),Y=m.parse(u,ie,pe),ge(),z?{meta:{paused:!0}}:Y||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,m.abort(),u=C(c.chunk)?"":u.substring(m.getCharIndex())},this.resume=function(){x.streamer._halted?(z=!1,x.streamer.parseChunk(u,!0)):setTimeout(x.resume,3)},this.aborted=function(){return F},this.abort=function(){F=!0,m.abort(),Y.meta.aborted=!0,C(c.complete)&&c.complete(Y),u=""}}function b(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(c){var u,m=(c=c||{}).delimiter,A=c.newline,L=c.comments,V=c.step,M=c.preview,S=c.fastMode,x=u=c.quoteChar===void 0?'"':c.quoteChar;if(c.escapeChar!==void 0&&(x=c.escapeChar),(typeof m!="string"||-1<l.BAD_DELIMITERS.indexOf(m))&&(m=","),L===m)throw new Error("Comment character same as delimiter");L===!0?L="#":(typeof L!="string"||-1<l.BAD_DELIMITERS.indexOf(L))&&(L=!1),A!==`
`&&A!=="\r"&&A!==`\r
`&&(A=`
`);var D=0,j=!1;this.parse=function(z,F,I){if(typeof z!="string")throw new Error("Input must be a string");var Y=z.length,N=m.length,ae=A.length,ge=L.length,ce=C(V),fe=[],be=[],oe=[],ie=D=0;if(!z)return Ae();if(S||S!==!1&&z.indexOf(u)===-1){for(var pe=z.split(A),le=0;le<pe.length;le++){if(oe=pe[le],D+=oe.length,le!==pe.length-1)D+=A.length;else if(I)return Ae();if(!L||oe.substring(0,ge)!==L){if(ce){if(fe=[],$e(oe.split(m)),at(),j)return Ae()}else $e(oe.split(m));if(M&&M<=le)return fe=fe.slice(0,M),Ae(!0)}}return Ae()}for(var re=z.indexOf(m,D),se=z.indexOf(A,D),ne=new RegExp(b(x)+b(u),"g"),W=z.indexOf(u,D);;)if(z[D]!==u)if(L&&oe.length===0&&z.substring(D,D+ge)===L){if(se===-1)return Ae();D=se+ae,se=z.indexOf(A,D),re=z.indexOf(m,D)}else{if(re!==-1&&(re<se||se===-1)){if(!(re<W)){oe.push(z.substring(D,re)),D=re+N,re=z.indexOf(m,D);continue}var ue=gt(re,W,se);if(ue&&ue.nextDelim!==void 0){re=ue.nextDelim,W=ue.quoteSearch,oe.push(z.substring(D,re)),D=re+N,re=z.indexOf(m,D);continue}}if(se===-1)break;if(oe.push(z.substring(D,se)),Ie(se+ae),ce&&(at(),j))return Ae();if(M&&fe.length>=M)return Ae(!0)}else for(W=D,D++;;){if((W=z.indexOf(u,W+1))===-1)return I||be.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:fe.length,index:D}),xe();if(W===Y-1)return xe(z.substring(D,W).replace(ne,u));if(u!==x||z[W+1]!==x){if(u===x||W===0||z[W-1]!==x){re!==-1&&re<W+1&&(re=z.indexOf(m,W+1)),se!==-1&&se<W+1&&(se=z.indexOf(A,W+1));var ve=Pe(se===-1?re:Math.min(re,se));if(z[W+1+ve]===m){oe.push(z.substring(D,W).replace(ne,u)),z[D=W+1+ve+N]!==u&&(W=z.indexOf(u,D)),re=z.indexOf(m,D),se=z.indexOf(A,D);break}var ke=Pe(se);if(z.substring(W+1+ke,W+1+ke+ae)===A){if(oe.push(z.substring(D,W).replace(ne,u)),Ie(W+1+ke+ae),re=z.indexOf(m,D),W=z.indexOf(u,D),ce&&(at(),j))return Ae();if(M&&fe.length>=M)return Ae(!0);break}be.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:fe.length,index:D}),W++}}else W++}return xe();function $e(ye){fe.push(ye),ie=D}function Pe(ye){var ze=0;if(ye!==-1){var Ye=z.substring(W+1,ye);Ye&&Ye.trim()===""&&(ze=Ye.length)}return ze}function xe(ye){return I||(ye===void 0&&(ye=z.substring(D)),oe.push(ye),D=Y,$e(oe),ce&&at()),Ae()}function Ie(ye){D=ye,$e(oe),oe=[],se=z.indexOf(A,D)}function Ae(ye){return{data:fe,errors:be,meta:{delimiter:m,linebreak:A,aborted:j,truncated:!!ye,cursor:ie+(F||0)}}}function at(){V(Ae()),fe=[],be=[]}function gt(ye,ze,Ye){var We={nextDelim:void 0,quoteSearch:void 0},je=z.indexOf(u,ze+1);if(ze<ye&&ye<je&&(je<Ye||Ye===-1)){var Wt=z.indexOf(m,je);if(Wt===-1)return We;je<Wt&&(je=z.indexOf(u,je+1)),We=gt(Wt,je,Ye)}else We={nextDelim:ye,quoteSearch:ze};return We}},this.abort=function(){j=!0},this.getCharIndex=function(){return D}}function y(c){var u=c.data,m=e[u.workerId],A=!1;if(u.error)m.userError(u.error,u.file);else if(u.results&&u.results.data){var L={abort:function(){A=!0,O(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:E,resume:E};if(C(m.userStep)){for(var V=0;V<u.results.data.length&&(m.userStep({data:u.results.data[V],errors:u.results.errors,meta:u.results.meta},L),!A);V++);delete u.results}else C(m.userChunk)&&(m.userChunk(u.results,L,u.file),delete u.results)}u.finished&&!A&&O(u.workerId,u.results)}function O(c,u){var m=e[c];C(m.userComplete)&&m.userComplete(u),m.terminate(),delete e[c]}function E(){throw new Error("Not implemented.")}function $(c){if(typeof c!="object"||c===null)return c;var u=Array.isArray(c)?[]:{};for(var m in c)u[m]=$(c[m]);return u}function g(c,u){return function(){c.apply(u,arguments)}}function C(c){return typeof c=="function"}return a&&(s.onmessage=function(c){var u=c.data;if(l.WORKER_ID===void 0&&u&&(l.WORKER_ID=u.workerId),typeof u.input=="string")s.postMessage({workerId:l.WORKER_ID,results:l.parse(u.input,u.config),finished:!0});else if(s.File&&u.input instanceof File||u.input instanceof Object){var m=l.parse(u.input,u.config);m&&s.postMessage({workerId:l.WORKER_ID,results:m,finished:!0})}}),(d.prototype=Object.create(f.prototype)).constructor=d,(i.prototype=Object.create(f.prototype)).constructor=i,(w.prototype=Object.create(w.prototype)).constructor=w,(T.prototype=Object.create(f.prototype)).constructor=T,l})});var Be=rn(qn=>{Hn(qn,{APP_AUTHOR:()=>gn,APP_DEBUG_STYLE:()=>k,APP_ERROR_STYLE:()=>me,APP_INFO_STYLE:()=>yn,APP_LOG_STYLE:()=>bn,APP_NAME:()=>Yt,APP_PERF_STYLE:()=>Oe,APP_WARN_STYLE:()=>Ne,BILL_AUTOFUNDED:()=>Q,BILL_BILLMODIFICATORS:()=>vn,BILL_FUNDED:()=>K,BILL_OTHER:()=>Z,OC_AUTOFUNDED:()=>He,OC_FUNDED:()=>Te,OC_MAX_LEVEL:()=>Ve,OC_OTHER:()=>Qe,OC_PRICE1:()=>jt,OC_PRICE2:()=>Ot,OC_PRICE3:()=>Pt,OC_PRICE4:()=>Bt,OC_PRICE5:()=>Lt,OC_PRICE6:()=>It,OC_STATUS_0:()=>ct,OC_STATUS_1:()=>ft,OC_STATUS_2:()=>pt,OC_STATUS_3_F:()=>ht,OC_STATUS_3_M:()=>mt,SESSION_CANCEL:()=>ee,SESSION_CANCEL_LATE:()=>J,SESSION_DONE:()=>X,SESSION_STUDENT_AWAY:()=>te,TYPE_COACHING:()=>G,TYPE_DEFENSE:()=>q,TYPE_SESSION:()=>U,default:()=>hn});const Re={Cfg:{dbase:null},raf:null,start:async function(){await dn();const t=Re.checkSupport();console.log(`%cAre all functions supported ? : ${t}`,k),document.querySelector(".MuiAvatar-img")===null?(console.log("%c All condition not met, waiting element '.MuiAvatar-img' ",k),document.arrive(".MuiAvatar-img",Re._warmup)):(console.log("%c All condition already met go",k),Re._warmup())},checkSupport:function(){return!0},_warmup:function(){console.log("%c in _warmup",k),document.unbindArrive(Re._warmup),GM===void 0?(console.log("%cI am not in a tamper env",k),Re._userscriptless()):console.log(`%cTamper environment detected the version is ${GM.info.version}`,k),GM_addStyle(GM_getResourceText("jspanelcss")),GM_addStyle(GM_getResourceText("toastifycss")),GM_addStyle(GM_getResourceText("simpledatatablecss")),GM_addStyle(GM_getResourceText("loading_barcss")),GM_config.init(cn),GM_registerMenuCommand("OC Facturier - configure",fn),GM_config.get("hackheaderzindex")===!0&&(document.getElementById("header").style.zIndex=0),GM_addStyle(".swal2-title{font-size:1.275em)"),Re._main()},_userscriptless(){console.log("%cIm'not in a Tamper environment so i need to load js scripts",k)},_main:function(){console.log("​​​%cMainLoaded​​​",k),Kt.paintTiming(),Kt.longTaskTiming();let t=new LocalStorage("db");var s=low(t);s.defaults({students:[],sessions:[],f_archives:[],history_session_cache:[],meta:[],students_history:[]}).write(),Re.Cfg.dbase=s,dayjs.extend(dayjs_plugin_isSameOrAfter),dayjs.extend(dayjs_plugin_isSameOrBefore),dayjs.extend(dayjs_plugin_isBetween),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_customParseFormat),document.querySelector(".panel.menuBar.flex.draggable")===null&&un.init(),GM_config.get("alwaysaddcbox")===!0&&xt(),dayjs.locale("fr"),s.get("meta").value()===void 0&&(console.log("%cDb dont' contain meta table create it",k),s.assign({meta:[]}).write()),console.log("%cCheck DB version to find anyupdate to do",k);let n=nt.getDbVersion();if(n===-1&&(console.log("%cDb dont' contain dbVersion field in meta table create it with value 1.0.0",k),s.get("meta").push({key:"dbVersion",value:"1.0.0"}).write(),n=nt.getDbVersion(),n===-1))throw console.log("%cERROR:Could'nt set version on DB",me),new Error("!!!! IRRECOVERABLE ERROR");if(St(GM.info.script.version,n)==1&&(console.log(`%cDB is in version: ${nt.getDbVersion()} need to go to version ${GM.info.script.version}`,k),dt.update(GM.info.script.version)),lt(["https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"]).then(async function(a){console.log("%cALPINE js fetched",k)}),lt(["https://unpkg.com/htmx.org@1.1.0","https://unpkg.com/htmx.org@1.1.0/dist/ext/debug.js"]).then(async function(a){console.log("%cHTMX fetched",k),htmx.defineExtension("get-dirty",{onEvent:function(e,o){e==="htmx:configRequest"&&console.log("%cPatched htmx htmx:configRequest",k),e==="htmx:loadstart"&&(console.log("%cPatched htmx htmx:loadstart",k),xhr.addEventListener("abort",function(){console.log("Patched Abort",Ne)}),xhr.abort())}}),htmx.defineExtension("stt-get",{onEvent:function(e,o){e==="htmx:afterProcessNode"&&console.log("%cExtension 'stt-get' htmx htmx:afterProcessNode",Ne),e==="htmx:beforeRequest"&&(console.log("%cExtension 'stt-get' htmx htmx:beforeRequest",Ne),htmx.ajax("GET","http://127.0.0.1/views/dummy.html","#myDiv"))}}),htmx.on("htmx:configRequest",function(e){console.log("%cBroker htmx:configRequest event received",k)}),htmx.on("htmx:beforeRequest",function(e){if(console.log("%cBroker htmx:beforeRequest event received",k),e.detail.pathInfo.finalPath&&pn(e.detail.pathInfo.finalPath)!=="html"){console.log("%cIntercept path without .html need to route it to function",k),console.log(`%cWanna load ${e.detail.pathInfo.finalPath}`,k),e.detail.xhr.addEventListener("abort",function(){console.log("%cGLOBAL Patched Abort Function used()",Ne)}),e.detail.xhr.onloadstart=function(d){this.abort(),console.log("%cGLOBAL Patched onloadstart is set",k)};let p=mn.load(e.detail.pathInfo.finalPath),f=e.detail.target;console.log(e.detail),console.log(e.detail.elt.getAttribute("hx-select"));var o=e.detail.elt.getAttribute("hx-select");if(o){let d=new DOMParser().parseFromString(p,"text/html");oNode=d.querySelector(o),oNode?(console.log(`%cfound not ${o} in data received from calling ${e.detail.pathInfo.finalPath}`,k),p=oNode.outerHTML):console.log(`%cWanna select target ${o} in data received from calling ${e.detail.pathInfo.finalPath} but this node could'nt be found so return the whole string`,me)}console.log(p);var l=function(d,i){var w=document.createRange(),T=w.createContextualFragment(d);console.log(T);for(var h=T.childNodes.length-1;h>=0;h--){var b=T.childNodes[h];i.appendChild(b),console.log("appending to dom"),htmx.process(b)}return i.lastChild};l(p,e.detail.target)}}),htmx.on("htmx:xhr:loadstart",function(e){console.log("%cBroker htmx:xhr:loadstart event received",k)})}),lt(["https://cdn.jsdelivr.net/npm/sweetalert2@10"]).then(async function(a){console.log("%cSweetAlert fetched",k)}),GM_config.get("use_custom_css")===!0){let a=GM_config.get("custom_css_url"),e=a.split(",");if(e.length!==0)console.log(`%cWanna inject Custom CSS from URL:${e}`,k),lt(e).then(()=>{console.log(`%cCustom CSS from URL:${e} loaded`,k)}).catch(o=>console.log(`%cError detected when loading dependencies ${o}`,me));else{let o=GM_config.get("custom_css_data");if(o.length()>0){console.log(`%cNeed to inject a custom css in application content is ${o}`,k);const l=document.createElement("style");l.innerHTML=o,document.head.insertAdjacentElement("beforeend",l)}}}unsafeWindow.Facturier={libs:[],cfg:{dbase:null},klass:[]},unsafeWindow.Facturier.cfg.dbase=Re.Cfg.dbase,unsafeWindow.Facturier.libs.push({id:"fetchInject",ptr:lt}),unsafeWindow.Facturier.libs.push({id:"dayjs",ptr:dayjs}),unsafeWindow.Facturier.klass.push({id:"Student",ptr:Ee}),unsafeWindow.Facturier.klass.push({id:"Session",ptr:Ce}),unsafeWindow.Facturier.klass.push({id:"Archive",ptr:ut}),unsafeWindow.Facturier.klass.push({id:"History",ptr:bt}),unsafeWindow.Facturier.klass.push({id:"StudentHistory",ptr:Me}),unsafeWindow.Facturier.klass.push({id:"Dbase",ptr:dt}),console.log("%cImportants values are exported in unsafeWindow.Facturier",k),GM.info.script.downloadURL==="http://localhost:8000/dist/app-facturier.iife.js"?(console.log("%cALERTE .... version locale !!!!!! ","background-color:coral;color:white"),console.log("%c test readfile",k),ln("file:////media/pwyll/USB120Go/DevStt/UserScripts/SttAddon/src/update_data_base.js",function(a){console.log(a)}),Re.loadDependencies()):console.log(`%c GM.info.script.downloadURL url : ${GM.info.script.downloadURL}`,k)},loadDependencies:function(){let t=[];t.push("http://localhost:8000/src/branch01/sandbox.js"),t.push("http://localhost:8000/src/branch01/sandbox.css"),lt(t).then(()=>{console.log(`dependencies ${t} loaded`)})},dbUpdate:function(){console.log("%c Need to update DB",k),St(GM.info.script.version,"1.00.0006")==0&&(console.log("%c Need to update DB to version '1.00.0006'",k),dt.update("1.00.0006"))},overrideDebug:function(){var t=window.XMLHttpRequest.prototype.open,s=window.XMLHttpRequest.prototype.send;function n(o,l,p,f,d){return this._url=l,t.apply(this,arguments)}function a(o){return this.onreadystatechange&&(this._onreadystatechange=this.onreadystatechange),console.log(`%c Request sent : ${o}`,k),this.onreadystatechange=e,s.apply(this,arguments)}function e(){if(console.log(`%c Ready state changed to: ${this.readyState}`,k),this._onreadystatechange)return this._onreadystatechange.apply(this,arguments)}window.XMLHttpRequest.prototype.open=n,window.XMLHttpRequest.prototype.send=a}};window.Facturier!==void 0?window.Facturier.start():Re.start();var hn=Re});var Ft={async XHR(t){const s=window.GM_xmlhttpRequest||(GM?GM.xmlHttpRequest:null);return s?new Promise((n,a)=>{Object.assign(t,{onabort:a,onerror:a,onload:n,ontimeout:a}),s(t)}):Promise.reject()},async getValue(t,s=null){return window.GM_getValue?Promise.resolve(GM_getValue(t)||s):await GM.getValue(t)||s},async setValue(t,s){window.GM_setValue?GM_setValue(t,s):GM.setValue(t,s)}};const Yt="OC-Addons",gn="Stéphane TORCHY",k="background-color:green;color:white",bn="background-color:black;color:white",Ne="background-color:coral;color:white",yn="background-color:cyan;color:white",me="background-color:red;color:white",Oe="background-color:blue;color:white",He="auto-financé",Te="financé par un tiers",Qe="autre",ct="réalisée",ft="annulée",pt="annulée tardivement",mt="étudiant absent",ht="étudiante absente",Ve=6,jt=30,Ot=35,Pt=40,Bt=45,Lt=50,It=55,Q=0,K=1,Z=2,vn=[{pathId:158,path:"158-trouvez-lemploi-qui-vous-correspond",value:2}],X=0,ee=1,J=2,te=3,U=0,q=1,G=2;var dn=function(){return new Promise(t=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",t):t()})},At=async function(t="",s="",n=!1){console.info(`%cfetch() waiting return from : ${t}`,k);const a=await Ft.XHR({method:"GET",url:t,responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"},onprogress:function(f){}}).catch(f=>{console.error(`%cError ${f}`,me)});let e=new DOMParser,o=e.parseFromString(a.responseText.replace(/\n/mg,""),"text/html"),l=o.querySelector("meta[id=captcha-bypass]");if(l!==null)throw console.error(`%cError CloudFlare CAPTCHA : ${o.querySelector("title").innerText}`,k),new Error("Must Respond to Cloudflare Captcha or waiting....");var p={};return n===!0?p=o.querySelectorAll(s):p=o.querySelector(s),p},ot=function(t,s=-1){try{var n=(t.children[0].href||"/").split("/");return n[n.length+s]}catch(a){console.error(`%cError in getkey${a.stack||a}`,me)}},Zt=function(t){var s=t.trim().split(" ");try{var n=dayjs_locale_fr.months.findIndex(a=>a===s[1])+1}catch(a){console.error(`%cError in extractDate${a.stack||a}`,me)}return`${s[2]}-${n}-${s[0]}T${s[4]}`},Jt=function(t,s=0){s===-1&&(s=t.children.length-1);var n=t.children[s].children[0].innerText;let a=Zt(n);var e=dayjs(a);return e},Ue=function(t){return new Promise(s=>setTimeout(s,t))};const pn=function(t){return t.substring(t.lastIndexOf(".")+1,t.length)||t};var St=function(t,s){for(var n=t.split("."),a=s.split("."),e=0;e<3;e++){var o=Number(n[e]),l=Number(a[e]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0},ln=function(s,n){return console.info("Reading:",s),fetch(s,{mode:"same-origin"}).then(function(a){return a.blob()}).then(function(a){var e=new FileReader;e.addEventListener("loadend",function(){n(this.result)}),e.readAsText(a)})},wn=function(t){const s=t,n=t.reduce(function(i,w){return i*w});var a=new Array(n);const e=function(...i){const w=i.pop();if(i.length!==t.length)throw"Wrong matrix dimensions, need "+t.length+", you provide "+w.length+"!";if(d(i)===0)throw"Wrong type for set need one or more int has dimension, check type of!";const T=f(i);return a[T]=w,w},o=function(...i){if(i.length!==t.length)throw"Wrong matrix dimensions, need "+t.length+", you provide "+i.length+"!";if(d(i)===0)throw"Wrong type for set need one or more int has dimension, check type of!";const w=f(i);return a[w]},l=function(...i){const w=f(i);return a[w]=void 0,a[w]===void 0},p=function(){console.group("dump table"),console.table(a),console.groupEnd("dump table")},f=function(i){return i.reduce(function(w,T,h,b){let v=s.slice(h+1),y=v.length>0?v.reduce(function(O,E){return O*E}):1;return w+T*y},0)},d=function(i){return i.reduce((w,T)=>w&typeof T=="number",1)};return Object.freeze({set:e,get:o,del:l,toConsole:p})},it=function(t,s,n=Error){if(!t)throw new n(s)};HTMLElement.prototype.appendFirst=function(t){this.firstChild?this.insertBefore(t,this.firstChild):this.appendChild(t)};var yt=async function(t=null,s=null,n=!0){var a="";a+="<style>",a+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",a+="form input {background: #fff;border: 1px solid #9c9c9c;}",a+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",a+="form button:hover {background: gold;}",a+="form label {padding: 0.5em 0.5em 0.5em 0;}",a+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",a+="form input:focus {outline: 3px solid gold;}",a+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",a+="</style>",a+='<form class="form1" action="">',a+='<label for="dtFrom" class="date">Date de début</label>',t?a+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(t).format("YYYY-MM-DD")+'">':a+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',a+='<label for="dtTo" class="date">Date de fin</label>',t?a+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(s).format("YYYY-MM-DD")+'">':a+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',a+="</form>";const{value:e}=await Swal.fire({title:"<strong>Choix de la période</strong>",icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez la période pour la sélection des temps facturés",showLoaderOnConfirm:!0,preConfirm:()=>[document.getElementById("dtFrom").value,document.getElementById("dtTo").value],onRender:o=>{},onOpen:o=>{n===!0&&o.querySelector("#dtFrom").addEventListener("change",_handler=function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:o=>{n===!0&&o.querySelector("#dtFrom").removeEventListener("change",_handler)},onAfterClose:o=>{},onDestroy:o=>{}});return t=dayjs(e[0]),s=dayjs(e[1]),await Ue(250),[t,s]},Nt=async function(t){await Swal.fire({position:"top-end",icon:"success",title:t,showConfirmButton:!1,timer:1500})};const Et=Fe(Be());class rt{static tbl_name="f_archives";static add=async function(t){let s=Et.default.Cfg.dbase,n=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]"),a={id:t[0].to.format("YYYYMM"),data:t,created_at:t[0].now};console.log(`%cWill create archive for id ${t[0].to.format("YYYYMM")} (YYYYMM)`,k),s.get(rt.tbl_name).push(JSON.parse(JSON.stringify(a))).write()};static exists=function(t){let s=Et.default.Cfg.dbase,n=s.get(rt.tbl_name).find({id:t}).value();return!(n===void 0)};static get=function(t){let s=Et.default.Cfg.dbase;var n=s.get(rt.tbl_name).find({id:t}).value();if(n===void 0)throw Error("Erreur qui ne devrait jamais arriver en Archive.get");return console.log(`%cWill use archive for id ${t} (YYYYMM)`,k),n};static delete=function(t=null,s=null){let n=Et.default.Cfg.dbase;if(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof s=="string"&&(s=s.format("YYYY-MM-DD")),t===null&&s==null){console.log("%cWanna suppress ALL Archives from DB ",k),n.get(rt.tbl_name).remove().write();return}if(s==null){n.get(rt.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMM").isBefore(s),"month"}).write();return}if(t==null){n.get(rt.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMM").isAfter(t,"month")}).write();return}n.get(rt.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMM").isBetween(t,s,"month","[]")}).write()}}var ut=rt;class _n{static isInOldMode=function(t){var s=null;typeof t=="string"?s=dayjs(t):s=t;try{return s.isBefore(_n.getOldModeDate())}catch(n){throw Error("Erreur qui ne devrait jamais arriver en IsInOldMode (probablement un probleme sur la conversion de la date en objet dayjs:"+n.stack||n)}};static getOldModeDate=function(){return dayjs("2020-06-01")};static getAppVersion=function(){return GM.info.script.version}}var we=_n;const Rt=Fe(Be());var Gn=function(){const t="students_history",s=1,n=2,a=function(T){if(T.toUpperCase()==="FUNDING")return s;if(T.toUpperCase()==="PATH")return n;throw Error("Erreur qui ne devrait jamais arriver en getype")},e=function(T,h,b=null){return l(T,s,h,b)},o=function(T,h,b=null){return l(T,n,h,b)},l=function(T,h,b,v=null){it(typeof T=="string","You must provide a string.",TypeError);const y=Rt.default.Cfg.dbase;typeof v=="string"&&(v=dayjs(v)),v===null&&(v=dayjs()),it(v instanceof dayjs,"created date must be a string, a dayjs instance or null.",TypeError);let O={id:T,type:0|h,value:b,date:v.valueOf(),humanDate:v.format("YYYY-MM-DDTHH:mm:ssZZ")};return console.log(`%cAdd in student history at date ${dayjs(O.date).format("YYYY-MM-DDTHH:mm:ssZZ")} data ${b} with type:${h}`,k),y.get(t).push(JSON.parse(JSON.stringify(O))).write()},p=function(T,h=null,b=null){const v=Rt.default.Cfg.dbase;return T==null&&h==null&&b==null?(console.log("%cRemove all in student history",k),v.get(t).remove().write()):(typeof b=="string"&&(b=dayjs(b)),b==null?h==null?(console.log(`%cRemove for student id:${T} history for all type of event`,k),v.get(t).remove({id:T}).write()):(console.log(`%cRemove for student id:${T} history with event type:${type}`,k),v.get(t).remove({id:T,type:h}).write()):(console.log(`%cRemove for student id:${T} history at date ${b.format("DD/MM/YYYY")} with event type:${type}`,k),v.get(t).remove({id:T,type:h,date:b.valueOf()}).write()))},f=function(T,h,b=null){const v=Rt.default.Cfg.dbase;typeof b=="string"&&(b=dayjs(b)),b===null&&(b=dayjs()),console.log(`%cSearching in student history at date ${b.format("DD/MM/YYYY")} any data with type:${h}`,k);var y=+b.valueOf(),O=v.get(t).filter(g=>g.id===T&&g.type&h).map(g=>g.date-y).filter(g=>g>=0).value();if(O.length==0){console.log(`%cThere is no data in student history at date ${b.format("DD/MM/YYYY")} with type:${h}`,k);return}const E=g=>Math.min(...g);let $=y+E(O);return v.get(t).filter(g=>g.id===T&&g.type&h&&g.date==$).value()[0]},d=function(T){return w(T,s)},i=function(T){return w(T,n)},w=function(T,h){return T.type&h};return Object.freeze({addFunding:e,addPath:o,getType:a,remove:p,find:f,isFunding:d,isPath:i,tbl_name:t})};const zn=Gn();var Me=zn;const st=Fe(Be());class he{static tbl_name="students";static add=function(t,s="noname",n="nopath",a="unknown",e){let o=st.default.Cfg.dbase;var l=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let p={id:t,fullname:s,path:n,funding:a,created:l};o.get(he.tbl_name).push(JSON.parse(JSON.stringify(p))).write()};static exists=function(t,s=null){let n=he.findById(t,s);return console.log(`%cStudent ${t} exists in db ? ${!(n===void 0)}`,k),!(n===void 0)};static findById=function(t,s=null){return it(typeof t=="string","You must provide a string.",TypeError),typeof s=="string"&&(s=dayjs(s)),s==null?he.m_findById(t,s):he.m_findById(t,s.format("YYYY-MM-DDTHH:mm:ssZZ"))};static _findById=function(t,s=null){let n=st.default.Cfg.dbase;typeof s=="string"&&(s=dayjs(s)),console.log(`%cSearching student with id:${t} in db`,k);var a=n.get(he.tbl_name).find({id:t}).value();if(a===void 0)return;if(s!==null){var e={...a},o=Me.find(t,Me.getType("FUNDING"),s);o!==void 0&&(e.funding=o.value);var l=Me.find(t,Me.getType("PATH"),s);return l!==void 0&&(e.path=l.value),e}return a};static m_findById=moize.default(he._findById,{maxAge:6e5,isSerialized:!0,onCacheHit:function(){console.log("%cGet data from cache",k)}});static getFunding=function(t,s=null){return typeof s=="string"&&(s=dayjs(s)),he.m_getFunding(t,s)};static _getFunding=function(t,s=null){let n=he.findById(t,s);return n===void 0?(console.log(`%cStudent ${studentId} is not in db, fetchin data:'funded mode' from webpage`,k),he.getFundingFomDashboard(studentId).toLowerCase()):n.funding.toLowerCase()};static m_getFunding=moize.default(he._getFunding,{maxAge:6e5,isSerialized:!0});static isAutoFunded=function(t){return console.log("%cFUNCTION DEPRECATED !!!!!!!!!!!!!!!!!!!!!! ",me),he.getFunded(t).toLowerCase()===He};static getFundingFomDashboard=async function(t){const s=await At(`https://openclassrooms.com/fr/mentorship/students/${t}/dashboard`,".mentorshipStudent__details > p");return s.innerText.trim()};static getPath=async function(t,s=null){let n=he.findById(t,s);if(n==null){console.log(`%cStudent ${t} is not in db, fetching data: 'path' from webpage ....`,k);const a=await At(`https://openclassrooms.com/fr/mentorship/students/${t}/dashboard`,"a[href*='paths/']");return a.innerText.length==0&&console.error(`%cStudent path is not readable from url : https://openclassrooms.com/fr/mentorship/students/${t}/dashboard`,me),a.innerText.trim()}else return n.path};static delete=function(t=null,s=null){let n=st.default.Cfg.dbase;if(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof s=="string"&&(s=s.format("YYYY-MM-DD")),t===null&&s==null){console.log("%cWanna suppress ALL Students from DB",k),n.get(he.tbl_name).remove().write();return}if(s==null){n.get(he.tbl_name).remove(function(a){return dayjs(a.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBefore(s),"day"}).write();return}if(t==null){n.get(he.tbl_name).remove(function(a){return dayjs(a.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isAfter(t,"day")}).write();return}n.get(he.tbl_name).remove(function(a){return dayjs(a.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBetween(t,s,"day","[]")}).write()};static deleteById=function(t,s=null){let n=st.default.Cfg.dbase;n.get("students").remove(a=>a.id===t).write(),console.log(`%cAll students with id:${t} are removed from DataBase`,k)};static modifyFunding(t,s,n){typeof s=="string"&&(s=dayjs(s)),it(created instanceof dayjs,"modifyFunding date must be a string, a dayjs instance or null.",TypeError);const a=he.getFunding(t,s);if(n.toLower()===a.toLower()){console.log(`%cFundingMode ${n} is identical as current: ${sCurrent}, nothing to do`,k);return}(n!==He||n!=Te||n!==Qe)&&console.log(`%cWarning this state is unknown ${n}`,Ne);const e=st.default.Cfg.dbase,o=dayjs().format("YYYY-MM-DDTHH:mm:ssZZ");if(s===null&&(s=o),oLastHistory=Me.find(t,Me.getType("FUNDING"),s),e.get(he.tbl_name).find({id:t}).assign({funding:n}).write(),Me.addFunding(t,a,o),s.isSameOrAfter(we.getOldModeDate()))var l=e.get("sessions").filter(f=>f.who_id===t&&(d=>dayjs(d.when).isSameOrAfter(s,"day")));else var l=e.get("sessions").filter(d=>d.who_id===t&&(i=>dayjs(i.when).isSameOrAfter(we.getOldModeDate(),"day")));for(var p=l.value().length;p-=1;)console.log(`There is ${p} elements left to update`,k),l.get(p).assign({funding:n}).write()}static getAll=async(t,s)=>{var n=!1;let a=st.default.Cfg.dbase;var e="table.crud-list tbody",o=document.querySelectorAll(e)[1];const l=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var p=performance.now(),f=ot(o.children[0].children[0],-2);await he.getFundingFomDashboard(f),console.log(`%cEstimated time for updating : ${(performance.now()-p)*o.children.length} ms`,k),Swal.fire({position:"top-end",icon:"info",toast:!0,title:`mise à jour de la base de donnée des étudiants...
cela peut prendre du temps ~ ${(performance.now()-p)*o.children.length/1e3} s`,showConfirmButton:!1,timer:1e3}),await Ue(1e3);for(const h of o.children){Nt(`Collecte les données de l'étudiant : ${h.children[0].innerText}`);var d=ot(h.children[0],-2),i=h.children[0].innerText,w="non défini";h.children[1].firstElementChild&&(w=h.children[1].firstElementChild.href.split("/").pop());let b=await he.getFundingFomDashboard(d);var T=he.m_findById(d,null);if(T===void 0)return console.log(`%cStudent ${i}(id:${d}) not present in database will create it`,k),he.add(d,i,w,b,l);b.toLowerCase()!==T.funding.toLowerCase()&&(a.get(he.tbl_name).find({id:d}).assign({funding:b.toLowerCase()}).write(),Me.add(d,Me.getType("FUNDING"),T.funding.toLowerCase(),dayjs()),console.log(`%cStudent ${i}(id:${d}) was already present in database but change of funding was detected (from ${T.funding.toLowerCase()} to ${b.toLowerCase()})`,k)),w!==T.path&&(a.get(he.tbl_name).find({id:d}).assign({path:w}).write(),Me.add(d,Me.getType("PATH"),T.path,dayjs()),console.log(`%cStudent ${i}(id:${d}) was already present in database but change of path was detected (from ${T.path} to ${w})`,k))}};static showList=function(){let t=st.default.Cfg.dbase,s=t.get(he.tbl_name).value();var n="";n+="<table>",n+="<caption>Liste des étudiant</caption>",n+="<thead>",n+="<tr>",n+="<th>Nom</th><th>Parcours</th><th>Financement</th><th>Date de création</th><th>Edition</th>",n+="</tr>",n+="</thead>",n+="<tbody>";for(var a in s)n+="<tr>",n+=`<td>${s[a].fullname}</td><td>${s[a].path}</td><td>${s[a].funding}</td>`,n+=`<td>${dayjs(s[a].created,"YYYY-MM-DDTHH:mm:ssZ[Z]").format("DD/MM/YYYY à HH:mm")}</td>`,n+=`<td><a href="https://openclassrooms.com/fr/mentorship/students/${s[a].id}/dashboard">${s[a].id}</a></td>`,n+="</tr>";n+="</tbody>",n+="</table>",Swal.fire({title:"<strong>Liste des Etudiants</strong>",icon:"info",html:n,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"fullscreen",onOpen:e=>{var o=e.querySelector("table"),l=new simpleDatatables.DataTable(o)}})};static createManually=async function(t,s,n){let a=["non présent dans la liste","Chef de projet digital","Chef de projet SI","Développeur d'application - Frontend","Développeur Web","Expert en stratégie marketing et communication ","Production de contenu web avec CMS et Content Marketing ","Tech lead"];var e="";e+="<style>",e+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",e+="form input {background: #fff;border: 1px solid #9c9c9c;}",e+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",e+="form button:hover {background: gold;}",e+="form label {padding: 0.5em 0.5em 0.5em 0;}",e+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",e+="form input:focus {outline: 3px solid gold;}",e+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",e+="</style>",e+='<form class="form1" action="">',e+='<label for="student_id" class="name">Reference</label>',e+='<input id="student_id" type="text" value="'+t+'">',e+='<label for="student_name" class="name">Name</label>',e+='<input id="student_name" type="text" value="'+s+'">',e+='<label for="funding">Autofinancé</label>',e+='<input id="funding" type="checkbox" value="autofunded">',e+='<label for="student_path">Parcours</label>',e+='<input id="student_path" name="student_path" type="text" list="student_path-list">',e+='<datalist id="student_path-list">';for(var o in a)e+=`<option>${a[o]}</option>`;e+="/<datalist>",e+='<label for="session_date">Date</label>',e+='<input id="session_date" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(n).format("YYYY-MM-DD")+'">',e+="</form>";const{value:l}=await Swal.fire({title:"<strong>Ajout d'un étudiant en mode manuel</strong>",icon:"info",html:e,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:`votre étudiant(e) ${s} n'a pas été trouvé`,preConfirm:()=>({student_id:document.getElementById("student_id").value,student_name:document.getElementById("student_name").value,student_path:document.getElementById("student_path").value,student_funding:document.getElementById("funding").checked,session_date:document.getElementById("session_date").value})});if(l&&l.hasOwnProperty("student_id")){var p="";l.student_funding===!0?p=He:p=Te,he.add(l.student_id,l.student_name,l.student_path,p,l.session_date)}}}var Ee=he;const vt=Fe(Be());class Ke{static tbl_name="sessions";static add=async function(t){let s=vt.default.Cfg.dbase;if(GM_config.get("checksessionalreadyexists")===!0)var n=!0;if(n===!0&&Ke.exists(t.id)===!0)return;if(we.isInOldMode(dayjs(t.when)))console.log("%cWe are in old mode",k),t.funding=Te,t.type.toLowerCase()==="soutenance"?(console.log("%cThis is a defense, we DON't need to add the path to the session",k),t.path="this ia a defense no need for path"):t.path="old mode no need for path";else if(t.type.toLowerCase()==="soutenance")console.log("%cThis is a defense nothing to do specially for now",k),t.funding=Te;else{if(Ee.exists(t.who_id)===!1&&(await Ee.getAll(),Ee.exists(t.who_id,t.when)==!1))return console.warn(`%cStudent {oSession.who_id} which exists at ${t.when} still not exit in Db, have to manually create him/her`,k),Ee.createManually(t.who_id,t.who_name,t.when);t.funding=await Ee.getFunding(t.who_id,t.when),t.path=await Ee.getPath(t.who_id,t.when)}console.log(`%cSaving session id:${t.id} of ${t.who_name}(${t.who_id}) at ${t.when} to DB`,k),s.get(Ke.tbl_name).push(JSON.parse(JSON.stringify(t))).write()};static exists=function(t){let s=vt.default.Cfg.dbase;console.log(`%cWill search existence of session id:${t} in database`,k);var n=s.get(Ke.tbl_name).find({id:t}).value();return!(n===void 0)};static delete=function(t=null,s=null){let n=vt.default.Cfg.dbase;if(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof s=="string"&&(s=s.format("YYYY-MM-DD")),t===null&&s==null){console.log("%cWanna suppress ALL Sessions from DB",k),n.get(Ke.tbl_name).remove().write();return}if(s==null){n.get(Ke.tbl_name).remove(function(a){return dayjs(a.when).isBefore(s),"day"}).write();return}if(t==null){n.get(Ke.tbl_name).remove(function(a){return dayjs(a.when).isAfter(t,"day")}).write();return}n.get(Ke.tbl_name).remove(function(a){return dayjs(a.when).isBetween(t,s,"day","[]")}).write()};static deleteById=function(t){let s=vt.default.Cfg.dbase;s.get("sessions").remove(n=>n.id===t).write(),console.log(`%cSession ${t} suppressed from DB`,k)};static getBetween(t,s){typeof t=="string"&&(t=dayjs(t)),typeof s=="string"&&(t=dayjs(s));let n=vt.default.Cfg.dbase,a=n.get(Ke.tbl_name).filter(e=>dayjs(e.when).isSameOrBefore(s,"day")&&dayjs(e.when).isSameOrAfter(t,"day")).value();return a}static parseTable=function(t){var s=t.children[0].children[0].innerText,n=ot(t.children[0]),a=t.children[1].children[0].innerText.trim(),e=ot(t.children[1],-2),o=t.children[2].innerText.trim().toLowerCase(),l=t.children[3].children.length?t.children[3].children[0].innerText.trim().toLowerCase():"session",p=-1;t.children[4].children.length>0&&(p=t.children[4].children[0].innerText.trim()),s=Zt(s);var f={id:n,when:s,who_id:e,who_name:a,status:o,type:l,lvl:p};return f}}var Ce=Ke;const xn=Fe(Be());class Ht{static calculateBill=function(t,s){let n=s.format("YYYYMM");if(ut.exists(n)===!0){console.log(`%cUse Archived version ${n} of accounting`,k);let a=ut.get(n);return a.data}return typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof s=="string"&&(s=s.format("YYYY-MM-DD")),Ht.m_calculateBill(t,s)};static _calculateBill=function(t,s){typeof t=="string"&&(t=dayjs(t)),typeof s=="string"&&(s=dayjs(s));const n=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var a=0,e=0,o=performance.now();const l=xn.default.Cfg.dbase,p=l.get(Ce.tbl_name).filter(c=>dayjs(c.when).isSameOrBefore(s,"day")&&dayjs(c.when).isSameOrAfter(t,"day")),f=p.value(),d=f.length;let i={from:t,to:s,created_at:null,maxLevel:Ve,number:0,amount:0,errors:{funding:[],level:[],path:[],status:[],type:[]},flatFee:[]},w=0,T=0,h=[];a=performance.now();const b=Ht.getPriceList(t);e=performance.now(),console.log("%cGetPriceList took "+(e-a)+" milliseconds.",Oe);let v=wn([Ve+1,Ve+1,Ve+1,Ve+1]);for(var y=0;y<d;y+=1){const c=f[y];var O=0;c.status===ct&&(O=X),c.status===ft&&(O=ee),c.status===pt&&(O=J),(c.status===mt||c.status===ht)&&(O=te);var E=0;c.type.toLowerCase()==="session"&&(E=U),c.type.toLowerCase()==="soutenance"&&(E=q),c.path!=null&&c.path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&c.type!=="soutenance"&&(E=G);var $=0;const u=we.isInOldMode(t);if(u===!0&&($=c.isFunded===!0?K:Q),c.funding===He&&($=Q),c.funding===Te&&($=K),c.funding===Qe&&($=Z),c.lvl<0){i.errors.level.push(c);continue}if(u===!1&&c.funding!==He&&c.funding!==Te&&c.funding!==Qe){i.errors.funding.push(c);continue}if(c.type.toLowerCase()!=="session"&&E!==q&&E!==G){i.errors.type.push(c);continue}if(c.status!==ct&&c.status!==ft&&c.status!==pt&&c.status!==mt&&c.status!==ht){i.errors.status.push(c);continue}let m=v.get(E,O,$,+c.lvl);m===void 0&&(m={number:0,amount:0,data:[]}),m.number+=1,w+=1,c.lvl<0?(m.amount+=0,T+=0):(m.amount+=1*b[c.lvl][E][O][$],T+=1*b[c.lvl][E][O][$]),m.data.push(c),v.set(E,O,$,+c.lvl,m),E===U&&$===Q&&h.push({id:+c.who_id,who_id:c.who_id,who_name:c.who_name})}var g=[];a=performance.now(),g=_.uniqBy(h,"id"),i.flatFee=g,i.number=w,i.amount=T,i.number+i.errors.funding.length+i.errors.level.length+i.errors.path.length+i.errors.status.length+i.errors.type.length<d&&(console.log(`%cError total number of sessions is ${d} and total number of sessions in bill ${w} + all errors are different`,me),console.log("errors are",i.errors),console.log("sessions are",f)),i.created_at=n,v.set(0,0,0,0,i);var C=performance.now();return console.log("%cFunction took "+(C-o)+" milliseconds.",Oe),v};static m_calculateBill=moize.default(Ht._calculateBill,{maxAge:12e4,isSerialized:!0,onCacheAdd:function(t,s,n){console.log("%cAdd data to cache",k)},onCacheHit:function(){console.log("%cGet data from cache",k)}});static getPriceList=function(t){typeof t=="string"&&(t=dayjs(t));var s=[0,jt,Ot,Pt,Bt,Lt,It];const n=we.isInOldMode(t);var a=new Array(7);for(let e=1;e<=Ve;e+=1){let o=s[e],l=s[e]/2,p=s[e]/4;n?(a[e]=new Array(3),a[e][U]=new Array(5),a[e][U][X]=new Array(4),a[e][U][X][Q]=o,a[e][U][X][K]=o,a[e][U][X][Z]=o,a[e][U][ee]=new Array(4),a[e][U][ee][Q]=0,a[e][U][ee][K]=0,a[e][U][ee][Z]=0,a[e][U][J]=new Array(4),a[e][U][J][Q]=l,a[e][U][J][K]=l,a[e][U][J][Z]=l,a[e][U][te]=new Array(4),a[e][U][te][Q]=l,a[e][U][te][K]=l,a[e][U][te][Z]=l,a[e][q]=new Array(5),a[e][q][X]=new Array(4),a[e][q][X][Q]=o,a[e][q][X][K]=o,a[e][q][X][Z]=o,a[e][q][ee]=new Array(4),a[e][q][ee][Q]=0,a[e][q][ee][K]=0,a[e][q][ee][Z]=0,a[e][q][J]=new Array(4),a[e][q][J][Q]=l,a[e][q][J][K]=l,a[e][q][J][Z]=l,a[e][q][te]=new Array(4),a[e][q][te][Q]=l,a[e][q][te][K]=l,a[e][q][te][Z]=l,a[e][G]=new Array(5),a[e][G][X]=new Array(4),a[e][G][X][Q]=o,a[e][G][X][K]=o,a[e][G][X][Z]=o,a[e][G][ee]=new Array(4),a[e][G][ee][Q]=0,a[e][G][ee][K]=0,a[e][G][ee][Z]=0,a[e][G][J]=new Array(4),a[e][G][J][Q]=l,a[e][G][J][K]=l,a[e][G][J][Z]=l,a[e][G][te]=new Array(4),a[e][G][te][Q]=l,a[e][G][te][K]=l,a[e][G][te][Z]=l):(a[e]=new Array(3),a[e][U]=new Array(5),a[e][U][X]=new Array(4),a[e][U][X][Q]=l,a[e][U][X][K]=o,a[e][U][X][Z]=o,a[e][U][ee]=new Array(4),a[e][U][ee][Q]=0,a[e][U][ee][K]=0,a[e][U][ee][Z]=0,a[e][U][J]=new Array(4),a[e][U][J][Q]=0,a[e][U][J][K]=0,a[e][U][J][Z]=0,a[e][U][te]=new Array(4),a[e][U][te][Q]=p,a[e][U][te][K]=l,a[e][U][te][Z]=l,a[e][q]=new Array(5),a[e][q][X]=new Array(4),a[e][q][X][Q]=o,a[e][q][X][K]=o,a[e][q][X][Z]=o,a[e][q][ee]=new Array(4),a[e][q][ee][Q]=0,a[e][q][ee][K]=0,a[e][q][ee][Z]=0,a[e][q][J]=new Array(4),a[e][q][J][Q]=0,a[e][q][J][K]=0,a[e][q][J][Z]=0,a[e][q][te]=new Array(4),a[e][q][te][Q]=l,a[e][q][te][K]=l,a[e][q][te][Z]=l,a[e][G]=new Array(5),a[e][G][X]=new Array(4),a[e][G][X][Q]=o,a[e][G][X][K]=o,a[e][G][X][Z]=o,a[e][G][ee]=new Array(4),a[e][G][ee][Q]=0,a[e][G][ee][K]=0,a[e][G][ee][Z]=0,a[e][G][J]=new Array(4),a[e][G][J][Q]=0,a[e][G][J][K]=0,a[e][G][J][Z]=0,a[e][G][te]=new Array(4),a[e][G][te][Q]=l,a[e][G][te][K]=l,a[e][G][te][Z]=l)}return a}}var Ge=Ht;const wt=Fe(Be());class _e{static tbl_name="history_session_cache";static getSessionPage=function(t){t.get("day")<t.daysInMonth()&&(t=t.endOf("month")),console.log(`%cSearch in history session cache data for id: ${t.format("DD/MM/YYYY")}`,k);let s=wt.default.Cfg.dbase;if(!s.has(_e.tbl_name).value())throw Error(`DB ${_e.db_name} NOT FOUND`);let n=s.get(_e.tbl_name).find({id:+t.format("YYYYMMDD")}).value();return n===void 0?-1:n};static getNearestSessionPage=function(t){t.get("day")<t.daysInMonth()&&(t=t.endOf("month")),console.log(`%cSearch in history session cache NEAREST cached data for id: ${t.format("DD/MM/YYYY")}`,k);let s=wt.default.Cfg.dbase;if(!s.has(_e.tbl_name).value())throw Error(`DB ${_e.db_name} NOT FOUND`);let n=+t.format("YYYYMMDD"),a=s.get(_e.tbl_name).value().map(l=>+l.id-n).filter(l=>l>0);const e=l=>Math.min(...l);let o=e(a)+n;return console.log(`%cNearest data in history session cache is data with id: ${t.format("DD/MM/YYYY")}`,k),a=s.get(_e.tbl_name).find({id:o}).value(),a===void 0?-1:a};static getSameOrNearestSessionPage=function(t){let s=_e.getSessionPage(t);return s===-1&&(s=_e.getNearestSessionPage(t)),s};static delete=function(t=null,s=null){let n=wt.default.Cfg.dbase;if(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof s=="string"&&(s=s.format("YYYY-MM-DD")),t===null&&s==null){n.get(_e.tbl_name).remove().write(),console.log("%cWanna suppress ALL History from DB",k);return}if(s==null){n.get(_e.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMMDD").isBefore(s),"day"}).write();return}if(t==null){n.get(_e.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMMDD").isAfter(t,"day")}).write();return}n.get(_e.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMMDD").isBetween(t,s,"day","[]")}).write()};static addOrUpdateSessionPage=function(t=1,s=dayjs("1970-10-06")){_e.getSessionPage(s)==-1?_e.addSessionPage(t,s):_e.updateSessionPage(t,s)};static updateSessionPage=function(t=1,s=dayjs("1970-10-06")){let n=wt.default.Cfg.dbase,a=_e.getSessionPage(s);if(a==-1)throw Error("session page not found in history");n.get(_e.tbl_name).find({id:+s.format("YYYYMMDD")}).assign({page:t}).write()};static addSessionPage=function(t=1,s=dayjs("1970-10-06")){let n=wt.default.Cfg.dbase;n.get(_e.tbl_name).push(JSON.parse(JSON.stringify({id:+s.format("YYYYMMDD"),page:t}))).write()}}var bt=_e;var Xt=function(t,s){let n=[[0,1,2,3,4,5,5],[5,1,2,3,4,5,5],[4,5,1,2,3,4,4],[3,4,5,1,2,3,3],[2,3,4,5,1,2,2],[1,2,3,4,5,1,1],[0,1,2,3,4,5,0]];return Math.trunc(s.diff(t,"days")/7)*5+n[t.day()][s.day()]};const Sn=Fe(Be());class Wn{static detail_bill="truc";static getListDetailBill=function(t,s){let n=Sn.default.Cfg.dbase,a=n.get(Ce.tbl_name).filter(y=>dayjs(y.when).isSameOrBefore(s,"day")&&dayjs(y.when).isSameOrAfter(t,"day")).sortBy(function(y){return dayjs(y.when).valueOf()}).value();const e=we.getOldModeDate();let o=Ge.getPriceList(e.subtract(1,"day")),l=Ge.getPriceList(e),p=0;var f=_.cloneDeep(a);for(var d in f){var i=0,w=0,T=!0,h=0;f[d].status===ct&&(h=X),f[d].status===ft&&(h=ee),f[d].status===pt&&(h=J),(f[d].status===mt||f[d].status===ht)&&(h=te);var b=0;f[d].type.toLowerCase()==="session"&&(b=U),f[d].type.toLowerCase()==="soutenance"&&(b=q),f[d].path!=null&&f[d].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&f[d].type!=="soutenance"&&(b=G);var v=0;f[d].funding===He&&(v=Q),f[d].funding===Te&&(v=K),f[d].funding===Qe&&(v=Z),we.isInOldMode(dayjs(f[d].when))?i=+f[d].lvl>0?o[+f[d].lvl][b][h][v]:0:(T=!1,i=+f[d].lvl>0?l[+f[d].lvl][b][h][v]:0),p+=i,f[d].iPu=i,f[d].oldMode=T,f[d].iCumul=p}return f};static getListStatistic=function(t,s){let n=t.clone(),a=n.endOf("month"),e=[],o=[],l=0,p=s.diff(t,"month");for(var f=performance.now();n.isSameOrBefore(s,"day");)e.push(Ge.calculateBill(n,a)),n=n.add(1,"month"),a=n.endOf("month");var d=performance.now();console.log("%cComputed data between the two dates in"+(d-f)+" milliseconds.",Oe),n=t.clone(),a=n.endOf("month");let i=0,w=0,T=0,h=0,b=0,v=0,y=0;for(;l<=p;){const E=e[l].get(0,0,0,0),$=E.maxLevel;o[l]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let g=1;for(;g<$;){let c=0,u=0,m=0,A=0;i=e[l].get(U,X,Q,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(U,X,K,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(U,X,Z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,we.isInOldMode(n)?(o[l].kpi.hrs+=(i+w+T)*(45/60),o[l].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsS")/60)):(o[l].kpi.hrs+=T*(30/60),o[l].kpi.hrsp+=T*(GM_config.get("nbHrsAfM")/60),o[l].kpi.hrs+=(i+w)*(45/60),o[l].kpi.hrsp+=(i+w)*(GM_config.get("nbHrsfM")/60)),i=e[l].get(U,ee,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(U,ee,K,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(U,ee,Z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,we.isInOldMode(n)?(i=e[l].get(U,J,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(U,J,K,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(U,J,Z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount):(i=e[l].get(U,J,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(U,J,K,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(U,J,Z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount),i=e[l].get(U,te,Q,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(U,te,K,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(U,te,Z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i,o[l].kpi.hrs+=(i+w+T)*(15/60),o[l].kpi.hrsp+=(i+w+T)*(15/60),c=o[l].sessions.total,u=o[l].sessions.nb,m=o[l].sessions.pu,A=o[l].sessions.nbc,o[l].sessions={total:b+c,nb:h+u,pu:(b+c)/(h+u),nbc:v+A},c=0,u=0,m=0,A=0,h=0,b=0,v=0,y=0,i=e[l].get(q,X,Q,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(q,X,K,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(q,X,Z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,o[l].kpi.hrs+=(i+w+T)*(45/60),o[l].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsD")/60),i=e[l].get(q,ee,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(q,ee,K,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(q,ee,Z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(q,J,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(q,J,K,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(q,J,Z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(q,te,Q,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(q,te,K,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(q,te,Z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,o[l].kpi.hrs+=(i+w+T)*(15/60),o[l].kpi.hrsp+=(i+w+T)*(15/60),c=o[l].defenses.total,u=o[l].defenses.nb,m=o[l].defenses.pu,A=o[l].defenses.nbc,o[l].defenses={total:b+c,nb:h+u,pu:(b+c)/(h+u),nbc:v+A},c=0,c=0,u=0,m=0,A=0,h=0,b=0,v=0,y=0,i=e[l].get(G,X,Q,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(G,X,K,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(G,X,Z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,o[l].kpi.hrs+=(i+w+T)*(45/60),o[l].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsC")/60),i=e[l].get(G,ee,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(G,ee,K,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(G,ee,Z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(G,J,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(G,J,K,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(G,J,Z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(G,te,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(G,te,K,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(G,te,Z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,c=o[l].coaches.total,u=o[l].coaches.nb,m=o[l].coaches.pu,A=o[l].coaches.nbc,i=typeof i=="undefined"?0:i.number,o[l].kpi.hrs+=i*(15/60),o[l].kpi.hrsp+=i*(15/60),o[l].coaches={total:b+c,nb:h+u,pu:(b+c)/(h+u),nbc:v+A},g+=1}let C=E.flatFee.length;for(var O=0;O<C;O+=1)o[l].bonus+=30;a.isAfter(s,"day")&&(a=s.clone()),o[l].kpi.jrs=Xt(n,a),o[l].header.dtFrom=n.format("YYYY-MM-DD"),o[l].header.dtTo=a.format("YYYY-MM-DD"),o[l].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),n=n.add(1,"month"),a=n.endOf("month"),l+=1}return o};static getListStatisticOld=function(t,s){let n=t.clone(),a=n.endOf("month"),e=[],o=[],l=s.get("month")-t.get("month");for(var p=performance.now();n.isSameOrBefore(s,"day");)e.push(Ge.calculateBill(n,a)),n=n.add(1,"month"),a=n.endOf("month");var f=performance.now();console.log("%cComputed data between the two dates in"+(f-p)+" milliseconds.",Oe);let d=0;for(n=t.clone(),a=n.endOf("month"),console.log(e);d<=l;){let i=e[d][0].max_level;o[d]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let w=1;for(;w<i;){let T=[...Array(8).keys()];for(let h=0;h<T.length;h+=1)o[d].sessions.total+=e[d][w].sessions.number[h]*e[d][w].sessions.pu[h],o[d].sessions.nb+=e[d][w].sessions.number[h],o[d].defenses.total+=e[d][w].defenses.number[h]*e[d][w].defenses.pu[h],o[d].defenses.nb+=e[d][w].defenses.number[h],we.isInOldMode(n)?[1,5].includes(h)&&(o[d].sessions.nbc+=e[d][w].sessions.number[h],o[d].defenses.nbc+=e[d][w].defenses.number[h]):[1,2,5,6].includes(h)&&(o[d].sessions.nbc+=e[d][w].sessions.number[h],o[d].defenses.nbc+=e[d][w].defenses.number[h]),we.isInOldMode(n)?(o[d].kpi.hrs+=(e[d][w].sessions.number[h]-e[d][w].defenses.number[h])*(45/60),o[d].kpi.hrsp+=(e[d][w].sessions.number[h]-e[d][w].defenses.number[h])*(GM_config.get("nbHrsfM")/60)):([4,5,6,7].includes(h)&&(o[d].kpi.hrs+=(e[d][w].sessions.number[h]-e[d][w].defenses.number[h])*(30/60),o[d].kpi.hrsp+=(e[d][w].sessions.number[h]-e[d][w].defenses.number[h])*(GM_config.get("nbHrsAfM")/60)),[0,1,2,3].includes(h)&&(o[d].kpi.hrs+=(e[d][w].sessions.number[h]-e[d][w].defenses.number[h])*(45/60),o[d].kpi.hrsp+=(e[d][w].sessions.number[h]-e[d][w].defenses.number[h])*(GM_config.get("nbHrsfM")/60))),o[d].kpi.hrs+=e[d][w].defenses.number[h]*(45/60),o[d].kpi.hrsp+=e[d][w].defenses.number[h]*(GM_config.get("nbHrsD")/60);w+=1}o[d].sessions.pu=o[d].sessions.total/(o[d].sessions.nb-o[d].sessions.nbc),o[d].defenses.pu=o[d].defenses.total/(o[d].defenses.nb-o[d].defenses.nbc),o[d].coaches.total=o[d].sessions.total-o[d].defenses.total,o[d].coaches.nb=o[d].sessions.nb-o[d].defenses.nb,o[d].coaches.nbc=o[d].sessions.nbc-o[d].defenses.nbc,o[d].coaches.pu=o[d].coaches.total/(o[d].coaches.nb-o[d].coaches.nbc);for(let T=0;T<e[d][0].bonus.length;T+=1)o[d].bonus+=e[d][0].bonus[T].sessions>0?30:0;a.isAfter(s,"day")&&(a=s.clone()),o[d].kpi.jrs=Xt(n,a),o[d].header.dtFrom=n.format("YYYY-MM-DD"),o[d].header.dtTo=a.format("YYYY-MM-DD"),o[d].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),n=n.add(1,"month"),a=n.endOf("month"),d+=1}return o}}var Ut=Wn;class Qn{static addFooter=async function(t,s,n={}){const{degrees:a,PDFDocument:e,rgb:o,StandardFonts:l}=PDFLib,p=t.getPageCount(),f="8".repeat(p),d=await t.embedFont(l.TimesRoman),i=12,w=d.widthOfTextAtSize(`page ${f} / ${f}`,i),T=10,h=10,b=1,v=o(0/255,0/255,0/255),y=o(253/255,246/255,227/255),O=5,E=5,$=3,g=3,C=!0;t.getPages().forEach((c,u)=>{if(!(C===!0&&u==0)){const{width:m,height:A}=c.getSize(),L=i+2*b+$+g;c.moveTo(T+O,i+g),c.setFont(d),c.setFontSize(i),c.setFontColor(o(1,0,0)),s!==void 0&&c.drawText(`${s}`),c.drawText(`page ${u+1} / ${p}`,{x:m-w-E}),c.drawRectangle({x:T,y:10,width:m-(T+h),height:L,color:y,opacity:.6,borderColor:v,borderWidth:b})}})};static changePgIfNeeded(t,s,n,a){var e=a.getPageCount(),o=a.getPages()[e-1],l=o.fontSize,p=o.getFont(),f=o.lineHeight;return t<s&&(n=1,o=a.addPage(),o.font=p,o.setFontSize(l),o.lineHeight=f),[n,o]}}var Ze=Qn;const Ct=Fe(Be());var Vn=function(){const t="meta",s=function(o){return it(typeof o=="string","You must provide a string.",TypeError),Ct.default.Cfg.dbase.get(en.tbl_name).find({key:"dbVersion"}).assign({value:o}).write().value},n=function(){let o=Ct.default.Cfg.dbase.get(en.tbl_name).find({key:"dbVersion"}).value();return typeof o=="undefined"?-1:o.value},a=function(){return Ct.default.Cfg.dbase.get("meta").remove(o=>!0).write()},e=function(){return console.log("%c resetDbVersion NE FONCTIONNE PAS",me),Ct.default.Cfg.dbase.get("meta").find({key:"dbVersion"}).remove(o=>!0).write()};return Object.freeze({getDbVersion:n,setDbVersion:s,delDbVersion:e,tbl_name:t})};const en=Vn();var nt=en;const An=Fe(Be());var En=async function(){let t=An.default.Cfg.dbase;const s=await Swal.mixin({confirmButtonText:"Suivant &rarr;",showCancelButton:!0,progressSteps:["0","1","2","3","4","5"],onOpen:function(w){console.log("...onOpen")},onRender:function(w){console.log("....onUpdate")},onClose:function(w){console.log(".....onClose")},onAfterClose:function(w){console.log("......onAfterClose")},onDestroy:function(w){console.log(".......onDestroy")}}).queue([{title:"Migration de la base",html:"<p>Cette migration va corriger la base et ajouter les nouveaux champs nécessaires, l`interrpuption du traitement est sans danger (mais ce n' est pas une raison !)</p>"},{title:"Correction de la table étudiant",html:"<p>Correction de la liste des étudiants (who_id)",onOpen:async function(w){console.log("%cMigration table des étudiants correction du who_id",k),Swal.showLoading();var T=dayjs("2020-06-01"),h=t.get("students"),b=h.value(),v=t.get("sessions").filter(g=>dayjs(g.when).isSameOrAfter(T,"day")),y=h.size().value(),O=Swal.getContent().textContent;for(f=0;f<y;f+=1){var E=v.find(C=>C.who_name===b[f].fullname).value();E!==void 0&&h.get(f).assign({who_id:E.who_id}).write();const g=Swal.getContent();g!=null&&(g.innerHTML=`${O}<br /><p>Traitement en cours : ${f}/${b.length}</p>`),await Ue(1)}Swal.hideLoading();const $=Swal.getContent();$!=null&&($.textContent=`Traitement terminé : ${b.length}/${b.length}`)}},{title:"Correction de la table étudiant",html:"<p>Correction de la liste des étudiants funded devient funding</p>",onOpen:async function(w){console.log("%cMigration : table des étudiants suppression de l'ancien champs et ajout du champs funding",k),Swal.showLoading();for(var T=t.get("students"),h=T.size().value(),b=Swal.getContent().textContent,v=0;v<h;v+=1){var y=T.get(v).value().fundedby;if(y===void 0){console.log("%cStudent ${oListStudents.get(i).who_name} already converted, skip it",k);continue}T.get(v).unset(["fundedby"]).assign({funding:y}).write(),console.log("%cStudent ${oListStudents.get(i).who_name} create field funding and remove fundedby",k);const E=Swal.getContent();E!=null&&(E.innerHTML=`${b}<br /><p>Traitement en cours : ${v}/${h}</p>`),await Ue(1)}Swal.hideLoading();const O=Swal.getContent();O!=null&&(O.textContent=`Traitement terminé : ${h}/${h}`)}},{title:"Correction table Etudiants",html:"<p>Correction de la liste des sessions, ajout du path dans la session</p>",onOpen:async function(w){console.log("%cMigration table des sessions correction de id_who",k),Swal.showLoading();var T=dayjs("2020-06-01"),h=t.get("students"),b=h.value(),v=t.get("sessions").filter(C=>dayjs(C.when).isSameOrAfter(T,"day")),y=v.filter(C=>C.type!="soutenance").value(),O=Swal.getContent().textContent;for(f=0;f<y.length;f+=1){var E=h.find({who_id:y[f].who_id}).value();console.log("found",E);var $=E!==void 0&&E.path.length>0?E.path:"0-unknown";t.get("sessions").find({id:y[f].id}).assign({path:$}).write();const C=Swal.getContent();C!=null&&(C.innerHTML=`${O}<br /><p>Traitement en cours : ${f}/${y.length}</p>`),await Ue(1)}Swal.hideLoading();const g=Swal.getContent();g!=null&&(g.textContent=`Traitement terminé : ${f}/${y.length}`)}},{title:"Migration de la table des Sessions",html:'<p>Correction de la liste des sessions, suppression du champs "isFunded"</p>',onOpen:async function(w){console.log("%cMigration : table des sessions suppression de isFunded",k),Swal.showLoading();for(var T=dayjs("2020-06-01"),h=t.get("students").value(),b=t.get("sessions").filter($=>dayjs($.when).isSameOrAfter(T,"day")),v=Swal.getContent().textContent,y=b.value().length;y-=1;){var O=b.get(y);O.value().isFunded===void 0||O.value().isFunded===void 0?console.log(`%cSkip ${O.value()} already converted`,k):O.unset(["isFunded"]).write();const $=Swal.getContent();$!=null&&($.innerHTML=`${v}<br /><p>Traitement en cours : il reste ${y} élements à convertir</p>`),await Ue(1)}Swal.hideLoading();const E=Swal.getContent();E!=null&&(E.textContent=`Traitement en terminé : ${b.value().length}/${b.value().length}`)}},{title:"Migration de la table des Sessions",html:"<p>Correction de la liste des sessions, ajout de funding</p>",onOpen:async function(w){console.log("%cMigration : table des sessions ajout de fundedBy",k),Swal.showLoading();for(var T=dayjs("2020-06-01"),h=t.get("students").value(),b=t.get("sessions").filter(C=>dayjs(C.when).isSameOrAfter(T,"day")),v=b.filter(C=>C.type!="soutenance"),y=Swal.getContent().textContent,O=v.value().length;O-=1;){var E=v.get(O);E.value().funding!==void 0?console.log(`%cSkip ${E.value()} already converted`,k):E.assign({funding:Ee.getFunding(E.value().who_id)}).write();const C=Swal.getContent();C.innerHTML=`${y}<br /><p>Traitement en cours : il rest ${O}élements à convertir</p>`,await Ue(1)}for(var $=O,v=b.filter(C=>C.type=="soutenance"),O=0;O<v.value().length;O+=1){v.get(O).assign({funding:Te}).write();const c=Swal.getContent();c!=null&&(c.innerHTML=`${y}<br /><p>Traitement en cours : ${$+O}/${b.value().length}</p>`),await Ue(1)}Swal.hideLoading();const g=Swal.getContent();g!=null&&(g.textContent=`Traitement terminé :  ${b.value().length}/${b.value().length}`)}}]).then(w=>{if(w.value){const T=JSON.stringify(w.value);Swal.fire({title:"Traitement terminé!",html:`
			Your answers:
			<pre><code>${T}</code></pre>
		  `,confirmButtonText:"Lovely!"})}else return console.log("%c resultat en erreur",k,w,w.dismiss===Swal.DismissReason.cancel),-1});return s;var n,a,e;for(f=0;f<a.length;f+=1){var o=e.find(w=>w.who_name===a[f].fullname).value();o!==void 0&&t.get("students").find({fullname:o.who_name}).assign({who_id:o.who_id}).write()}var l;for(f=0;f<l.length;f+=1){var o=t.get("students").find({who_id:l[f].who_id}).value(),p=o!==void 0&&o.path.length>0?o.path:"0-unknown";t.get("sessions").find({id:l[f].id}).assign({path:p}).write()}for(var f=0;f<e.value().length;f+=1)e.get(f).unset(["isFunded"]).write();for(var d,f=0;f<d.value().length;f+=1){var i=d.get(f);i.assign({fundedBy:Ee.getFunded(i.value().who_id)}).write()}for(var d,f=0;f<d.value().length;f+=1)d.get(f).assign({fundedBy:Te}).write()};const Je=Fe(Be()),Cn=Fe(an());class Tn{static save=function(){return console.log("%cWanna save DBASE",k),JSON.stringify(Je.default.Cfg.dbase.getState())};static load=function(t){return console.log(`%cWanna load ${t} in DBASE`,k),console.log("%c !!!!!! TYPE NOT CHECKED BE CARREFULL",k),Je.default.Cfg.dbase.setState(JSON.parse(t)).write()};static update=async function(t){console.log(`%cIs there any update to DB to go to version ${t}`,k);const s=[{version:"1.00.0006",action:En}];for(let a=0,e=s.length;a<e;a++)if(St(t,s[a].version)==0){console.log(`%cFound an update to DB version '${s[a].version}' proceed conversion...`,k);let o=await s[a].action();if(o==-1)console.log(`%cError something was wrong during update of database from version: ${nt.getVersion()} to version:${s[a].version}.... you have canceled it`,me),Swal.fire({icon:"error",title:"Oops...",text:`Quelque chose s'est mal passé ou vous avez annulé l'update 

Utiliser l'application dans ces conditions n'est pas garanti  !`,footer:'<a href="https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/issues">Générer un bug?</a>'});else{let l=nt.setDbVersion(t);console.log(`%cChanged DB to version ${l}`,k)}}let n=nt.setDbVersion(t);console.log(`%cChanged DB to version ${n}`,k)};static erase=function(t){return console.log(`%cErase all data of table: ${t}`,k),Je.default.Cfg.dbase.get(t).remove().write()};static exportTblToCSV=function(t="",s,n){const a=Tn.exportTblToJSON(t,s,n),e={quotes:!1,quoteChar:'"',escapeChar:'"',delimiter:",",header:!0,newline:`\r
`,skipEmptyLines:!1,columns:null};return Cn.default.unparse(a,e)};static exportTblToJSON=function(t="",s,n){if(t=="")return console.log("%cIrrecoverable Error: You forget to define a data table name",me),-1;if(s!==null&&s!==""&&(dtFrom=dayjs(s)),n!==null&&n!==""&&(dtTo=dayjs(n)),Je.default.Cfg.dbase.has(t).value==!1)return console.log(`%cIrrecoverable Error: table ${t} don't exist`,me),-1;if(t===Ce.tbl_name){if(typeof dtFrom=="object"&&dtTo==="object")return Je.default.Cfg.dbase.get(t).filter(a=>dayjs(a.when).isSameOrBefore(dtTo,"day")&&dayjs(a.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtFrom=="object")return Je.default.Cfg.dbase.get(t).filter(a=>dayjs(a.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtTo=="object")return Je.default.Cfg.dbase.get(t).filter(a=>dayjs(a.when).isSameOrBefore(dtTo,"day")).value()}return Je.default.Cfg.dbase.get(t).value()}}var dt=Tn;var Dn=async function(){var t="";t+="<style>div.about_content {background-color: #fed9ff;/*width: 600px;*/height: var(--heigth, 80%);overflow-x: hidden;overflow-y: auto;text-align: left;padding: 20px;}</style>",t+='<div class="about_content" style="--heigth: 600px;">',t+='<div class="about_content__wrapper">';const s=await Ft.XHR({method:"GET",url:"https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/README.md",responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"}});var n=s.responseText,a=new showdown.Converter,e=a.makeHtml(n);t+=e,t+="</div>",t+="</div>",Swal.fire({title:`<strong>A propos de ${Yt}</strong>`,icon:"info",html:t,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},xt=function(){var t="table.crud-list tbody",s=document.querySelector(t),n=!1;if(s.querySelector("[type=checkbox]")===null){for(const T of s.children){var a=ot(T.children[0]),e=document.createElement("input");e.type="checkbox",e.name="name",e.value=a,e.id="id",n=Ce.exists(a),n===!0&&(e.checked=!0);var o=document.createElement("td");o.style="text-align: center",o.appendChild(e),T.appendChild(o)}t="table.crud-list thead tr";var l=document.querySelector(t);e=document.createElement("input"),e.type="checkbox",e.name="name",e.value="value",e.id="id",e.onclick=function(){document.querySelectorAll("tbody input[type=checkbox]").forEach(T=>T.checked=!T.checked)},e.style="visibility: hidden;";var p=document.createElement("label");p.innerText="in DB",p.style="display:block;",p.onMouseOver="this.style.cursor=pointer;",p.onMouseOut="this.style.cursor=auto;",p.appendChild(e),o=document.createElement("td"),o.style="text-align: center",o.appendChild(p),l.appendChild(o)}else{for(var f=s.querySelectorAll("[type=checkbox]"),d=f.length,i=new Array(d);d--;i[d]=f[d]);for(var w in i)n=Ce.exists(i[w].value),n===!0?i[w].checked=!0:i[w].checked=!1}},$n=async function(){var[t,s]=await yt(dayjs().startOf("month"),dayjs().endOf("month"));let n=Ut.getListDetailBill(t,s),a="";a+="<table>",a+="<thead>",a+="<tr><th>Quand</th><th>Qui</th><th>Financé ?</th><th>Type</th><th>Niveau</th><th>Ancien Mode ?</th><th>Statut</th><th>PU HT</th><th>Cumul</th></tr>",a+="<thead>",a+="<tbody>";for(let e=0;e<n.length;e+=1)a+="<tr>",a+=`<td>${dayjs(n[e].when).format("DD/MM/YYYY à HH:mm:ss")}</td>`,a+=`<td>${n[e].who_name}</td><td>${n[e].funding}</td>`,sType=n[e].type,n[e].path!=null&&n[e].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&n[e].type!=="soutenance"&&(sType="Coaching"),a+=`<td>${sType}</td><td>${n[e].lvl}</td>`,a+=`<td>${n[e].oldMode===!0?"Oui":"Non"}</td>`,a+=`<td>${n[e].status}</td>`,a+=`<td>${n[e].iPu}</td><td>${n[e].iCumul}€</td>`,a+="</tr>";a+="</tbody>",a+="</table>",Swal.fire({title:`<strong>Liste détaillées des sessions du ${t.format("DD/MM/YYYY")} au ${s.format("DD/MM/YYYY")}</strong>`,icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:e=>{var o=e.querySelector("table"),l=new simpleDatatables.DataTable(o)}})},Mn=async function(){var[t,s]=await yt(dayjs().startOf("month"),dayjs().endOf("month"));let n=0,a=GM_config.get("maxfetchpg"),e=!0;var o={};let l=[],p=1,f=bt.getSameOrNearestSessionPage(s);for(f!==void 0&&f.page>p&&(p=f.page);e;){if(n>a){console.warn("%cEMERGENCY EXIT LOOP",Ne);break}try{o=await Kn(t,s,p,l)}catch(w){throw console.error(`%c IRRECOVERABLE ERROR ... ${w}, will exit !!!! `,me),new Error}o.length>0&&dayjs(o[o.length-1].when).isSameOrBefore(t)===!0&&(e=!1),p+=1,n+=1}GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let d='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';var i=o.length;Swal.fire({title:"Traitement en cours!",html:d,confirmButtonText:"Lovely!",onBeforeOpen:function(w){var T=new ldBar("#pbar")},onRender:function(w){},onOpen:async function(w){var T=document.getElementById("pbar").ldBar;for(var h in o){if(dayjs(o[h].when).isBefore(t,"day")===!0)break;if(dayjs(o[h].when).isAfter(s,"day")===!0){T.set(h/i*100,!1);continue}dayjs(o[h].when).isBetween(t,s,"day","[]")&&(await Ce.add(o[h]),T.set(h/i*100,!1))}T.set(100,!1),Swal.getTitle().innerText="Traitement terminé !"},onClose:function(w){},onAfterClose:function(w){},onDestroy:function(w){}}),xt()},kn=async function(){var t="table.crud-list tbody input:checked",s=document.querySelectorAll(t);GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let n='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';Swal.fire({title:"Traitement en cours!",html:n,confirmButtonText:"Lovely!",onBeforeOpen:function(a){var e=new ldBar("#pbar")},onRender:function(a){},onOpen:async function(a){for(var e=document.getElementById("pbar").ldBar,o=0;o<s.length;o+=1){var l=s[o].parentElement.parentElement,p=Ce.parseTable(l);await Ce.add(p),e.set(o/s.length*100,!1)}e.set(100,!1),Swal.getTitle()&&(Swal.getTitle().innerText="Traitement terminé !")},onClose:function(a){},onAfterClose:function(a){},onDestroy:function(a){}})},Yn=function(){const t=unsafeWindow.Facturier.cfg.dbase,s=unsafeWindow.Facturier.libs.find(f=>f.id=="dayjs").ptr,n=unsafeWindow.Facturier.libs.find(f=>f.id=="fetchInject").ptr,a=unsafeWindow.Facturier.klass.find(f=>f.id=="Session").ptr,e=unsafeWindow.Facturier.klass.find(f=>f.id=="Student").ptr,o=unsafeWindow.Facturier.klass.find(f=>f.id=="History").ptr,l=unsafeWindow.Facturier.klass.find(f=>f.id=="Archive").ptr,p=unsafeWindow.Facturier.klass.find(f=>f.id=="StudentHistory").ptr;console.log("%cd_dbase, d_dayjs, d_Session, d_Student, d_History, d_Archive, d_StudentHistory are exported",k),console.log("%cfor examples write all code after $>",k),console.group("%cd_dbase",k),console.log("example : get last session in db $>d_dbase.get(d_Session.tbl_name).last().value();"),console.log("          get first student in db $>d_dbase.get(d_Student.tbl_name).first().value()"),console.log("          or d_dbase.get(d_Student.tbl_name).get(0).value()"),console.log("          get all sessions grouped by month/yyyy in db $>d_dbase.get(d_Session.tbl_name).groupBy( v => d_dayjs(v.when).format('MM/YYYY')).value()"),console.log("          get all table $> d_dbase.value()"),console.groupEnd(),console.group("%cd_fetchInject",k),console.log("same as fetchInject libs : https://habd.as/code/fetch-inject/"),console.groupEnd(),console.group("%cd_dayjs",k),console.log("same as dayjs libs"),console.groupEnd(),console.group("%cd_Student",k),console.log("find a student by id ¤ d_Student.findById(STUDENT_ID, (DATE) ); // date is optionnal"),console.groupEnd(),console.group("%cd_Session",k),console.log("get a list of session ¤ d_Session.getBetween('2020-08-01','2020-08-31')"),console.log("delete a session by id ¤ d_Session.deleteById(SESSION_ID);"),console.groupEnd(),console.group("%cSome combinated example",k),console.log("Delete last saved session :  d_Session.deleteById( d_dbase.get(d_Session.tbl_name).last().value().id ); "),console.log("Find all session between 01/08/2020 and 31/08/2020 :  d_dbase.get(d_Session.tbl_name).filter( v => d_dayjs(v.when).isSameOrBefore('20200831', 'day') && d_dayjs(v.when).isSameOrAfter('20200801', 'day')).value(); "),console.groupEnd();debugger},Kn=async function(t,s,n=1,a=[]){Swal.fire({position:"top-end",icon:"info",toast:!0,title:`Collecte des sessions de l'historique
du `+t.format("DD/MM/YYYY")+" au "+s.format("DD/MM/YYYY")+` 
page : `+n+`
cela peut prendre du temps...`,showConfirmButton:!1,timer:3e3});let e=null;try{e=await At(`https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history?page=${n}`,"table.crud-list tbody")}catch(i){console.error(`%c _historyFetch : ${i}`,me)}if(e===null)throw new Error(`Something went wrong could'nt collect anything from ${t.format("DD/MM/YYYY")} to ${s.format("DD/MM/YYYY")} working on history page:${n}.... try to navigate forward and backward or click some buttons to change url`);let o=Jt(e),l=Jt(e,-1);if(o.get("month")!=l.get("month")){let i=l.endOf("month");bt.addOrUpdateSessionPage(n,i)}if(l.isAfter(s,"day")===!0)return console.log(`%cOptimization: oldest (last) data from page are at :${l.format("DD/MM/YYYY")}, don't analyze what was before end date of extraction ${s.format("DD/MM/YYYY")}`,k),a;for(var p=0;p<e.children.length;p+=1){var f=e.children[p],d=Ce.parseTable(f);a.push(d)}return a},jn=function(){const{degrees:t,PDFDocument:s,rgb:n,StandardFonts:a}=PDFLib;async function e(){const p="https://pdf-lib.js.org/assets/with_update_sections.pdf",f=await fetch(p).then(y=>y.arrayBuffer()),d=await s.load(f),i=await d.embedFont(a.Helvetica),w=d.getPages(),T=w[0],{width:h,height:b}=T.getSize();T.drawText("This text was added with JavaScript!",{x:5,y:b/2+300,size:50,font:i,color:n(.95,.1,.1),rotate:t(-45)});const v=await d.save();download(v,"pdf-lib_modification_example.pdf","application/pdf")}async function o(){const p=await s.create(),f=await p.embedFont(a.TimesRoman),d=p.addPage(),{width:i,height:w}=d.getSize(),T=30;d.drawText("Creating PDFs in JavaScript is awesome!",{x:50,y:w-4*T,size:T,font:f,color:n(0,.53,.71)});const h=await p.save();download(h,"pdf-lib_modification_example.pdf","application/pdf")}async function l(){var[p,f]=await yt(dayjs().startOf("month"),dayjs().endOf("month"));let d=Ut.getListDetailBill(p,f);const i=await s.create(),w=await i.embedFont(a.TimesRoman),T=i.addPage(),{width:h,height:b}=T.getSize(),v=30;T.drawText(`Prestations en détail 

 du ${p.format("DD/MM/YYYY")} au ${f.format("DD/MM/YYYY")}`,{x:50,y:b/2-v,size:v,font:w,color:n(116/255,81/255,235/255)});let y=12,O=1.25,E=i.addPage();E.setFontSize(y),E.line_space=O,E.font=w;let $=1,g=20,C=O*y+g,c=b/2;const u=function(ne){const W="LOrEm ipsum DOLor sit aMet, conSEc/tetUr 25 porttitor. ";return ne*1.0925*(w.widthOfTextAtSize(W,y)/W.length)};let m=[0,18,36,10,13,8,5,7],A=[m[0],u(m[1]),u(m[2]),u(m[3]),u(m[4]),u(m[5]),u(m[6]),u(m[7])],L=T.lineHeight,V=25;for(let ne=1;ne<d.length;ne+=1){if(c=b-O*y*$,c<C&&($=1,E=i.addPage(),E.font=w,E.setFontSize(y),E.line_space=O,c=b-O*y*$),$===1){let Pe=["","Quand","Qui","Financé","Type-Niv.","Statut","Pu","Cumul"],xe=V;E.moveTo(xe,c);for(let Ie=1;Ie<Pe.length;Ie+=1)E.drawText(Pe[Ie],{x:xe}),xe+=A[Ie];$+=1,c=b-O*y*$}let W=V;E.drawText(dayjs(d[ne].when).format("DD/MM/YYYY à HH:mm"),{font:w,size:y,y:c,x:W,lineHeight:L}),W+=A[1],E.drawText(d[ne].who_name.trim().slice(0,m[2]),{font:w,size:y,y:c,x:W,lineHeight:L}),W+=A[2];let ue=d[ne].funding.trim().slice(0,m[3]);d[ne].funding==="auto-financé"&&(ue="Au. Fin."),d[ne].funding==="financé par un tiers"&&(ue="Fin."),E.drawText(ue,{font:w,size:y,y:c,x:W,lineHeight:L}),W+=A[3];let ve=d[ne].type;d[ne].path!=null&&d[ne].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&d[ne].type!=="soutenance"&&(ve="Coaching");let ke=`${ve.trim().slice(0,m[4]-2)}-${d[ne].lvl.toString()}`;E.drawText(ke,{font:w,size:y,y:c,x:W,lineHeight:L}),W+=A[4];let $e=d[ne].status;d[ne].status==="étudiant absent"&&($e="absent"),d[ne].status==="étudiante absente"&&($e="absente"),d[ne].status==="annulée tardivement"&&($e="an. tard."),E.drawText($e,{font:w,size:y,y:c,x:W,lineHeight:L}),W+=A[5],E.drawText(d[ne].iPu.toString(),{font:w,size:y,y:c,x:W,lineHeight:L}),W+=A[6],E.drawText(d[ne].iCumul.toString(),{font:w,size:y,y:c,x:W,lineHeight:L}),$+=1}var M=await Ge.calculateBill(p,f);const S=M.get(0,0,0,0),x=S.maxLevel,D=we.getOldModeDate(),j=Ge.getPriceList(D.subtract(1,"day")),z=Ge.getPriceList(D);var F=1;const I=!1;var Y=[U,q,G],N=["Sessions","Soutenance","Coaching"],ae=[0,1,2,3],ge=["Réalisée","Annulée","Annulée tardivement","Etudiant(e) absent(e)"],ce=[Q,K,Z],fe=["Autofinancés","Financés","Autres"];$=1,E=i.addPage();let be=["","Quand","Qui","Nb","Pu","Cumul"],oe=[0,18,50,3,5,7],ie=[m[0],u(m[1]),u(m[2]),u(m[3]),u(m[4]),u(m[5])],pe="";for(_iSessionType=0,_iSessionTypeLength=Y.length;_iSessionType<_iSessionTypeLength;_iSessionType+=1){for(;F<=x;){for([$,E]=Ze.changePgIfNeeded(c,C,$,i),c=b-O*y*$,_iSessionQuality=0,_iSessionQualityLength=ae.length;_iSessionQuality<_iSessionQualityLength;_iSessionQuality+=1)for(_iFunding=0,_iFundingLength=ce.length;_iFunding<_iFundingLength;_iFunding+=1){if(_i0=M.get(Y[_iSessionType],ae[_iSessionQuality],ce[_iFunding],F),typeof _i0=="undefined"&&I===!1)continue;_i0.data=_i0.data.reverse();let ne=V;if(pe=`${N[_iSessionType]} de Niveau ${F} Etudiants ${fe[_iFunding]}`,E.moveTo(ne,c),E.drawText(pe,{font:w,size:y+4,y:c,x:ne,lineHeight:L}),ne+=15,$+=1,[$,E]=Ze.changePgIfNeeded(c,C,$,i),c=b-O*y*$,E.moveTo(ne,c),E.drawText(ge[_iSessionQuality],{font:w,size:y+2,y:c,x:ne,lineHeight:L}),ne+=15,$+=1,[$,E]=Ze.changePgIfNeeded(c,C,$,i),c=b-O*y*$,typeof _i0=="undefined"){E.drawText(`désolé pas de résultat pour cette section au niveau de facturation (${F})`,{font:w,size:y,y:c,x:ne,lineHeight:L}),$+=1,[$,E]=Ze.changePgIfNeeded(c,C,$,i),c=b-O*y*$;continue}let W=ne,ue=0;E.moveTo(ne,c);for(let ve=1;ve<be.length;ve+=1)E.drawText(be[ve],{font:w,size:y+2,y:c,x:W,lineHeight:L}),W+=ie[ve];$+=1,[$,E]=Ze.changePgIfNeeded(c,C,$,i),c=b-O*y*$,W=ne;for(var le=0,re=_i0.data.length;le<re;le+=1)W=ne,E.drawText(dayjs(_i0.data[le].when).format("DD/MM/YYYY à HH:mm"),{font:w,size:y,y:c,x:W,lineHeight:L}),W+=ie[1],E.drawText(_i0.data[le].who_name.trim().slice(0,oe[1]),{font:w,size:y,y:c,x:W,lineHeight:L}),W+=ie[2],E.drawText((le+1).toString(),{font:w,size:y,y:c,x:W,lineHeight:L}),W+=ie[3],we.isInOldMode(dayjs(_i0.data[le].when))?iPu=+_i0.data[le].lvl>0?j[F][Y[_iSessionType]][ae[_iSessionQuality]][ce[_iFunding]]:0:iPu=+_i0.data[le].lvl>0?z[F][Y[_iSessionType]][ae[_iSessionQuality]][ce[_iFunding]]:0,E.drawText(iPu.toString(),{font:w,size:y,y:c,x:W,lineHeight:L}),W+=ie[4],ue+=iPu,E.drawText(ue.toString(),{font:w,size:y,y:c,x:W,lineHeight:L}),$+=1,[$,E]=Ze.changePgIfNeeded(c,C,$,i),c=b-O*y*$}F+=1,$+=1,[$,E]=Ze.changePgIfNeeded(c,C,$,i),c=b-O*y*$}F=1}Ze.addFooter(i,`Généré avec Facturier version ${we.getAppVersion()}`);const se=await i.save();download(se,`prestations_facturees_detail_${p.format("YYYYMMDD")}-${f.format("YYYYMMDD")}.pdf`,"application/pdf")}l()},On=async function(){GM_addStyle('.formgrid{font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", Helvetica, Arial, sans-serif;}'),GM_addStyle(".swal2-styled[type=button]{background-color:#3085d6;border-radius:.75em;color:#fff;font-size:1.0625em;border-left-color:#3085d6;border-right-color:#3085d6;display:inline-block}.formgrid{display:grid;grid-template-columns:1fr 1em 1fr;grid-gap:.3em .6em;grid-auto-flow:dense;align-items:center}input,output,textarea,select,button{grid-column:2 / 4;width:auto;margin:0}legend{font-size:1.2em;width:100%;border-bottom:1px dotted #99c}fieldset{max-width:40em;padding:4px;margin:2em auto;border:0 none}");let t="";t+="<legend>Que voulez vous faire ?</legend>",t+="<fieldset>",t+='<div class="formgrid">',t+='Epurer<button id="answer1" data-action="raz" class="swal2-styled" type="button">RAZ</button>',t+='Sauvegarder toute la base<button id="answer2" data-action="export" class="swal2-styled" type="button">Sauvegarder</button>',t+='Charger toute la base<button id="answer3" data-action="import" class="swal2-styled" type="button">Charger</button>',t+=`Exporter les tables
    <button class="swal2-styled" type="button"
    	hx-get="/views/test-swal-sauvegarde"
		hx-select="body"
        hx-target="#sttPlaceHolder"
        hx-include="[name='email']"
        hx-swap="innerHTML"> Exporter
    </button>
		`,t+="</fieldset>",t+="</div>";const{value:s}=await Swal.fire({title:"Gestion de la base de donnée",html:t,focusConfirm:!1,preConfirm:()=>[document.getElementById("answer1").value,document.getElementById("answer2").value],didOpen:n=>{console.log("%conOpen popup","color:coral"),htmx.process(document.querySelector(".swal2-container")),console.log("%cHtmx Process done","color:coral"),n.querySelector(".formgrid").addEventListener("click",_handler=function(a){const e=function(p){p.target.matches('button[data-action="raz"]')&&(Swal.close(),Xn());return},o=function(p){p.target.matches('button[data-action="export"]')&&(Swal.close(),Zn());return},l=function(p){p.target.matches('button[data-action="import"]')&&(Swal.close(),Jn());return};e(a),o(a),l(a)})},onClose:n=>{n.querySelector(".formgrid").removeEventListener("click",_handler),console.log("%conClose popup","color:coral")}});s&&Swal.fire(JSON.stringify(s))},Zn=async function(){let t=dt.save();console.log(`%cWanna save : ${t}`,k);let s=dayjs(),n="";n+=`<a id="download" href="data:text/plain;charset=utf-8,${encodeURIComponent(t)}" download="save_${s.format("YYYYMMDD")}.json">save_${s.format("YYYYMMDD")}.json</a>`,Swal.fire({title:"Sauvegarde de la base de donnée",html:n,focusConfirm:!1,onOpen:a=>{a.querySelector("#download").click()},onClose:a=>{}})},Jn=async function(){console.log("%cWanna load DATABASE",k);const{value:t}=await Swal.fire({title:"Selection de la sauvegarde (json)",input:"file",inputAttributes:{accept:".json","aria-label":"Upload your database"}});if(t){const s=new FileReader;s.onload=n=>{dt.import(n.target.result),xt(),Nt("Chargement de la base terminé")},s.readAsText(t)}},Xn=async function(){GM_addStyle(".form_addon {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}"),GM_addStyle(".form_addon input {background: #fff;border: 1px solid #9c9c9c;}"),GM_addStyle(".form_addon button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}"),GM_addStyle(".form_addon button:hover {background: gold;}"),GM_addStyle(".form_addon label {padding: 0.5em 0.5em 0.5em 0;}"),GM_addStyle(".form_addon input {padding: 0.7em;margin-bottom: 0.5rem;}"),GM_addStyle(".form_addon input:focus {outline: 3px solid gold;}"),GM_addStyle("@media (min-width: 400px) {.form_addon {grid-template-columns: 200px 1fr;grid-gap: 16px;} .form_addon label {text-align: right;grid-column: 1 / 2;} .form_addon input, .form_addon button {grid-column: 2 / 3;}}");var t="";t+='<form id="RAZ" class="form_addon" action="">',t+='<label for="students" class="cbox">Etudiants</label>',t+='<input id="students" type="checkbox" value="del_students_true" checked>',t+='<label for="sessions" class="cbox">Sessions</label>',t+='<input id="sessions" type="checkbox" value="del_sessions_true" checked>',t+='<label for="archives" class="cbox">Archives : factures</label>',t+='<input id="archives" type="checkbox" value="del_archives_true" checked>',t+='<label for="history_cache" class="cbox">Signet historique</label>',t+='<input id="history_cache" type="checkbox" value="del_history_cache_true" checked>',t+='<label for="radio1">filtrer la date</label>',t+='<input type="radio" id="radio1" name="date_filter" value="false" checked>',t+='<label for="radio2">ne pas filtrer</label>',t+='<input type="radio" id="radio2" name="date_filter" value="true">',t+='<label for="dtFrom" class="date">Date de début</label>',t+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',t+='<label for="dtTo" class="date">Date de fin</label>',t+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',t+="<!-- Switch -->",t+='<input type="checkbox" class="switch" name="s1" id="s1">',t+='<label for="s1">Switch</label>',t+="</form>";const{value:s}=await Swal.fire({title:"<strong>RAZ des données</strong>",icon:"info",html:t,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez ce que vous allez supprimer de la base de donnée",preConfirm:()=>{let f=document.getElementsByName("date_filter"),d="notfound";for(var i in f)f[i].checked===!0&&(d=f[i].value);return console.log(document.getElementById("s1")),[document.getElementById("students").checked,document.getElementById("sessions").checked,document.getElementById("archives").checked,document.getElementById("history_cache").checked,document.getElementById("dtFrom").disabled===!0?null:document.getElementById("dtFrom").value,document.getElementById("dtTo").disabled===!0?null:document.getElementById("dtTo").value,d]},onOpen:f=>{f.querySelector("#radio1").addEventListener("change",function(){console.log(document.getElementById("radio1").checked);let d=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!d,document.getElementById("dtTo").disabled=!d}),f.querySelector("#radio2").addEventListener("change",function(){let d=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!d,document.getElementById("dtTo").disabled=!d}),f.querySelector("#dtFrom").addEventListener("change",function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:f=>{f.querySelector("#radio1").removeEventListener("change"),f.querySelector("#radio2").removeEventListener("change"),f.querySelector("#dtFrom").removeEventListener("change")}});let n=s[0],a=s[1],e=s[2],o=s[3];console.log(`%cWanna raz students ? ${n}, wanna raz sessions ? ${a}, wanna raz archives ? ${e}`,k);let l=s[4]?dayjs(s[4]):null,p=s[5]?dayjs(s[5]):null;n===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des étudiants",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),Ee.delete(l,p)),a===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des sessions",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),Ce.delete(l,p),xt()),e===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des archives (financières)",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),ut.delete(l,p)),o===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base du cache des historique de session",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),bt.delete(l,p))},Pn=async function(){var t="";t+="<style>",t+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",t+="form input {background: #fff;border: 1px solid #9c9c9c;}",t+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",t+="form button:hover {background: gold;}",t+="form label {padding: 0.5em 0.5em 0.5em 0;}",t+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",t+="form input:focus {outline: 3px solid gold;}",t+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",t+="</style>",t+='<form class="form1" action="">',t+='<label for="dd" class="date">Date de début</label>',t+='<input id="dd" type="date" max="2030-12-31" min="2010-12-31">',t+='<label for="df" class="date">Date de fin</label>',t+='<input id="df" type="date" max="2030-12-31" min="2010-12-31">',t+="</form>";var[s,n]=await yt(dayjs().startOf("month"),dayjs().endOf("month")),a=await Ge.calculateBill(s,n);we.isInOldMode(s)?eo(s,n,a):to(s,n,a)},eo=function(t,s,n){const a=n.get(0,0,0,0),e=4;var o="",l=null,p=0,f=0,d=0,i=[[4,"Groupe"],[1,"Niveau 1"],[2,"Niveau 2"],[3,"Niveau 3"]],w=0,T=0,h=!1,b=0,v=0,y=0,O=0,E=0,$=0,g=0,C=0,c=0,u=0,m=0,A=0,L=0,V=0,M=0,S=0,x=0,D=0,j=1;n.toConsole(),o+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",o+='<div class="wrapper">',o+="<table>",o+="<thead>",o+="<tr>",o+='<th>Type</th><th><abbr title="nombre">nb</abbr></th><th>PU(<abbr title="hors taxes">HT</abbr>)</th><th>Total(<abbr title="hors taxes">HT</abbr>)</th>',o+="</tr>",o+="</thead>",o+="<tbody>",o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Mentorat</th>',o+="</tr>";for(var w=performance.now();j<=e;)_i0=n.get(U,X,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(U,X,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(U,X,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : réalisées</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(U,ee,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(U,ee,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(U,ee,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : annulées</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(U,J,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(U,J,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(U,J,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : annulées tard.</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(U,te,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(U,te,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(U,te,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : étudiant abs.</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),j+=1;var T=performance.now();console.log("%cCalculate first array"+(T-w)+" milliseconds.",Oe),o+="<tr>",o+="<td>Total</td>",o+=`<td>${p}</td><td></td><td>${f}€</td>`,o+="</tr>",o+="<tr>",o+="</tr>",d+=f,p=0,f=0,o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',o+="</tr>",j=1;for(var w=performance.now();j<=e;)_i0=n.get(q,X,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(q,X,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(q,X,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : réalisées</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(q,ee,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(q,ee,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(q,ee,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : annulées</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(q,J,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(q,J,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(q,J,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : annulées tard.</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(q,te,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(q,te,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(q,te,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : étudiant abs.</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),j+=1;var T=performance.now();console.log("%cCalculate second array"+(T-w)+" milliseconds.",Oe),o+="<tr>",o+="<td>Total</td>",o+=`<td>${p}</td><td></td><td>${f}€</td>`,o+="</tr>",o+="<tr>",o+="</tr>",d+=f,p=0,f=0,o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',o+="</tr>",j=1;for(var w=performance.now();j<=e;)_i0=n.get(G,X,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(G,X,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(G,X,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : réalisées</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(G,ee,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(G,ee,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(G,ee,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : annulées</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(G,J,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(G,J,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(G,J,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : annulées tard.</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),_i0=n.get(G,te,Q,j),u=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=n.get(G,te,K,j),m=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(G,te,Z,j),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,L=u>0?S/u:S,V=m>0?x/m:x,M=A>0?D/A:D,(h===!0||u+m+A>0)&&(p+=u,p+=m,p+=A,f+=S,f+=x,f+=D,o+="<tr>",o+=`<td>Niveau ${j} : étudiant abs.</td>`,o+=`<td>${u+m+A}</td><td>${V}</td><td>${S+x+D}€</td>`,o+="</tr>"),j+=1;var T=performance.now();console.log("%cCalculate third array"+(T-w)+" milliseconds.",Oe),o+="<tr>",o+="<td>Total</td>",o+=`<td>${p}</td><td></td><td>${f}€</td>`,o+="</tr>",o+="<tr>",o+="</tr>",d+=f,o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Total Général</th>',o+="</tr>",o+=`<td colspan="3"></td><td>${d}€</td>`,o+="</tr>",o+="<tr>",o+="</tr>",o+="</tbody>",o+="<tfoot>",o+="</tfoot>",o+="</table>",o+=`<p>Soit un total général à facturer de ${d}€`,Swal.fire({title:`<strong>Liste des formations tarifées du ${t.format("DD/MM/YYYY")} au ${s.format("DD/MM/YYYY")}</strong>`,html:o,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},to=function(t,s,n){console.log("%cEnter computation bill",k);const a=!1;var e="",o=0,l=0,p=0,f=0,d=0,i=0,w=0,T=0,h=0,b=0,v=0,y=0;const O=n.get(0,0,0,0),E=O.maxLevel;var $=0,g=0,C=0,c=0,u=0,m=0,A=0,L=0,V=0,M=0,S=0,x=0,D=0,j=0,z=0,F=0,I=0,Y=0,N=1;e+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",e+='<div class="wrapper">',e+="<table>",e+="<thead>",e+="<tr>",e+='<th rowspan="2">Type</th><th colspan="3" scope="colgroup">Auto Financés</th><th colspan="3" scope="colgroup">Financés</th><th colspan="3" scope="colgroup">Autres</th><th colspan="2" scope="colgroup">Total</th>',e+="</tr>",e+="<tr>",e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+="</tr>",e+="</thead>",e+="<tbody>",e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de mentorat</th>',e+="</tr>";for(var ae=performance.now();N<=E;)_i0=n.get(U,X,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(U,X,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(U,X,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : réalisées</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(U,ee,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(U,ee,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(U,ee,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : annulées</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(U,J,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(U,J,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(U,J,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : annulées tard.</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(U,te,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(U,te,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(U,te,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : étud. absent</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),N+=1;var ge=performance.now();for(console.log("%cCalculate first array"+(ge-ae)+" milliseconds.",Oe),e+="<tr>",e+="<td>Total</td>",e+=`<td>${o}</td><td></td><td>${f}€</td>`,e+=`<td>${l}</td><td></td><td>${d}€</td>`,e+=`<td>${p}</td><td></td><td>${i}€</td>`,e+=`<td>${o+l+p}</td><td>${f+d+i}€</td>`,e+="</tr>",e+="<tr>",e+="</tr>",w+=o,T+=l,h+=p,b+=f,v+=d,y+=i,o=0,l=0,p=0,f=0,d=0,i=0,e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',e+="</tr>",N=1;N<=E;)_i0=n.get(q,X,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(q,X,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(q,X,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : réalisées</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(q,ee,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(q,ee,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(q,ee,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : annulées</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(q,J,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(q,J,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(q,J,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : annulées tard.</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(q,te,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(q,te,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(q,te,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : étud. absent</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),N+=1;e+="<tr>",e+="<td>Total</td>",e+=`<td>${o}</td><td></td><td>${f}€</td>`,e+=`<td>${l}</td><td></td><td>${d}€</td>`,e+=`<td>${p}</td><td></td><td>${i}€</td>`,e+=`<td>${o+l+p}</td><td>${f+d+i}€</td>`,e+="</tr>",e+="<tr>",e+="</tr>",w+=o,T+=l,h+=p,b+=f,v+=d,y+=i,o=0,l=0,p=0,f=0,d=0,i=0,e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',e+="</tr>";for(var N=1;N<=E;)_i0=n.get(G,X,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(G,X,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(G,X,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : réalisées</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(G,ee,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(G,ee,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(G,ee,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : annulées</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(G,J,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(G,J,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(G,J,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : annulées tard.</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),_i0=n.get(G,te,Q,N),M=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=n.get(G,te,K,N),S=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=n.get(G,te,Z,N),x=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,D=M>0?F/M:F,j=S>0?I/S:I,z=x>0?Y/x:Y,(a===!0||M+S+x>0)&&(o+=M,l+=S,p+=x,f+=F,d+=I,i+=Y,e+="<tr>",e+=`<td>Niveau ${N} : étud. absent</td>`,e+=`<td>${M}</td><td>${D}</td><td>${F}€</td>`,e+=`<td>${S}</td><td>${j}</td><td>${I}€</td>`,e+=`<td>${x}</td><td>${z}</td><td>${Y}€</td>`,e+=`<td>${M+S+x}</td><td>${F+I+Y}€</td>`,e+="</tr>"),N+=1;w+=o,T+=l,h+=p,b+=f,v+=d,y+=i,e+="<tr>",e+="<td>Total</td>",e+=`<td>${o}</td><td></td><td>${f}€</td>`,e+=`<td>${l}</td><td></td><td>${d}€</td>`,e+=`<td>${p}</td><td></td><td>${i}€</td>`,e+=`<td>${o+l+p}</td><td>${f+d+i}€</td>`,e+="</tr>",e+="<tr>",e+="</tr>",e+="</tbody>",e+="<tfoot>",e+="</tfoot>",e+="</table>";var ce=0,fe="";let be=O.flatFee.length;for(var oe=0;oe<be;oe+=1)ce+=30,fe+=O.flatFee[oe].who_name+", ";be>1?e+=`<p class="flat_fee">Calcul du forfait "autofinancé". Ce mois ci ${be} étudiants ont eu au moins une session il s'agit de : ${fe.slice(0,-1)}`:e+=`<p class="flat_fee">Calcul du forfait "autofinancé". Ce mois ci ${be} étudiant a eu au moins une session il s'agit de : ${fe.slice(0,-1)}`,e+=`. Le forfait est donc de ${ce}€</p>`,e+=`<p>Soit un total général à facturer de ${b+v+y+ce}€</p>`,Swal.fire({title:`<strong>Liste des formations tarifées du ${t.format("DD/MM/YYYY")} au ${s.format("DD/MM/YYYY")}</strong>`,html:e,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},Bn=async function(){var[t,s]=await yt(dayjs().startOf("month"),dayjs().endOf("month"),!1);if(t===null||s===null)throw console.log("%cError need date from, date to",me),new Error;const n=Ut.getListStatistic(t,s);let a="",e=new Array(22),o=Array.apply(null,Array(22)).map(Number.prototype.valueOf,0),l=t.clone(),p=l.endOf("month"),f="";e[0]="<thead><tr><th>Sessions</th>",e[1]="<tbody><tr><td>Sessions</td>",e[2]='<tr class="header"><td>Montant</td>',e[3]="<tr><td>Nb.",e[4]="<tr><td>Pu",e[5]='<tr class="header"><td>Soutenances</td>',e[6]="<tr><td>Montant</td>",e[7]="<tr><td>Nb.",e[8]="<tr><td>Pu",e[9]='<tr class="header"><td>Coaching</td>',e[10]="<tr><td>Montant</td>",e[11]="<tr><td>Nb.",e[12]="<tr><td>Pu",e[13]='<tr class="header"><td>Bonus</td>',e[14]="<tr><td>Bonus AF</td>",e[15]="<tr><td>Total Général</td>",e[16]='<tr class="header"><td>KPI</td>',e[17]="<tr><td>NbJrs</td>",e[18]="<tr><td>TJM</td>",e[19]="<tr><td>Nb hrs</td>",e[20]="<tr><td>THM</td>",e[21]="<tr><td>Nb hrs (p.)</td>",e[22]="<tr><td>THM (p)</td>";for(var d=0;d<n.length;d+=1){o[2]+=n[d].sessions.total,o[3]+=n[d].sessions.nb-n[d].sessions.nbc,o[4]+=n[d].sessions.pu,o[6]+=n[d].defenses.total,o[7]+=n[d].defenses.nb-n[d].defenses.nbc,o[8]+=n[d].defenses.pu,o[10]+=n[d].coaches.total,o[11]+=n[d].coaches.nb-n[d].coaches.nbc,o[12]+=n[d].coaches.pu,o[14]+=n[d].bonus;let i=n[d].sessions.total+n[d].defenses.total+n[d].coaches.total+n[d].bonus;o[15]+=i,o[16]+=n[d].kpi.jrs,o[18]+=n[d].kpi.hrs,o[20]+=n[d].kpi.hrsp,n.length==1&&(f="</tr>"),d===n.length-1&&n.length>1?p.isAfter(s,"day")?(o[2]-=n[d].sessions.total,o[3]-=n[d].sessions.nb-n[d].sessions.nbc,o[4]-=n[d].sessions.pu,o[6]-=n[d].defenses.total,o[7]-=n[d].defenses.nb-n[d].defenses.nbc,o[8]-=n[d].defenses.pu,o[10]-=n[d].coaches.total,o[11]-=n[d].coaches.nb-n[d].coaches.nbc,o[12]-=n[d].coaches.pu,o[14]-=n[d].bonus,o[15]-=i,o[16]-=n[d].kpi.jrs,o[18]-=n[d].kpi.hrs,o[20]-=n[d].kpi.hrsp,e[0]+=`<td>Total(moy)</td><td>${dayjs(n[d].header.dtTo).format("MMMM")}</td></thead></tr>`,e[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[2]+=`<td>${o[2]} (${(o[2]/(n.length-1)).toFixed(2)})</td><td>${n[d].sessions.total}</td></tr>`,e[3]+=`<td>${o[3]} (${(o[3]/(n.length-1)).toFixed(2)})</td><td>${n[d].sessions.nb} (${n[d].sessions.nbc})</td></tr>`,e[4]+=`<td> n/a (${(o[4]/(n.length-1)).toFixed(2)})</td><td>${n[d].sessions.pu.toFixed(2)}</td></tr>`,e[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[6]+=`<td>${o[6]} (${(o[6]/(n.length-1)).toFixed(2)})</td><td>${n[d].defenses.total}</td></tr>`,e[7]+=`<td>${o[7]} (${(o[7]/(n.length-1)).toFixed(2)})</td><td>${n[d].defenses.nb} (${n[d].defenses.nbc})</td></tr>`,e[8]+=`<td> n/a (${(o[8]/(n.length-1)).toFixed(2)})</td><td>${n[d].defenses.pu.toFixed(2)}</td></tr>`,e[9]+=`<td>&nbsp;</td>${f}`,e[10]+=`<td>${o[10]} (${(o[10]/(n.length-1)).toFixed(2)})</td><td>${n[d].coaches.total}</td></tr>`,e[11]+=`<td>${o[11]} (${(o[11]/(n.length-1)).toFixed(2)})</td><td>${n[d].coaches.nb} (${n[d].coaches.nbc})</td></tr>`,e[12]+=`<td> n/a (${(o[12]/(n.length-1)).toFixed(2)})</td><td>${n[d].coaches.pu.toFixed(2)}</td></tr>`,e[13]+="<td>&nbsp;</td></tr>",e[14]+=`<td>${o[14]} (${(o[14]/(n.length-1)).toFixed(2)})</td><td>${n[d].bonus}</td></tr>`,e[15]+=`<td>${o[15]} (${(o[15]/(n.length-1)).toFixed(2)})</td><td>${i}</td></tr>`,e[16]+="<td>&nbsp;</td></tr>",e[17]+=`<td>${o[16]} (${(o[16]/(n.length-1)).toFixed(2)})</td><td>${n[d].kpi.jrs}</td></tr>`,e[18]+=`<td> n/a (${(o[15]/o[16]).toFixed(2)})</td><td>${(i/n[d].kpi.jrs).toFixed(2)}</td></tr>`,e[19]+=`<td>${o[18]} (${(o[18]/(n.length-1)).toFixed(2)})</td><td>${n[d].kpi.hrs.toFixed(2)}</td></tr>`,e[20]+=`<td> n/a  (${(o[15]/o[18]).toFixed(2)})</td><td>${(i/n[d].kpi.hrs).toFixed(2)}</td></tr>`,e[21]+=`<td>${o[20].toFixed(2)} (${(o[20]/(n.length-1)).toFixed(2)})</td><td>${n[d].kpi.hrsp.toFixed(2)}</td></tr>`,e[22]+=`<td> n/a  (${(o[15]/o[20]).toFixed(2)})</td><td>${(i/n[d].kpi.hrsp).toFixed(2)}</td></tr>`):(e[0]+=`<td>${dayjs(n[d].header.dtTo).format("MMMM")}</td><td>Tot.</td></thead></tr>`,e[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[2]+=`<td>${n[d].sessions.total}</td><td>${o[2]} (${(o[2]/n.length).toFixed(2)})</td></tr>`,e[3]+=`<td>${n[d].sessions.nb} (${n[d].sessions.nbc})</td><td>${o[3]} (${(o[3]/n.length).toFixed(2)})</td></tr>`,e[4]+=`<td>${n[d].sessions.pu.toFixed(2)}</td><td> n/a (${(o[4]/n.length).toFixed(2)})</td></tr>`,e[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[6]+=`<td>${n[d].defenses.total}</td><td>${o[6]} (${(o[6]/n.length).toFixed(2)})</td></tr>`,e[7]+=`<td>${n[d].defenses.nb} (${n[d].defenses.nbc})</td><td>${o[7]} (${(o[7]/n.length).toFixed(2)})</td></tr>`,e[8]+=`<td>${n[d].defenses.pu.toFixed(2)}</td><td> n/a (${(o[8]/n.length).toFixed(2)})</td></tr>`,e[9]+=`<td>&nbsp;</td>${f}`,e[10]+=`<td>${n[d].coaches.total}</td><td>${o[10]} (${(o[10]/n.length).toFixed(2)})</td></tr>`,e[11]+=`<td>${n[d].coaches.nb} (${n[d].coaches.nbc})</td><td>${o[11]} (${(o[11]/n.length).toFixed(2)})</td></tr>`,e[12]+=`<td>${n[d].coaches.pu.toFixed(2)}</td><td> n/a (${(o[12]/n.length).toFixed(2)})</td></tr>`,e[13]+="<td>&nbsp;</td></tr>",e[14]+=`<td>${n[d].bonus}</td><td>${o[14]} (${(o[14]/n.length).toFixed(2)})</td></tr>`,e[15]+=`<td>${i}</td><td>${o[15]} (${(o[15]/n.length).toFixed(2)})</td></tr>`,e[16]+="<td>&nbsp;</td></tr>",e[17]+=`<td>${n[d].kpi.jrs}</td><td>${o[16]} (${(o[16]/n.length).toFixed(2)})</td></tr>`,e[18]+=`<td>${(i/n[d].kpi.jrs).toFixed(2)}</td><td> n/a (${(o[15]/o[16]).toFixed(2)})</td></tr>`,e[19]+=`<td>${n[d].kpi.hrs.toFixed(2)}</td><td>${o[18]} (${(o[18]/n.length).toFixed(2)})</td></tr>`,e[20]+=`<td>${(i/n[d].kpi.hrs).toFixed(2)}</td><td> n/a  (${(o[15]/o[18]).toFixed(2)})</td></tr>`,e[21]+=`<td>${n[d].kpi.hrsp.toFixed(2)}</td><td>${o[20].toFixed(2)} (${(o[20]/n.length).toFixed(2)})</td></tr>`,e[22]+=`<td>${(i/n[d].kpi.hrsp).toFixed(2)}</td><td> n/a  (${(o[15]/o[20]).toFixed(2)})</td></tr>`):(e[0]+=`<td>${dayjs(n[d].header.dtTo).format("MMMM")}</td>${f}`,e[1]+=`<td>&nbsp;</td>${f}`,e[2]+=`<td>${n[d].sessions.total}</td>${f}`,e[3]+=`<td>${n[d].sessions.nb} (${n[d].sessions.nbc})</td>${f}`,e[4]+=`<td>${n[d].sessions.pu.toFixed(2)}</td>${f}`,e[5]+=`<td>&nbsp;</td>${f}`,e[6]+=`<td>${n[d].defenses.total}</td>${f}`,e[7]+=`<td>${n[d].defenses.nb} (${n[d].defenses.nbc})</td>${f}`,e[8]+=`<td>${n[d].defenses.pu.toFixed(2)}</td>${f}`,e[9]+=`<td>&nbsp;</td>${f}`,e[10]+=`<td>${n[d].coaches.total}</td>${f}`,e[11]+=`<td>${n[d].coaches.nb} (${n[d].coaches.nbc})</td>${f}`,e[12]+=`<td>${n[d].coaches.pu.toFixed(2)}</td>${f}`,e[13]+=`<td>&nbsp;</td>${f}`,e[14]+=`<td>${n[d].bonus}</td>${f}`,e[15]+=`<td>${i}</td>${f}`,e[16]+=`<td>&nbsp;</td>${f}`,e[17]+=`<td>${n[d].kpi.jrs}</td>${f}`,e[18]+=`<td>${(i/n[d].kpi.jrs).toFixed(2)}</td>${f}`,e[19]+=`<td>${n[d].kpi.hrs.toFixed(2)}</td>${f}`,e[20]+=`<td>${(i/n[d].kpi.hrs).toFixed(2)}</td>${f}`,e[21]+=`<td>${n[d].kpi.hrsp.toFixed(2)}</td>${f}`,e[22]+=`<td>${(i/n[d].kpi.hrsp).toFixed(2)}</td>${f}`),l=l.add(1,"month"),p=l.endOf("month")}a="<table>"+e.join(" ")+`</tbody><tfoot><tr><td colspan=${n.length+1}>la valeur entre parenthèse fait reference aux annulés</td></tr></tfoot></table>`,Swal.fire({title:`<strong>Statistiques du ${t.format("DD/MM/YYYY")} au ${s.format("DD/MM/YYYY")}</strong>`,icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:i=>{}})};let Se=t=>!isNaN(t),De=t=>!isNaN(parseInt(t)),Xe=t=>t.split("!"),tn=(t,s)=>Xe(t).indexOf(s),de=(t,s)=>Xe(t).includes(s),Tt=t=>Se(t)?_t+Number(t)*.25+"rem":_t+t,et=(t={})=>Object.assign(Object.create(null),t),jr=new Map,Or=new Map,Ln,Pr=et({separator:":",screens:{sm:"640px",md:"768px",lg:"1024px",xl:"1280px"}}),no=t=>Object.prototype.toString.call(t)==="[object Object]",oo=t=>{if(typeof t!="string")throw Error("Hex value is not a hex string.");if(t.startsWith("#")||(t="#"+t),t=t.length===4?t.slice(1).split("").map(s=>s+s).join(""):t.slice(1),!/^[0-9a-f]{6}$/i.test(t))throw Error("Incorrect hex color format.");return t},io=new Map;document.styleSheets.length===0?Ln=document.head.appendChild(document.createElement("style")).sheet:Ln=document.styleSheets[0];let Br=new Map,ro,Lr=et({p:"padding",m:"margin",h:"height",z:"z-index",w:"width"}),qt=et();for(let t of Xe('box-border|-webkit-box-sizing:border-box;box-sizing:border-box!box-content|-webkit-box-sizing:content-box;box-sizing:content-box!hidden|display:none!object-scale-down|object-fit:scale-down;-o-object-fit:scale-down!scrolling-touch|-webkit-overflow-scrolling:touch!scrolling-auto|-webkit-overflow-scrolling:auto!visible|visibility:visible!invisible|visibility:hidden!order-first|order:-9999!order-last|order:9999!order-none|order:0!grid-cols-none|grid-template-columns:none!col-auto|grid-column:auto!col-start-auto|-ms-grid-column:auto;grid-column-start:auto!col-end-auto|-ms-grid-column-span:auto;grid-column-end:auto!grid-rows-none|-ms-grid-rows:none;grid-template-rows:none!row-auto|grid-row:auto!row-start-auto|-ms-grid-row:auto;grid-row-start:auto!row-end-auto|-ms-grid-row-span:auto;grid-row-end:auto!gap-px|gap:1px!row-gap-px|row-gap:1px!grid-flow-row|grid-auto-flow:row!grid-flow-col|grid-auto-flow:column!grid-flow-row-dense|grid-auto-flow:row dense!grid-flow-col-dense|grid-auto-flow:column dense!min-w-full|min-width:100%!max-w-full|max-width:100%!max-w-screen-sm|max-width:640px!max-w-screen-md|max-width:768px!max-w-screen-lg|max-width:1024px!max-w-screen-xl|max-width:1280px!max-w-none|max-width:none!min-h-full|min-height:100%!min-h-screen|min-height:100vh!max-h-full|max-height:100%!max-h-screen|max-height:100vh!text-2xl|font-size:1.5rem!text-3xl|font-size:1.875rem!text-4xl|font-size:2.25rem!underline|text-decoration:underline!line-through|text-decoration:line-through!no-underline|text-decoration:none!uppercase|text-transform:uppercase!lowercase|text-transform:lowercase!capitalize|text-transform:capitalize!normal-case|text-transform:none!whitespace-no-wrap|white-space:nowrap!break-normal|word-break:normal;overflow-wrap:normal!break-words|overflow-wrap:break-word!break-all|word-break:break-all!truncate|overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap!h-auto|height:auto!max-w-2xl|max-width:42rem!tracking-tighter|letter-spacing:-0.05em!tracking-tight|letter-spacing:-0.025em!tracking-normal|0!tracking-wide:letter-spacing:0.025em!tracking-wider|letter-spacing:0.05em!tracking-widest|letter-spacing: 0.1em!leading-none|line-height:1!leading-tight|line-height:1.25!leading-snug|line-height:1.375!leading-normal|line-height:1.5!leading-relaxed|line-height:1.625!leading-loose|line-height:2!list-none|list-style-type:none!list-disc|list-style-type:disc!list-decimal|list-style-type:decimal!list-inside|list-style-position:inside!list-outside|list-style-position:outside!border|border-width:1px!border-collapse|border-collapse:collapse!border-separate|border-collapse:separate!table-auto|table-layout:auto!table-fixed|table-layout:fixed!appearance-none|-webkit-appearance:none;-moz-appearance:none;appearance:none!outline-none|outline:0!resize-none|resize:none!resize|resize:both!resize-y|resize:vertical!resize-x|resize:horizontal!fill-current|fill:currentColor!stroke-current|stroke:currentColor!sr-only|position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0!not-sr-only|position:static;width:auto;height:auto;padding:0;margin:0;overflow:visible;clip:auto;white-space:normal!font-sans|font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji!font-serif|font-family:Georgia,Cambria,"Times New Roman",Times,serif!font-mono|font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace!sticky|position:-webkit-sticky;position:sticky')){let[s,n]=t.split("|");qt[s]=n}for(let t of Xe("float-right!float-left!float-none!clear-left!clear-right!clear-both!clear-none"))qt[t]=t.replace("-",":");for(let t of Xe("block!flow-root!inline-block!inline!flex!grid!inline-grid!table!table-caption!table-cell!table-column!table-column-group!table-footer-group!table-header-group!table-row-group!table-row")){let s=t;t==="flex"?s="-webkit-box;display:-ms-flexbox;display:-webkit-flex;display:flex":t==="inline-flex"?s="-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex":t==="grid"?s="-ms-grid;display:grid":t==="inline-grid"&&(s="-ms-inline-grid;display:inline-grid"),qt[t]="display:"+s}for(let t of Xe("static!fixed!absolute!relative"))qt[t]="position:"+t;let so=Xe("f7fafc!edf2f7!e2e8f0!cbd5e0!a0aec0!718096!4a5568!2d3748!1a202c!fff5f5!fed7d7!feb2b2!fc8181!f56565!e53e3e!c53030!9b2c2c!742a2a!fffaf0!feebc8!fbd38d!f6ad55!ed8936!dd6b20!c05621!9c4221!7b341e!fffff0!fefcbf!faf089!f6e05e!ecc94b!d69e2e!b7791f!975a16!744210!f0fff4!c6f6d5!9ae6b4!68d391!48bb78!38a169!2f855a!276749!22543d!e6fffa!b2f5ea!81e6d9!4fd1c5!38b2ac!319795!2c7a7b!285e61!234e52!ebf8ff!bee3f8!90cdf4!63b3ed!4299e1!3182ce!2b6cb0!2c5282!2a4365!ebf4ff!c3dafe!a3bffa!7f9cf5!667eea!5a67d8!4c51bf!434190!3c366b!faf5ff!e9d8fd!d6bcfa!b794f4!9f7aea!805ad5!6b46c1!553c9a!44337a!fff5f7!fed7e2!fbb6ce!f687b3!ed64a6!d53f8c!b83280!97266d!702459"),ao=Xe("gray!red!orange!yellow!green!teal!blue!indigo!purple!pink"),lo=Xe("none!sm!nm!md!lg!full"),Gt=et({l:"left",r:"right",t:"top",b:"bottom"}),Dt=t=>{if(B==="opacity"&&Se(H))P=`--${t}-opacity:`+(H==="100"?"1":H/100);else{let s=io.get(R);if(s)H&&no(s)&&(s=s[H]);else if(H){let n=ao.indexOf(B);s=so[n*9+(Number(H[0])-1)]}else if(B&&B.startsWith("#"))try{s=oo(B)}catch{}if(s){let n=t+`:rgba(${parseInt(s.slice(0,2),16)},${parseInt(s.slice(2,4),16)},${parseInt(s.slice(4,6),16)},var(--${t}-opacity,1))`;P=t+`:#${s};`+n}else B==="current"?P=t+":currentColor":P=t+":"+R}},Mt=()=>{if(!zt&&(de("auto!initial!inherit",tt)||De(tt))){let t=_t+tt;H?(qe=1,B==="y"?P=`top:${t};bottom:`+t:B==="x"&&(P=`left:${t};right:`+t)):B&&($t==="inset"?P=`top:${t};right:${t};bottom:${t};left:`+t:(qe=2,P=$t+":"+t))}},In=()=>{let t;Se(B)?t=B+"ms":De(B)&&(t=B),t&&(P=`-webkit-transition-${$t}:${t};-o-transition-${$t}:${t};transition-${$t}:`+t)},Ir=et({object:()=>{de("contain!cover!fill!none!bottom",R)?P=`-o-object-fit:${R};object-fit:`+R:de("bottom!center!left!left-bottom!left-top!right!right-bottom!right-top!top",R)&&(R=R.replace("-"," "),P=`-o-object-position:${R};object-position:`+R)},overflow:()=>{de("x!y",B)&&(qe=1),P=uo+":"+tt},clearfix:()=>{ro="clearfix::after",P='content:"";display:table;clear:both'},text:()=>{let t=tn("xs!sm!base!lg!xl",B);if(t>-1)P=`font-size:${.75+.125*t}rem`;else if(B.endsWith("xl")){let[s]=B.split("x");Se(s)&&(P=`font-size:${Number(s)-2}rem`)}else de("left!center!right!justify",R)?P="text-align:"+R:Dt("color")},font:()=>{let t=tn("hairline!thin!light!normal!medium!semibold!bold!extrabold!black",B);t>-1?P="font-weight:"+100*(1+t):Se(B)&&(P="font-weight:"+B)},whitespace:()=>{de("normal!pre!pre-line!pre-wrap",R)&&(P="white-space:"+R)},inset:Mt,top:Mt,right:Mt,bottom:Mt,left:Mt,flex:()=>{let t=(s,n=1,a="0%")=>`-webkit-box-flex:${s};-ms-flex:${s} ${n} ${a};flex:${s} ${n} `+a;if(de("row!row-reverse!col!col-reverse",R))R=R.replace("col","column"),P=`-webkit-box-orient:${B==="row"?"horizontal":"vertical"};-webkit-box-direction:${H==="reverse"?H:"normal"};-ms-flex-direction:${R};flex-direction:${R}`;else if(de("no-wrap!flex-wrap!wrap-reverse",R))R==="no-wrap"&&(R="nowrap"),P=`-ms-flex-wrap:${R};flex-wrap:${R}`;else if(de("grow!shrink",B)){qe=1;let s=H||1;B==="grow"?P=`-webkit-box-flex:${s};-ms-flex-positive:${s};flex-grow:${s}`:P=`-ms-flex-negative:${s};flex-shrink:${s}`}else R==="initial"?P=t(0,1,"auto"):R==="auto"?P=t(1,1,"auto"):R==="none"?P="-webkit-box-flex:0;-ms-flex:none;flex:none":zt?P=t(B,H,zt):H?P=t(B,H):P=t(B)},order:()=>{if(Se(B)){let t=_t+B;P=`-webkit-box-ordinal-group:${Number(t)+1};-ms-flex-order:${t};order:`+t}},grid:()=>{Se(H)&&(P=et({cols:`-ms-grid-columns:(minmax(0,1fr))[${H}];grid-template-columns: repeat(${H}, minmax(0, 1fr))`,span:`-ms-grid-column-span:${H};grid-column: span ${H} / span `+H,start:`-ms-grid-column:${H};grid-column-start:`+H,end:`-ms-grid-column-span:${H};grid-column-end:`+H,rows:`-ms-grid-rows:(minmax(0,1fr))[${H}];grid-template-rows: repeat(${H}, minmax(0, 1fr))`})[B])},row:()=>{De(H)&&(P=et({span:`-ms-grid-row-span:${H};grid-row: span ${H} / span ${H}`,start:`-ms-grid-row:${H};grid-row-start:`+H,end:`-ms-grid-row-span:${H};grid-row-end:`+H,gap:"row-gap:"+Tt(H)})[B])},col:()=>{if(Se(H)&&(B==="span"?P=`-ms-grid-column-span:${H};grid-column:span ${H} / span ${H};`:B==="start"?P=`-ms-grid-column:${H};grid-column-start:${H}`:B==="end"&&(P=`-ms-grid-column-span:${H};grid-column-end:${H}`)),De(H)&&B==="gap"){let t=H==="px"?"1px":Tt(H);P=`-webkit-column-gap:${t};-moz-column-gap:${t}column-gap:`+t}},gap:()=>{De(B)&&(P="gap:"+Tt(B))},space:()=>{if(nn=[">:not(template)~:not(template)"],H==="px"&&(H="1px"),H)if(De(H)){let t=Tt(H);B==="x"?P=`margin-right:calc(${t}*var(--space-x-reverse,0));margin-left:calc(${t}*(1 - var(--space-x-reverse,0)))`:B==="y"&&(P=`margin-top:calc(${t}*(1 - var(--space-y-reverse,0)));margin-bottom:calc(${t}*var(--space-y-reverse,0))`)}else H==="reverse"&&(P=`--space-${B}-reverse:1`)},divide:()=>{if(nn=[">:not(template)~:not(template)"],qe=1,!zt){let t;Se(H)?t=H+"px":De(H)?t=H:H==="reverse"?P=`--divide-${B}-reverse:1`:B&&(t="1px"),t&&(B==="y"?P=`border-top-width:calc(${t}*calc(1 - var(--divide-y-reverse,0)));border-bottom-width:calc(${t}*var(--divide-y-reverse,0)))`:B==="x"&&(P=`border-right-width:calc(${t}*var(--divide-x-reverse,0));border-left-width:calc(${t}*calc(1 - var(--divide-x-reverse,0)))`))}P||Dt("border-color")},min:()=>{if(De(H)&&(B==="w"||B==="h")){let t=B==="w"?"width":"height";P=`min-${t}:`+H}},max:()=>{if(B==="w"){let t=tn("xs!sm!md!lg!xl",H);t>-1?P=`max-width:${t*4+20}rem`:De(H)&&(H.endsWith("xl")?P=`max-width:${parseInt(H)*8+24}rem`:P="max-width:"+H)}else B==="h"&&De(H)&&(P="max-height:"+H)},tracking:()=>{De(B)&&(P="letter-spacing:"+B)},leading:()=>{Se(B)?P=`line-height:${Number(B)*.25}rem`:De(B)&&(P="line-height:"+B)},placeholder:()=>{nn.push("::placeholder"),Dt("color")},align:()=>{de("baseline!top!middle!bottom!text-top!text-bottom",R)&&(P="vertical-align:"+R)},bg:()=>{R=R.replace("-"," "),de("bottom!center!left!left bottom!left top!right!right bottom!right top!top",R)?P="background-position:"+R:de("repeat!no-repeat!repeat-x!repeat-y",R)?P="background-repeat:"+R:de("repeat-round!repeat-space",R)?P="background-repeat:"+H:de("auto!cover!contain",R)?P="background-size:"+R:de("fixed!local!scroll",B)?P="background-attachment:"+B:Dt("background-color")},rounded:()=>{let t,s=lo.indexOf(tt);if(De(tt)?(t=tt,s=9):s===5?t="9999px":s>-1?t=s*.125+"rem":(!B||Gt[B]||de("t!b",B[0])&&de("r!l",B[1]))&&(t="0.25rem"),t){let n=Gt[B[0]];!B||!H&&s>-1?P="border-radius:"+t:de("t!b",B)?(qe=1,P=`border-${n}-left-radius:${t};border-${n}-right-radius:`+t):de("l!r",B)?(qe=1,P=`border-top-${n}-radius:${t};border-bottom-${n}-radius:`+t):(qe=2,P=`border-${n}-${Gt[B[1]]}-radius:`+t)}},border:()=>{let t=Gt[B];H&&t?Se(H)?(qe=1,P=`border-${t}-width:${H}px`):De(H)&&(P=`border-${t}-width:`+H):de("solid!dashed!dotted!double!none",B)?P="border-style:"+B:t?(qe=1,P=`border-${t}-width:1px`):Se(B)?P=`border-width:${B}px`:De(B)?P="border-width:"+B:Dt("border-color")},opacity:()=>{Se(B)&&(P="opacity:"+B/100)},transition:()=>{let t=n=>`-webkit-transition-property:${n};-o-transition-property:${n};transition-property:`+n,s=n=>`-webkit-transition-property:-webkit-${n};transition-property:-webkit-${n};-o-transition-property:${n};transition-property:${n};transition-property:${n},-webkit-${n}`;B?B==="colors"?P=t("background-color,border-color,color,fill,stroke"):B==="shadow"?P=s("box-shadow"):B==="transform"?P=s("transform"):B&&(P=t(B)):(P="-webkit-transition-property:S-webkit-box-shadow,-webkit-transform;transition-property:S-webkit-box-shadow,-webkit-transform;-o-transition-property:Sbox-shadow,transform;transition-property:Sbox-shadow,transform;transition-property:Sbox-shadow,transform,-webkit-box-shadow,-webkit-transform",P=P.replace(/S/g,"background-color,border-color,color,fill,stroke,opacity,"))},duration:In,delay:In,ease:()=>{let t=s=>`-webkit-transition-timing-function:${s};-o-transition-timing-function:${s};transition-timing-function:${s}`;R==="in"?P=t("cubic-bezier(0.4,0,1,1)"):R==="out"?P=t("cubic-bezier(0,0,0.2,1)"):R==="in-out"?P=t("cubic-bezier(0.4,0,0.2,1)"):R==="linear"&&(P=t("linear"))},scale:()=>{if(Se(tt)){let t=tt/100;de("x!y",B)?(qe=1,P=`--transform-scale-${B}:`+t):P=`--transform-scale-x:${t};--transform-scale-y:`+t}},rotate:()=>{Se(B)&&(P=`--transform-rotate:${_t}${B}deg`)},translate:()=>{if(de("x!y",B)){if(H==="px")H="1px";else if(H==="full")H="100%";else if(H.includes("/")){let t=H.split("/");t.length===2&&(H=Number(t[0])/Number(t[1])+"%")}De(H)&&(P=`--transform-translate-${B}:`+Tt(H))}},skew:()=>{de("x!y",B)&&Se(H)&&(P=`--transform-skew-${B}:${_t+H}deg`)},transform:()=>{let t="translatex(var(--transform-translate-x,0))translatey(var(--transform-translate-y,0))rotate(var(--transform-rotate,0))skewx(var(--transform-skew-x,0))skewy(var(--transform-skew-y,0))scalex(var(--transform-scale-x,1))scaley(var(--transform-scale-y,1))";P=`-webkit-transform:${t};-ms-transform:${t};transform:`+t},origin:()=>{de("center!top!top-right!right!bottom-right!bottom!bottom-left!left!top-left",R)&&(R=R.replace("-"," "),P=`-webkit-transform-origin:${R};-ms-transform-origin:${R};transform-origin:`+R)},cursor:()=>{de("auto!default!pointer!wait!text!move!not-allowed",R)&&(P="cursor:"+R)},shadow:()=>{let t=et({xs:"0 0 0 1pxR.05)",sm:"0 1px 2px 0R.05)","":"0 1px 3px 0R.1), 0 1px 2px 0R.06)",md:"0 4px 6px -1pxR.1), 0 2px 4px -1pxR.06)",lg:"0 10px 15px -3pxR.1), 0 4px 6px -2pxR.05)",xl:"0 20px 25px -5pxR.1), 0 10px 10px -5pxR.04)","2xl":"0 25px 50px -12pxR.25)",inner:"inset 0 2px 4px 0R.06)",outline:"0 0 0 3px rgba(66, 153, 225, 0.5)",none:"none"}),s=t[B];s&&(s=s.replace(/R/g," rgba(0, 0, 0, 0"),P=`-webkit-box-shadow:${s};box-shadow:`+s)},outline:()=>{B&&(P="outline:"+R.replace("-"," "))},pointer:()=>{B&&(P="pointer-events:"+B)},select:()=>{de("none!auto!text!contain!all!inherit!initial!unset",R)&&(P=`-webkit-user-select:${R};-moz-user-select:${R};-ms-user-select:${R};user-select:`+R)},fill:()=>{B&&(P="fill:"+B)},stroke:()=>{Se(B)?P="stroke-width:"+B:B&&(P="stroke:"+B)},items:()=>{de("stretch!start!center!end!baseline",R)&&(P=`-webkit-box-align:${R};-ms-flex-align:${R};align-items:`+(de("start!end",R)?"flex-":"")+R)},content:()=>{if(de("start!center!end!between!around")){let t=R;de("start!end",R)?R="flex-"+R:R==="between"?(t="justify",R="space-"+R):R==="around"&&(t="distribute",R="space-"+R),P=`-ms-flex-line-pack:${t};align-content:`+R}},self:()=>{if(de("auto!start!center!end!stretch",R)){let t=`-ms-grid-row-align:${R};`,s=R;de("start!end",R)&&(R="flex-"+R,t=""),P=`-ms-flex-item-align:${s};${t}align-self:`+R}},justify:()=>{if(de("start!center!end!between!around",R)){let t=R;t==="between"?(t="justify",R="space-"+R):de("start!end")&&(R="flex-"+R);let s=`-webkit-box-pack:${t};`;t==="around"&&(t="distribute",R="space-"+R,s=""),P=s+`-ms-flex-pack:${t};justify-content:`+R}}}),$t,B,H,zt,tt,uo,R,_t,P,nn,qe,Fr=new Map,Nr=et({"::placeholder":"::-webkit-input-P!::-moz-P!:-ms-input-P!::-ms-input-P".replace(/P/g,"placeholder"),"::selection":":::-moz-selection"});class Le{static init=function(){console.log("%cin initUI",k),Le.build();var t=new Draggabilly(".draggable",{handle:".handle"});GM_config.get("hackheaderzindex")===!0&&co.start("animation-target")};static build=function(){console.log("%c in buildUI","background-color:green;color:white"),GM_addStyle(".flex > * { margin: 2px 1px; }"),GM_addStyle(".flex > :first-child { margin-left: 0; }"),GM_addStyle(".flex > :last-child { margin-right: 0; }"),GM_addStyle(".panel {display: flex; justify-content: center;z-index:999}"),GM_addStyle(".menuBar {border-top: 1px solid; padding: 10px; font-size: 1rem; pointer-events: inherit;position: relative;top:0px;  flex-flow: row wrap;/*align-content: space-between;justify-content: space-between;*/}"),GM_addStyle(".draggable {background: transparent;border-radius: 10px;padding: 20px;}"),GM_addStyle(".draggable.is-pointer-down {background: #09F;}"),GM_addStyle(".draggable.is-dragging { opacity: 0.7; }"),GM_addStyle(".handle {background: #555;background: hsla(0, 0%, 0%, 0.4);width: 20px;height: 20px; border-radius: 10px;}"),GM_addStyle(".flex > :nth-last-child(2) {page-break-after: always; /* CSS 2.1 syntax */break-after: always; /* New syntax */}"),GM_addStyle("#animation-target {width: 10px;height: 5px;background-color:coral;border-radius: 25%;}");var t=document.createElement("div"),s=document.createElement("div");s.classList.add("handle"),t.appendChild(s),t.classList.add("panel","menuBar","flex","draggable"),document.body.appendFirst(t),Le.addButton("collectChecked",kn,{},t),Le.addButton("CollectAuto",Mn,{},t),Le.addButton("showBill",Pn,{},t),Le.addButton("billInDetails",$n,{},t),Le.addButton("PDF",jn,{},t),Le.addButton("SList",Ee.showList,{},t),Le.addButton("DbgMode",Yn,{},t),Le.addButton("statistics",Bn,{},t),Le.addButton("Database",On,{},t),Le.addButton("about",Dn,{},t);let n=document.createElement("div"),a=n.style;n.id="sttPlaceHolder";let e={position:"absolute",bottom:"7%",left:"4%","z-index":999,display:"hidden"};if(document.body.insertAdjacentElement("beforeend",n),Object.keys(e).forEach(l=>a[l]=e[l]),GM_config.get("hackheaderzindex")===!0){var o=document.createElement("div");o.id="animation-target",t.appendChild(o)}};static addButton=function(t,s,n,a){a=a||document.body,n=n||{position:"absolute",bottom:"7%",left:"4%","z-index":3};let e=document.createElement("button"),o=e.style;return e.classList.add("button--primary","button"),a.appendChild(e),e.innerHTML=t,e.onclick=s,Object.keys(n).forEach(l=>o[l]=n[l]),e}}class co{static start=function(t){const s=document.getElementById(t),n=p=>s.style.transform=`translateX(${p}px)`;let a=0;const e=7,o=p=>{n(a),a+=e,a>100?requestAnimationFrame(l):requestAnimationFrame(o)},l=p=>{n(a),a-=e,a<-100?requestAnimationFrame(o):requestAnimationFrame(l)};return requestAnimationFrame(o)};static stop=function(t){window.cancelAnimationFrame(t)}}var un=Le;const fo="#OCAddonsCfg {background-color: lightblue;} #OCAddonsCfg .reset_holder {float: left; position: relative; bottom: -1em;} #OCAddonsCfg .saveclose_buttons {margin: .7em;}",po="height: 16.7em; width: 30em; border: 1px solid; border-radius: 3px; position: fixed; z-index: 999;",cn={id:"OCAddonsCfg",title:"Configuration du module",fields:{nbHrsAfM:{section:["Statistiques","paramètres"],label:"Nombre de minutes pour une session d'étudiant auto financé",title:"Durée moyenne d'une session AF (calcul du THM)",labelPos:"left",type:"input",default:30},nbHrsfM:{label:"Nombre de minutes pour une session d'étudiant financé",title:"Durée moyenne d'une session Financée (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsS:{label:"Nombre de minutes pour une session (avant 01/07/2020)",title:"Durée moyenne d'une session avant la séparation auto financé | financé (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsD:{label:"Nombre de minutes pour une session de soutenance",title:"Durée moyenne d'une sessionde soutenance AF (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsC:{label:"Nombre de minutes pour une session de coaching",title:"Durée moyenne d'une session de coachine (calcul du THM)",labelPos:"left",type:"input",default:45},maxfetchpg:{section:["Application","optimisation"],label:"Maximum de page recherchées dans l'historique",labelPos:"left",type:"input",default:1e3},datacachelifetime:{label:"Temps de conservation des données dans le cache (en ms)",labelPos:"left",type:"input",default:12e4},checksessionalreadyexists:{section:["Application","Base de donnée"],label:"sessions: vérifier existence avant insertion",labelPos:"left",type:"checkbox",default:!0},sizeofcontentlist:{section:["Interface","thème"],label:"taille de la police des listes",labelPos:"left",type:"input",default:"1em;"},use_custom_css:{label:"utiliser des styles personnalisés",labelPos:"left",type:"checkbox",default:!1},custom_css_url:{label:"url de la feuille de style (si plusieurs les séparer par des virgules)",labelPos:"left",type:"input",default:""},custom_css_data:{label:"saisir ici le code css à injecter directement dans la page",title:"Je me demande bien à quoi sert le titre",labelPos:"left",type:"input",default:""},alwaysaddcbox:{section:["Interface","Gadget"],label:"Toujours ajouter les checkbox sur l'interface",labelPos:"left",type:"checkbox",default:!0},show_throttle:{label:"Afficher le temoin d'utilisation du CPU",title:"Affiche le point rouge qui circule dans la barre de menu. Quand il s'arrête le CPU est utilisé",labelPos:"left",type:"checkbox",default:!0},hackheaderzindex:{section:["","Hack"],label:"Changer le zindex du bandeau haut",title:"le bandeau haut à un z-index  (1000) qui le place au dessus de tout ce qui est présent à l'écran, ce qui gêne la barre de menu ; activer cette option réduit ce chiffre à 0",labelPos:"left",type:"checkbox",default:!0},support:{section:["","Support"],label:"StephaneTy-Pro.github.io",title:"more info on https://github.com/StephaneTy-Pro",type:"button",click:()=>{GM_openInTab("https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon",{active:!0,insert:!0,setParent:!0})}}},css:fo,events:{save:function(){GM_config.close()}}};var fn=function(){GM_config.open(),OCAddonsCfg.style=po};class mo{static longTaskTiming=function(){if(window.self!==window.top)return;console.log("LongTasks: Initializing");var t=new window.PerformanceObserver(function(s){for(var n=s.getEntries(),a=0;a<n.length;a++)console.log("LongTasks: ",n[a].name,n[a].duration,n[a].attribution.length,n[a].attribution.length>0?n[a].attribution[0].containerType:null,n[a].attribution.length>0?n[a].attribution[0].containerName:null,n[a].attribution.length>0?n[a].attribution[0].containerSrc:null,n[a].attribution.length>0?n[a].attribution[0].containerId:null,n[a])});typeof window.PerformanceLongTaskTiming!="undefined"?console.log("LongTasks: Appears to be supported"):console.log("LongTasks: Not supported");try{t.observe({entryTypes:["longtask"]})}catch(s){console.log("LongTasks: Not supported")}};static paintTiming=function(){if(window.self!==window.top)return;console.log("PaintTiming: Initializing");var t=new window.PerformanceObserver(function(s){for(var n=s.getEntries(),a=0;a<n.length;a++)console.log("PaintTiming: ",n[a].name,n[a].startTime)});if(typeof window.PerformancePaintTiming!="undefined")console.log("PaintTiming: Appears to be supported");else{console.log("PaintTiming: Not supported");return}try{t.observe({entryTypes:["paint"],buffered:!0})}catch(s){console.log("PaintTiming: Not supported")}}}var Kt=mo;const on=function(t,s,n,a,e,o,l){o=s.createElement(n),l=s.getElementsByTagName(n)[0],o.appendChild(s.createTextNode(a.text)),o.onload=e(a),l?l.parentNode.insertBefore(o,l):s.head.appendChild(o)};const ho=function(t,s){if(!arguments.length)return Promise.reject(new ReferenceError("Failed to execute 'fetchInject': 1 argument required but only 0 present."));if(arguments[0]&&arguments[0].constructor!==Array)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 1 must be of type 'Array'."));if(arguments[1]&&arguments[1].constructor!==Promise)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 2 must be of type 'Promise'."));const n=[],a=s?[].concat(s):[],e=[];return t.forEach(o=>a.push(window.fetch(o).then(l=>[l.clone().text(),l.blob()]).then(l=>Promise.all(l).then(p=>{n.push({text:p[0],blob:p[1]})})))),Promise.all(a).then(()=>(n.forEach(o=>{e.push({then:l=>{o.blob.type.includes("text/css")?on(window,document,"style",o,l):on(window,document,"script",o,l)}})}),Promise.all(e)))};var lt=ho;var Ks=function(t,s,n){"use strict";if(!t.MutationObserver||typeof HTMLElement=="undefined")return;var a=0,e=function(){var b=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(v,y){return v instanceof HTMLElement&&b.call(v,y)},addMethod:function(v,y,O){var E=v[y];v[y]=function(){if(O.length==arguments.length)return O.apply(this,arguments);if(typeof E=="function")return E.apply(this,arguments)}},callCallbacks:function(v,y){y&&y.options.onceOnly&&y.firedElems.length==1&&(v=[v[0]]);for(var O=0,E;E=v[O];O++)E&&E.callback&&E.callback.call(E.elem,E.elem);y&&y.options.onceOnly&&y.firedElems.length==1&&y.me.unbindEventWithSelectorAndCallback.call(y.target,y.selector,y.callback)},checkChildNodesRecursively:function(v,y,O,E){for(var $=0,g;g=v[$];$++)O(g,y,E)&&E.push({callback:y.callback,elem:g}),g.childNodes.length>0&&e.checkChildNodesRecursively(g.childNodes,y,O,E)},mergeArrays:function(v,y){var O={},E;for(E in v)v.hasOwnProperty(E)&&(O[E]=v[E]);for(E in y)y.hasOwnProperty(E)&&(O[E]=y[E]);return O},toElementsArray:function(v){return typeof v!="undefined"&&(typeof v.length!="number"||v===t)&&(v=[v]),v}}}(),o=function(){var b=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return b.prototype.addEvent=function(v,y,O,E){var $={target:v,selector:y,options:O,callback:E,firedElems:[]};return this._beforeAdding&&this._beforeAdding($),this._eventsBucket.push($),$},b.prototype.removeEvent=function(v){for(var y=this._eventsBucket.length-1,O;O=this._eventsBucket[y];y--)if(v(O)){this._beforeRemoving&&this._beforeRemoving(O);var E=this._eventsBucket.splice(y,1);E&&E.length&&(E[0].callback=null)}},b.prototype.beforeAdding=function(v){this._beforeAdding=v},b.prototype.beforeRemoving=function(v){this._beforeRemoving=v},b}(),l=function(b,v){var y=new o,O=this,E={fireOnAttributesModification:!1};return y.beforeAdding(function($){var g=$.target,C;(g===t.document||g===t)&&(g=document.getElementsByTagName("html")[0]),C=new MutationObserver(function(u){v.call(this,u,$)});var c=b($.options);C.observe(g,c),$.observer=C,$.me=O}),y.beforeRemoving(function($){$.observer.disconnect()}),this.bindEvent=function($,g,C){g=e.mergeArrays(E,g);for(var c=e.toElementsArray(this),u=0;u<c.length;u++)y.addEvent(c[u],$,g,C)},this.unbindEvent=function(){var $=e.toElementsArray(this);y.removeEvent(function(g){for(var C=0;C<$.length;C++)if(this===n||g.target===$[C])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function($){var g=e.toElementsArray(this),C=$,c;typeof $=="function"?c=function(u){for(var m=0;m<g.length;m++)if((this===n||u.target===g[m])&&u.callback===C)return!0;return!1}:c=function(u){for(var m=0;m<g.length;m++)if((this===n||u.target===g[m])&&u.selector===$)return!0;return!1},y.removeEvent(c)},this.unbindEventWithSelectorAndCallback=function($,g){var C=e.toElementsArray(this);y.removeEvent(function(c){for(var u=0;u<C.length;u++)if((this===n||c.target===C[u])&&c.selector===$&&c.callback===g)return!0;return!1})},this},p=function(){var b={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function v($){var g={attributes:!1,childList:!0,subtree:!0};return $.fireOnAttributesModification&&(g.attributes=!0),g}function y($,g){$.forEach(function(C){var c=C.addedNodes,u=C.target,m=[],A;c!==null&&c.length>0?e.checkChildNodesRecursively(c,g,O,m):C.type==="attributes"&&(O(u,g,m)&&m.push({callback:g.callback,elem:u})),e.callCallbacks(m,g)})}function O($,g,C){return e.matchesSelector($,g.selector)&&($._id===n&&($._id=a++),g.firedElems.indexOf($._id)==-1)?(g.firedElems.push($._id),!0):!1}d=new l(v,y);var E=d.bindEvent;return d.bindEvent=function($,g,C){typeof C=="undefined"?(C=g,g=b):g=e.mergeArrays(b,g);var c=e.toElementsArray(this);if(g.existing){for(var u=[],m=0;m<c.length;m++)for(var A=c[m].querySelectorAll($),L=0;L<A.length;L++)u.push({callback:C,elem:A[L]});if(g.onceOnly&&u.length)return C.call(u[0].elem,u[0].elem);setTimeout(e.callCallbacks,1,u)}E.call(this,$,g,C)},d},f=function(){var b={};function v(){var $={childList:!0,subtree:!0};return $}function y($,g){$.forEach(function(C){var c=C.removedNodes,u=[];c!==null&&c.length>0&&e.checkChildNodesRecursively(c,g,O,u),e.callCallbacks(u,g)})}function O($,g){return e.matchesSelector($,g.selector)}i=new l(v,y);var E=i.bindEvent;return i.bindEvent=function($,g,C){typeof C=="undefined"?(C=g,g=b):g=e.mergeArrays(b,g),E.call(this,$,g,C)},i},d=new p,i=new f;function w(b,v,y){e.addMethod(v,y,b.unbindEvent),e.addMethod(v,y,b.unbindEventWithSelectorOrCallback),e.addMethod(v,y,b.unbindEventWithSelectorAndCallback)}function T(b){b.arrive=d.bindEvent,w(d,b,"unbindArrive"),b.leave=i.bindEvent,w(i,b,"unbindLeave")}s&&T(s.fn),T(HTMLElement.prototype),T(NodeList.prototype),T(HTMLCollection.prototype),T(HTMLDocument.prototype),T(Window.prototype);var h={};return w(d,h,"unbindAllArrive"),w(i,h,"unbindAllLeave"),h}(window,typeof jQuery=="undefined"?null:jQuery,void 0);var Fn={data:"DwCwLgtgNgfAUKApgQwCb2BRZkAIDGIyATgM7YC8ARAK5gBmAtABxUYCEjjuADgPY1iARxp8AlrjEA7fFEGJcURKUViARitSIaAD1z1xKgPy5GMXgOIWaAN3FWlKgFYDEVxFNwQ+W3KRxSqMhQfFIKXBik+MRiPGB+xPjU4GA8pABcAPSZ+KhSAHROpFpQYjbE+WFgmVI8EJmkAO6I2MFuYABMAAIAjAAMbMAN0bFgkSNxCUlUKWlZmTS1ANYA5vn4fPVBAJ5FvfnM+R09mTtF+RDShaRUuFr0brgwQ1ExcRxcuNZWAJIAoj0eqYzAhXqMpskwKkMtlcgUiiUyhUqpkViBMsEeNJEEUMVAsWEujYOvkdKTTmJ-HiCYhGGJEIDrrd7m5nsM3mMEJxuPxBIplLhkHRiAKpMgbGIVsgwNoyMDxhyITMoXNYXlrojypVsKj0Zjsbj9YTiaTyahKdUjYgmWywe84KCwNslPA1D5trgAN5wL4GKRgRj0ZCXKDbdK4KgAeR4HlwAGVkFIbgAaUzIHg8JSMUjbfyICCpgBCpSkSwAssh8HHczKIAAxUJgVNUOOIFZ8BQAVR+VFTACU+G6wHxU5GdNsVh5GAmk6nO2pFmAaKmAMKJnAiqBQZsACUQUBs2DE+DwADltIhe7g9wejyfUwBBGLBVOkROkbNuMT0ADcuDgAC+CANE6LrASAKDoA6wBuqg2zwAg5o2AQUDIKQpDULWmbSpeGAUjYCGghMnJwI00ioHwjT5CyxAADJ8Gg0grA++LYrgFD6Is+BgGIoS4AAFCeW5qJWSwAJRenAACQUkbEmfBKPkIQrPxVA0YoDHmlIKxUGJP4+l8hlfGRgSUfkaCoH8h7+rRFoeG4-EAORNMEjmpvQXE8Xx-GIBJ3pGUZsmhKQCnWspqmINZ8TOY0rm4CK+CIGUiCoKmFEEMEUAifgSy6fpAWGUF8mKeFvn5QVAVCVlon8XpBkFQBdUVQQwWhUpfAqY5kUePE5BgI5TWGQB+lySFJUdapNH0Yx2ksTSfjYDKqB5XAHkyF5niTmAnbEFAABqJCkLVklGTYJC4GdcocZ6w31Rd508CQYAqBxJkUVRIQnht+QgCK9D5CK2GJfxmQANpGAAZAAugA1PxoMAHoUNDMNiRQ8MI9DABUYmomI7mebxUj8QWSyINsyZnXIvknRVl2kKDZPbFD7H3dT5VfI1HPxdggiePT+lAathN8VtO1QAACiQwb8Y9xDBtgbhpYgQY0FAYBUzQvn+YZl24II+LS1gMpWBx9xCurmuINz378W9ZmfdKRM-X9+TkYgOiRvQstG4rxASeYjA9GJOsFQbcsKybrNi7tB1kLVoMR8bbhQ9zRlAUZIpLsQnjh77JuCw6esURAfaQR6HFrdxRMCX50lZ3zuBhI0uAS8QmyUog-EimNh7seY3oyd+AkUfgNBYP6APl3GOAyuxHFUCEM06XXMlSaP489eZqCWVFtl5mExCqQAIpGZYro2PXTVoy2pj3CmHmJ0lSQBuD7uQklr-ft61fpMlAS-J+t04D8TQtsGQx0KAD2kqNNq4UqAAFJ8D5HyP4J6V4qAbBCMQdIGx5ZQBWlJZAsUxDxBLmXNA2xf4wNauNFSiDch8HwJIFQIpKEYKwXwHBeDgiEP4DwGgPBqFFTGmFCaDCUH5A8LfCMnDuFcN4XVKSgExLULgJkLGPosb6x4qUJ0nF1o1xoOQVAkhTFnBUJSRy-p9YmK0f+XA2ivgNxzgQQQIobFBBlKmR6O8Uq4DImAEAuA+iSHoE3FoN8tGZDgHrLaAAVCCx8cLsSrhtY6g80k118fxUgfkebZ08Lk3AwBcD9AkiYRyfRHK4Bhn4XA4ZSB-gAcXVmzdcDJJlLVeuvNXGg1QPkLadY1ZQAAJooCPhJHxaB+IDK2mWRsIBaow2DtM1AszBnYE6V3MSYkoaFHEMTRyjABqASLg9PgAieCszATIAx1dQi1UHsPfiToYx8HCXGWKUBcDsAoBxRyWTQgDUHiItqbh25HwYT8YgCU+CHnlmoJQb9YVcIwdlVY7dFioEYHI9IIpUp4qRaJQhUkXFSD-i-aS2RgR3AAJf0GkKQmuWgVD7nzD1FQGwIAQEWKQalORgq9RlGkVmoNHI9DcrgRyHQpWOQAMyOShtJJQwrECio4uKyVyYZVKpoUmXq3yACKWstYz3VazL5wQLhiB0NIfioKAD6WE44ZCbiM5MBkZJyUZcQCAhY6DDikPEj2YBwyOTjDQMo65cAQ3lrCn8bkvWyUTIlKAAaoShBDToMN0q250vwHSrQNiIaoQTUmr4MkeDtxWD3Ug5q5h+BFaQT1layXdTIIgDNQa3VgGIFrVtuAZJUzEF4omZZlBvknOGlcChCDBlFcoeIIoRBWM9TJc0qBoweHDECop3gghQFXmvWBdDVKSKtVAdIm7t1SFJTJe2VFzSkEemAQgVker8WfmvdpK5jHDggB+-0TkXJQCld+mSnpcALjUEi5Q4Y+0DruK0MQV6vS4BlDm8MUYADS+RbivwAWvKST9iNKJfqmZ+ZEty3t3SLYm2tv2nrEfQi93z0jUagLe0lAF13r1HWXQIbg6OGO8ge4IIcIPMfaqxtjwRr0CekW4e9UlH3UUpK+99UV+K-v-ZsIDYAQPfKlVBmDcHe39sQMrHAqHwxQcw7myB5gHMkBQPkK2uBCO7OfrxqjqGoArhCOQETDzibiaPaC71tCWPnskfkS9HH-OBb4OQHjfHN3JeC-c9J4XJPEek-AuLKCEsZaC5ecjvmN2juPku9uYZstExJj4CTkWwVnqoEV4r7HN01f8HVtLz9pJc2kvq-wbMtYvVwKDVOKrsBuNhT1Btf9RvxEemEKAjrGggFCpGYgrYlDcVZqCniYBkVSXDSahQdg1aIAAF4XQECoN8tg2wkC0MQJNMlwDQCMuGAABs-YAShJyBBgCubblJKTkHu2BulMpAhayGMD6R8AZLAEZfuVAfVUdSWAEhFCaEMJUAMH62to62CA+kAI+Io7qCEHEIlW4YosB04h4zjD2wYzJFHcW24VtqBSBGYMbkRBAjIoXJmzwshjxLAIGz8IIIZLxIEPED2-BiAmxgoGvitOqDvmaMQHozJpTIEYJWDa1A1dcLAI6zKtxZCE+oKBjo2ZQIpVuG8xA1AJdBrYJGHDQwfehBx3GOlUAC0bUPvyFQOBzNa8l2Y6g+u3AdGNzgM3oXLc6HVzb0Il4CfoSd98l3-hnTu451zqgQe70wH94H7XUgcdDAx1ALH2Am+ohiFBGSf2+PVsQBfKQvqIAhfScgVMahkz4GTKlGmn8ovFRi+Pyf0-Z-kakqq3Azr8w8Fdd+vtHpWvb4gLvw6rMABScZIynnyHLcgsymGb0niINw2x9uIG4lwpyoNmde8wfLqgKGAadzYILWdfKSWEaLGTVSENE-dIK8Y-U-MgdfV+L6QgHyY9GSSAxfaAv7JBP4HQRKOIGuAAEk9EQAAl72lTxR4SgB-AxVrQEECFxQUi4XxRSgGkpRkkvVQW20aAOlKDHVCAnXQmQEnH4j+wnUSAkF8Hp0hysEWAUFZWQ10FwEuQ2lID+3APJX0GCHIC4KIzaxi0v2v1v0Oi7g3gnjAHyBf2IDf3ZU-yPkch-wVlZwZ0vCALEhAOpl2S4OyFtk9w+S3xdTP3+QBWxRVmxFQBqQAB8Yjgid9XV54OJBctw8sh5vYEiT8kiwj3U0jWseDSA+CBDR0nZhDJ0xCu5JC3B8AZC50IdSAxAFCwhkNNBtA9B1CiZNDtDelPAgwoB9Dv1X5v1sDRFcCkFYCkCWFcAyDEDXVKDkxMFWD5F8F70dDPQ8weB0gehUwrZ0g5jDohZ-4+MNFn4nArtkBKRkM7AmjeAnpbjSA+RFDkMZRQs7hHI6VrIOUbE5smhSFCBHhHiHBHJFg1CaBFBHIhQ+0lCBR2UrC2jFA8AX8tY34+jQhQsziFAYxVCtBXio5UIWoDU7j1tNttslBdt39uJUxzivAupPByANc7h0TvheB25HpJwHAFBiA6VHj1ZpRcBJFcAABzvAFov0ULFox6FQZ+LGGJB9fzWjBrbyfcTAgrcROTK9Tjbjdfb9fcGwrWOwyk4cJw-IEnCAMnaIrwiyAzfeeHByRyaXHKKVR1UXVAJQU2JUhjSTKTKA8KPA-AAzXAeJEgLacMMg60DcLaBYpY7BXBBRAhcAn0okq3DXFiDbc3GuSuejHyGwMAdIteW2SKawyM7AC4aUAEo6RyavfpE3DPC3KgFMm3O3Tw-Mk9X0iaf0ggnPXAB8WiWiOXdw3vGMtg2glTLAzINbfcUknbPbBw6wg4q6aVRs23LcRyP8GlDYNWPIRyeIYxBQUhCDGSIs9YdxHqYM4gLafU1-I0r-Zw3-Nw48Dw4AjzDiEwm-PrJib8KhT0PYhs7Pa3FcghRqQ8iA04RABcFYDkrgmSIdHgx0pYQfYfYRYjIdQwmSclaC26fLIVN+f8jXSMMIW3N4rM0TBjXM1sqSQs3M-IEs6ww8iAcsiCSs6srxU3DM0ILPHPR1PPQAgaCi0CycjbLbGco0-IBcybLqPC3PMINc3ADcgQVvKQHc2xfcsAEC48seBbf0c8y82w+wg7Y07-e8--dw3irwl83AN81BPtT8+gb8385cni4C4jKSIdNUlSf0n4JMdoQUJtC1fk-gRojaBpGYz0HgraS7M1EVZZHoaMmg+Msc2C75N2byjXSKxABtH2EkrbaUZXBMQ8ZMcK7AdKzKsSFZUjFyzY0gVBTMR8-iIqsAEq6KsqnYkJVMCVNQTgkCng6QBkxq01DK6KwSx1M06UQq5KiKga0qmGDoCq4jKqmq0oYGBqpq9VZZDoVMPodqnofALqlyoybITfR1NQMATwDiBqxCpo-1BvZCteIdbIY6069YJapYW6mCqSOCl6y6v1N6l+f8YjDCiDLCteDRQUN40hRxOUteRstMoi9JMqCDRsgixAOGxrBGteYbf+IbB0ERVbRMKcnKsAPK8UBQa6Z+E7M7C7FE67JQe7a7J7IUQ8KUYgd7T7KSb7KAc7XAAHNePHMoZNKSHQRgVi6gUOIdGSWPRwOzO6NtKSHoOzMxcMfoVMMAJFdIZyJcYtZ6KVBzcNP4TWsQdcUgGpXzAqNeDoBW0dcMDoLajDNW5ySdLonW0NcNVsdCJ2zzQdQKGSeVS21AcMeVW21Wq9DWmgLW0gF0i0LhbYZ2rDaVHcKOmIF-FQOHMOw2-0Y2z2mW8WqSAAFj9vDFzqDvtpAETu2EdXIHdtCEdRPABNjtzUcgrGEBRPZIUErsaOChNq9sKhkgAFYC7cBe7i6Q7jZkB67w1j5QgpA6UWgVB0xaqvpkpM7Tae6qVZaAIqBv0cdcc1Z4BZbgBuQeYxsgisJUI54Ig7pebT6cJs614haSdqBQZR1djQDEAWZpBcBIw1BzjuIpF-QYhlBXlkBzMxJN6zaZJ0gmZqBydL6ZI96ApebSh4Hva0cqc6AK8-8ASco3QdBbh0hdcrY3ZloGljLCHg6+dX7qAKdwG0dUI1B9wGkH6qBCHydcAhaHNqAyHQ1BhMg6H9xkHV6kcxABHebMhr6ZRt7ccFhYBv0hgkIcde9n5+9vqR9a5+559QLBQY8IIRRpi8AsGlgcGAlSFgkpA+AzFJAvB-19BUMo4ddTFhw+AmMcLuLLUJrsAJZLlBFaorzDS5yuE0zv9PcKADGcGoYn7UBPCuDN8JAOJuKlIPAVgglUxbdYU2lEAW4nx5YqExA9J-qZISd+I-wxAuA-xUniAn6WZrorbuLKmiHUxf99i+A6nf8p8IIcoUomm6mDGUpMb0Lej0NNj0gNrxtEBwxymiMAEsLRo8aSSvFSb58KbEAuaqBLstwBR5mUxn4OauaebcdS8wIsDtEhJpEAGrA0B0wwA6VkNcBZgYRBVsFSg1B1hNhMhsB8BMgRQVgzSHmuEnnGAvmzTGAOhe7MhbmVR7m5EnmXmthKIpAl5UBMgegABOVFsF2U5+DRPhqAaiHCdIdIZAegKOT0OSeHXNKgAAHUQGYHlQADYqAfxArmVQhwxNwnZDwfwlAiXC6+geAdAfxhwtjB6+WfwAIMWCmuEIAvRn1sJ6sLTGWLImIlb8x6DRJGDsVwwABiegZFnVnV+grhd7JWvlvwBSUdXATV-AHa61n8Bii86Qa2kUKVqE8x0JF1215AIWsiVAIJcMWlvoXl-l3xLSFYZViAUV5+M0yQWodBz0BgrFQILV+gZNg1lm4TMpE1sac1zV5F-AXN3NiNiVv1aDBvL0eNpg-21QNEMAWtcmBVneJVkJfIAAdhVe9d9bKQDYQVTaNZCULakijer3SG2wRTLbVYTcrfbFb37ajexa9GDcbb6HyF7vzCbZXalaXfXb7aIyjbQfiE9AXe0nDCXdbfDbtZWGkEYCHAA2PeXadZnclejep3SAMDHhUE9BVxLDGdwHlUzbNdMSndQH7a6CwHNDwBJkvfbZAB5cDb8lNMldtx3j4k9AtMYHEdpCwXHiTGtoDZNZ6HoGIB-FQ6lCFZ6FpZFdfng79UQ4ok8Dnc9AczN1KBWCkFZclHACI67xYLkAgFY7KTktwA6FFYFLNJo51xjabBE4Q4sj4mry9FQ8w94+toE-lVFaIxeDdyb13dQGoD7AfAAC17dUJC9idpOkO70wb6yKdUGJOMHWcP9DG+BcHE8q8jS082LM8qA+oK65yjB7d2myZu9cc52mH8A1AjTdtTw+AwA2BQ8DKiYo9nieA6UYgfAFAjAkdgH+HAcQuuFqAfW6x24IAjPHc1IcI2BtkbnUA6UJdMv6GZGbPqcXOCuiuPdOc-95nbgGKdBqAbbA6g4Xd5UjcvBpBeu+h+gBvGAhv3O6yiYndsBHV5mRrWu7hazUJtIaBKiKBAUPsm9cviB8uia+ASuTPOuYBKvfBGUpA6vsvGv0HdcfXlc2vK9OuvBPWxv+uehBvhvLgpAxuJuvupvhvWLZuOKvOFulvhwZv1uVhNvJxtuCPHIO8zSm8X1EwYAouZRwxkVGV1ZdGgTETVu54WjShLg54X9o8Foq6kwClLBp7lAXg1sFG+8RQVHwwnMNHv01BzwUpKuzZH8rDNkwA-glArDCxtgfh1kqyjTgCemgPv0WvNhWZLCt4toRfviwBxfJenJFeIBnzX6uDHvzH+ex5Be1fReeotepfdf9f2Zv1v1bZufIk+f-kMNLNY0IYBI7gwBCulfciqBbg4jvfldkiIxdJcBWzCjijghSiNoRCp0qipDaibnSAw8P9I9Hhnj5mwT6UNgASYd9G0IYS-A0-QstDoKdD+jBiMb8nlEv4BnWshn5VKNiM9jQZDyVfJ5zeNerenJwu5zZeAuUo+M15O-rDu+xeJfrefeivgDn1gGlBTFcjEN0u8iflwwx+hf1fJ-tfHIbfzLX6R+N0BfVfsBt-Lep+deju5-KQF--Fl-3eTBUj1+mTTfT-heLf-Re+9-r+D-qYINlUGNSlJVn4xboYwfHHyEenUZi1AoepPSjeRNKicZOSlK0jvBtJ2RD4TkedNpEQDOlXS7pVmHugwIwCKouNBaGAG2S+8IAqNPiCRVCw5k8yrWSit7GPK0Uyyb6Jit-hB7sU-u4PG3EtwI6bAzKFFTfBYlZh1hzcggekBUCebVUru6yY3uYD4BEN540qCxHtWIy2wxBuRCIldxSj8V3KqkJBD8D7B9g-gK4SMHtD+B6dCwtEP4LgGsF9hIwfYXAKeD+B-Bj4PZFcCuD+Bxg4wQZSMPGDPj2CHwEsCWLRB+ArgHw8SH4NflwB7QHwfYOML2BApVlx2FbbjmwQJR-giUqEHKImhArgF+mhSaClShcraDVuuwaqnEGIAd8T+XfM-p-016X8f+yuW3iiQ4ggULED+N-g0I-498Wh+-bwmARAp-0t03sRyN4H9AgBgCo1QzFQFGSLDRkjAMsGWEYDHxj4Y5KSOQCgD-RxKYqT0IINUab8J+F-XfkMKtgq0+A16eoeP0aEDDzhv-YYRQUAEoU0K7aEoUDWgpJkxsfUB8HBjypzk+enpBgRRSorFkQypZBihwMAbOFuBnnbzjsPT5+cWyTAoyEdTUDK9bhW-Jod-374GVB+DnFKKUPXjYjThX-QYTP02A383wcGJfr8i3xqAuhZI+4Tv2n5tCvC8-OkazHYCMjDyaFYGkc0s41wIa4rNeH1EoFFcaBXpaCn8IBF8AjS2yDAmnAqjDZmoB1QVDgXgRIJQgt6CwFcg4TLE4yqxQaKqO7pGRSsKWb9pAIkhQJaY6ogKHAINL6V0+t5KjtQOQHAEnW8KRAOgIPgOR-8iYScAgVFyt43ApogKJViGx-wZmxJKcnMKOzk1SElNaVGs30CStpQbNHZv9kBxIQBaQtEWlQDFprxJa8Ge0avXlroYranbdyBmLDSOQigwKFWi7WlSNilKWdGhhbSrGVsbatYv1NKHVr4BSANgcetQWHFd1b6MkWBmvRzob0t6sjXegLQPqfAe48QE+jvjPoK4RGaOdDpOMFqBg8uVACJi-Wpjv1PAX9H+tYR6gAMjopYvJGAwQYQMoGVAGBigwEb70kGe43HHuzs7-4HOODPBgQ1fpEM8GpDYCXMIobUwqG74nOsFyy7r8mGLDYhuw1DScNgJDmHhtixgmiNPxKDIYOh0kZDBFxojeRoNh7ws8B8oQYfOz1tHQIQaYLNCBhh0b7k56cuf8U52MZBIm45jc1hIF5RjZcedjTwOa0cY-D4grjc6u4zACeMrkPjeAf42ICBNnCwTUJk53CajoomEGGJqzHiZKBtIyTLfCQA9LtIsmyAHJnkwgyFNimpTQybCkqZHYamzTMQPsmfpNwFYXTZyZUAVhtMiR-tWpp5Ll59NihjcKDEM1zonitY4zIyYYSmbLZthxqKaiKivJax4YSjfGkJTJKIAKSc5PvOlMW44R10UMLwkEg8D8QBIPcNWHmWgHPxRBjqY+CJA-gcQJB3EKQW4HyBLBjOcg8iPxEUFqEVBrvRyPVKL4aCtBdUhqaTVd66Coi+ZQwdClMHmDLB1gh8LYPsGODnBrg9wZ4IfDeDfB-g+JIEKvxlgQhYQiIVEJiFxCEhSQlIWvDSE5R1WzBPFNkJaixliUOUY2t+nXyA0saG6MaUX2V6-TyAt+PtM-BeQVT1YzwzAjSj7TvgzSjwMDIOHOKq5PA5oCUpcRFDfojqKM1mGDOsKEMCUNAYGKAmTA6BaJAkT0JInHxTYyQmxKGOGDJBWxGoqYG6BJChnywkwUbBGenwwzmMUZQaMUHYQEhMx0gmxCKWMythzVN8pAHcJACgDUApSNzbkryVngMsMZc2XXm0g9TB9jea-LgiMTBaNF+QcuBdJoBSRLpUSa-VMASWz5KUzZ8s6tJ3HNnco4giAB3uEn4iLdjwoMeVOEz6BVNXeK-TAuvCpFSspIcTFGV7PCY9AZsxGI3kOjDmezvZoMDoNHLbJaiOySCHng43MZ7kieCgMgrr1fjcB85R3BYrIiNGjkUC9vAspkQ9n4BQYUcj3l8Frn1z9kL5V3n+S4p24Q4clMFg2jKQQYaUOc0uioATH0MTwOciGrFG0YKA88KlUxB-StACQScb8MBC1B4DbA5qZAu8YmJcqVioM1Y5WnbRDr+Aw6nKUcY5H1pp0jaE4lyl2P3k9jh66tduk7WbFx0I0jtTulnRcq+1uxAdR+aHXDqR1-A0dc+QnWAVJ0JsuAVOmBwzo3ziM+dX+bgCLoq0S6ZdHztTxrqVgII58puhT1bpU8O6SYOBWvH7qIKh6KCkeq0HPmT0pA9PAUPPSWrstlAxCmcbLSOr3YOIF49Pn-RsqAM7xLMsFoU14nnjv63C68fSFvF388kIcQwXeIiZFTX4HiG4goGeIQpZQ7xd2HoD-DIpe6b8MbPLL7QCAbAdKLSb8S7LW4qGf4SyV-j1hiAKAjqW7Ak30kgAg4xTGABQD6DWTGAIg34sGTgyngFYOk27JUxbk0UkUpQ2aZxlwo54rwpAPxUoACVYAihpAcxYyRhivkr875GytpC-IOpSxws+JYgESVWZWK16AGdaEbLxIkUyuN8rkkKXFK0owcxpcrjEhBSyh4o6WdAEsUQYpZMs9JX9mAB4AHucLBFrcF+gqx8uJudIA5gnKoRpAP4edJ2jAAUA6ATAZgMmHDIyA0unYPsJEM2D8AwgwGFJVJVaXMgRlmkTigBTIIJIkkOEWqABGuChA2Ay5a5dgESSIAlRrSx5ddwxAwA-s0FbIL0ugD9LgAPAGAFc3DyLLJwVhG5i8s9BmMqIcwpyEsNGSrCNhA0B5W2MdmWBqqkiIYGCv+Vrwhib8AYgoCgw0pmgASRMGKGiXW5fKSIt4ifTv4DzeGFobGcoEqnPCyyQiPQHaIdSJgxADFNDDoEajgEaUnwUsdzNpUa5TF4k27BQGmzQVJZIqR1I2R0nhzk5Vi7CmnJUi1zN5EGNQA2H7FgA3y6qz2bnX2TyCypvU5Qb-lUENiQoKA9YEP1QAGqjV0IlcHGD2hfB45dci1aaW6lqF1GtqwJQNKHEjivCcvCDI73dXShPVe0CioUyOp2LbajqCABQE2KqqpKTipJiAB-COoxAwANNWUzEAwxUYTAowtAUzWNlQYBaoqSSNtjVqpKtagKS6v4pSQHFt+YxEslr4uVPQNTfGCBQ3RTKPAGwLQDsr2Un488wGVAOUqkRSUqlUAZXPGtyQqqa1daryVgEaVUDmlfAXZEf2IyNMm1OeFtfslaZDqpILYh0uOIvXvCZIRQ9pRjSBrRrvYhqusW+UTVf5k1HilJumuPXW4c1QSfNYWuLVb5S15akCoYP-Ua5T1D6xtWuubUbq5e7aztQIiKJlSL1-avyYOpcqj8R1Wy8dbsovhTrDlhmKyh+RyV2VZkc6ypdUr4C1LoNYAU9Zuqsze8d1Ws3ZGJAPU-p3JjG5jeetw1Hk35bYxyLeqHUPr3hAoiDD0s6WyyqAwAXeirOIxJq5sBan9VvilZxNHFek3NSWqLXhswNZanxb1DrCoYiloa7mnCocX8aFYAER1K8qJq3KukXy2YsEo3WhpKCh5IFVAH6WHkgcwjECoMua7nK0AYyv6JMpwDTLQ0syy4hSkWV9QVlDAFgBss9DWaN1rFOcYJvejwsLlVAMgqQFM0JLbNbAVzTZqwAAR+IpW9zTmmcq4bAtvyvzayr+XPr5qsm9JfJukYwAlNWNb2jwV9RdwSBEtZMd+0cimbCA0glQCsDpTT1FZ7ACtI+I5o5jmodfNHPI3y2yaAIcjMoNhKkiKNwGPqK6t2izRXr6Ih4UMHNtgZ9MpmdUV+IZGAh2hOQged0HhA5rwAgAA",method:"decompressFromEncodedURIComponent"};var Nn=function(){var t=String.fromCharCode,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function e(l,p){if(!a[l]){a[l]={};for(var f=0;f<l.length;f++)a[l][l.charAt(f)]=f}return a[l][p]}var o={compressToBase64:function(l){if(l==null)return"";var p=o._compress(l,6,function(f){return s.charAt(f)});switch(p.length%4){default:case 0:return p;case 1:return p+"===";case 2:return p+"==";case 3:return p+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:o._decompress(l.length,32,function(p){return e(s,l.charAt(p))})},compressToUTF16:function(l){return l==null?"":o._compress(l,15,function(p){return t(p+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:o._decompress(l.length,16384,function(p){return l.charCodeAt(p)-32})},compressToUint8Array:function(l){for(var p=o.compress(l),f=new Uint8Array(p.length*2),d=0,i=p.length;d<i;d++){var w=p.charCodeAt(d);f[d*2]=w>>>8,f[d*2+1]=w%256}return f},decompressFromUint8Array:function(l){if(l==null)return o.decompress(l);for(var p=new Array(l.length/2),f=0,d=p.length;f<d;f++)p[f]=l[f*2]*256+l[f*2+1];var i=[];return p.forEach(function(w){i.push(t(w))}),o.decompress(i.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":o._compress(l,6,function(p){return n.charAt(p)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),o._decompress(l.length,32,function(p){return e(n,l.charAt(p))}))},compress:function(l){return o._compress(l,16,function(p){return t(p)})},_compress:function(l,p,f){if(l==null)return"";var d,i,w={},T={},h="",b="",v="",y=2,O=3,E=2,$=[],g=0,C=0,c;for(c=0;c<l.length;c+=1)if(h=l.charAt(c),Object.prototype.hasOwnProperty.call(w,h)||(w[h]=O++,T[h]=!0),b=v+h,Object.prototype.hasOwnProperty.call(w,b))v=b;else{if(Object.prototype.hasOwnProperty.call(T,v)){if(v.charCodeAt(0)<256){for(d=0;d<E;d++)g=g<<1,C==p-1?(C=0,$.push(f(g)),g=0):C++;for(i=v.charCodeAt(0),d=0;d<8;d++)g=g<<1|i&1,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=i>>1}else{for(i=1,d=0;d<E;d++)g=g<<1|i,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=0;for(i=v.charCodeAt(0),d=0;d<16;d++)g=g<<1|i&1,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=i>>1}y--,y==0&&(y=Math.pow(2,E),E++),delete T[v]}else for(i=w[v],d=0;d<E;d++)g=g<<1|i&1,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=i>>1;y--,y==0&&(y=Math.pow(2,E),E++),w[b]=O++,v=String(h)}if(v!==""){if(Object.prototype.hasOwnProperty.call(T,v)){if(v.charCodeAt(0)<256){for(d=0;d<E;d++)g=g<<1,C==p-1?(C=0,$.push(f(g)),g=0):C++;for(i=v.charCodeAt(0),d=0;d<8;d++)g=g<<1|i&1,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=i>>1}else{for(i=1,d=0;d<E;d++)g=g<<1|i,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=0;for(i=v.charCodeAt(0),d=0;d<16;d++)g=g<<1|i&1,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=i>>1}y--,y==0&&(y=Math.pow(2,E),E++),delete T[v]}else for(i=w[v],d=0;d<E;d++)g=g<<1|i&1,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=i>>1;y--,y==0&&(y=Math.pow(2,E),E++)}for(i=2,d=0;d<E;d++)g=g<<1|i&1,C==p-1?(C=0,$.push(f(g)),g=0):C++,i=i>>1;for(;;)if(g=g<<1,C==p-1){$.push(f(g));break}else C++;return $.join("")},decompress:function(l){return l==null?"":l==""?null:o._decompress(l.length,32768,function(p){return l.charCodeAt(p)})},_decompress:function(l,p,f){var d=[],i,w=4,T=4,h=3,b="",v=[],y,O,E,$,g,C,c,u={val:f(0),position:p,index:1};for(y=0;y<3;y+=1)d[y]=y;for(E=0,g=Math.pow(2,2),C=1;C!=g;)$=u.val&u.position,u.position>>=1,u.position==0&&(u.position=p,u.val=f(u.index++)),E|=($>0?1:0)*C,C<<=1;switch(i=E){case 0:for(E=0,g=Math.pow(2,8),C=1;C!=g;)$=u.val&u.position,u.position>>=1,u.position==0&&(u.position=p,u.val=f(u.index++)),E|=($>0?1:0)*C,C<<=1;c=t(E);break;case 1:for(E=0,g=Math.pow(2,16),C=1;C!=g;)$=u.val&u.position,u.position>>=1,u.position==0&&(u.position=p,u.val=f(u.index++)),E|=($>0?1:0)*C,C<<=1;c=t(E);break;case 2:return""}for(d[3]=c,O=c,v.push(c);;){if(u.index>l)return"";for(E=0,g=Math.pow(2,h),C=1;C!=g;)$=u.val&u.position,u.position>>=1,u.position==0&&(u.position=p,u.val=f(u.index++)),E|=($>0?1:0)*C,C<<=1;switch(c=E){case 0:for(E=0,g=Math.pow(2,8),C=1;C!=g;)$=u.val&u.position,u.position>>=1,u.position==0&&(u.position=p,u.val=f(u.index++)),E|=($>0?1:0)*C,C<<=1;d[T++]=t(E),c=T-1,w--;break;case 1:for(E=0,g=Math.pow(2,16),C=1;C!=g;)$=u.val&u.position,u.position>>=1,u.position==0&&(u.position=p,u.val=f(u.index++)),E|=($>0?1:0)*C,C<<=1;d[T++]=t(E),c=T-1,w--;break;case 2:return v.join("")}if(w==0&&(w=Math.pow(2,h),h++),d[c])b=d[c];else if(c===T)b=O+O.charAt(0);else return null;v.push(b),d[T++]=O+b.charAt(0),w--,O=b,w==0&&(w=Math.pow(2,h),h++)}}};return o}();var go=function(){var t=[{id:"/views/test-swal-sauvegarde",path:"views",file:"test-swal-sauvegarde",ptr:Fn}],s=function(n){oCurView=t.find(o=>o.id==n),oCurView===void 0&&console.log(`%cError view ${n} could't be found`,me),oCurView=oCurView.ptr;let a=oCurView.data,e=Nn[oCurView.method](a);return e};return Object.freeze({load:s})};const bo=go();var mn=bo;Be();})();
/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
/**
 * Fetch Inject module.
 *
 * @module fetchInject
 * @license Zlib
 * @param {(USVString[]|Request[])} inputs Resources you wish to fetch.
 * @param {Promise} [promise] A promise to await before attempting injection.
 * @throws {Promise<ReferenceError>} Rejects with error when given no arguments.
 * @throws {Promise<TypeError>} Rejects with error on invalid arguments.
 * @throws {Promise<Error>} Whatever `fetch` decides to throw.
 * @throws {SyntaxError} Via DOM upon attempting to parse unexpected tokens.
 * @returns {Promise<Object[]>} A promise which resolves to an `Array` of
 *     Objects containing `Response` `Body` properties used by the module.
 */
//# sourceMappingURL=app-facturier.min.js.map
