// ==UserScript==
// @name         Facturier
// @namespace    http://tampermonkey.net/
// @version      1.10.0005
// @description  Un addon pour vous aider dans votre facturation
// @author       Stéphane TORCHY
// @updateURL    https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @downloadURL  https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// multiple usage
// @match        https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history*
// @match        https://openclassrooms.com/fr/mentorship/dashboard/sessions
// @match        https://openclassrooms.com/fr/mentorship/dashboard/booked-mentorship-sessions

// Start at document start https://www.tampermonkey.net/documentation.php#_run_at
// @run-at document-start   

// @grant        unsafeWindow
// @grant        GM_addStyle
// @grant        GM_getResourceText
// @grant        GM_registerMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        GM.xmlHttpRequest
// @grant        GM_notification

// @require      https://cdn.jsdelivr.net/npm/lodash@4.17.19/lodash.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/low.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/LocalStorage.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/dayjs.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/locale/fr.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isBetween.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrBefore.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrAfter.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/customParseFormat.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/localeData.min.js


// GM_Config
// require      https://openuserjs.org/src/libs/sizzle/GM_config.js (cassé ce jour 28/08/2020);
// @require      https://raw.githubusercontent.com/sizzlemctwizzle/GM_config/master/gm_config.js

// sweetalert 2
// require      https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.all.min.js
// @require      https://cdn.jsdelivr.net/npm/sweetalert2@10

// draggabilly
// @require      https://cdnjs.cloudflare.com/ajax/libs/draggabilly/2.2.0/draggabilly.pkgd.min.js

// toastify
// @require     https://cdn.jsdelivr.net/npm/toastify-js@1.8.0/src/toastify.min.js
// @resource    toastifycss https://raw.githubusercontent.com/apvarun/toastify-js/master/src/toastify.css

// https://github.com/uzairfarooq/arrive --> included manually
// require     https://raw.githubusercontent.com/uzairfarooq/arrive/master/minified/arrive.min.js

// simple-datatables
// @require     https://cdn.jsdelivr.net/npm/simple-datatables@latest
// @resource    simpledatatablecss https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css

// require https://raw.githubusercontent.com/anywhichway/nano-memoize/master/dist/nano-memoize.min.js
// @require https://cdn.jsdelivr.net/npm/moize@5.4.7/dist/moize.min.js

// FETCH INJECT --> included manually
// require https://cdn.jsdelivr.net/npm/fetch-inject

// PARSER MKDOWN
// @require 	 https://cdn.jsdelivr.net/npm/showdown@1.9.1/dist/showdown.min.js

// PDF https://pdf-lib.js.org/docs/api/
// @require      https://unpkg.com/pdf-lib@1.9.0/dist/pdf-lib.min.js
// @require      https://unpkg.com/downloadjs@1.4.7/download.js

// HTMX https://htmx.org
// @require https://unpkg.com/htmx.org@1.1.0/dist/htmx.min.js

// ALPINE JS
// @require https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js


// ProgressBar 
// https://loading.io/progress/
// require https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.js
// resource loading_barcss https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.css
// @require https://loadingio.github.io/loading-bar/dist/loading-bar.js
// @resource loading_barcss https://loadingio.github.io/loading-bar/dist/loading-bar.min.css

// https://www.cssscript.com/demo/text-progress-bar-ascii-loader/
// https://github.com/kimmobrunfeldt/progressbar.js - fonctionne mais probleme avec le easing dans mon popup progress bar
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.min.js
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.js
// https://pvdlg.github.io/uprogress/js-api/#UProgress+start
// https://ricostacruz.com/nprogress

// semble cassé
// https://github.com/webosorg/Process
// https://unpkg.com/@webos/process@0.2.0/dist/process.js
// https://cdn.jsdelivr.net/npm/@webos/process@0.2.0/dist/process.min.js
// bof ... je ne parviens pas à faire fonctionner l'exemple
// https://cdn.jsdelivr.net/npm/worker-function@2.0.1/WorkerFunction.min.js
// Threading 
// @require  https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/Thread.js
// @require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadPool.js
// @require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadQueue.js
// semble cassé
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// https://unpkg.com/paralleljs@1.0/lib/parallel.js
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// Freelancer
// https://github.com/Wildhoney/Freelancer
// fonctionne require https://raw.githubusercontent.com/arqex/worker-function/master/WorkerFunction.js
// ne fonctonne pas https://raw.githubusercontent.com/duart38/Thread/master/Thread.bundle.js
// require      https://cdn.jsdelivr.net/npm/paralleljs@1.0.1/lib/parallel.min.js


/*
 * History
 * cf https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/blob/master/CHANGELOG.md
 */
// ==/UserScript==
(()=>{var _n=Object.create,St=Object.defineProperty;var wn=Object.getOwnPropertyDescriptor;var An=Object.getOwnPropertyNames;var Sn=Object.getPrototypeOf,xn=Object.prototype.hasOwnProperty;var En=(p,o,n)=>o in p?St(p,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):p[o]=n;var Cn=p=>St(p,"__esModule",{value:!0});var Mn=(p,o)=>()=>(o||p((o={exports:{}}).exports,o),o.exports);var Tn=(p,o,n)=>{if(o&&typeof o=="object"||typeof o=="function")for(let a of An(o))!xn.call(p,a)&&a!=="default"&&St(p,a,{get:()=>o[a],enumerable:!(n=wn(o,a))||n.enumerable});return p},Dn=p=>Tn(Cn(St(p!=null?_n(Sn(p)):{},"default",p&&p.__esModule&&"default"in p?{get:()=>p.default,enumerable:!0}:{value:p,enumerable:!0})),p);var R=(p,o,n)=>(En(p,typeof o!="symbol"?o+"":o,n),n);var nn=Mn((Ot,Lt)=>{(function(p,o){typeof define=="function"&&define.amd?define([],o):typeof Lt=="object"&&typeof Ot!="undefined"?Lt.exports=o():p.Papa=o()})(Ot,function p(){"use strict";var o=typeof self!="undefined"?self:typeof window!="undefined"?window:o!==void 0?o:{},n=!o.document&&!!o.postMessage,a=n&&/blob:/i.test((o.location||{}).protocol),e={},t=0,l={parse:function(m,s){var y=(s=s||{}).dynamicTyping||!1;if(v(y)&&(s.dynamicTypingFunction=y,y={}),s.dynamicTyping=y,s.transform=!!v(s.transform)&&s.transform,s.worker&&l.WORKERS_SUPPORTED){var C=function(){if(!l.WORKERS_SUPPORTED)return!1;var G=(E=o.URL||o.webkitURL||null,x=p.toString(),l.BLOB_URL||(l.BLOB_URL=E.createObjectURL(new Blob(["(",x,")();"],{type:"text/javascript"})))),$=new o.Worker(G),E,x;return $.onmessage=g,$.id=t++,e[$.id]=$}();return C.userStep=s.step,C.userChunk=s.chunk,C.userComplete=s.complete,C.userError=s.error,s.step=v(s.step),s.chunk=v(s.chunk),s.complete=v(s.complete),s.error=v(s.error),delete s.worker,void C.postMessage({input:m,config:s,workerId:C.id})}var j=null;return l.NODE_STREAM_INPUT,typeof m=="string"?j=s.download?new u(s):new i(s):m.readable===!0&&v(m.read)&&v(m.on)?j=new w(s):(o.File&&m instanceof File||m instanceof Object)&&(j=new h(s)),j.stream(m)},unparse:function(m,s){var y=!1,C=!0,j=",",G=`\r
`,$='"',E=$+$,x=!1,Y=null,I=!1;(function(){if(typeof s=="object"){if(typeof s.delimiter!="string"||l.BAD_DELIMITERS.filter(function(P){return s.delimiter.indexOf(P)!==-1}).length||(j=s.delimiter),(typeof s.quotes=="boolean"||typeof s.quotes=="function"||Array.isArray(s.quotes))&&(y=s.quotes),typeof s.skipEmptyLines!="boolean"&&typeof s.skipEmptyLines!="string"||(x=s.skipEmptyLines),typeof s.newline=="string"&&(G=s.newline),typeof s.quoteChar=="string"&&($=s.quoteChar),typeof s.header=="boolean"&&(C=s.header),Array.isArray(s.columns)){if(s.columns.length===0)throw new Error("Option columns is empty");Y=s.columns}s.escapeChar!==void 0&&(E=s.escapeChar+$),typeof s.escapeFormulae=="boolean"&&(I=s.escapeFormulae)}})();var U=new RegExp(f($),"g");if(typeof m=="string"&&(m=JSON.parse(m)),Array.isArray(m)){if(!m.length||Array.isArray(m[0]))return O(null,m,x);if(typeof m[0]=="object")return O(Y||L(m[0]),m,x)}else if(typeof m=="object")return typeof m.data=="string"&&(m.data=JSON.parse(m.data)),Array.isArray(m.data)&&(m.fields||(m.fields=m.meta&&m.meta.fields),m.fields||(m.fields=Array.isArray(m.data[0])?m.fields:L(m.data[0])),Array.isArray(m.data[0])||typeof m.data[0]=="object"||(m.data=[m.data])),O(m.fields||[],m.data||[],x);throw new Error("Unable to serialize unrecognized input");function L(P){if(typeof P!="object")return[];var ie=[];for(var he in P)ie.push(he);return ie}function O(P,ie,he){var ce="";typeof P=="string"&&(P=JSON.parse(P)),typeof ie=="string"&&(ie=JSON.parse(ie));var fe=Array.isArray(P)&&0<P.length,ge=!Array.isArray(ie[0]);if(fe&&C){for(var te=0;te<P.length;te++)0<te&&(ce+=j),ce+=B(P[te],te);0<ie.length&&(ce+=G)}for(var ne=0;ne<ie.length;ne++){var pe=fe?P.length:ie[ne].length,se=!1,oe=fe?Object.keys(ie[ne]).length===0:ie[ne].length===0;if(he&&!fe&&(se=he==="greedy"?ie[ne].join("").trim()==="":ie[ne].length===1&&ie[ne][0].length===0),he==="greedy"&&fe){for(var re=[],ee=0;ee<pe;ee++){var q=ge?P[ee]:ee;re.push(ie[ne][q])}se=re.join("").trim()===""}if(!se){for(var le=0;le<pe;le++){0<le&&!oe&&(ce+=j);var _e=fe&&ge?P[le]:le;ce+=B(ie[ne][_e],le)}ne<ie.length-1&&(!he||0<pe&&!oe)&&(ce+=G)}}return ce}function B(P,ie){if(P==null)return"";if(P.constructor===Date)return JSON.stringify(P).slice(1,25);I===!0&&typeof P=="string"&&P.match(/^[=+\-@].*$/)!==null&&(P="'"+P);var he=P.toString().replace(U,E),ce=typeof y=="boolean"&&y||typeof y=="function"&&y(P,ie)||Array.isArray(y)&&y[ie]||function(fe,ge){for(var te=0;te<ge.length;te++)if(-1<fe.indexOf(ge[te]))return!0;return!1}(he,l.BAD_DELIMITERS)||-1<he.indexOf(j)||he.charAt(0)===" "||he.charAt(he.length-1)===" ";return ce?$+he+$:he}}};if(l.RECORD_SEP=String.fromCharCode(30),l.UNIT_SEP=String.fromCharCode(31),l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!n&&!!o.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=b,l.ParserHandle=T,l.NetworkStreamer=u,l.FileStreamer=h,l.StringStreamer=i,l.ReadableStreamStreamer=w,o.jQuery){var d=o.jQuery;d.fn.parse=function(m){var s=m.config||{},y=[];return this.each(function(G){if(!(d(this).prop("tagName").toUpperCase()==="INPUT"&&d(this).attr("type").toLowerCase()==="file"&&o.FileReader)||!this.files||this.files.length===0)return!0;for(var $=0;$<this.files.length;$++)y.push({file:this.files[$],inputElem:this,instanceConfig:d.extend({},s)})}),C(),this;function C(){if(y.length!==0){var G,$,E,x,Y=y[0];if(v(m.before)){var I=m.before(Y.file,Y.inputElem);if(typeof I=="object"){if(I.action==="abort")return G="AbortError",$=Y.file,E=Y.inputElem,x=I.reason,void(v(m.error)&&m.error({name:G},$,E,x));if(I.action==="skip")return void j();typeof I.config=="object"&&(Y.instanceConfig=d.extend(Y.instanceConfig,I.config))}else if(I==="skip")return void j()}var U=Y.instanceConfig.complete;Y.instanceConfig.complete=function(L){v(U)&&U(L,Y.file,Y.inputElem),j()},l.parse(Y.file,Y.instanceConfig)}else v(m.complete)&&m.complete()}function j(){y.splice(0,1),C()}}}function c(m){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(s){var y=D(s);y.chunkSize=parseInt(y.chunkSize),s.step||s.chunk||(y.chunkSize=null),this._handle=new T(y),(this._handle.streamer=this)._config=y}.call(this,m),this.parseChunk=function(s,y){if(this.isFirstChunk&&v(this._config.beforeFirstChunk)){var C=this._config.beforeFirstChunk(s);C!==void 0&&(s=C)}this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+s;this._partialLine="";var G=this._handle.parse(j,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var $=G.meta.cursor;this._finished||(this._partialLine=j.substring($-this._baseIndex),this._baseIndex=$),G&&G.data&&(this._rowCount+=G.data.length);var E=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(a)o.postMessage({results:G,workerId:l.WORKER_ID,finished:E});else if(v(this._config.chunk)&&!y){if(this._config.chunk(G,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);G=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(G.data),this._completeResults.errors=this._completeResults.errors.concat(G.errors),this._completeResults.meta=G.meta),this._completed||!E||!v(this._config.complete)||G&&G.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),E||G&&G.meta.paused||this._nextChunk(),G}this._halted=!0},this._sendError=function(s){v(this._config.error)?this._config.error(s):a&&this._config.error&&o.postMessage({workerId:l.WORKER_ID,error:s,finished:!1})}}function u(m){var s;(m=m||{}).chunkSize||(m.chunkSize=l.RemoteChunkSize),c.call(this,m),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(y){this._input=y,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(s=new XMLHttpRequest,this._config.withCredentials&&(s.withCredentials=this._config.withCredentials),n||(s.onload=S(this._chunkLoaded,this),s.onerror=S(this._chunkError,this)),s.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var y=this._config.downloadRequestHeaders;for(var C in y)s.setRequestHeader(C,y[C])}if(this._config.chunkSize){var j=this._start+this._config.chunkSize-1;s.setRequestHeader("Range","bytes="+this._start+"-"+j)}try{s.send(this._config.downloadRequestBody)}catch(G){this._chunkError(G.message)}n&&s.status===0&&this._chunkError()}},this._chunkLoaded=function(){s.readyState===4&&(s.status<200||400<=s.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:s.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(y){var C=y.getResponseHeader("Content-Range");return C===null?-1:parseInt(C.substring(C.lastIndexOf("/")+1))}(s),this.parseChunk(s.responseText)))},this._chunkError=function(y){var C=s.statusText||y;this._sendError(new Error(C))}}function h(m){var s,y;(m=m||{}).chunkSize||(m.chunkSize=l.LocalChunkSize),c.call(this,m);var C=typeof FileReader!="undefined";this.stream=function(j){this._input=j,y=j.slice||j.webkitSlice||j.mozSlice,C?((s=new FileReader).onload=S(this._chunkLoaded,this),s.onerror=S(this._chunkError,this)):s=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input;if(this._config.chunkSize){var G=Math.min(this._start+this._config.chunkSize,this._input.size);j=y.call(j,this._start,G)}var $=s.readAsText(j,this._config.encoding);C||this._chunkLoaded({target:{result:$}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(s.error)}}function i(m){var s;c.call(this,m=m||{}),this.stream=function(y){return s=y,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var y,C=this._config.chunkSize;return C?(y=s.substring(0,C),s=s.substring(C)):(y=s,s=""),this._finished=!s,this.parseChunk(y)}}}function w(m){c.call(this,m=m||{});var s=[],y=!0,C=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){C&&s.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),s.length?this.parseChunk(s.shift()):y=!0},this._streamData=S(function(j){try{s.push(typeof j=="string"?j:j.toString(this._config.encoding)),y&&(y=!1,this._checkIsFinished(),this.parseChunk(s.shift()))}catch(G){this._streamError(G)}},this),this._streamError=S(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=S(function(){this._streamCleanUp(),C=!0,this._streamData("")},this),this._streamCleanUp=S(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function T(m){var s,y,C,j=Math.pow(2,53),G=-j,$=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,E=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,x=this,Y=0,I=0,U=!1,L=!1,O=[],B={data:[],errors:[],meta:{}};if(v(m.step)){var P=m.step;m.step=function(te){if(B=te,ce())he();else{if(he(),B.data.length===0)return;Y+=te.data.length,m.preview&&Y>m.preview?y.abort():(B.data=B.data[0],P(B,x))}}}function ie(te){return m.skipEmptyLines==="greedy"?te.join("").trim()==="":te.length===1&&te[0].length===0}function he(){if(B&&C&&(ge("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),C=!1),m.skipEmptyLines)for(var te=0;te<B.data.length;te++)ie(B.data[te])&&B.data.splice(te--,1);return ce()&&function(){if(!B)return;function ne(se,oe){v(m.transformHeader)&&(se=m.transformHeader(se,oe)),O.push(se)}if(Array.isArray(B.data[0])){for(var pe=0;ce()&&pe<B.data.length;pe++)B.data[pe].forEach(ne);B.data.splice(0,1)}else B.data.forEach(ne)}(),function(){if(!B||!m.header&&!m.dynamicTyping&&!m.transform)return B;function ne(se,oe){var re,ee=m.header?{}:[];for(re=0;re<se.length;re++){var q=re,le=se[re];m.header&&(q=re>=O.length?"__parsed_extra":O[re]),m.transform&&(le=m.transform(le,q)),le=fe(q,le),q==="__parsed_extra"?(ee[q]=ee[q]||[],ee[q].push(le)):ee[q]=le}return m.header&&(re>O.length?ge("FieldMismatch","TooManyFields","Too many fields: expected "+O.length+" fields but parsed "+re,I+oe):re<O.length&&ge("FieldMismatch","TooFewFields","Too few fields: expected "+O.length+" fields but parsed "+re,I+oe)),ee}var pe=1;return!B.data.length||Array.isArray(B.data[0])?(B.data=B.data.map(ne),pe=B.data.length):B.data=ne(B.data,0),m.header&&B.meta&&(B.meta.fields=O),I+=pe,B}()}function ce(){return m.header&&O.length===0}function fe(te,ne){return pe=te,m.dynamicTypingFunction&&m.dynamicTyping[pe]===void 0&&(m.dynamicTyping[pe]=m.dynamicTypingFunction(pe)),(m.dynamicTyping[pe]||m.dynamicTyping)===!0?ne==="true"||ne==="TRUE"||ne!=="false"&&ne!=="FALSE"&&(function(se){if($.test(se)){var oe=parseFloat(se);if(G<oe&&oe<j)return!0}return!1}(ne)?parseFloat(ne):E.test(ne)?new Date(ne):ne===""?null:ne):ne;var pe}function ge(te,ne,pe,se){var oe={type:te,code:ne,message:pe};se!==void 0&&(oe.row=se),B.errors.push(oe)}this.parse=function(te,ne,pe){var se=m.quoteChar||'"';if(m.newline||(m.newline=function(ee,q){ee=ee.substring(0,1048576);var le=new RegExp(f(q)+"([^]*?)"+f(q),"gm"),_e=(ee=ee.replace(le,"")).split("\r"),$e=ee.split(`
`),Te=1<$e.length&&$e[0].length<_e[0].length;if(_e.length===1||Te)return`
`;for(var je=0,Se=0;Se<_e.length;Se++)_e[Se][0]===`
`&&je++;return je>=_e.length/2?`\r
`:"\r"}(te,se)),C=!1,m.delimiter)v(m.delimiter)&&(m.delimiter=m.delimiter(te),B.meta.delimiter=m.delimiter);else{var oe=function(ee,q,le,_e,$e){var Te,je,Se,Pe;$e=$e||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var Ee=0;Ee<$e.length;Ee++){var Ve=$e[Ee],rt=0,be=0,qe=0;Se=void 0;for(var ke=new b({comments:_e,delimiter:Ve,newline:q,preview:10}).parse(ee),Ge=0;Ge<ke.data.length;Ge++)if(le&&ie(ke.data[Ge]))qe++;else{var Be=ke.data[Ge].length;be+=Be,Se!==void 0?0<Be&&(rt+=Math.abs(Be-Se),Se=Be):Se=Be}0<ke.data.length&&(be/=ke.data.length-qe),(je===void 0||rt<=je)&&(Pe===void 0||Pe<be)&&1.99<be&&(je=rt,Te=Ve,Pe=be)}return{successful:!!(m.delimiter=Te),bestDelimiter:Te}}(te,m.newline,m.skipEmptyLines,m.comments,m.delimitersToGuess);oe.successful?m.delimiter=oe.bestDelimiter:(C=!0,m.delimiter=l.DefaultDelimiter),B.meta.delimiter=m.delimiter}var re=D(m);return m.preview&&m.header&&re.preview++,s=te,y=new b(re),B=y.parse(s,ne,pe),he(),U?{meta:{paused:!0}}:B||{meta:{paused:!1}}},this.paused=function(){return U},this.pause=function(){U=!0,y.abort(),s=v(m.chunk)?"":s.substring(y.getCharIndex())},this.resume=function(){x.streamer._halted?(U=!1,x.streamer.parseChunk(s,!0)):setTimeout(x.resume,3)},this.aborted=function(){return L},this.abort=function(){L=!0,y.abort(),B.meta.aborted=!0,v(m.complete)&&m.complete(B),s=""}}function f(m){return m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(m){var s,y=(m=m||{}).delimiter,C=m.newline,j=m.comments,G=m.step,$=m.preview,E=m.fastMode,x=s=m.quoteChar===void 0?'"':m.quoteChar;if(m.escapeChar!==void 0&&(x=m.escapeChar),(typeof y!="string"||-1<l.BAD_DELIMITERS.indexOf(y))&&(y=","),j===y)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<l.BAD_DELIMITERS.indexOf(j))&&(j=!1),C!==`
`&&C!=="\r"&&C!==`\r
`&&(C=`
`);var Y=0,I=!1;this.parse=function(U,L,O){if(typeof U!="string")throw new Error("Input must be a string");var B=U.length,P=y.length,ie=C.length,he=j.length,ce=v(G),fe=[],ge=[],te=[],ne=Y=0;if(!U)return Ee();if(E||E!==!1&&U.indexOf(s)===-1){for(var pe=U.split(C),se=0;se<pe.length;se++){if(te=pe[se],Y+=te.length,se!==pe.length-1)Y+=C.length;else if(O)return Ee();if(!j||te.substring(0,he)!==j){if(ce){if(fe=[],Te(te.split(y)),Ve(),I)return Ee()}else Te(te.split(y));if($&&$<=se)return fe=fe.slice(0,$),Ee(!0)}}return Ee()}for(var oe=U.indexOf(y,Y),re=U.indexOf(C,Y),ee=new RegExp(f(x)+f(s),"g"),q=U.indexOf(s,Y);;)if(U[Y]!==s)if(j&&te.length===0&&U.substring(Y,Y+he)===j){if(re===-1)return Ee();Y=re+ie,re=U.indexOf(C,Y),oe=U.indexOf(y,Y)}else{if(oe!==-1&&(oe<re||re===-1)){if(!(oe<q)){te.push(U.substring(Y,oe)),Y=oe+P,oe=U.indexOf(y,Y);continue}var le=rt(oe,q,re);if(le&&le.nextDelim!==void 0){oe=le.nextDelim,q=le.quoteSearch,te.push(U.substring(Y,oe)),Y=oe+P,oe=U.indexOf(y,Y);continue}}if(re===-1)break;if(te.push(U.substring(Y,re)),Pe(re+ie),ce&&(Ve(),I))return Ee();if($&&fe.length>=$)return Ee(!0)}else for(q=Y,Y++;;){if((q=U.indexOf(s,q+1))===-1)return O||ge.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:fe.length,index:Y}),Se();if(q===B-1)return Se(U.substring(Y,q).replace(ee,s));if(s!==x||U[q+1]!==x){if(s===x||q===0||U[q-1]!==x){oe!==-1&&oe<q+1&&(oe=U.indexOf(y,q+1)),re!==-1&&re<q+1&&(re=U.indexOf(C,q+1));var _e=je(re===-1?oe:Math.min(oe,re));if(U[q+1+_e]===y){te.push(U.substring(Y,q).replace(ee,s)),U[Y=q+1+_e+P]!==s&&(q=U.indexOf(s,Y)),oe=U.indexOf(y,Y),re=U.indexOf(C,Y);break}var $e=je(re);if(U.substring(q+1+$e,q+1+$e+ie)===C){if(te.push(U.substring(Y,q).replace(ee,s)),Pe(q+1+$e+ie),oe=U.indexOf(y,Y),q=U.indexOf(s,Y),ce&&(Ve(),I))return Ee();if($&&fe.length>=$)return Ee(!0);break}ge.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:fe.length,index:Y}),q++}}else q++}return Se();function Te(be){fe.push(be),ne=Y}function je(be){var qe=0;if(be!==-1){var ke=U.substring(q+1,be);ke&&ke.trim()===""&&(qe=ke.length)}return qe}function Se(be){return O||(be===void 0&&(be=U.substring(Y)),te.push(be),Y=B,Te(te),ce&&Ve()),Ee()}function Pe(be){Y=be,Te(te),te=[],re=U.indexOf(C,Y)}function Ee(be){return{data:fe,errors:ge,meta:{delimiter:y,linebreak:C,aborted:I,truncated:!!be,cursor:ne+(L||0)}}}function Ve(){G(Ee()),fe=[],ge=[]}function rt(be,qe,ke){var Ge={nextDelim:void 0,quoteSearch:void 0},Be=U.indexOf(s,qe+1);if(qe<be&&be<Be&&(Be<ke||ke===-1)){var Dt=U.indexOf(y,Be);if(Dt===-1)return Ge;Be<Dt&&(Be=U.indexOf(s,Be+1)),Ge=rt(Dt,Be,ke)}else Ge={nextDelim:be,quoteSearch:qe};return Ge}},this.abort=function(){I=!0},this.getCharIndex=function(){return Y}}function g(m){var s=m.data,y=e[s.workerId],C=!1;if(s.error)y.userError(s.error,s.file);else if(s.results&&s.results.data){var j={abort:function(){C=!0,A(s.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:M,resume:M};if(v(y.userStep)){for(var G=0;G<s.results.data.length&&(y.userStep({data:s.results.data[G],errors:s.results.errors,meta:s.results.meta},j),!C);G++);delete s.results}else v(y.userChunk)&&(y.userChunk(s.results,j,s.file),delete s.results)}s.finished&&!C&&A(s.workerId,s.results)}function A(m,s){var y=e[m];v(y.userComplete)&&y.userComplete(s),y.terminate(),delete e[m]}function M(){throw new Error("Not implemented.")}function D(m){if(typeof m!="object"||m===null)return m;var s=Array.isArray(m)?[]:{};for(var y in m)s[y]=D(m[y]);return s}function S(m,s){return function(){m.apply(s,arguments)}}function v(m){return typeof m=="function"}return a&&(o.onmessage=function(m){var s=m.data;if(l.WORKER_ID===void 0&&s&&(l.WORKER_ID=s.workerId),typeof s.input=="string")o.postMessage({workerId:l.WORKER_ID,results:l.parse(s.input,s.config),finished:!0});else if(o.File&&s.input instanceof File||s.input instanceof Object){var y=l.parse(s.input,s.config);y&&o.postMessage({workerId:l.WORKER_ID,results:y,finished:!0})}}),(u.prototype=Object.create(c.prototype)).constructor=u,(h.prototype=Object.create(c.prototype)).constructor=h,(i.prototype=Object.create(i.prototype)).constructor=i,(w.prototype=Object.create(c.prototype)).constructor=w,l})});var it={async XHR(p){let o=window.GM_xmlhttpRequest||(GM?GM.xmlHttpRequest:null);return o?new Promise((n,a)=>{Object.assign(p,{onabort:a,onerror:a,onload:n,ontimeout:a}),o(p)}):Promise.reject()},async getValue(p,o=null){return window.GM_getValue?Promise.resolve(GM_getValue(p)||o):await GM.getValue(p)||o},async setValue(p,o){window.GM_setValue?GM_setValue(p,o):GM.setValue(p,o)}};var Ht="OC-Addons",Kn="St\xE9phane TORCHY",k="background-color:green;color:white",Vn="background-color:black;color:white",st="background-color:coral;color:white",Jn="background-color:cyan;color:white",ue="background-color:red;color:white",Re="background-color:blue;color:white",Qe="auto-financ\xE9",De="financ\xE9 par un tiers",Je="autre",ft="r\xE9alis\xE9e",pt="annul\xE9e",ht="annul\xE9e tardivement",mt="\xE9tudiant absent",gt="\xE9tudiante absente",Ze=6,Nt=30,Ut=35,qt=40,Gt=45,Qt=50,zt=55,Q=0,W=1,K=2,Zn=[{pathId:158,path:"158-trouvez-lemploi-qui-vous-correspond",value:2}],J=0,Z=1,V=2,X=3,F=0,H=1,N=2,Wt=0;var Kt=function(){return new Promise(p=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",p):p()})},at=async function(p="",o="",n=!1){console.info(`%cfetch() waiting return from : ${p}`,k);let a=await it.XHR({method:"GET",url:p,responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"},onprogress:function(c){}}).catch(c=>{console.error(`%cError ${c}`,ue)}),t=new DOMParser().parseFromString(a.responseText.replace(/\n/mg,""),"text/html");if(t.querySelector("meta[id=captcha-bypass]")!==null)throw console.error(`%cError CloudFlare CAPTCHA : ${t.querySelector("title").innerText}`,k),new Error("Must Respond to Cloudflare Captcha or waiting....");var d={};return n===!0?d=t.querySelectorAll(o):d=t.querySelector(o),d};var Ke=function(p,o=-1){try{var n=(p.querySelector("a").href||"/").split("/");return n[n.length+o]}catch(a){console.error(`%cError in getkey${a.stack||a}`,ue)}},Yt=function(p){var o=p.trim().split(" ");try{var n=dayjs_locale_fr.months.findIndex(a=>a===o[1])+1}catch(a){console.error(`%cError in extractDate${a.stack||a}`,ue)}return`${o[2]}-${n}-${o[0]}T${o[4]}`},$t=function(p,o=0){o===-1&&(o=p.children.length-1);var n=p.children[o].children[0].innerText;let a=Yt(n);var e=dayjs(a);return e},Fe=function(p){return new Promise(o=>setTimeout(o,p))},Vt=function(p){return p.substring(p.lastIndexOf(".")+1,p.length)||p},bt=function(p,o){for(var n=p.split("."),a=o.split("."),e=0;e<3;e++){var t=Number(n[e]),l=Number(a[e]);if(t>l)return 1;if(l>t)return-1;if(!isNaN(t)&&isNaN(l))return 1;if(isNaN(t)&&!isNaN(l))return-1}return 0},Jt=function(o,n){return console.info("Reading:",o),fetch(o,{mode:"same-origin"}).then(function(a){return a.blob()}).then(function(a){var e=new FileReader;e.addEventListener("loadend",function(){n(this.result)}),e.readAsText(a)})},Zt=function(p){let o=p,n=p.reduce(function(h,i){return h*i});var a=new Array(n);let e=function(...h){let i=h.pop();if(h.length!==p.length)throw"Wrong matrix dimensions, need "+p.length+", you provide "+i.length+"!";if(u(h)===0)throw"Wrong type for set need one or more int has dimension, check type of!";let w=c(h);return a[w]=i,i},t=function(...h){if(h.length!==p.length)throw"Wrong matrix dimensions, need "+p.length+", you provide "+h.length+"!";if(u(h)===0)throw"Wrong type for set need one or more int has dimension, check type of!";let i=c(h);return a[i]},l=function(...h){let i=c(h);return a[i]=void 0,a[i]===void 0},d=function(){console.group("dump table"),console.table(a),console.groupEnd("dump table")},c=function(h){return h.reduce(function(i,w,T,f){let b=o.slice(T+1),g=b.length>0?b.reduce(function(A,M){return A*M}):1;return i+w*g},0)},u=function(h){return h.reduce((i,w)=>i&typeof w=="number",1)};return Object.freeze({set:e,get:t,del:l,toConsole:d})},Xt=function(p,o=0){let n=3735928559^o,a=1103547991^o;for(let e=0,t;e<p.length;e++)t=p.charCodeAt(e),n=Math.imul(n^t,2654435761),a=Math.imul(a^t,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(a^a>>>13,3266489909),a=Math.imul(a^a>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),4294967296*(2097151&a)+(n>>>0)},ae=function(p,o,n=Error){if(!p)throw new n(o)};var kt=function(p){var o;return function(){var n=this,a=arguments;o&&window.cancelAnimationFrame(o),o=window.requestAnimationFrame(function(){p.apply(n,a)})}};var en=function(p){let o=Date.now(),n=null;do n=Date.now();while(n-o<p)};HTMLElement.prototype.appendFirst=function(p){this.firstChild?this.insertBefore(p,this.firstChild):this.appendChild(p)};var dt=async function(p=null,o=null,n=!0){var a="";a+="<style>",a+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",a+="form input {background: #fff;border: 1px solid #9c9c9c;}",a+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",a+="form button:hover {background: gold;}",a+="form label {padding: 0.5em 0.5em 0.5em 0;}",a+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",a+="form input:focus {outline: 3px solid gold;}",a+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",a+="</style>",a+='<form class="form1" action="">',a+='<label for="dtFrom" class="date">Date de d\xE9but</label>',p?a+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(p).format("YYYY-MM-DD")+'">':a+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',a+='<label for="dtTo" class="date">Date de fin</label>',p?a+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(o).format("YYYY-MM-DD")+'">':a+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',a+="</form>";let{value:e}=await Swal.fire({title:"<strong>Choix de la p\xE9riode</strong>",icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez la p\xE9riode pour la s\xE9lection des temps factur\xE9s",showLoaderOnConfirm:!0,preConfirm:()=>[document.getElementById("dtFrom").value,document.getElementById("dtTo").value],onRender:t=>{},onOpen:t=>{n===!0&&t.querySelector("#dtFrom").addEventListener("change",_handler=function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:t=>{n===!0&&t.querySelector("#dtFrom").removeEventListener("change",_handler)},onAfterClose:t=>{},onDestroy:t=>{}});return p=dayjs(e[0]),o=dayjs(e[1]),await Fe(250),[p,o]},xt=async function(p){await Swal.fire({position:"top-end",icon:"success",title:p,showConfirmButton:!1,timer:1500})};var ze=class{},Xe=ze;R(Xe,"tbl_name","f_archives"),R(Xe,"add",async function(o){let n=z.Cfg.dbase,a=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]"),e={id:o[0].to.format("YYYYMM"),data:o,created_at:o[0].now};console.log(`%cWill create archive for id ${o[0].to.format("YYYYMM")} (YYYYMM)`,k),n.get(ze.tbl_name).push(JSON.parse(JSON.stringify(e))).write()}),R(Xe,"exists",function(o){return z.Cfg.dbase.get(ze.tbl_name).find({id:o}).value()!==void 0}),R(Xe,"get",function(o){var a=z.Cfg.dbase.get(ze.tbl_name).find({id:o}).value();if(a===void 0)throw Error("Erreur qui ne devrait jamais arriver en Archive.get");return console.log(`%cWill use archive for id ${o} (YYYYMM)`,k),a}),R(Xe,"delete",function(o=null,n=null){let a=z.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof n=="string"&&(n=n.format("YYYY-MM-DD")),o===null&&n==null){console.log("%cWanna suppress ALL Archives from DB ",k),a.get(ze.tbl_name).remove().write();return}if(n==null){a.get(ze.tbl_name).remove(function(e){return dayjs(e.id,"YYYYMM").isBefore(n),"month"}).write();return}if(o==null){a.get(ze.tbl_name).remove(function(e){return dayjs(e.id,"YYYYMM").isAfter(o,"month")}).write();return}a.get(ze.tbl_name).remove(function(e){return dayjs(e.id,"YYYYMM").isBetween(o,n,"month","[]")}).write()});var et=Xe;var Bt=class{},yt=Bt;R(yt,"isInOldMode",function(o){var n=null;typeof o=="string"?n=dayjs(o):n=o;try{return n.isBefore(Bt.getOldModeDate())}catch(a){throw Error("Erreur qui ne devrait jamais arriver en IsInOldMode (probablement un probleme sur la conversion de la date en objet dayjs:"+a.stack||a)}}),R(yt,"getOldModeDate",function(){return dayjs("2020-06-01")}),R(yt,"getAppVersion",function(){return GM.info.script.version});var we=yt;var Yn=function(){let p="students_history",o=1,n=2,a=function(w){if(w.toUpperCase()==="FUNDING")return o;if(w.toUpperCase()==="PATH")return n;throw Error("Erreur qui ne devrait jamais arriver en getype")},e=function(w,T,f=null){return l(w,o,T,f)},t=function(w,T,f=null){return l(w,n,T,f)},l=function(w,T,f,b=null){typeof w=="number"&&(w=w.toString(10)),ae(typeof w=="string","You must provide a string.",TypeError);let g=z.Cfg.dbase;typeof b=="string"&&(b=dayjs(b)),b===null&&(b=dayjs()),ae(b instanceof dayjs,"created date must be a string, a dayjs instance or null.",TypeError);let A={id:w,type:0|T,value:f,date:b.valueOf(),humanDate:b.format("YYYY-MM-DDTHH:mm:ssZZ")};return console.log(`%cAdd in student history at date ${dayjs(A.date).format("YYYY-MM-DDTHH:mm:ssZZ")} data ${f} with type:${T} cf const of object`,k),g.get(p).push(JSON.parse(JSON.stringify(A))).write()},d=function(w,T=null,f=null){let b=z.Cfg.dbase;return w==null&&T==null&&f==null?(console.log("%cRemove all in student history",k),b.get(p).remove().write()):(typeof f=="string"&&(f=dayjs(f)),f==null?T==null?(console.log(`%cRemove for student id:${w} history for all type of event`,k),b.get(p).remove({id:w}).write()):(console.log(`%cRemove for student id:${w} history with event type:${T} cf const of object`,k),b.get(p).remove({id:w,type:T}).write()):(console.log(`%cRemove for student id:${w} history at date ${f.format("DD/MM/YYYY")} with event type:${T} cf const of object`,k),b.get(p).remove({id:w,type:T,date:f.valueOf()}).write()))},c=function(w,T,f=null){let b=z.Cfg.dbase;typeof f=="string"&&(f=dayjs(f)),f===null&&(f=dayjs()),console.log(`%cSearching in student history at date ${f.format("DD/MM/YYYY")} any data with type:${T} cf const of object`,k);var g=+f.valueOf(),A=b.get(p).filter(S=>S.id===w&&S.type&T).map(S=>S.date-g).filter(S=>S>=0).value();if(A.length==0){console.log(`%cThere is no data in student history at date ${f.format("DD/MM/YYYY")} with type:${T} cf const of object`,k);return}let D=g+(S=>Math.min(...S))(A);return b.get(p).filter(S=>S.id===w&&S.type&T&&S.date==D).value()[0]},u=function(w){return i(w,o)},h=function(w){return i(w,n)},i=function(w,T){return w.type&T};return Object.freeze({addFunding:e,addPath:t,getType:a,remove:d,find:c,isFunding:u,isPath:h,tbl_name:p})},$n=Yn(),Ye=$n;var de=class{static modifyFunding(o,n,a){typeof n=="string"&&(n=dayjs(n)),ae(created instanceof dayjs,"modifyFunding date must be a string, a dayjs instance or null.",TypeError);let e=de.getFunding(o,n);if(a.toLower()===e.toLower()){console.log(`%cFundingMode ${a} is identical as current: ${sCurrent}, nothing to do`,k);return}(a!==Qe||a!=De||a!==Je)&&console.log(`%cWarning this state is unknown ${a}`,st);let t=z.Cfg.dbase,l=dayjs().format("YYYY-MM-DDTHH:mm:ssZZ");if(n===null&&(n=l),oLastHistory=Ye.find(o,Ye.getType("FUNDING"),n),t.get(de.tbl_name).find({id:o}).assign({funding:a}).write(),Ye.addFunding(o,e,l),n.isSameOrAfter(we.getOldModeDate()))var d=t.get("sessions").filter(function(u){return u.who_id===o&&dayjs(u.when).isSameOrAfter(n,"day")});else var d=t.get("sessions").filter(function(h){h.who_id===o&&dayjs(h.when).isSameOrAfter(we.getOldModeDate(),"day")});for(var c=d.value().length;c-=1;)console.log(`There is ${c} elements left to update`,k),d.get(c).assign({funding:a}).write()}},ye=de;R(ye,"tbl_name","students"),R(ye,"add",function(o,n="noname",a="nopath",e="unknown",t){let l=z.Cfg.dbase;var d=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let c={id:o,fullname:n,path:a,funding:e,created:d};de._save(c)}),R(ye,"_checkObject",function(o){console.log("%cChecking object student:%o ",k,o),ae(typeof o.id=="string","Student object id need to be a string.",TypeError),ae(typeof o.fullname=="string","Student object fullname need to be a number.",TypeError),ae(typeof o.path=="string","Student object path need to be a string.",TypeError),ae(typeof o.funding=="string","Student object funding need to be a string.",TypeError),ae(typeof o.created=="string","Student object created need to be a string.",TypeError)}),R(ye,"_save",function(o){de._checkObject(o),console.log("%cSaving student %o to DB",k,o),z.Cfg.dbase.get(de.tbl_name).push(JSON.parse(JSON.stringify(o))).write()}),R(ye,"exists",function(o,n=null){let a=de.findById(o,n);return console.log(`%cStudent ${o} exists in db ? ${a!==void 0}`,k),a!==void 0}),R(ye,"findById",function(o,n=null){let a=!0;return typeof o=="number"&&(o=o.toString(10)),ae(typeof o=="string","You must provide a string.",TypeError),typeof n=="string"&&(n=dayjs(n)),n==null?a===!1?de._findById(o,n):de.m_findById(o,"null"):a===!1?de._findById(o,n.toISOString()):de.m_findById(o,n.toISOString())}),R(ye,"_findById",function(o,n=null){let a=z.Cfg.dbase;typeof n=="string"&&(n=dayjs(n)),console.log(`%cSearching student with id:(${typeof o})${o} in db`,k);var e=a.get(de.tbl_name).find({id:o}).value();if(console.log("student %o is found",e),e!==void 0){if(n!==null){var t={...e},l=Ye.find(o,Ye.getType("FUNDING"),n);l!==void 0&&(t.funding=l.value);var d=Ye.find(o,Ye.getType("PATH"),n);return d!==void 0&&(t.path=d.value),t}return console.log("student final %o is found",e),e}}),R(ye,"m_findById",moize.default(de._findById,{maxAge:6e5,isSerialized:!0,onCacheAdd:function(o,n,a){console.log("%cAdd data to cache c.keys: %o, o:%o, m:%o",k,o.keys,n,a)},onCacheHit:function(){console.log("%cGet Student data from cache",k)}})),R(ye,"getFunding",function(o,n=null){return typeof n=="string"&&(n=dayjs(n)),de.m_getFunding(o,n)}),R(ye,"_getFunding",function(o,n=null){let a=de.findById(o,n);return a===void 0?(console.log(`%cStudent ${studentId} is not in db, fetching data:'funded mode' from webpage`,k),de.getFundingFomDashboard(studentId).toLowerCase()):a.funding.toLowerCase()}),R(ye,"m_getFunding",moize.default(de._getFunding,{maxAge:6e5,isSerialized:!0})),R(ye,"isAutoFunded",function(o){return console.log("%cFUNCTION DEPRECATED !!!!!!!!!!!!!!!!!!!!!! ",ue),de.getFunded(o).toLowerCase()===Qe}),R(ye,"getFundingFomDashboard",async function(o){return(await at(`https://openclassrooms.com/fr/mentorship/students/${o}/dashboard`,".mentorshipStudent__details > p")).innerText.trim()}),R(ye,"getPath",async function(o,n=null){let a=de.findById(o,n);if(a==null){console.log(`%cStudent ${o} is not in db, fetching data: 'path' from webpage ....`,k);let e=await at(`https://openclassrooms.com/fr/mentorship/students/${o}/dashboard`,"a[href*='paths/']");return e.innerText.length==0&&console.error(`%cStudent path is not readable from url : https://openclassrooms.com/fr/mentorship/students/${o}/dashboard`,ue),e.innerText.trim()}else return a.path}),R(ye,"delete",function(o=null,n=null){let a=z.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof n=="string"&&(n=n.format("YYYY-MM-DD")),o===null&&n==null){console.log("%cWanna suppress ALL Students from DB",k),a.get(de.tbl_name).remove().write();return}if(n==null){a.get(de.tbl_name).remove(function(e){return dayjs(e.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBefore(n,"day")}).write();return}if(o==null){a.get(de.tbl_name).remove(function(e){return dayjs(e.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isAfter(o,"day")}).write();return}a.get(de.tbl_name).remove(function(e){return dayjs(e.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBetween(o,n,"day","[]")}).write()}),R(ye,"deleteById",function(o,n=null){z.Cfg.dbase.get("students").remove(e=>e.id===o).write(),console.log(`%cAll students with id:${o} are removed from DataBase`,k)}),R(ye,"getAll",async(o,n)=>{var a=!1;let e=z.Cfg.dbase;var t="table.crud-list tbody";let l=await at("https://openclassrooms.com/fr/mentorship/dashboard/students",'script[id="mentorshipDashboardConfiguration"]');var d=JSON.parse(l.innerText.trim()),c=d.mentorStudents;let u=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var h=performance.now();await de.getFundingFomDashboard(c[0].studentId),console.log(`%cEstimated time for updating : ${(performance.now()-h)*c.length} ms`,k),Swal.fire({position:"top-end",icon:"info",toast:!0,title:`mise \xE0 jour de la base de donn\xE9e des \xE9tudiants...
cela peut prendre du temps ~ ${(performance.now()-h)*c.length/1e3} s`,showConfirmButton:!1,timer:1e3}),await Fe(1e3);for(let f of c){var i=f.studentId.toString(10),w=f.studentDisplayableName;xt(`Collecte les donn\xE9es de l'\xE9tudiant : ${w}`);var T=f.followedProjectSlug;T.length==0&&(T="non d\xE9fini");let b=await de.getFundingFomDashboard(i);ae(typeof i=="string","sStudentId need to be a string.",TypeError);var d=de.m_findById(i,null);if(d===void 0){console.log(`%cStudent ${w}(id:${i}) not present in database will create it`,k),de.add(i,w,T,b,u);continue}b.toLowerCase()!==d.funding.toLowerCase()&&(e.get(de.tbl_name).find({id:i}).assign({funding:b.toLowerCase()}).write(),Ye.add(i,Ye.getType("FUNDING"),d.funding.toLowerCase(),dayjs()),console.log(`%cStudent ${w}(id:${i}) was already present in database but change of funding was detected (from ${d.funding.toLowerCase()} to ${b.toLowerCase()})`,k)),T!==d.path&&(e.get(de.tbl_name).find({id:i}).assign({path:T}).write(),Ye.add(i,Ye.getType("PATH"),d.path,dayjs()),console.log(`%cStudent ${w}(id:${i}) was already present in database but change of path was detected (from ${d.path} to ${T})`,k))}}),R(ye,"showList",function(){let n=z.Cfg.dbase.get(de.tbl_name).value();var a="";a+="<table>",a+="<caption>Liste des \xE9tudiant</caption>",a+="<thead>",a+="<tr>",a+="<th>Nom</th><th>Parcours</th><th>Financement</th><th>Date de cr\xE9ation</th><th>Edition</th>",a+="</tr>",a+="</thead>",a+="<tbody>";for(var e in n)a+="<tr>",a+=`<td>${n[e].fullname}</td><td>${n[e].path}</td><td>${n[e].funding}</td>`,a+=`<td>${dayjs(n[e].created,"YYYY-MM-DDTHH:mm:ssZ[Z]").format("DD/MM/YYYY \xE0 HH:mm")}</td>`,a+=`<td><a href="https://openclassrooms.com/fr/mentorship/students/${n[e].id}/dashboard">${n[e].id}</a></td>`,a+="</tr>";a+="</tbody>",a+="</table>",Swal.fire({title:"<strong>Liste des Etudiants</strong>",icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"fullscreen",onOpen:t=>{var l=t.querySelector("table"),d=new simpleDatatables.DataTable(l)}})}),R(ye,"createManually",async function(o,n,a){let e=["non pr\xE9sent dans la liste","Chef de projet digital","Chef de projet SI","D\xE9veloppeur d'application - Frontend","D\xE9veloppeur Web","Expert en strat\xE9gie marketing et communication ","Production de contenu web avec CMS et Content Marketing ","Tech lead"];var t="";t+="<style>",t+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",t+="form input {background: #fff;border: 1px solid #9c9c9c;}",t+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",t+="form button:hover {background: gold;}",t+="form label {padding: 0.5em 0.5em 0.5em 0;}",t+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",t+="form input:focus {outline: 3px solid gold;}",t+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",t+="</style>",t+='<form class="form1" action="">',t+='<label for="student_id" class="name">Reference</label>',t+='<input id="student_id" type="text" value="'+o+'">',t+='<label for="student_name" class="name">Name</label>',t+='<input id="student_name" type="text" value="'+n+'">',t+='<label for="funding">Autofinanc\xE9</label>',t+='<input id="funding" type="checkbox" value="autofunded">',t+='<label for="student_path">Parcours</label>',t+='<input id="student_path" name="student_path" type="text" list="student_path-list">',t+='<datalist id="student_path-list">';for(var l in e)t+=`<option>${e[l]}</option>`;t+="/<datalist>",t+='<label for="session_date">Date</label>',t+='<input id="session_date" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(a).format("YYYY-MM-DD")+'">',t+="</form>";let{value:d}=await Swal.fire({title:"<strong>Ajout d'un \xE9tudiant en mode manuel</strong>",icon:"info",html:t,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:`votre \xE9tudiant(e) ${n} n'a pas \xE9t\xE9 trouv\xE9`,preConfirm:()=>({student_id:document.getElementById("student_id").value,student_name:document.getElementById("student_name").value,student_path:document.getElementById("student_path").value,student_funding:document.getElementById("funding").checked,session_date:document.getElementById("session_date").value})});if(d&&d.hasOwnProperty("student_id")){var c="";d.student_funding===!0?c=Qe:c=De,de.add(d.student_id,d.student_name,d.student_path,c,d.session_date)}});var Ce=ye;var kn=function(){let p="refs",o=0,n=1,a=2,e={DEFAULT:0,SESSIONID_DATEREFID:1},t=function(){z.Cfg.dbase.get("refs").value()===void 0&&(console.log("%cDb dont' contain ref table create it",k),z.Cfg.dbase.assign({refs:[]}).write())},l=function(w,T,f=e.DEFAULT){let b=z.Cfg.dbase;var g=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let M=d({key1:w,key2:T,type:f,created:g,updated:g});en(50),ae(Array.isArray(M)&&M.length>0,"Database insertion fail")},d=function(w){return z.Cfg.dbase.get(tt.tbl_name).push(JSON.parse(JSON.stringify(w))).write()};return Object.freeze({tbl_name:p,TYPE:e,add:l,updKey1:function(w,T,f=e.DEFAULT){let b=z.Cfg.dbase,g;g=b.get(tt.tbl_name).find(A=>A.key2===w&&A.type===f).assign({key1:T}).write(),console.log("%cNeedle  %o mValue %o sType %o",k,w,T,f),console.log("%c_r %o",k,g),ae(Array.isArray(g)&&g.length>0,"Database insertion fail")},updKey2:function(w,T,f=e.DEFAULT){let b=z.Cfg.dbase,g;g=b.get(tt.tbl_name).find(A=>A.key1===w&&A.type===f).assign({key2:T}).write(),console.log("%cNeedle  %o mValue %o sType %o",k,w,T,f),console.log("%c_r %o",k,g),ae(Array.isArray(g)&&g.length>0,"Database insertion fail")},checkSupport:t,exists:function(w,T,f=e.DEFAULT){let b=tt.getByKey(w,T,f);return console.log(`%cRef ${w} exists in db ? ${b!==void 0}`,k),b!==void 0},getByKey:function(w,T=1,f=e.DEFAULT){ae(typeof T=="number","You must provide a number as index of key.",TypeError);let b=z.Cfg.dbase,g=null;if(T==1&&(g=b.get(tt.tbl_name).find(A=>A.key1===w&&A.type===f).value()),T==2&&(g=b.get(tt.tbl_name).find(A=>A.key2===w&&A.type===f).value()),g!=null)return g}})},tt=kn(),xe=tt;var Bn=function(){let p="meta",o=function(c){return ae(typeof c=="string","You must provide a string.",TypeError),z.Cfg.dbase.get(vt.tbl_name).find({key:"dbVersion"}).assign({value:c}).write().value},n=function(){let c=z.Cfg.dbase.get(vt.tbl_name).find({key:"dbVersion"}).value();return typeof c=="undefined"?-1:c.value},a=function(){return z.Cfg.dbase.get("meta").remove(c=>!0).write()},e=function(){return console.log("%c resetDbVersion NE FONCTIONNE PAS",ue),z.Cfg.dbase.get("meta").find({key:"dbVersion"}).remove(c=>!0).write()},t=function(c){return ae(typeof c=="string","You must provide a string.",TypeError),z.Cfg.dbase.get(vt.tbl_name).find({key:"studentLstUpd"}).assign({value:c}).write().value},l=function(){let c=z.Cfg.dbase.get(vt.tbl_name).find({key:"studentLstUpd"}).value();return typeof c=="undefined"?-1:c.value};return Object.freeze({checkSupport:function(){z.Cfg.dbase.get("meta").value()===void 0&&(console.log("%cDb dont' contain meta table create it",k),z.Cfg.dbase.assign({meta:[]}).write()),n()==-1&&z.Cfg.dbase.get("meta").push({key:"dbVersion",value:"1.0.0"}).write(),l()==-1&&z.Cfg.dbase.get("meta").push({key:"studentLstUpd",value:dayjs("19701006").toISOString()}).write()},getDbVersion:n,setDbVersion:o,delDbVersion:e,setStudenListUpd:t,getStudenListUpd:l,tbl_name:p})},vt=Bn(),Oe=vt;var Me=class{static getBetween(o,n){return typeof o=="string"&&(o=dayjs(o)),typeof n=="string"&&(o=dayjs(n)),z.Cfg.dbase.get(Me.tbl_name).filter(t=>dayjs(t.when).isSameOrBefore(n,"day")&&dayjs(t.when).isSameOrAfter(o,"day")).value()}},Le=Me;R(Le,"tbl_name","sessions"),R(Le,"add",async function(o){let n=z.Cfg.dbase;if(GM_config.get("checksessionalreadyexists")===!0)var a=!0;if(o.id.length>0){if(a===!0&&Me.exists(o.id)===!0)return}else if(a===!0&&Me.exists(o.cid)===!0)return;if(we.isInOldMode(dayjs(o.when)))o.funding=De,o.type.toLowerCase()==="soutenance"?o.path="n/a (defense)":o.path="n/a (old mode)";else if(o.type.toLowerCase()==="soutenance")o.funding=De,o.path="n/a (defense)";else{if(Ce.exists(o.who_id)===!1&&(dayjs(Oe.getStudenListUpd()).diff(dayjs(),"m")<-30&&(await Ce.getAll(),Oe.setStudenListUpd(dayjs().toISOString())),Ce.exists(o.who_id,o.when)==!1))return console.warn(`%cStudent ${o.who_id} which exists at ${o.when} still not exit in Db, have to manually create him/her`,k),Ce.createManually(o.who_id,o.who_name,o.when);o.funding=await Ce.getFunding(o.who_id,o.when),o.path=await Ce.getPath(o.who_id,o.when)}o.cid=Me.getHashId(o.when,o.who_id),_r=xe.getByKey(o.cid,2,xe.TYPE.SESSIONID_DATEREFID),_r!==void 0&&(o.id=_r.key1.toString()),Me._save(o)}),R(Le,"_save",function(o){ae(typeof o.id=="string","Session object id need to be a string.",TypeError),ae(typeof o.cid=="number","Session object cid need to be a number.",TypeError),ae(typeof o.who_id=="string","Session object who_id need to be a string.",TypeError),ae(typeof o.who_name=="string","Session object who_name need to be a string.",TypeError),ae(typeof o.status=="string","Session object status need to be a string.",TypeError),ae(typeof o.type=="string","Session object type need to be a string.",TypeError),ae(typeof o.lvl=="string","Session object lvl need to be a string.",TypeError),ae(typeof o.when=="string","Session object when need to be a string.",TypeError),ae(typeof o.path=="string","Session object path need to be a string.",TypeError),ae(typeof o.funding=="string","Session object funding need to be a string.",TypeError),o.lvl==""&&(o.lvl="2"),o.lvl.lvl=parseInt(o.lvl.lvl,10),z.Cfg.dbase.get(Me.tbl_name).push(JSON.parse(JSON.stringify(o))).write()}),R(Le,"exists",function(o){let n=z.Cfg.dbase;var a=Me.findById(o);return a!==void 0}),R(Le,"findById",function(o){let n=z.Cfg.dbase;var a=n.get(Me.tbl_name).find({id:o}).value();return a===void 0&&(a=n.get(Me.tbl_name).find({cid:o}).value()),a}),R(Le,"delete",function(o=null,n=null){let a=z.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof n=="string"&&(n=n.format("YYYY-MM-DD")),o===null&&n==null){console.log("%cWanna suppress ALL Sessions from DB",k),a.get(Me.tbl_name).remove().write();return}if(n==null){a.get(Me.tbl_name).remove(function(e){return dayjs(e.when).isBefore(n),"day"}).write();return}if(o==null){a.get(Me.tbl_name).remove(function(e){return dayjs(e.when).isAfter(o,"day")}).write();return}a.get(Me.tbl_name).remove(function(e){return dayjs(e.when).isBetween(o,n,"day","[]")}).write()}),R(Le,"deleteById",function(o){z.Cfg.dbase.get("sessions").remove(a=>a.id===o).write(),console.log(`%cSession ${o} suppressed from DB`,k)}),R(Le,"parseTable",function(o){var n=o.children[0].children[0].innerText,a=Ke(o.children[0]),e=o.children[1].children[0].innerText.trim(),t=Ke(o.children[1],-2),l=o.children[2].innerText.trim().toLowerCase(),d=o.children[3].children.length?o.children[3].children[0].innerText.trim().toLowerCase():"session",c=-1;o.children[4].children.length>0&&(c=o.children[4].children[0].innerText.trim()),n=Yt(n);var u={id:a,when:n,who_id:t,who_name:e,status:l,type:d,lvl:c};return u}),R(Le,"getHashId",function(o,n){return ae(typeof o=="string"&&typeof n=="string","getId need two string",TypeError),Xt(o+n)}),R(Le,"parseRow",function(o){var n=o.children[0].innerText.length>0?o.children[0].innerText.trim().toLowerCase():"session",a=o.children[0].querySelector("svg").getAttribute("aria-label").trim().toLowerCase(),e=o.children[1].querySelector("time").dateTime;e=dayjs(e).toISOString();var t=Ke(o.children[2],-2),l=o.children[2].innerText.trim(),d=Me.getHashId(e,t),c=o.children[3].innerText.trim();c=c.replace(/[^\d]/gmis,"");var u={id:"",cid:d,when:e,who_id:t,who_name:l,status:a,type:n,lvl:c};return u});var Ae=Le;var _t=class{},lt=_t;R(lt,"calculateBill",function(o,n){let a=n.format("YYYYMM");return et.exists(a)===!0?(console.log(`%cUse Archived version ${a} of accounting`,k),et.get(a).data):(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof n=="string"&&(n=n.format("YYYY-MM-DD")),_t.m_calculateBill(o,n))}),R(lt,"_calculateBill",function(o,n){typeof o=="string"&&(o=dayjs(o)),typeof n=="string"&&(n=dayjs(n));let a=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var e=0,t=0,l=performance.now();let u=z.Cfg.dbase.get(Ae.tbl_name).filter(s=>dayjs(s.when).isSameOrBefore(n,"day")&&dayjs(s.when).isSameOrAfter(o,"day")).value(),h=u.length,i={from:o,to:n,created_at:null,maxLevel:Ze,number:0,amount:0,errors:{funding:[],level:[],path:[],status:[],type:[]},flatFee:[]},w=0,T=0,f=[];e=performance.now();let b=_t.getPriceList(o);t=performance.now(),console.log("%cGetPriceList took "+(t-e)+" milliseconds.",Re);let g=Zt([Ze+1,Ze+1,Ze+1,Ze+1]);for(var A=0;A<h;A+=1){let s=u[A];var M=0;s.status===ft&&(M=J),s.status===pt&&(M=Z),s.status===ht&&(M=V),(s.status===mt||s.status===gt)&&(M=X);var D=0;s.type.toLowerCase()==="session"&&(D=F),s.type.toLowerCase()==="mentorat"&&(D=Wt),s.type.toLowerCase()==="soutenance"&&(D=H),s.path!=null&&s.path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&s.type!=="soutenance"&&(D=N);var S=0;let y=we.isInOldMode(o);if(y===!0&&(S=s.isFunded===!0?W:Q),s.funding===Qe&&(S=Q),s.funding===De&&(S=W),s.funding===Je&&(S=K),s.lvl==""){i.errors.level.push(s);continue}if(typeof s.lvl=="string"&&(s.lvl=parseInt(s.lvl,10)),s.lvl<0){i.errors.level.push(s);continue}if(y===!1&&s.funding!==Qe&&s.funding!==De&&s.funding!==Je){i.errors.funding.push(s);continue}if(s.type.toLowerCase()!=="session"&&s.type.toLowerCase()!=="mentorat"&&D!==H&&D!==N){i.errors.type.push(s);continue}if(s.status!==ft&&s.status!==pt&&s.status!==ht&&s.status!==mt&&s.status!==gt){i.errors.status.push(s);continue}let C=g.get(D,M,S,+s.lvl);C===void 0&&(C={number:0,amount:0,data:[]}),C.number+=1,w+=1,s.lvl<0?(C.amount+=0,T+=0):(C.amount+=1*b[s.lvl][D][M][S],T+=1*b[s.lvl][D][M][S]),C.data.push(s),g.set(D,M,S,+s.lvl,C),D===F&&S===Q&&f.push({id:+s.who_id,who_id:s.who_id,who_name:s.who_name})}var v=[];e=performance.now(),v=_.uniqBy(f,"id"),i.flatFee=v,i.number=w,i.amount=T,i.number+i.errors.funding.length+i.errors.level.length+i.errors.path.length+i.errors.status.length+i.errors.type.length<h&&(console.log(`%cError total number of sessions is ${h} and total number of sessions in bill ${w} + all errors are different`,ue),console.log("errors are",i.errors),console.log("sessions are",u)),i.created_at=a,g.set(0,0,0,0,i);var m=performance.now();return console.log("%cFunction took "+(m-l)+" milliseconds.",Re),i.errors.funding.length+i.errors.level.length+i.errors.path.length+i.errors.status.length+i.errors.type.length>0&&console.log("%cWarning some errors found %o",st,i.errors),g}),R(lt,"m_calculateBill",moize.default(_t._calculateBill,{maxAge:12e4,isSerialized:!0,onCacheAdd:function(o,n,a){console.log("%cAdd data to cache",k)},onCacheHit:function(){console.log("%cGet data from cache",k)}})),R(lt,"getPriceList",function(o){typeof o=="string"&&(o=dayjs(o));var n=[0,Nt,Ut,qt,Gt,Qt,zt];let a=we.isInOldMode(o);var e=new Array(7);for(let t=1;t<=Ze;t+=1){let l=n[t],d=n[t]/2,c=n[t]/4;a?(e[t]=new Array(3),e[t][F]=new Array(5),e[t][F][J]=new Array(4),e[t][F][J][Q]=l,e[t][F][J][W]=l,e[t][F][J][K]=l,e[t][F][Z]=new Array(4),e[t][F][Z][Q]=0,e[t][F][Z][W]=0,e[t][F][Z][K]=0,e[t][F][V]=new Array(4),e[t][F][V][Q]=d,e[t][F][V][W]=d,e[t][F][V][K]=d,e[t][F][X]=new Array(4),e[t][F][X][Q]=d,e[t][F][X][W]=d,e[t][F][X][K]=d,e[t][H]=new Array(5),e[t][H][J]=new Array(4),e[t][H][J][Q]=l,e[t][H][J][W]=l,e[t][H][J][K]=l,e[t][H][Z]=new Array(4),e[t][H][Z][Q]=0,e[t][H][Z][W]=0,e[t][H][Z][K]=0,e[t][H][V]=new Array(4),e[t][H][V][Q]=d,e[t][H][V][W]=d,e[t][H][V][K]=d,e[t][H][X]=new Array(4),e[t][H][X][Q]=d,e[t][H][X][W]=d,e[t][H][X][K]=d,e[t][N]=new Array(5),e[t][N][J]=new Array(4),e[t][N][J][Q]=l,e[t][N][J][W]=l,e[t][N][J][K]=l,e[t][N][Z]=new Array(4),e[t][N][Z][Q]=0,e[t][N][Z][W]=0,e[t][N][Z][K]=0,e[t][N][V]=new Array(4),e[t][N][V][Q]=d,e[t][N][V][W]=d,e[t][N][V][K]=d,e[t][N][X]=new Array(4),e[t][N][X][Q]=d,e[t][N][X][W]=d,e[t][N][X][K]=d):(e[t]=new Array(3),e[t][F]=new Array(5),e[t][F][J]=new Array(4),e[t][F][J][Q]=d,e[t][F][J][W]=l,e[t][F][J][K]=l,e[t][F][Z]=new Array(4),e[t][F][Z][Q]=0,e[t][F][Z][W]=0,e[t][F][Z][K]=0,e[t][F][V]=new Array(4),e[t][F][V][Q]=0,e[t][F][V][W]=0,e[t][F][V][K]=0,e[t][F][X]=new Array(4),e[t][F][X][Q]=c,e[t][F][X][W]=d,e[t][F][X][K]=d,e[t][H]=new Array(5),e[t][H][J]=new Array(4),e[t][H][J][Q]=l,e[t][H][J][W]=l,e[t][H][J][K]=l,e[t][H][Z]=new Array(4),e[t][H][Z][Q]=0,e[t][H][Z][W]=0,e[t][H][Z][K]=0,e[t][H][V]=new Array(4),e[t][H][V][Q]=0,e[t][H][V][W]=0,e[t][H][V][K]=0,e[t][H][X]=new Array(4),e[t][H][X][Q]=d,e[t][H][X][W]=d,e[t][H][X][K]=d,e[t][N]=new Array(5),e[t][N][J]=new Array(4),e[t][N][J][Q]=l,e[t][N][J][W]=l,e[t][N][J][K]=l,e[t][N][Z]=new Array(4),e[t][N][Z][Q]=0,e[t][N][Z][W]=0,e[t][N][Z][K]=0,e[t][N][V]=new Array(4),e[t][N][V][Q]=0,e[t][N][V][W]=0,e[t][N][V][K]=0,e[t][N][X]=new Array(4),e[t][N][X][Q]=d,e[t][N][X][W]=d,e[t][N][X][K]=d)}return e});var Ne=lt;var ve=class{},Ue=ve;R(Ue,"tbl_name","history_session_cache"),R(Ue,"getSessionPage",function(o){o.get("day")<o.daysInMonth()&&(o=o.endOf("month")),console.log(`%cSearch in history session cache data for id: ${o.format("DD/MM/YYYY")}`,k);let n=z.Cfg.dbase;if(!n.has(ve.tbl_name).value())throw Error(`DB ${ve.db_name} NOT FOUND`);let a=n.get(ve.tbl_name).find({id:+o.format("YYYYMMDD")}).value();return a===void 0?-1:a}),R(Ue,"getNearestSessionPage",function(o){o.get("day")<o.daysInMonth()&&(o=o.endOf("month")),console.log(`%cSearch in history session cache NEAREST cached data for id: ${o.format("DD/MM/YYYY")}`,k);let n=z.Cfg.dbase;if(!n.has(ve.tbl_name).value())throw Error(`DB ${ve.db_name} NOT FOUND`);let a=+o.format("YYYYMMDD"),e=n.get(ve.tbl_name).value().map(d=>+d.id-a).filter(d=>d>0),l=(d=>Math.min(...d))(e)+a;return console.log(`%cNearest data in history session cache is data with id: ${o.format("DD/MM/YYYY")}`,k),e=n.get(ve.tbl_name).find({id:l}).value(),e===void 0?-1:e}),R(Ue,"getSameOrNearestSessionPage",function(o){let n=ve.getSessionPage(o);return n===-1&&(n=ve.getNearestSessionPage(o)),n}),R(Ue,"delete",function(o=null,n=null){let a=z.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof n=="string"&&(n=n.format("YYYY-MM-DD")),o===null&&n==null){a.get(ve.tbl_name).remove().write(),console.log("%cWanna suppress ALL History from DB",k);return}if(n==null){a.get(ve.tbl_name).remove(function(e){return dayjs(e.id,"YYYYMMDD").isBefore(n),"day"}).write();return}if(o==null){a.get(ve.tbl_name).remove(function(e){return dayjs(e.id,"YYYYMMDD").isAfter(o,"day")}).write();return}a.get(ve.tbl_name).remove(function(e){return dayjs(e.id,"YYYYMMDD").isBetween(o,n,"day","[]")}).write()}),R(Ue,"addOrUpdateSessionPage",function(o=1,n=dayjs("1970-10-06")){ve.getSessionPage(n)==-1?ve.addSessionPage(o,n):ve.updateSessionPage(o,n)}),R(Ue,"updateSessionPage",function(o=1,n=dayjs("1970-10-06")){let a=z.Cfg.dbase;if(ve.getSessionPage(n)==-1)throw Error("session page not found in history");a.get(ve.tbl_name).find({id:+n.format("YYYYMMDD")}).assign({page:o}).write()}),R(Ue,"addSessionPage",function(o=1,n=dayjs("1970-10-06")){z.Cfg.dbase.get(ve.tbl_name).push(JSON.parse(JSON.stringify({id:+n.format("YYYYMMDD"),page:o}))).write()});var ut=Ue;var It=function(p,o){let n=[[0,1,2,3,4,5,5],[5,1,2,3,4,5,5],[4,5,1,2,3,4,4],[3,4,5,1,2,3,3],[2,3,4,5,1,2,2],[1,2,3,4,5,1,1],[0,1,2,3,4,5,0]];return Math.trunc(o.diff(p,"days")/7)*5+n[p.day()][o.day()]};var ct=class{};R(ct,"detail_bill","truc"),R(ct,"getListDetailBill",function(o,n){let e=z.Cfg.dbase.get(Ae.tbl_name).filter(A=>dayjs(A.when).isSameOrBefore(n,"day")&&dayjs(A.when).isSameOrAfter(o,"day")).sortBy(function(A){return dayjs(A.when).valueOf()}).value(),t=we.getOldModeDate(),l=Ne.getPriceList(t.subtract(1,"day")),d=Ne.getPriceList(t),c=0;var u=_.cloneDeep(e);for(var h in u){var i=0,w=0,T=!0,f=0;u[h].status===ft&&(f=J),u[h].status===pt&&(f=Z),u[h].status===ht&&(f=V),(u[h].status===mt||u[h].status===gt)&&(f=X);var b=0;u[h].type.toLowerCase()==="session"&&(b=F),u[h].type.toLowerCase()==="soutenance"&&(b=H),u[h].path!=null&&u[h].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&u[h].type!=="soutenance"&&(b=N);var g=0;u[h].funding===Qe&&(g=Q),u[h].funding===De&&(g=W),u[h].funding===Je&&(g=K),we.isInOldMode(dayjs(u[h].when))?i=+u[h].lvl>0?l[+u[h].lvl][b][f][g]:0:(T=!1,i=+u[h].lvl>0?d[+u[h].lvl][b][f][g]:0),c+=i,u[h].iPu=i,u[h].oldMode=T,u[h].iCumul=c}return u}),R(ct,"getListStatistic",function(o,n){let a=o.clone(),e=a.endOf("month"),t=[],l=[],d=0,c=n.diff(o,"month");for(var u=performance.now();a.isSameOrBefore(n,"day");)t.push(Ne.calculateBill(a,e)),a=a.add(1,"month"),e=a.endOf("month");var h=performance.now();console.log("%cComputed data between the two dates in"+(h-u)+" milliseconds.",Re),a=o.clone(),e=a.endOf("month");let i=0,w=0,T=0,f=0,b=0,g=0,A=0;for(;d<=c;){let D=t[d].get(0,0,0,0),S=D.maxLevel;l[d]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let v=1;for(;v<S;){let s=0,y=0,C=0,j=0;i=t[d].get(F,J,Q,v),T=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(F,J,W,v),w=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(F,J,K,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,we.isInOldMode(a)?(l[d].kpi.hrs+=(i+w+T)*(45/60),l[d].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsS")/60)):(l[d].kpi.hrs+=T*(30/60),l[d].kpi.hrsp+=T*(GM_config.get("nbHrsAfM")/60),l[d].kpi.hrs+=(i+w)*(45/60),l[d].kpi.hrsp+=(i+w)*(GM_config.get("nbHrsfM")/60)),i=t[d].get(F,Z,Q,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(F,Z,W,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(F,Z,K,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,we.isInOldMode(a)?(i=t[d].get(F,V,Q,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(F,V,W,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(F,V,K,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount):(i=t[d].get(F,V,Q,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(F,V,W,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(F,V,K,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount),i=t[d].get(F,X,Q,v),T=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(F,X,W,v),w=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(F,X,K,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i,l[d].kpi.hrs+=(i+w+T)*(15/60),l[d].kpi.hrsp+=(i+w+T)*(15/60),s=l[d].sessions.total,y=l[d].sessions.nb,C=l[d].sessions.pu,j=l[d].sessions.nbc,l[d].sessions={total:b+s,nb:f+y,pu:(b+s)/(f+y),nbc:g+j},s=0,y=0,C=0,j=0,f=0,b=0,g=0,A=0,i=t[d].get(H,J,Q,v),T=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(H,J,W,v),w=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(H,J,K,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,l[d].kpi.hrs+=(i+w+T)*(45/60),l[d].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsD")/60),i=t[d].get(H,Z,Q,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(H,Z,W,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(H,Z,K,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(H,V,Q,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(H,V,W,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(H,V,K,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(H,X,Q,v),T=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(H,X,W,v),w=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(H,X,K,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,l[d].kpi.hrs+=(i+w+T)*(15/60),l[d].kpi.hrsp+=(i+w+T)*(15/60),s=l[d].defenses.total,y=l[d].defenses.nb,C=l[d].defenses.pu,j=l[d].defenses.nbc,l[d].defenses={total:b+s,nb:f+y,pu:(b+s)/(f+y),nbc:g+j},s=0,s=0,y=0,C=0,j=0,f=0,b=0,g=0,A=0,i=t[d].get(N,J,Q,v),T=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(N,J,W,v),w=typeof i=="undefined"?0:i.number,f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(N,J,K,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,l[d].kpi.hrs+=(i+w+T)*(45/60),l[d].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsC")/60),i=t[d].get(N,Z,Q,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(N,Z,W,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(N,Z,K,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(N,V,Q,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(N,V,W,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(N,V,K,v),g=typeof i=="undefined"?g:g+i.number,A=typeof i=="undefined"?A:A+i.amount,i=t[d].get(N,X,Q,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(N,X,W,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,i=t[d].get(N,X,K,v),f=typeof i=="undefined"?f:f+i.number,b=typeof i=="undefined"?b:b+i.amount,s=l[d].coaches.total,y=l[d].coaches.nb,C=l[d].coaches.pu,j=l[d].coaches.nbc,i=typeof i=="undefined"?0:i.number,l[d].kpi.hrs+=i*(15/60),l[d].kpi.hrsp+=i*(15/60),l[d].coaches={total:b+s,nb:f+y,pu:(b+s)/(f+y),nbc:g+j},v+=1}let m=D.flatFee.length;for(var M=0;M<m;M+=1)l[d].bonus+=30;e.isAfter(n,"day")&&(e=n.clone()),l[d].kpi.jrs=It(a,e),l[d].header.dtFrom=a.format("YYYY-MM-DD"),l[d].header.dtTo=e.format("YYYY-MM-DD"),l[d].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),a=a.add(1,"month"),e=a.endOf("month"),d+=1}return l}),R(ct,"getListStatisticOld",function(o,n){let a=o.clone(),e=a.endOf("month"),t=[],l=[],d=n.get("month")-o.get("month");for(var c=performance.now();a.isSameOrBefore(n,"day");)t.push(Ne.calculateBill(a,e)),a=a.add(1,"month"),e=a.endOf("month");var u=performance.now();console.log("%cComputed data between the two dates in"+(u-c)+" milliseconds.",Re);let h=0;for(a=o.clone(),e=a.endOf("month"),console.log(t);h<=d;){let i=t[h][0].max_level;l[h]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let w=1;for(;w<i;){let T=[...Array(8).keys()];for(let f=0;f<T.length;f+=1)l[h].sessions.total+=t[h][w].sessions.number[f]*t[h][w].sessions.pu[f],l[h].sessions.nb+=t[h][w].sessions.number[f],l[h].defenses.total+=t[h][w].defenses.number[f]*t[h][w].defenses.pu[f],l[h].defenses.nb+=t[h][w].defenses.number[f],we.isInOldMode(a)?[1,5].includes(f)&&(l[h].sessions.nbc+=t[h][w].sessions.number[f],l[h].defenses.nbc+=t[h][w].defenses.number[f]):[1,2,5,6].includes(f)&&(l[h].sessions.nbc+=t[h][w].sessions.number[f],l[h].defenses.nbc+=t[h][w].defenses.number[f]),we.isInOldMode(a)?(l[h].kpi.hrs+=(t[h][w].sessions.number[f]-t[h][w].defenses.number[f])*(45/60),l[h].kpi.hrsp+=(t[h][w].sessions.number[f]-t[h][w].defenses.number[f])*(GM_config.get("nbHrsfM")/60)):([4,5,6,7].includes(f)&&(l[h].kpi.hrs+=(t[h][w].sessions.number[f]-t[h][w].defenses.number[f])*(30/60),l[h].kpi.hrsp+=(t[h][w].sessions.number[f]-t[h][w].defenses.number[f])*(GM_config.get("nbHrsAfM")/60)),[0,1,2,3].includes(f)&&(l[h].kpi.hrs+=(t[h][w].sessions.number[f]-t[h][w].defenses.number[f])*(45/60),l[h].kpi.hrsp+=(t[h][w].sessions.number[f]-t[h][w].defenses.number[f])*(GM_config.get("nbHrsfM")/60))),l[h].kpi.hrs+=t[h][w].defenses.number[f]*(45/60),l[h].kpi.hrsp+=t[h][w].defenses.number[f]*(GM_config.get("nbHrsD")/60);w+=1}l[h].sessions.pu=l[h].sessions.total/(l[h].sessions.nb-l[h].sessions.nbc),l[h].defenses.pu=l[h].defenses.total/(l[h].defenses.nb-l[h].defenses.nbc),l[h].coaches.total=l[h].sessions.total-l[h].defenses.total,l[h].coaches.nb=l[h].sessions.nb-l[h].defenses.nb,l[h].coaches.nbc=l[h].sessions.nbc-l[h].defenses.nbc,l[h].coaches.pu=l[h].coaches.total/(l[h].coaches.nb-l[h].coaches.nbc);for(let T=0;T<t[h][0].bonus.length;T+=1)l[h].bonus+=t[h][0].bonus[T].sessions>0?30:0;e.isAfter(n,"day")&&(e=n.clone()),l[h].kpi.jrs=It(a,e),l[h].header.dtFrom=a.format("YYYY-MM-DD"),l[h].header.dtTo=e.format("YYYY-MM-DD"),l[h].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),a=a.add(1,"month"),e=a.endOf("month"),h+=1}return l});var Et=ct;var jt=class{static changePgIfNeeded(o,n,a,e){var t=e.getPageCount(),l=e.getPages()[t-1],d=l.fontSize,c=l.getFont(),u=l.lineHeight;return o<n&&(a=1,l=e.addPage(),l.font=c,l.setFontSize(d),l.lineHeight=u),[a,l]}};R(jt,"addFooter",async function(o,n,a={}){let{degrees:e,PDFDocument:t,rgb:l,StandardFonts:d}=PDFLib,c=o.getPageCount(),u="8".repeat(c),h=await o.embedFont(d.TimesRoman),i=12,w=h.widthOfTextAtSize(`page ${u} / ${u}`,i),T=10,f=10,b=1,g=l(0/255,0/255,0/255),A=l(253/255,246/255,227/255),M=5,D=5,S=3,v=3,m=!0;o.getPages().forEach((s,y)=>{if(!(m===!0&&y==0)){let{width:C,height:j}=s.getSize(),G=i+2*b+S+v;s.moveTo(T+M,i+v),s.setFont(h),s.setFontSize(i),s.setFontColor(l(1,0,0)),n!==void 0&&s.drawText(`${n}`),s.drawText(`page ${y+1} / ${c}`,{x:C-w-D}),s.drawRectangle({x:T,y:10,width:C-(T+f),height:G,color:A,opacity:.6,borderColor:g,borderWidth:b})}})});var We=jt;var tn=async function(){let p=z.Cfg.dbase;return await Swal.mixin({confirmButtonText:"Suivant &rarr;",showCancelButton:!0,progressSteps:["0","1","2","3","4","5"],onOpen:function(i){console.log("...onOpen")},onRender:function(i){console.log("....onUpdate")},onClose:function(i){console.log(".....onClose")},onAfterClose:function(i){console.log("......onAfterClose")},onDestroy:function(i){console.log(".......onDestroy")}}).queue([{title:"Migration de la base",html:"<p>Cette migration va corriger la base et ajouter les nouveaux champs n\xE9cessaires, l`interrpuption du traitement est sans danger (mais ce n' est pas une raison !)</p>"},{title:"Correction de la table \xE9tudiant",html:"<p>Correction de la liste des \xE9tudiants (who_id)",onOpen:async function(i){console.log("%cMigration table des \xE9tudiants correction du who_id",k),Swal.showLoading();var w=dayjs("2020-06-01"),T=p.get("students"),f=T.value(),b=p.get("sessions").filter(S=>dayjs(S.when).isSameOrAfter(w,"day")),g=T.size().value(),A=Swal.getContent().textContent;for(c=0;c<g;c+=1){var M=b.find(v=>v.who_name===f[c].fullname).value();M!==void 0&&T.get(c).assign({who_id:M.who_id}).write();let S=Swal.getContent();S!=null&&(S.innerHTML=`${A}<br /><p>Traitement en cours : ${c}/${f.length}</p>`),await Fe(1)}Swal.hideLoading();let D=Swal.getContent();D!=null&&(D.textContent=`Traitement termin\xE9 : ${f.length}/${f.length}`)}},{title:"Correction de la table \xE9tudiant",html:"<p>Correction de la liste des \xE9tudiants funded devient funding</p>",onOpen:async function(i){console.log("%cMigration : table des \xE9tudiants suppression de l'ancien champs et ajout du champs funding",k),Swal.showLoading();for(var w=p.get("students"),T=w.size().value(),f=Swal.getContent().textContent,b=0;b<T;b+=1){var g=w.get(b).value().fundedby;if(g===void 0){console.log("%cStudent ${oListStudents.get(i).who_name} already converted, skip it",k);continue}w.get(b).unset(["fundedby"]).assign({funding:g}).write(),console.log("%cStudent ${oListStudents.get(i).who_name} create field funding and remove fundedby",k);let M=Swal.getContent();M!=null&&(M.innerHTML=`${f}<br /><p>Traitement en cours : ${b}/${T}</p>`),await Fe(1)}Swal.hideLoading();let A=Swal.getContent();A!=null&&(A.textContent=`Traitement termin\xE9 : ${T}/${T}`)}},{title:"Correction table Etudiants",html:"<p>Correction de la liste des sessions, ajout du path dans la session</p>",onOpen:async function(i){console.log("%cMigration table des sessions correction de id_who",k),Swal.showLoading();var w=dayjs("2020-06-01"),T=p.get("students"),f=T.value(),b=p.get("sessions").filter(v=>dayjs(v.when).isSameOrAfter(w,"day")),g=b.filter(v=>v.type!="soutenance").value(),A=Swal.getContent().textContent;for(c=0;c<g.length;c+=1){var M=T.find({who_id:g[c].who_id}).value();console.log("found",M);var D=M!==void 0&&M.path.length>0?M.path:"0-unknown";p.get("sessions").find({id:g[c].id}).assign({path:D}).write();let v=Swal.getContent();v!=null&&(v.innerHTML=`${A}<br /><p>Traitement en cours : ${c}/${g.length}</p>`),await Fe(1)}Swal.hideLoading();let S=Swal.getContent();S!=null&&(S.textContent=`Traitement termin\xE9 : ${c}/${g.length}`)}},{title:"Migration de la table des Sessions",html:'<p>Correction de la liste des sessions, suppression du champs "isFunded"</p>',onOpen:async function(i){console.log("%cMigration : table des sessions suppression de isFunded",k),Swal.showLoading();for(var w=dayjs("2020-06-01"),T=p.get("students").value(),f=p.get("sessions").filter(D=>dayjs(D.when).isSameOrAfter(w,"day")),b=Swal.getContent().textContent,g=f.value().length;g-=1;){var A=f.get(g);A.value().isFunded===void 0||A.value().isFunded===void 0?console.log(`%cSkip ${A.value()} already converted`,k):A.unset(["isFunded"]).write();let D=Swal.getContent();D!=null&&(D.innerHTML=`${b}<br /><p>Traitement en cours : il reste ${g} \xE9lements \xE0 convertir</p>`),await Fe(1)}Swal.hideLoading();let M=Swal.getContent();M!=null&&(M.textContent=`Traitement en termin\xE9 : ${f.value().length}/${f.value().length}`)}},{title:"Migration de la table des Sessions",html:"<p>Correction de la liste des sessions, ajout de funding</p>",onOpen:async function(i){console.log("%cMigration : table des sessions ajout de fundedBy",k),Swal.showLoading();for(var w=dayjs("2020-06-01"),T=p.get("students").value(),f=p.get("sessions").filter(v=>dayjs(v.when).isSameOrAfter(w,"day")),b=f.filter(v=>v.type!="soutenance"),g=Swal.getContent().textContent,A=b.value().length;A-=1;){var M=b.get(A);M.value().funding!==void 0?console.log(`%cSkip ${M.value()} already converted`,k):M.assign({funding:Ce.getFunding(M.value().who_id)}).write();let v=Swal.getContent();v.innerHTML=`${g}<br /><p>Traitement en cours : il rest ${A}\xE9lements \xE0 convertir</p>`,await Fe(1)}for(var D=A,b=f.filter(v=>v.type=="soutenance"),A=0;A<b.value().length;A+=1){b.get(A).assign({funding:De}).write();let m=Swal.getContent();m!=null&&(m.innerHTML=`${g}<br /><p>Traitement en cours : ${D+A}/${f.value().length}</p>`),await Fe(1)}Swal.hideLoading();let S=Swal.getContent();S!=null&&(S.textContent=`Traitement termin\xE9 :  ${f.value().length}/${f.value().length}`)}}]).then(i=>{if(i.value){let w=JSON.stringify(i.value);Swal.fire({title:"Traitement termin\xE9!",html:`
			Your answers:
			<pre><code>${w}</code></pre>
		  `,confirmButtonText:"Lovely!"})}else return console.log("%c resultat en erreur",k,i,i.dismiss===Swal.DismissReason.cancel),-1});var n,a,e;for(c=0;c<a.length;c+=1){var t;t!==void 0&&p.get("students").find({fullname:t.who_name}).assign({who_id:t.who_id}).write()}var l;for(c=0;c<l.length;c+=1){var t,d;p.get("sessions").find({id:l[c].id}).assign({path:d}).write()}for(var c;c<e.value().length;c+=1)e.get(c).unset(["isFunded"]).write();for(var u,c;c<u.value().length;c+=1){var h=u.get(c);h.assign({fundedBy:Ce.getFunded(h.value().who_id)}).write()}for(var u,c;c<u.value().length;c+=1)u.get(c).assign({fundedBy:De}).write()};var on=Dn(nn()),Pt=class{},He=Pt;R(He,"save",function(){return console.log("%cWanna save DBASE",k),JSON.stringify(z.Cfg.dbase.getState())}),R(He,"load",function(o){return console.log(`%cWanna load ${o} in DBASE`,k),console.log("%c !!!!!! TYPE NOT CHECKED BE CARREFULL",k),z.Cfg.dbase.setState(JSON.parse(o)).write()}),R(He,"update",async function(o){console.log(`%cIs there any update to DB to go to version ${o}`,k);let n=[{version:"1.00.0006",action:tn}];for(let e=0,t=n.length;e<t;e++)if(bt(o,n[e].version)==0)if(console.log(`%cFound an update to DB version '${n[e].version}' proceed conversion...`,k),await n[e].action()==-1)console.log(`%cError something was wrong during update of database from version: ${Oe.getVersion()} to version:${n[e].version}.... you have canceled it`,ue),Swal.fire({icon:"error",title:"Oops...",text:`Quelque chose s'est mal pass\xE9 ou vous avez annul\xE9 l'update 

Utiliser l'application dans ces conditions n'est pas garanti  !`,footer:'<a href="https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/issues">G\xE9n\xE9rer un bug?</a>'});else{let d=Oe.setDbVersion(o);console.log(`%cChanged DB to version ${d}`,k)}let a=Oe.setDbVersion(o);console.log(`%cChanged DB to version ${a}`,k)}),R(He,"erase",function(o){return console.log(`%cErase all data of table: ${o}`,k),z.Cfg.dbase.get(o).remove().write()}),R(He,"loadTable",function(o,n){if(table_exist(o))return z.Cfg.dbase.set(o,n).write();throw"Table :"+o+", not exists in DB !"}),R(He,"table_exist",o=>z.Cfg.dbase.has(o).value),R(He,"table_export",function(o){if(table_exist(o))return JSON.stringify(z.Cfg.dbase.get(o).value());throw"Table :"+o+", not exists id DB !"}),R(He,"exportTblToCSV",function(o="",n,a){let e=Pt.exportTblToJSON(o,n,a),t={quotes:!1,quoteChar:'"',escapeChar:'"',delimiter:",",header:!0,newline:`\r
`,skipEmptyLines:!1,columns:null};return on.default.unparse(e,t)}),R(He,"exportTblToJSON",function(o="",n,a){if(o=="")return console.log("%cIrrecoverable Error: You forget to define a data table name",ue),-1;if(n!==null&&n!==""&&(dtFrom=dayjs(n)),a!==null&&a!==""&&(dtTo=dayjs(a)),z.Cfg.dbase.has(o).value==!1)return console.log(`%cIrrecoverable Error: table ${o} don't exist`,ue),-1;if(o===Ae.tbl_name){if(typeof dtFrom=="object"&&dtTo==="object")return z.Cfg.dbase.get(o).filter(e=>dayjs(e.when).isSameOrBefore(dtTo,"day")&&dayjs(e.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtFrom=="object")return z.Cfg.dbase.get(o).filter(e=>dayjs(e.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtTo=="object")return z.Cfg.dbase.get(o).filter(e=>dayjs(e.when).isSameOrBefore(dtTo,"day")).value()}return z.Cfg.dbase.get(o).value()});var nt=He;var rn=async function(){var p="";p+="<style>div.about_content {background-color: #fed9ff;/*width: 600px;*/height: var(--heigth, 80%);overflow-x: hidden;overflow-y: auto;text-align: left;padding: 20px;}</style>",p+='<div class="about_content" style="--heigth: 600px;">',p+='<div class="about_content__wrapper">';var n=(await it.XHR({method:"GET",url:"https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/README.md",responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"}})).responseText,a=new showdown.Converter,e=a.makeHtml(n);p+=e,p+="</div>",p+="</div>",Swal.fire({title:`<strong>A propos de ${Ht}</strong>`,icon:"info",html:p,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})};var wt=function(){console.log("%c ADDCBOX WAS CALLED",k);var p="table#sessions_2",o=document.querySelector(p),n=!1;if(o===null)throw console.log(`%cERROR:Could'nt find the table which display sessions : ${o}`,ue),new Error("!!!! IRRECOVERABLE ERROR NO TABLE OF SESSIONS FOUNDED");if(o.querySelector("[type=checkbox]")===null){var p="table#sessions_2 tbody",o=document.querySelector(p);for(let S of o.children){var a=Ke(S.children[2],-2),e=document.createElement("input");e.type="checkbox",e.name="name";var t=S.children[1].querySelector("time").dateTime.trim();t=dayjs(t).toISOString();var l=Ae.getHashId(t,a);e.value=l,e.onclick=function(v){v.stopPropagation()},n=Ae.exists(l),n===!0&&(e.checked=!0);var d=document.createElement("td");d.style="text-align: center",d.appendChild(e),S.appendChild(d)}if(document.querySelector("table#sessions_2 thead")===null){let S=(v,m)=>m.insertAdjacentElement("beforebegin",v);p="table#sessions_2 tbody";var c=document.querySelector(p);e=document.createElement("input"),e.type="checkbox",e.name="name",e.value="value",e.id="id",e.onclick=function(){document.querySelectorAll("tbody input[type=checkbox]").forEach(v=>v.checked=!v.checked)},e.style="visibility: hidden;";var u=document.createElement("label");u.innerText="in DB",u.style="display:block;",u.onMouseOver="this.style.cursor=pointer;",u.onMouseOut="this.style.cursor=auto;",u.appendChild(e);var h=document.createElement("td");h.style=`
    font-size: 1rem;
    max-width: 280px;
    font-family: Montserrat;
    font-weight: 400;
    line-height: 1.625rem;
    text-transform: inherit;
`,h.innerText="&nbsp;"+GM.info.script.version;var i=document.createElement("td");i.style=`
    font-size: 1rem;
    max-width: 280px;
    font-family: Montserrat;
    font-weight: 400;
    line-height: 1.625rem;
    text-transform: inherit;
    margin-left: auto;
`,i.innerText="Fact.(o/n)",i.addEventListener("click",_handler=function(v){document.querySelectorAll("tbody input[type=checkbox]").forEach(m=>m.checked=!m.checked)});var w=document.createElement("tr");w.style=`
    display: flex;
    align-items: center;
    border-bottom: 1px solid #e0e0e0;
    flex-direction: row;
    background-color: #fff;
`,w.appendChild(h),w.appendChild(i);var T=document.createElement("thead");T.style="display: block;",T.appendChild(w),S(T,document.querySelector(p))}}else{for(var f=o.querySelectorAll("[type=checkbox]"),b=f.length,g=new Array(b);b--;g[b]=f[b]);for(var A in g){let M=parseInt(g[A].value,10);n=Ae.exists(M),n===!0?g[A].checked=!0:g[A].checked=!1}}},sn=async function(){var[p,o]=await dt(dayjs().startOf("month"),dayjs().endOf("month"));let n=Et.getListDetailBill(p,o),a="";a+="<table>",a+="<thead>",a+="<tr><th>Quand</th><th>Qui</th><th>Financ\xE9 ?</th><th>Type</th><th>Niveau</th><th>Ancien Mode ?</th><th>Statut</th><th>PU HT</th><th>Cumul</th></tr>",a+="<thead>",a+="<tbody>";for(let e=0;e<n.length;e+=1)a+="<tr>",a+=`<td>${dayjs(n[e].when).format("DD/MM/YYYY \xE0 HH:mm:ss")}</td>`,a+=`<td>${n[e].who_name}</td><td>${n[e].funding}</td>`,sType=n[e].type,n[e].path!=null&&n[e].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&n[e].type!=="soutenance"&&(sType="Coaching"),a+=`<td>${sType}</td><td>${n[e].lvl}</td>`,a+=`<td>${n[e].oldMode===!0?"Oui":"Non"}</td>`,a+=`<td>${n[e].status}</td>`,a+=`<td>${n[e].iPu}</td><td>${n[e].iCumul}\u20AC</td>`,a+="</tr>";a+="</tbody>",a+="</table>",Swal.fire({title:`<strong>Liste d\xE9taill\xE9es des sessions du ${p.format("DD/MM/YYYY")} au ${o.format("DD/MM/YYYY")}</strong>`,icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:e=>{var t=e.querySelector("table"),l=new simpleDatatables.DataTable(t)}})},an=async function(){var[p,o]=await dt(dayjs().startOf("month"),dayjs().endOf("month"));let n=0,a=GM_config.get("maxfetchpg"),e=!0;var t={};let l=[],d=1,c=ut.getSameOrNearestSessionPage(o);for(c!==void 0&&c.page>d&&(d=c.page);e;){if(n>a){console.warn("%cEMERGENCY EXIT LOOP",st);break}try{t=await In(p,o,d,l)}catch(i){throw console.error(`%c IRRECOVERABLE ERROR ... ${i}, will exit !!!! `,ue),new Error}t.length>0&&dayjs(t[t.length-1].when).isSameOrBefore(p)===!0&&(e=!1),d+=1,n+=1}GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let u='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';var h=t.length;Swal.fire({title:"Traitement en cours!",html:u,confirmButtonText:"Lovely!",onBeforeOpen:function(i){var w=new ldBar("#pbar")},onRender:function(i){},onOpen:async function(i){var w=document.getElementById("pbar").ldBar;for(var T in t){if(dayjs(t[T].when).isBefore(p,"day")===!0)break;if(dayjs(t[T].when).isAfter(o,"day")===!0){w.set(T/h*100,!1);continue}dayjs(t[T].when).isBetween(p,o,"day","[]")&&(await Ae.add(t[T]),w.set(T/h*100,!1))}w.set(100,!1),Swal.getTitle().innerText="Traitement termin\xE9 !"},onClose:function(i){},onAfterClose:function(i){},onDestroy:function(i){}}),wt()},dn=async function(){var p="table#sessions_2 tbody input:checked",o=document.querySelectorAll(p);GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let n='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';Swal.fire({title:"Traitement en cours!",html:n,confirmButtonText:"Lovely!",onBeforeOpen:function(a){var e=new ldBar("#pbar")},onRender:function(a){},onOpen:async function(a){for(var e=document.getElementById("pbar").ldBar,t=0;t<o.length;t+=1){var l=o[t].parentElement.parentElement,d=Ae.parseRow(l);await Ae.add(d),e.set(t/o.length*100,!1)}e.set(100,!1),Swal.getTitle()&&(Swal.getTitle().innerText="Traitement termin\xE9 !")},onClose:function(a){},onAfterClose:function(a){},onDestroy:function(a){}})},ln=function(){let p=unsafeWindow.Facturier.cfg.dbase,o=unsafeWindow.Facturier.libs.find(c=>c.id=="dayjs").ptr,n=unsafeWindow.Facturier.libs.find(c=>c.id=="fetchInject").ptr,a=unsafeWindow.Facturier.klass.find(c=>c.id=="Session").ptr,e=unsafeWindow.Facturier.klass.find(c=>c.id=="Student").ptr,t=unsafeWindow.Facturier.klass.find(c=>c.id=="History").ptr,l=unsafeWindow.Facturier.klass.find(c=>c.id=="Archive").ptr,d=unsafeWindow.Facturier.klass.find(c=>c.id=="StudentHistory").ptr;console.log("%cd_dbase, d_dayjs, d_Session, d_Student, d_History, d_Archive, d_StudentHistory are exported",k),console.log("%cfor examples write all code after $>",k),console.group("%cd_dbase",k),console.log("example : get last session in db $>d_dbase.get(d_Session.tbl_name).last().value();"),console.log("          get first student in db $>d_dbase.get(d_Student.tbl_name).first().value()"),console.log("          or d_dbase.get(d_Student.tbl_name).get(0).value()"),console.log("          get all sessions grouped by month/yyyy in db $>d_dbase.get(d_Session.tbl_name).groupBy( v => d_dayjs(v.when).format('MM/YYYY')).value()"),console.log("          get all table $> d_dbase.value()"),console.groupEnd(),console.group("%cd_fetchInject",k),console.log("same as fetchInject libs : https://habd.as/code/fetch-inject/"),console.groupEnd(),console.group("%cd_dayjs",k),console.log("same as dayjs libs"),console.groupEnd(),console.group("%cd_Student",k),console.log("find a student by id \xA4 d_Student.findById(STUDENT_ID, (DATE) ); // date is optionnal"),console.groupEnd(),console.group("%cd_Session",k),console.log("get a list of session \xA4 d_Session.getBetween('2020-08-01','2020-08-31')"),console.log("delete a session by id \xA4 d_Session.deleteById(SESSION_ID);"),console.groupEnd(),console.group("%cSome combinated example",k),console.log("Delete last saved session :  d_Session.deleteById( d_dbase.get(d_Session.tbl_name).last().value().id ); "),console.log("Find all session between 01/08/2020 and 31/08/2020 :  d_dbase.get(d_Session.tbl_name).filter( v => d_dayjs(v.when).isSameOrBefore('20200831', 'day') && d_dayjs(v.when).isSameOrAfter('20200801', 'day')).value(); "),console.groupEnd();debugger},In=async function(p,o,n=1,a=[]){Swal.fire({position:"top-end",icon:"info",toast:!0,title:`Collecte des sessions de l'historique
du `+p.format("DD/MM/YYYY")+" au "+o.format("DD/MM/YYYY")+` 
page : `+n+`
cela peut prendre du temps...`,showConfirmButton:!1,timer:3e3});let e=null;try{e=await at(`https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history?page=${n}`,"table.crud-list tbody")}catch(h){console.error(`%c _historyFetch : ${h}`,ue)}if(e===null)throw new Error(`Something went wrong could'nt collect anything from ${p.format("DD/MM/YYYY")} to ${o.format("DD/MM/YYYY")} working on history page:${n}.... try to navigate forward and backward or click some buttons to change url`);let t=$t(e),l=$t(e,-1);if(t.get("month")!=l.get("month")){let h=l.endOf("month");ut.addOrUpdateSessionPage(n,h)}if(l.isAfter(o,"day")===!0)return console.log(`%cOptimization: oldest (last) data from page are at :${l.format("DD/MM/YYYY")}, don't analyze what was before end date of extraction ${o.format("DD/MM/YYYY")}`,k),a;for(var d=0;d<e.children.length;d+=1){var c=e.children[d],u=Ae.parseTable(c);a.push(u)}return a},un=function(){let{degrees:p,PDFDocument:o,rgb:n,StandardFonts:a}=PDFLib;async function e(){let c=await fetch("https://pdf-lib.js.org/assets/with_update_sections.pdf").then(g=>g.arrayBuffer()),u=await o.load(c),h=await u.embedFont(a.Helvetica),w=u.getPages()[0],{width:T,height:f}=w.getSize();w.drawText("This text was added with JavaScript!",{x:5,y:f/2+300,size:50,font:h,color:n(.95,.1,.1),rotate:p(-45)});let b=await u.save();download(b,"pdf-lib_modification_example.pdf","application/pdf")}async function t(){let d=await o.create(),c=await d.embedFont(a.TimesRoman),u=d.addPage(),{width:h,height:i}=u.getSize(),w=30;u.drawText("Creating PDFs in JavaScript is awesome!",{x:50,y:i-4*w,size:w,font:c,color:n(0,.53,.71)});let T=await d.save();download(T,"pdf-lib_modification_example.pdf","application/pdf")}async function l(){var[d,c]=await dt(dayjs().startOf("month"),dayjs().endOf("month"));let u=Et.getListDetailBill(d,c),h=await o.create(),i=await h.embedFont(a.TimesRoman),w=h.addPage(),{width:T,height:f}=w.getSize(),b=30;w.drawText(`Prestations en d\xE9tail 

 du ${d.format("DD/MM/YYYY")} au ${c.format("DD/MM/YYYY")}`,{x:50,y:f/2-b,size:b,font:i,color:n(116/255,81/255,235/255)});let g=12,A=1.25,M=h.addPage();M.setFontSize(g),M.line_space=A,M.font=i;let D=1,S=20,v=A*g+S,m=f/2,s=function(ee){let q="LOrEm ipsum DOLor sit aMet, conSEc/tetUr 25 porttitor. ";return ee*1.0925*(i.widthOfTextAtSize(q,g)/q.length)},y=[0,18,36,10,13,8,5,7],C=[y[0],s(y[1]),s(y[2]),s(y[3]),s(y[4]),s(y[5]),s(y[6]),s(y[7])],j=w.lineHeight,G=25;for(let ee=1;ee<u.length;ee+=1){if(m=f-A*g*D,m<v&&(D=1,M=h.addPage(),M.font=i,M.setFontSize(g),M.line_space=A,m=f-A*g*D),D===1){let je=["","Quand","Qui","Financ\xE9","Type-Niv.","Statut","Pu","Cumul"],Se=G;M.moveTo(Se,m);for(let Pe=1;Pe<je.length;Pe+=1)M.drawText(je[Pe],{x:Se}),Se+=C[Pe];D+=1,m=f-A*g*D}let q=G;M.drawText(dayjs(u[ee].when).format("DD/MM/YYYY \xE0 HH:mm"),{font:i,size:g,y:m,x:q,lineHeight:j}),q+=C[1],M.drawText(u[ee].who_name.trim().slice(0,y[2]),{font:i,size:g,y:m,x:q,lineHeight:j}),q+=C[2];let le=u[ee].funding.trim().slice(0,y[3]);u[ee].funding==="auto-financ\xE9"&&(le="Au. Fin."),u[ee].funding==="financ\xE9 par un tiers"&&(le="Fin."),M.drawText(le,{font:i,size:g,y:m,x:q,lineHeight:j}),q+=C[3];let _e=u[ee].type;u[ee].path!=null&&u[ee].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&u[ee].type!=="soutenance"&&(_e="Coaching");let $e=`${_e.trim().slice(0,y[4]-2)}-${u[ee].lvl.toString()}`;M.drawText($e,{font:i,size:g,y:m,x:q,lineHeight:j}),q+=C[4];let Te=u[ee].status;u[ee].status==="\xE9tudiant absent"&&(Te="absent"),u[ee].status==="\xE9tudiante absente"&&(Te="absente"),u[ee].status==="annul\xE9e tardivement"&&(Te="an. tard."),M.drawText(Te,{font:i,size:g,y:m,x:q,lineHeight:j}),q+=C[5],M.drawText(u[ee].iPu.toString(),{font:i,size:g,y:m,x:q,lineHeight:j}),q+=C[6],M.drawText(u[ee].iCumul.toString(),{font:i,size:g,y:m,x:q,lineHeight:j}),D+=1}var $=await Ne.calculateBill(d,c);let x=$.get(0,0,0,0).maxLevel,Y=we.getOldModeDate(),I=Ne.getPriceList(Y.subtract(1,"day")),U=Ne.getPriceList(Y);var L=1;let O=!1;var B=[F,H,N],P=["Sessions","Soutenance","Coaching"],ie=[0,1,2,3],he=["R\xE9alis\xE9e","Annul\xE9e","Annul\xE9e tardivement","Etudiant(e) absent(e)"],ce=[Q,W,K],fe=["Autofinanc\xE9s","Financ\xE9s","Autres"];D=1,M=h.addPage();let ge=["","Quand","Qui","Nb","Pu","Cumul"],te=[0,18,50,3,5,7],ne=[y[0],s(y[1]),s(y[2]),s(y[3]),s(y[4]),s(y[5])],pe="";for(_iSessionType=0,_iSessionTypeLength=B.length;_iSessionType<_iSessionTypeLength;_iSessionType+=1){for(;L<=x;){for([D,M]=We.changePgIfNeeded(m,v,D,h),m=f-A*g*D,_iSessionQuality=0,_iSessionQualityLength=ie.length;_iSessionQuality<_iSessionQualityLength;_iSessionQuality+=1)for(_iFunding=0,_iFundingLength=ce.length;_iFunding<_iFundingLength;_iFunding+=1){if(_i0=$.get(B[_iSessionType],ie[_iSessionQuality],ce[_iFunding],L),typeof _i0=="undefined"&&O===!1)continue;_i0.data=_i0.data.reverse();let ee=G;if(pe=`${P[_iSessionType]} de Niveau ${L} Etudiants ${fe[_iFunding]}`,M.moveTo(ee,m),M.drawText(pe,{font:i,size:g+4,y:m,x:ee,lineHeight:j}),ee+=15,D+=1,[D,M]=We.changePgIfNeeded(m,v,D,h),m=f-A*g*D,M.moveTo(ee,m),M.drawText(he[_iSessionQuality],{font:i,size:g+2,y:m,x:ee,lineHeight:j}),ee+=15,D+=1,[D,M]=We.changePgIfNeeded(m,v,D,h),m=f-A*g*D,typeof _i0=="undefined"){M.drawText(`d\xE9sol\xE9 pas de r\xE9sultat pour cette section au niveau de facturation (${L})`,{font:i,size:g,y:m,x:ee,lineHeight:j}),D+=1,[D,M]=We.changePgIfNeeded(m,v,D,h),m=f-A*g*D;continue}let q=ee,le=0;M.moveTo(ee,m);for(let _e=1;_e<ge.length;_e+=1)M.drawText(ge[_e],{font:i,size:g+2,y:m,x:q,lineHeight:j}),q+=ne[_e];D+=1,[D,M]=We.changePgIfNeeded(m,v,D,h),m=f-A*g*D,q=ee;for(var se=0,oe=_i0.data.length;se<oe;se+=1)q=ee,M.drawText(dayjs(_i0.data[se].when).format("DD/MM/YYYY \xE0 HH:mm"),{font:i,size:g,y:m,x:q,lineHeight:j}),q+=ne[1],M.drawText(_i0.data[se].who_name.trim().slice(0,te[1]),{font:i,size:g,y:m,x:q,lineHeight:j}),q+=ne[2],M.drawText((se+1).toString(),{font:i,size:g,y:m,x:q,lineHeight:j}),q+=ne[3],we.isInOldMode(dayjs(_i0.data[se].when))?iPu=+_i0.data[se].lvl>0?I[L][B[_iSessionType]][ie[_iSessionQuality]][ce[_iFunding]]:0:iPu=+_i0.data[se].lvl>0?U[L][B[_iSessionType]][ie[_iSessionQuality]][ce[_iFunding]]:0,M.drawText(iPu.toString(),{font:i,size:g,y:m,x:q,lineHeight:j}),q+=ne[4],le+=iPu,M.drawText(le.toString(),{font:i,size:g,y:m,x:q,lineHeight:j}),D+=1,[D,M]=We.changePgIfNeeded(m,v,D,h),m=f-A*g*D}L+=1,D+=1,[D,M]=We.changePgIfNeeded(m,v,D,h),m=f-A*g*D}L=1}We.addFooter(h,`G\xE9n\xE9r\xE9 avec Facturier version ${we.getAppVersion()}`);let re=await h.save();download(re,`prestations_facturees_detail_${d.format("YYYYMMDD")}-${c.format("YYYYMMDD")}.pdf`,"application/pdf")}l()},cn=async function(){GM_addStyle('.formgrid{font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", Helvetica, Arial, sans-serif;}'),GM_addStyle(".swal2-styled[type=button]{background-color:#3085d6;border-radius:.75em;color:#fff;font-size:1.0625em;border-left-color:#3085d6;border-right-color:#3085d6;display:inline-block}.formgrid{display:grid;grid-template-columns:1fr 1em 1fr;grid-gap:.3em .6em;grid-auto-flow:dense;align-items:center}input,output,textarea,select,button{grid-column:2 / 4;width:auto;margin:0}legend{font-size:1.2em;width:100%;border-bottom:1px dotted #99c}fieldset{max-width:40em;padding:4px;margin:2em auto;border:0 none}");let p="";p+="<legend>Que voulez vous faire ?</legend>",p+="<fieldset>",p+='<div class="formgrid">',p+='Epurer<button id="answer1" data-action="raz" class="swal2-styled" type="button">RAZ</button>',p+='Sauvegarder toute la base<button id="answer2" data-action="export" class="swal2-styled" type="button">Sauvegarder</button>',p+='Charger toute la base<button id="answer3" data-action="import" class="swal2-styled" type="button">Charger</button>',p+=`Exporter les tables
    <button class="swal2-styled" type="button"
    	hx-get="/views/test-swal-sauvegarde"
		hx-select="body"
        hx-target="#sttPlaceHolder"
        hx-include="[name='email']"
        hx-swap="innerHTML"> Exporter
    </button>
		`,p+="</fieldset>",p+="</div>";let{value:o}=await Swal.fire({title:"Gestion de la base de donn\xE9e",html:p,focusConfirm:!1,preConfirm:()=>[document.getElementById("answer1").value,document.getElementById("answer2").value],didOpen:n=>{console.log("%conOpen popup","color:coral"),htmx.process(document.querySelector(".swal2-container")),console.log("%cHtmx Process done","color:coral"),n.querySelector(".formgrid").addEventListener("click",_handler=function(a){let e=function(d){d.target.matches('button[data-action="raz"]')&&(Swal.close(),Ln())},t=function(d){d.target.matches('button[data-action="export"]')&&(Swal.close(),jn())},l=function(d){d.target.matches('button[data-action="import"]')&&(Swal.close(),On())};e(a),t(a),l(a)})},onClose:n=>{n.querySelector(".formgrid").removeEventListener("click",_handler),console.log("%conClose popup","color:coral")}});o&&Swal.fire(JSON.stringify(o))},jn=async function(){let p=nt.save();console.log(`%cWanna save : ${p}`,k);let o=dayjs(),n="";n+=`<a id="download" href="data:text/plain;charset=utf-8,${encodeURIComponent(p)}" download="save_${o.format("YYYYMMDD")}.json">save_${o.format("YYYYMMDD")}.json</a>`,Swal.fire({title:"Sauvegarde de la base de donn\xE9e",html:n,focusConfirm:!1,onOpen:a=>{a.querySelector("#download").click()},onClose:a=>{}})};var On=async function(){console.log("%cWanna load DATABASE",k);let{value:p}=await Swal.fire({title:"Selection de la sauvegarde (json)",input:"file",inputAttributes:{accept:".json","aria-label":"Upload your database"}});if(p){let o=new FileReader;o.onload=n=>{nt.import(n.target.result),wt(),xt("Chargement de la base termin\xE9")},o.readAsText(p)}},Ln=async function(){GM_addStyle(".form_addon {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}"),GM_addStyle(".form_addon input {background: #fff;border: 1px solid #9c9c9c;}"),GM_addStyle(".form_addon button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}"),GM_addStyle(".form_addon button:hover {background: gold;}"),GM_addStyle(".form_addon label {padding: 0.5em 0.5em 0.5em 0;}"),GM_addStyle(".form_addon input {padding: 0.7em;margin-bottom: 0.5rem;}"),GM_addStyle(".form_addon input:focus {outline: 3px solid gold;}"),GM_addStyle("@media (min-width: 400px) {.form_addon {grid-template-columns: 200px 1fr;grid-gap: 16px;} .form_addon label {text-align: right;grid-column: 1 / 2;} .form_addon input, .form_addon button {grid-column: 2 / 3;}}");var p="";p+='<form id="RAZ" class="form_addon" action="">',p+='<label for="students" class="cbox">Etudiants</label>',p+='<input id="students" type="checkbox" value="del_students_true" checked>',p+='<label for="sessions" class="cbox">Sessions</label>',p+='<input id="sessions" type="checkbox" value="del_sessions_true" checked>',p+='<label for="archives" class="cbox">Archives : factures</label>',p+='<input id="archives" type="checkbox" value="del_archives_true" checked>',p+='<label for="history_cache" class="cbox">Signet historique</label>',p+='<input id="history_cache" type="checkbox" value="del_history_cache_true" checked>',p+='<label for="radio1">filtrer la date</label>',p+='<input type="radio" id="radio1" name="date_filter" value="false" checked>',p+='<label for="radio2">ne pas filtrer</label>',p+='<input type="radio" id="radio2" name="date_filter" value="true">',p+='<label for="dtFrom" class="date">Date de d\xE9but</label>',p+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',p+='<label for="dtTo" class="date">Date de fin</label>',p+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',p+="<!-- Switch -->",p+='<input type="checkbox" class="switch" name="s1" id="s1">',p+='<label for="s1">Switch</label>',p+="</form>";let{value:o}=await Swal.fire({title:"<strong>RAZ des donn\xE9es</strong>",icon:"info",html:p,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez ce que vous allez supprimer de la base de donn\xE9e",preConfirm:()=>{let c=document.getElementsByName("date_filter"),u="notfound";for(var h in c)c[h].checked===!0&&(u=c[h].value);return console.log(document.getElementById("s1")),[document.getElementById("students").checked,document.getElementById("sessions").checked,document.getElementById("archives").checked,document.getElementById("history_cache").checked,document.getElementById("dtFrom").disabled===!0?null:document.getElementById("dtFrom").value,document.getElementById("dtTo").disabled===!0?null:document.getElementById("dtTo").value,u]},onOpen:c=>{c.querySelector("#radio1").addEventListener("change",function(){console.log(document.getElementById("radio1").checked);let u=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!u,document.getElementById("dtTo").disabled=!u}),c.querySelector("#radio2").addEventListener("change",function(){let u=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!u,document.getElementById("dtTo").disabled=!u}),c.querySelector("#dtFrom").addEventListener("change",function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:c=>{c.querySelector("#radio1").removeEventListener("change"),c.querySelector("#radio2").removeEventListener("change"),c.querySelector("#dtFrom").removeEventListener("change")}}),n=o[0],a=o[1],e=o[2],t=o[3];console.log(`%cWanna raz students ? ${n}, wanna raz sessions ? ${a}, wanna raz archives ? ${e}`,k);let l=o[4]?dayjs(o[4]):null,d=o[5]?dayjs(o[5]):null;n===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des \xE9tudiants",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),Ce.delete(l,d)),a===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des sessions",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),Ae.delete(l,d),wt()),e===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des archives (financi\xE8res)",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),et.delete(l,d)),t===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base du cache des historique de session",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),ut.delete(l,d))};var fn=async function(){var p="";p+="<style>",p+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",p+="form input {background: #fff;border: 1px solid #9c9c9c;}",p+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",p+="form button:hover {background: gold;}",p+="form label {padding: 0.5em 0.5em 0.5em 0;}",p+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",p+="form input:focus {outline: 3px solid gold;}",p+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",p+="</style>",p+='<form class="form1" action="">',p+='<label for="dd" class="date">Date de d\xE9but</label>',p+='<input id="dd" type="date" max="2030-12-31" min="2010-12-31">',p+='<label for="df" class="date">Date de fin</label>',p+='<input id="df" type="date" max="2030-12-31" min="2010-12-31">',p+="</form>";var[o,n]=await dt(dayjs().startOf("month"),dayjs().endOf("month")),a=await Ne.calculateBill(o,n);we.isInOldMode(o)?Pn(o,n,a):Rn(o,n,a)};var Pn=function(p,o,n){let a=n.get(0,0,0,0),e=4;var t="",l=null,d=0,c=0,u=0,h=[[4,"Groupe"],[1,"Niveau 1"],[2,"Niveau 2"],[3,"Niveau 3"]],i=0,w=0,T=!1,f=0,b=0,g=0,A=0,M=0,D=0,S=0,v=0,m=0,s=0,y=0,C=0,j=0,G=0,$=0,E=0,x=0,Y=0,I=1;n.toConsole(),t+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",t+='<div class="wrapper">',t+="<table>",t+="<thead>",t+="<tr>",t+='<th>Type</th><th><abbr title="nombre">nb</abbr></th><th>PU(<abbr title="hors taxes">HT</abbr>)</th><th>Total(<abbr title="hors taxes">HT</abbr>)</th>',t+="</tr>",t+="</thead>",t+="<tbody>",t+="<tr>",t+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Mentorat</th>',t+="</tr>";for(var i=performance.now();I<=e;)_i0=n.get(F,J,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(F,J,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(F,J,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : r\xE9alis\xE9es</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(F,Z,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(F,Z,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(F,Z,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : annul\xE9es</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(F,V,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(F,V,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(F,V,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : annul\xE9es tard.</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(F,X,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(F,X,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(F,X,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : \xE9tudiant abs.</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),I+=1;var w=performance.now();console.log("%cCalculate first array"+(w-i)+" milliseconds.",Re),t+="<tr>",t+="<td>Total</td>",t+=`<td>${d}</td><td></td><td>${c}\u20AC</td>`,t+="</tr>",t+="<tr>",t+="</tr>",u+=c,d=0,c=0,t+="<tr>",t+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',t+="</tr>",I=1;for(var i=performance.now();I<=e;)_i0=n.get(H,J,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(H,J,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(H,J,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : r\xE9alis\xE9es</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(H,Z,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(H,Z,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(H,Z,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : annul\xE9es</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(H,V,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(H,V,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(H,V,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : annul\xE9es tard.</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(H,X,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(H,X,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(H,X,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : \xE9tudiant abs.</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),I+=1;var w=performance.now();console.log("%cCalculate second array"+(w-i)+" milliseconds.",Re),t+="<tr>",t+="<td>Total</td>",t+=`<td>${d}</td><td></td><td>${c}\u20AC</td>`,t+="</tr>",t+="<tr>",t+="</tr>",u+=c,d=0,c=0,t+="<tr>",t+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',t+="</tr>",I=1;for(var i=performance.now();I<=e;)_i0=n.get(N,J,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(N,J,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(N,J,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : r\xE9alis\xE9es</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(N,Z,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(N,Z,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(N,Z,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : annul\xE9es</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(N,V,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(N,V,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(N,V,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : annul\xE9es tard.</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),_i0=n.get(N,X,Q,I),s=_i0===void 0?0:_i0.number,E=_i0===void 0?0:_i0.amount,_i0=n.get(N,X,W,I),y=_i0===void 0?0:_i0.number,x=_i0===void 0?0:_i0.amount,_i0=n.get(N,X,K,I),C=_i0===void 0?0:_i0.number,Y=_i0===void 0?0:_i0.amount,j=s>0?E/s:E,G=y>0?x/y:x,$=C>0?Y/C:Y,(T===!0||s+y+C>0)&&(d+=s,d+=y,d+=C,c+=E,c+=x,c+=Y,t+="<tr>",t+=`<td>Niveau ${I} : \xE9tudiant abs.</td>`,t+=`<td>${s+y+C}</td><td>${G}</td><td>${E+x+Y}\u20AC</td>`,t+="</tr>"),I+=1;var w=performance.now();console.log("%cCalculate third array"+(w-i)+" milliseconds.",Re),t+="<tr>",t+="<td>Total</td>",t+=`<td>${d}</td><td></td><td>${c}\u20AC</td>`,t+="</tr>",t+="<tr>",t+="</tr>",u+=c,t+="<tr>",t+='<th colspan="4" class="pseudoheader" scope="colgroup">Total G\xE9n\xE9ral</th>',t+="</tr>",t+=`<td colspan="3"></td><td>${u}\u20AC</td>`,t+="</tr>",t+="<tr>",t+="</tr>",t+="</tbody>",t+="<tfoot>",t+="</tfoot>",t+="</table>",t+=`<p>Soit un total g\xE9n\xE9ral \xE0 facturer de ${u}\u20AC`,Swal.fire({title:`<strong>Liste des formations tarif\xE9es du ${p.format("DD/MM/YYYY")} au ${o.format("DD/MM/YYYY")}</strong>`,html:t,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},Rn=function(p,o,n){console.log("%cEnter computation bill",k);let a=!1;var e="",t=0,l=0,d=0,c=0,u=0,h=0,i=0,w=0,T=0,f=0,b=0,g=0;let A=n.get(0,0,0,0),M=A.maxLevel;var D=0,S=0,v=0,m=0,s=0,y=0,C=0,j=0,G=0,$=0,E=0,x=0,Y=0,I=0,U=0,L=0,O=0,B=0,P=1;e+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",e+='<div class="wrapper">',e+="<table>",e+="<thead>",e+="<tr>",e+='<th rowspan="2">Type</th><th colspan="3" scope="colgroup">Auto Financ\xE9s</th><th colspan="3" scope="colgroup">Financ\xE9s</th><th colspan="3" scope="colgroup">Autres</th><th colspan="2" scope="colgroup">Total</th>',e+="</tr>",e+="<tr>",e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+="</tr>",e+="</thead>",e+="<tbody>",e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de mentorat</th>',e+="</tr>";for(var ie=performance.now();P<=M;)_i0=n.get(F,J,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(F,J,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(F,J,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : r\xE9alis\xE9es</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(F,Z,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(F,Z,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(F,Z,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : annul\xE9es</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(F,V,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(F,V,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(F,V,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : annul\xE9es tard.</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(F,X,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(F,X,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(F,X,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : \xE9tud. absent</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),P+=1;var he=performance.now();for(console.log("%cCalculate first array"+(he-ie)+" milliseconds.",Re),e+="<tr>",e+="<td>Total</td>",e+=`<td>${t}</td><td></td><td>${c}\u20AC</td>`,e+=`<td>${l}</td><td></td><td>${u}\u20AC</td>`,e+=`<td>${d}</td><td></td><td>${h}\u20AC</td>`,e+=`<td>${t+l+d}</td><td>${c+u+h}\u20AC</td>`,e+="</tr>",e+="<tr>",e+="</tr>",i+=t,w+=l,T+=d,f+=c,b+=u,g+=h,t=0,l=0,d=0,c=0,u=0,h=0,e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',e+="</tr>",P=1;P<=M;)_i0=n.get(H,J,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(H,J,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(H,J,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : r\xE9alis\xE9es</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(H,Z,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(H,Z,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(H,Z,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : annul\xE9es</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(H,V,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(H,V,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(H,V,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : annul\xE9es tard.</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(H,X,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(H,X,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(H,X,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : \xE9tud. absent</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),P+=1;e+="<tr>",e+="<td>Total</td>",e+=`<td>${t}</td><td></td><td>${c}\u20AC</td>`,e+=`<td>${l}</td><td></td><td>${u}\u20AC</td>`,e+=`<td>${d}</td><td></td><td>${h}\u20AC</td>`,e+=`<td>${t+l+d}</td><td>${c+u+h}\u20AC</td>`,e+="</tr>",e+="<tr>",e+="</tr>",i+=t,w+=l,T+=d,f+=c,b+=u,g+=h,t=0,l=0,d=0,c=0,u=0,h=0,e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',e+="</tr>";for(var P=1;P<=M;)_i0=n.get(N,J,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(N,J,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(N,J,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : r\xE9alis\xE9es</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(N,Z,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(N,Z,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(N,Z,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : annul\xE9es</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(N,V,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(N,V,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(N,V,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : annul\xE9es tard.</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),_i0=n.get(N,X,Q,P),$=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=n.get(N,X,W,P),E=_i0===void 0?0:_i0.number,O=_i0===void 0?0:_i0.amount,_i0=n.get(N,X,K,P),x=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,Y=$>0?L/$:L,I=E>0?O/E:O,U=x>0?B/x:B,(a===!0||$+E+x>0)&&(t+=$,l+=E,d+=x,c+=L,u+=O,h+=B,e+="<tr>",e+=`<td>Niveau ${P} : \xE9tud. absent</td>`,e+=`<td>${$}</td><td>${Y}</td><td>${L}\u20AC</td>`,e+=`<td>${E}</td><td>${I}</td><td>${O}\u20AC</td>`,e+=`<td>${x}</td><td>${U}</td><td>${B}\u20AC</td>`,e+=`<td>${$+E+x}</td><td>${L+O+B}\u20AC</td>`,e+="</tr>"),P+=1;i+=t,w+=l,T+=d,f+=c,b+=u,g+=h,e+="<tr>",e+="<td>Total</td>",e+=`<td>${t}</td><td></td><td>${c}\u20AC</td>`,e+=`<td>${l}</td><td></td><td>${u}\u20AC</td>`,e+=`<td>${d}</td><td></td><td>${h}\u20AC</td>`,e+=`<td>${t+l+d}</td><td>${c+u+h}\u20AC</td>`,e+="</tr>",e+="<tr>",e+="</tr>",e+="</tbody>",e+="<tfoot>",e+="</tfoot>",e+="</table>";var ce=0,fe="";let ge=A.flatFee.length;for(var te=0;te<ge;te+=1)ce+=30,fe+=A.flatFee[te].who_name+", ";ge>1?e+=`<p class="flat_fee">Calcul du forfait "autofinanc\xE9". Ce mois ci ${ge} \xE9tudiants ont eu au moins une session il s'agit de : ${fe.slice(0,-1)}`:e+=`<p class="flat_fee">Calcul du forfait "autofinanc\xE9". Ce mois ci ${ge} \xE9tudiant a eu au moins une session il s'agit de : ${fe.slice(0,-1)}`,e+=`. Le forfait est donc de ${ce}\u20AC</p>`,e+=`<p>Soit un total g\xE9n\xE9ral \xE0 facturer de ${f+b+g+ce}\u20AC</p>`,Swal.fire({title:`<strong>Liste des formations tarif\xE9es du ${p.format("DD/MM/YYYY")} au ${o.format("DD/MM/YYYY")}</strong>`,html:e,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},pn=async function(){var[p,o]=await dt(dayjs().startOf("month"),dayjs().endOf("month"),!1);if(p===null||o===null)throw console.log("%cError need date from, date to",ue),new Error;let n=Et.getListStatistic(p,o),a="",e=new Array(22),t=Array.apply(null,Array(22)).map(Number.prototype.valueOf,0),l=p.clone(),d=l.endOf("month"),c="";e[0]="<thead><tr><th>Sessions</th>",e[1]="<tbody><tr><td>Sessions</td>",e[2]='<tr class="header"><td>Montant</td>',e[3]="<tr><td>Nb.",e[4]="<tr><td>Pu",e[5]='<tr class="header"><td>Soutenances</td>',e[6]="<tr><td>Montant</td>",e[7]="<tr><td>Nb.",e[8]="<tr><td>Pu",e[9]='<tr class="header"><td>Coaching</td>',e[10]="<tr><td>Montant</td>",e[11]="<tr><td>Nb.",e[12]="<tr><td>Pu",e[13]='<tr class="header"><td>Bonus</td>',e[14]="<tr><td>Bonus AF</td>",e[15]="<tr><td>Total G\xE9n\xE9ral</td>",e[16]='<tr class="header"><td>KPI</td>',e[17]="<tr><td>NbJrs</td>",e[18]="<tr><td>TJM</td>",e[19]="<tr><td>Nb hrs</td>",e[20]="<tr><td>THM</td>",e[21]="<tr><td>Nb hrs (p.)</td>",e[22]="<tr><td>THM (p)</td>";for(var u=0;u<n.length;u+=1){t[2]+=n[u].sessions.total,t[3]+=n[u].sessions.nb-n[u].sessions.nbc,t[4]+=n[u].sessions.pu,t[6]+=n[u].defenses.total,t[7]+=n[u].defenses.nb-n[u].defenses.nbc,t[8]+=n[u].defenses.pu,t[10]+=n[u].coaches.total,t[11]+=n[u].coaches.nb-n[u].coaches.nbc,t[12]+=n[u].coaches.pu,t[14]+=n[u].bonus;let h=n[u].sessions.total+n[u].defenses.total+n[u].coaches.total+n[u].bonus;t[15]+=h,t[16]+=n[u].kpi.jrs,t[18]+=n[u].kpi.hrs,t[20]+=n[u].kpi.hrsp,n.length==1&&(c="</tr>"),u===n.length-1&&n.length>1?d.isAfter(o,"day")?(t[2]-=n[u].sessions.total,t[3]-=n[u].sessions.nb-n[u].sessions.nbc,t[4]-=n[u].sessions.pu,t[6]-=n[u].defenses.total,t[7]-=n[u].defenses.nb-n[u].defenses.nbc,t[8]-=n[u].defenses.pu,t[10]-=n[u].coaches.total,t[11]-=n[u].coaches.nb-n[u].coaches.nbc,t[12]-=n[u].coaches.pu,t[14]-=n[u].bonus,t[15]-=h,t[16]-=n[u].kpi.jrs,t[18]-=n[u].kpi.hrs,t[20]-=n[u].kpi.hrsp,e[0]+=`<td>Total(moy)</td><td>${dayjs(n[u].header.dtTo).format("MMMM")}</td></thead></tr>`,e[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[2]+=`<td>${t[2]} (${(t[2]/(n.length-1)).toFixed(2)})</td><td>${n[u].sessions.total}</td></tr>`,e[3]+=`<td>${t[3]} (${(t[3]/(n.length-1)).toFixed(2)})</td><td>${n[u].sessions.nb} (${n[u].sessions.nbc})</td></tr>`,e[4]+=`<td> n/a (${(t[4]/(n.length-1)).toFixed(2)})</td><td>${n[u].sessions.pu.toFixed(2)}</td></tr>`,e[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[6]+=`<td>${t[6]} (${(t[6]/(n.length-1)).toFixed(2)})</td><td>${n[u].defenses.total}</td></tr>`,e[7]+=`<td>${t[7]} (${(t[7]/(n.length-1)).toFixed(2)})</td><td>${n[u].defenses.nb} (${n[u].defenses.nbc})</td></tr>`,e[8]+=`<td> n/a (${(t[8]/(n.length-1)).toFixed(2)})</td><td>${n[u].defenses.pu.toFixed(2)}</td></tr>`,e[9]+=`<td>&nbsp;</td>${c}`,e[10]+=`<td>${t[10]} (${(t[10]/(n.length-1)).toFixed(2)})</td><td>${n[u].coaches.total}</td></tr>`,e[11]+=`<td>${t[11]} (${(t[11]/(n.length-1)).toFixed(2)})</td><td>${n[u].coaches.nb} (${n[u].coaches.nbc})</td></tr>`,e[12]+=`<td> n/a (${(t[12]/(n.length-1)).toFixed(2)})</td><td>${n[u].coaches.pu.toFixed(2)}</td></tr>`,e[13]+="<td>&nbsp;</td></tr>",e[14]+=`<td>${t[14]} (${(t[14]/(n.length-1)).toFixed(2)})</td><td>${n[u].bonus}</td></tr>`,e[15]+=`<td>${t[15]} (${(t[15]/(n.length-1)).toFixed(2)})</td><td>${h}</td></tr>`,e[16]+="<td>&nbsp;</td></tr>",e[17]+=`<td>${t[16]} (${(t[16]/(n.length-1)).toFixed(2)})</td><td>${n[u].kpi.jrs}</td></tr>`,e[18]+=`<td> n/a (${(t[15]/t[16]).toFixed(2)})</td><td>${(h/n[u].kpi.jrs).toFixed(2)}</td></tr>`,e[19]+=`<td>${t[18]} (${(t[18]/(n.length-1)).toFixed(2)})</td><td>${n[u].kpi.hrs.toFixed(2)}</td></tr>`,e[20]+=`<td> n/a  (${(t[15]/t[18]).toFixed(2)})</td><td>${(h/n[u].kpi.hrs).toFixed(2)}</td></tr>`,e[21]+=`<td>${t[20].toFixed(2)} (${(t[20]/(n.length-1)).toFixed(2)})</td><td>${n[u].kpi.hrsp.toFixed(2)}</td></tr>`,e[22]+=`<td> n/a  (${(t[15]/t[20]).toFixed(2)})</td><td>${(h/n[u].kpi.hrsp).toFixed(2)}</td></tr>`):(e[0]+=`<td>${dayjs(n[u].header.dtTo).format("MMMM")}</td><td>Tot.</td></thead></tr>`,e[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[2]+=`<td>${n[u].sessions.total}</td><td>${t[2]} (${(t[2]/n.length).toFixed(2)})</td></tr>`,e[3]+=`<td>${n[u].sessions.nb} (${n[u].sessions.nbc})</td><td>${t[3]} (${(t[3]/n.length).toFixed(2)})</td></tr>`,e[4]+=`<td>${n[u].sessions.pu.toFixed(2)}</td><td> n/a (${(t[4]/n.length).toFixed(2)})</td></tr>`,e[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[6]+=`<td>${n[u].defenses.total}</td><td>${t[6]} (${(t[6]/n.length).toFixed(2)})</td></tr>`,e[7]+=`<td>${n[u].defenses.nb} (${n[u].defenses.nbc})</td><td>${t[7]} (${(t[7]/n.length).toFixed(2)})</td></tr>`,e[8]+=`<td>${n[u].defenses.pu.toFixed(2)}</td><td> n/a (${(t[8]/n.length).toFixed(2)})</td></tr>`,e[9]+=`<td>&nbsp;</td>${c}`,e[10]+=`<td>${n[u].coaches.total}</td><td>${t[10]} (${(t[10]/n.length).toFixed(2)})</td></tr>`,e[11]+=`<td>${n[u].coaches.nb} (${n[u].coaches.nbc})</td><td>${t[11]} (${(t[11]/n.length).toFixed(2)})</td></tr>`,e[12]+=`<td>${n[u].coaches.pu.toFixed(2)}</td><td> n/a (${(t[12]/n.length).toFixed(2)})</td></tr>`,e[13]+="<td>&nbsp;</td></tr>",e[14]+=`<td>${n[u].bonus}</td><td>${t[14]} (${(t[14]/n.length).toFixed(2)})</td></tr>`,e[15]+=`<td>${h}</td><td>${t[15]} (${(t[15]/n.length).toFixed(2)})</td></tr>`,e[16]+="<td>&nbsp;</td></tr>",e[17]+=`<td>${n[u].kpi.jrs}</td><td>${t[16]} (${(t[16]/n.length).toFixed(2)})</td></tr>`,e[18]+=`<td>${(h/n[u].kpi.jrs).toFixed(2)}</td><td> n/a (${(t[15]/t[16]).toFixed(2)})</td></tr>`,e[19]+=`<td>${n[u].kpi.hrs.toFixed(2)}</td><td>${t[18]} (${(t[18]/n.length).toFixed(2)})</td></tr>`,e[20]+=`<td>${(h/n[u].kpi.hrs).toFixed(2)}</td><td> n/a  (${(t[15]/t[18]).toFixed(2)})</td></tr>`,e[21]+=`<td>${n[u].kpi.hrsp.toFixed(2)}</td><td>${t[20].toFixed(2)} (${(t[20]/n.length).toFixed(2)})</td></tr>`,e[22]+=`<td>${(h/n[u].kpi.hrsp).toFixed(2)}</td><td> n/a  (${(t[15]/t[20]).toFixed(2)})</td></tr>`):(e[0]+=`<td>${dayjs(n[u].header.dtTo).format("MMMM")}</td>${c}`,e[1]+=`<td>&nbsp;</td>${c}`,e[2]+=`<td>${n[u].sessions.total}</td>${c}`,e[3]+=`<td>${n[u].sessions.nb} (${n[u].sessions.nbc})</td>${c}`,e[4]+=`<td>${n[u].sessions.pu.toFixed(2)}</td>${c}`,e[5]+=`<td>&nbsp;</td>${c}`,e[6]+=`<td>${n[u].defenses.total}</td>${c}`,e[7]+=`<td>${n[u].defenses.nb} (${n[u].defenses.nbc})</td>${c}`,e[8]+=`<td>${n[u].defenses.pu.toFixed(2)}</td>${c}`,e[9]+=`<td>&nbsp;</td>${c}`,e[10]+=`<td>${n[u].coaches.total}</td>${c}`,e[11]+=`<td>${n[u].coaches.nb} (${n[u].coaches.nbc})</td>${c}`,e[12]+=`<td>${n[u].coaches.pu.toFixed(2)}</td>${c}`,e[13]+=`<td>&nbsp;</td>${c}`,e[14]+=`<td>${n[u].bonus}</td>${c}`,e[15]+=`<td>${h}</td>${c}`,e[16]+=`<td>&nbsp;</td>${c}`,e[17]+=`<td>${n[u].kpi.jrs}</td>${c}`,e[18]+=`<td>${(h/n[u].kpi.jrs).toFixed(2)}</td>${c}`,e[19]+=`<td>${n[u].kpi.hrs.toFixed(2)}</td>${c}`,e[20]+=`<td>${(h/n[u].kpi.hrs).toFixed(2)}</td>${c}`,e[21]+=`<td>${n[u].kpi.hrsp.toFixed(2)}</td>${c}`,e[22]+=`<td>${(h/n[u].kpi.hrsp).toFixed(2)}</td>${c}`),l=l.add(1,"month"),d=l.endOf("month")}a="<table>"+e.join(" ")+`</tbody><tfoot><tr><td colspan=${n.length+1}>la valeur entre parenth\xE8se fait reference aux annul\xE9s</td></tr></tfoot></table>`,Swal.fire({title:`<strong>Statistiques du ${p.format("DD/MM/YYYY")} au ${o.format("DD/MM/YYYY")}</strong>`,icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:h=>{}})};var Ie=class{},At=Ie;R(At,"init",function(){console.log("%cin initUI",k),Ie.build();var o=new Draggabilly(".draggable",{handle:".handle"});GM_config.get("hackheaderzindex")===!0&&Ct.start("animation-target")}),R(At,"build",function(){console.log("%c in buildUI","background-color:green;color:white"),GM_addStyle(".flex > * { margin: 2px 1px; }"),GM_addStyle(".flex > :first-child { margin-left: 0; }"),GM_addStyle(".flex > :last-child { margin-right: 0; }"),GM_addStyle(".panel {display: flex; justify-content: center;z-index:999}"),GM_addStyle(".menuBar {border-top: 1px solid; padding: 10px; font-size: 1rem; pointer-events: inherit;position: relative;top:0px;  flex-flow: row wrap;/*align-content: space-between;justify-content: space-between;*/}"),GM_addStyle(".draggable {background: transparent;border-radius: 10px;padding: 20px;}"),GM_addStyle(".draggable.is-pointer-down {background: #09F;}"),GM_addStyle(".draggable.is-dragging { opacity: 0.7; }"),GM_addStyle(".handle {background: #555;background: hsla(0, 0%, 0%, 0.4);width: 20px;height: 20px; border-radius: 10px;}"),GM_addStyle(".flex > :nth-last-child(2) {page-break-after: always; /* CSS 2.1 syntax */break-after: always; /* New syntax */}"),GM_addStyle("#animation-target {width: 10px;height: 5px;background-color:coral;border-radius: 25%;}");var o=document.createElement("div"),n=document.createElement("div");n.classList.add("handle"),o.appendChild(n),o.classList.add("panel","menuBar","flex","draggable"),document.body.appendFirst(o),Ie.addButton("collectChecked",dn,{},o),Ie.addButton("CollectAuto",an,{},o),Ie.addButton("showBill",fn,{},o),Ie.addButton("billInDetails",sn,{},o),Ie.addButton("PDF",un,{},o),Ie.addButton("SList",Ce.showList,{},o),Ie.addButton("DbgMode",ln,{},o),Ie.addButton("statistics",pn,{},o),Ie.addButton("Database",cn,{},o),Ie.addButton("about",rn,{},o);let a=document.createElement("div"),e=a.style;a.id="sttPlaceHolder";let t={position:"absolute",bottom:"7%",left:"4%","z-index":999,display:"hidden"};if(document.body.insertAdjacentElement("beforeend",a),Object.keys(t).forEach(d=>e[d]=t[d]),GM_config.get("hackheaderzindex")===!0){var l=document.createElement("div");l.id="animation-target",o.appendChild(l)}}),R(At,"addButton",function(o,n,a,e){e=e||document.body,a=a||{position:"absolute",bottom:"7%",left:"4%","z-index":3};let t=document.createElement("button"),l=t.style;return t.classList.add("button--primary","button"),e.appendChild(t),t.innerHTML=o,t.onclick=n,Object.keys(a).forEach(d=>l[d]=a[d]),t});var Ct=class{};R(Ct,"start",function(o){let n=document.getElementById(o),a=c=>n.style.transform=`translateX(${c}px)`,e=0,t=7,l=c=>{a(e),e+=t,e>100?requestAnimationFrame(d):requestAnimationFrame(l)},d=c=>{a(e),e-=t,e<-100?requestAnimationFrame(l):requestAnimationFrame(d)};return requestAnimationFrame(l)}),R(Ct,"stop",function(o){window.cancelAnimationFrame(o)});var hn=At;var Fn="#OCAddonsCfg {background-color: lightblue;} #OCAddonsCfg .reset_holder {float: left; position: relative; bottom: -1em;} #OCAddonsCfg .saveclose_buttons {margin: .7em;}",Hn="height: 16.7em; width: 30em; border: 1px solid; border-radius: 3px; position: fixed; z-index: 999;";var mn={id:"OCAddonsCfg",title:"Configuration du module",fields:{userid:{section:["Application","param\xE8tres"],label:"Id utilisateur",title:"identifiant utilisateur oc",labelPos:"left",type:"input",default:0},nbHrsAfM:{section:["Statistiques","param\xE8tres"],label:"Nombre de minutes pour une session d'\xE9tudiant auto financ\xE9",title:"Dur\xE9e moyenne d'une session AF (calcul du THM)",labelPos:"left",type:"input",default:30},nbHrsfM:{label:"Nombre de minutes pour une session d'\xE9tudiant financ\xE9",title:"Dur\xE9e moyenne d'une session Financ\xE9e (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsS:{label:"Nombre de minutes pour une session (avant 01/07/2020)",title:"Dur\xE9e moyenne d'une session avant la s\xE9paration auto financ\xE9 | financ\xE9 (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsD:{label:"Nombre de minutes pour une session de soutenance",title:"Dur\xE9e moyenne d'une sessionde soutenance AF (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsC:{label:"Nombre de minutes pour une session de coaching",title:"Dur\xE9e moyenne d'une session de coachine (calcul du THM)",labelPos:"left",type:"input",default:45},maxfetchpg:{section:["Application","optimisation"],label:"Maximum de page recherch\xE9es dans l'historique",labelPos:"left",type:"input",default:1e3},datacachelifetime:{label:"Temps de conservation des donn\xE9es dans le cache (en ms)",labelPos:"left",type:"input",default:12e4},checksessionalreadyexists:{section:["Application","Base de donn\xE9e"],label:"sessions: v\xE9rifier existence avant insertion",labelPos:"left",type:"checkbox",default:!0},sizeofcontentlist:{section:["Interface","th\xE8me"],label:"taille de la police des listes",labelPos:"left",type:"input",default:"1em;"},use_custom_css:{label:"utiliser des styles personnalis\xE9s",labelPos:"left",type:"checkbox",default:!1},custom_css_url:{label:"url de la feuille de style (si plusieurs les s\xE9parer par des virgules)",labelPos:"left",type:"input",default:""},custom_css_data:{label:"saisir ici le code css \xE0 injecter directement dans la page",title:"Je me demande bien \xE0 quoi sert le titre",labelPos:"left",type:"input",default:""},alwaysaddcbox:{section:["Interface","Gadget"],label:"Toujours ajouter les checkbox sur l'interface",labelPos:"left",type:"checkbox",default:!0},show_throttle:{label:"Afficher le temoin d'utilisation du CPU",title:"Affiche le point rouge qui circule dans la barre de menu. Quand il s'arr\xEAte le CPU est utilis\xE9",labelPos:"left",type:"checkbox",default:!0},hackheaderzindex:{section:["","Hack"],label:"Changer le zindex du bandeau haut",title:"le bandeau haut \xE0 un z-index  (1000) qui le place au dessus de tout ce qui est pr\xE9sent \xE0 l'\xE9cran, ce qui g\xEAne la barre de menu ; activer cette option r\xE9duit ce chiffre \xE0 0",labelPos:"left",type:"checkbox",default:!0},support:{section:["","Support"],label:"StephaneTy-Pro.github.io",title:"more info on https://github.com/StephaneTy-Pro",type:"button",click:()=>{GM_openInTab("https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon",{active:!0,insert:!0,setParent:!0})}}},css:Fn,events:{save:function(){GM_config.close()}}},gn=function(){GM_config.open(),OCAddonsCfg.style=Hn};var Mt=class{};R(Mt,"longTaskTiming",function(){if(window.self===window.top){console.log("LongTasks: Initializing");var o=new window.PerformanceObserver(function(n){for(var a=n.getEntries(),e=0;e<a.length;e++)console.log("LongTasks: ",a[e].name,a[e].duration,a[e].attribution.length,a[e].attribution.length>0?a[e].attribution[0].containerType:null,a[e].attribution.length>0?a[e].attribution[0].containerName:null,a[e].attribution.length>0?a[e].attribution[0].containerSrc:null,a[e].attribution.length>0?a[e].attribution[0].containerId:null,a[e])});typeof window.PerformanceLongTaskTiming!="undefined"?console.log("LongTasks: Appears to be supported"):console.log("LongTasks: Not supported");try{o.observe({entryTypes:["longtask"]})}catch(n){console.log("LongTasks: Not supported")}}}),R(Mt,"paintTiming",function(){if(window.self===window.top){console.log("PaintTiming: Initializing");var o=new window.PerformanceObserver(function(n){for(var a=n.getEntries(),e=0;e<a.length;e++)console.log("PaintTiming: ",a[e].name,a[e].startTime)});if(typeof window.PerformancePaintTiming!="undefined")console.log("PaintTiming: Appears to be supported");else{console.log("PaintTiming: Not supported");return}try{o.observe({entryTypes:["paint"],buffered:!0})}catch(n){console.log("PaintTiming: Not supported")}}});var Rt=Mt;var Ft=function(p,o,n,a,e,t,l){t=o.createElement(n),l=o.getElementsByTagName(n)[0],t.appendChild(o.createTextNode(a.text)),t.onload=e(a),l?l.parentNode.insertBefore(t,l):o.head.appendChild(t)};var Nn=function(p,o){if(!arguments.length)return Promise.reject(new ReferenceError("Failed to execute 'fetchInject': 1 argument required but only 0 present."));if(arguments[0]&&arguments[0].constructor!==Array)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 1 must be of type 'Array'."));if(arguments[1]&&arguments[1].constructor!==Promise)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 2 must be of type 'Promise'."));let n=[],a=o?[].concat(o):[],e=[];return p.forEach(t=>a.push(window.fetch(t).then(l=>[l.clone().text(),l.blob()]).then(l=>Promise.all(l).then(d=>{n.push({text:d[0],blob:d[1]})})))),Promise.all(a).then(()=>(n.forEach(t=>{e.push({then:l=>{t.blob.type.includes("text/css")?Ft(window,document,"style",t,l):Ft(window,document,"script",t,l)}})}),Promise.all(e)))},ot=Nn;var Ei=function(p,o,n){"use strict";if(!p.MutationObserver||typeof HTMLElement=="undefined")return;var a=0,e=function(){var f=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(b,g){return b instanceof HTMLElement&&f.call(b,g)},addMethod:function(b,g,A){var M=b[g];b[g]=function(){if(A.length==arguments.length)return A.apply(this,arguments);if(typeof M=="function")return M.apply(this,arguments)}},callCallbacks:function(b,g){g&&g.options.onceOnly&&g.firedElems.length==1&&(b=[b[0]]);for(var A=0,M;M=b[A];A++)M&&M.callback&&M.callback.call(M.elem,M.elem);g&&g.options.onceOnly&&g.firedElems.length==1&&g.me.unbindEventWithSelectorAndCallback.call(g.target,g.selector,g.callback)},checkChildNodesRecursively:function(b,g,A,M){for(var D=0,S;S=b[D];D++)A(S,g,M)&&M.push({callback:g.callback,elem:S}),S.childNodes.length>0&&e.checkChildNodesRecursively(S.childNodes,g,A,M)},mergeArrays:function(b,g){var A={},M;for(M in b)b.hasOwnProperty(M)&&(A[M]=b[M]);for(M in g)g.hasOwnProperty(M)&&(A[M]=g[M]);return A},toElementsArray:function(b){return typeof b!="undefined"&&(typeof b.length!="number"||b===p)&&(b=[b]),b}}}(),t=function(){var f=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return f.prototype.addEvent=function(b,g,A,M){var D={target:b,selector:g,options:A,callback:M,firedElems:[]};return this._beforeAdding&&this._beforeAdding(D),this._eventsBucket.push(D),D},f.prototype.removeEvent=function(b){for(var g=this._eventsBucket.length-1,A;A=this._eventsBucket[g];g--)if(b(A)){this._beforeRemoving&&this._beforeRemoving(A);var M=this._eventsBucket.splice(g,1);M&&M.length&&(M[0].callback=null)}},f.prototype.beforeAdding=function(b){this._beforeAdding=b},f.prototype.beforeRemoving=function(b){this._beforeRemoving=b},f}(),l=function(f,b){var g=new t,A=this,M={fireOnAttributesModification:!1};return g.beforeAdding(function(D){var S=D.target,v;(S===p.document||S===p)&&(S=document.getElementsByTagName("html")[0]),v=new MutationObserver(function(s){b.call(this,s,D)});var m=f(D.options);v.observe(S,m),D.observer=v,D.me=A}),g.beforeRemoving(function(D){D.observer.disconnect()}),this.bindEvent=function(D,S,v){S=e.mergeArrays(M,S);for(var m=e.toElementsArray(this),s=0;s<m.length;s++)g.addEvent(m[s],D,S,v)},this.unbindEvent=function(){var D=e.toElementsArray(this);g.removeEvent(function(S){for(var v=0;v<D.length;v++)if(this===n||S.target===D[v])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(D){var S=e.toElementsArray(this),v=D,m;typeof D=="function"?m=function(s){for(var y=0;y<S.length;y++)if((this===n||s.target===S[y])&&s.callback===v)return!0;return!1}:m=function(s){for(var y=0;y<S.length;y++)if((this===n||s.target===S[y])&&s.selector===D)return!0;return!1},g.removeEvent(m)},this.unbindEventWithSelectorAndCallback=function(D,S){var v=e.toElementsArray(this);g.removeEvent(function(m){for(var s=0;s<v.length;s++)if((this===n||m.target===v[s])&&m.selector===D&&m.callback===S)return!0;return!1})},this},d=function(){var f={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function b(D){var S={attributes:!1,childList:!0,subtree:!0};return D.fireOnAttributesModification&&(S.attributes=!0),S}function g(D,S){D.forEach(function(v){var m=v.addedNodes,s=v.target,y=[],C;m!==null&&m.length>0?e.checkChildNodesRecursively(m,S,A,y):v.type==="attributes"&&A(s,S,y)&&y.push({callback:S.callback,elem:s}),e.callCallbacks(y,S)})}function A(D,S,v){return e.matchesSelector(D,S.selector)&&(D._id===n&&(D._id=a++),S.firedElems.indexOf(D._id)==-1)?(S.firedElems.push(D._id),!0):!1}u=new l(b,g);var M=u.bindEvent;return u.bindEvent=function(D,S,v){typeof v=="undefined"?(v=S,S=f):S=e.mergeArrays(f,S);var m=e.toElementsArray(this);if(S.existing){for(var s=[],y=0;y<m.length;y++)for(var C=m[y].querySelectorAll(D),j=0;j<C.length;j++)s.push({callback:v,elem:C[j]});if(S.onceOnly&&s.length)return v.call(s[0].elem,s[0].elem);setTimeout(e.callCallbacks,1,s)}M.call(this,D,S,v)},u},c=function(){var f={};function b(){var D={childList:!0,subtree:!0};return D}function g(D,S){D.forEach(function(v){var m=v.removedNodes,s=[];m!==null&&m.length>0&&e.checkChildNodesRecursively(m,S,A,s),e.callCallbacks(s,S)})}function A(D,S){return e.matchesSelector(D,S.selector)}h=new l(b,g);var M=h.bindEvent;return h.bindEvent=function(D,S,v){typeof v=="undefined"?(v=S,S=f):S=e.mergeArrays(f,S),M.call(this,D,S,v)},h},u=new d,h=new c;function i(f,b,g){e.addMethod(b,g,f.unbindEvent),e.addMethod(b,g,f.unbindEventWithSelectorOrCallback),e.addMethod(b,g,f.unbindEventWithSelectorAndCallback)}function w(f){f.arrive=u.bindEvent,i(u,f,"unbindArrive"),f.leave=h.bindEvent,i(h,f,"unbindLeave")}o&&w(o.fn),w(HTMLElement.prototype),w(NodeList.prototype),w(HTMLCollection.prototype),w(HTMLDocument.prototype),w(Window.prototype);var T={};return i(u,T,"unbindAllArrive"),i(h,T,"unbindAllLeave"),T}(window,typeof jQuery=="undefined"?null:jQuery,void 0);var bn={data:"DwCwLgtgNgfAUKApgQwCb2BRZkAIDGIyATgM7YC8ARAK5gBmAtABxUYCEjjuADgPY1iARxp8AlrjEA7fFEGJcURKUViARitSIaAD1z1xKgPy5GMXgOIWaAN3FWlKgFYDEVxFNwQ+W3KRxSqMhQfFIKXBik+MRiPGB+xPjU4GA8pABcAPSZ+KhSAHROpFpQYjbE+WFgmVI8EJmkAO6I2MFuYABMAAIAjAAMbMAN0bFgkSNxCUlUKWlZmTS1ANYA5vn4fPVBAJ5FvfnM+R09mTtF+RDShaRUuFr0brgwQ1ExcRxcuNZWAJIAoj0eqYzAhXqMpskwKkMtlcgUiiUyhUqpkViBMsEeNJEEUMVAsWEujYOvkdKTTmJ-HiCYhGGJEIDrrd7m5nsM3mMEJxuPxBIplLhkHRiAKpMgbGIVsgwNoyMDxhyITMoXNYXlrojypVsKj0Zjsbj9YTiaTyahKdUjYgmWywe84KCwNslPA1D5trgAN5wL4GKRgRj0ZCXKDbdK4KgAeR4HlwAGVkFIbgAaUzIHg8JSMUjbfyICCpgBCpSkSwAssh8HHczKIAAxUJgVNUOOIFZ8BQAVR+VFTACU+G6wHxU5GdNsVh5GAmk6nO2pFmAaKmAMKJnAiqBQZsACUQUBs2DE+DwADltIhe7g9wejyfUwBBGLBVOkROkbNuMT0ADcuDgAC+CANE6LrASAKDoA6wBuqg2zwAg5o2AQUDIKQpDULWmbSpeGAUjYCGghMnJwI00ioHwjT5CyxAADJ8Gg0grA++LYrgFD6Is+BgGIoS4AAFCeW5qJWSwAJRenAACQUkbEmfBKPkIQrPxVA0YoDHmlIKxUGJP4+l8hlfGRgSUfkaCoH8h7+rRFoeG4-EAORNMEjmpvQXE8Xx-GIBJ3pGUZsmhKQCnWspqmINZ8TOY0rm4CK+CIGUiCoKmFEEMEUAifgSy6fpAWGUF8mKeFvn5QVAVCVlon8XpBkFQBdUVQQwWhUpfAqY5kUePE5BgI5TWGQB+lySFJUdapNH0Yx2ksTSfjYDKqB5XAHkyF5niTmAnbEFAABqJCkLVklGTYJC4GdcocZ6w31Rd508CQYAqBxJkUVRIQnht+QgCK9D5CK2GJfxmQANpGAAZAAugA1PxoMAHoUNDMNiRQ8MI9DABUYmomI7mebxUj8QWSyINsyZnXIvknRVl2kKDZPbFD7H3dT5VfI1HPxdggiePT+lAathN8VtO1QAACiQwb8Y9xDBtgbhpYgQY0FAYBUzQvn+YZl24II+LS1gMpWBx9xCurmuINz378W9ZmfdKRM-X9+TkYgOiRvQstG4rxASeYjA9GJOsFQbcsKybrNi7tB1kLVoMR8bbhQ9zRlAUZIpLsQnjh77JuCw6esURAfaQR6HFrdxRMCX50lZ3zuBhI0uAS8QmyUog-EimNh7seY3oyd+AkUfgNBYP6APl3GOAyuxHFUCEM06XXMlSaP489eZqCWVFtl5mExCqQAIpGZYro2PXTVoy2pj3CmHmJ0lSQBuD7uQklr-ft61fpMlAS-J+t04D8TQtsGQx0KAD2kqNNq4UqAAFJ8D5HyP4J6V4qAbBCMQdIGx5ZQBWlJZAsUxDxBLmXNA2xf4wNauNFSiDch8HwJIFQIpKEYKwXwHBeDgiEP4DwGgPBqFFTGmFCaDCUH5A8LfCMnDuFcN4XVKSgExLULgJkLGPosb6x4qUJ0nF1o1xoOQVAkhTFnBUJSRy-p9YmK0f+XA2ivgNxzgQQQIobFBBlKmR6O8Uq4DImAEAuA+iSHoE3FoN8tGZDgHrLaAAVCCx8cLsSrhtY6g80k118fxUgfkebZ08Lk3AwBcD9AkiYRyfRHK4Bhn4XA4ZSB-gAcXVmzdcDJJlLVeuvNXGg1QPkLadY1ZQAAJooCPhJHxaB+IDK2mWRsIBaow2DtM1AszBnYE6V3MSYkoaFHEMTRyjABqASLg9PgAieCszATIAx1dQi1UHsPfiToYx8HCXGWKUBcDsAoBxRyWTQgDUHiItqbh25HwYT8YgCU+CHnlmoJQb9YVcIwdlVY7dFioEYHI9IIpUp4qRaJQhUkXFSD-i-aS2RgR3AAJf0GkKQmuWgVD7nzD1FQGwIAQEWKQalORgq9RlGkVmoNHI9DcrgRyHQpWOQAMyOShtJJQwrECio4uKyVyYZVKpoUmXq3yACKWstYz3VazL5wQLhiB0NIfioKAD6WE44ZCbiM5MBkZJyUZcQCAhY6DDikPEj2YBwyOTjDQMo65cAQ3lrCn8bkvWyUTIlKAAaoShBDToMN0q250vwHSrQNiIaoQTUmr4MkeDtxWD3Ug5q5h+BFaQT1layXdTIIgDNQa3VgGIFrVtuAZJUzEF4omZZlBvknOGlcChCDBlFcoeIIoRBWM9TJc0qBoweHDECop3gghQFXmvWBdDVKSKtVAdIm7t1SFJTJe2VFzSkEemAQgVker8WfmvdpK5jHDggB+-0TkXJQCld+mSnpcALjUEi5Q4Y+0DruK0MQV6vS4BlDm8MUYADS+RbivwAWvKST9iNKJfqmZ+ZEty3t3SLYm2tv2nrEfQi93z0jUagLe0lAF13r1HWXQIbg6OGO8ge4IIcIPMfaqxtjwRr0CekW4e9UlH3UUpK+99UV+K-v-ZsIDYAQPfKlVBmDcHe39sQMrHAqHwxQcw7myB5gHMkBQPkK2uBCO7OfrxqjqGoArhCOQETDzibiaPaC71tCWPnskfkS9HH-OBb4OQHjfHN3JeC-c9J4XJPEek-AuLKCEsZaC5ecjvmN2juPku9uYZstExJj4CTkWwVnqoEV4r7HN01f8HVtLz9pJc2kvq-wbMtYvVwKDVOKrsBuNhT1Btf9RvxEemEKAjrGggFCpGYgrYlDcVZqCniYBkVSXDSahQdg1aIAAF4XQECoN8tg2wkC0MQJNMlwDQCMuGAABs-YAShJyBBgCubblJKTkHu2BulMpAhayGMD6R8AZLAEZfuVAfVUdSWAEhFCaEMJUAMH62to62CA+kAI+Io7qCEHEIlW4YosB04h4zjD2wYzJFHcW24VtqBSBGYMbkRBAjIoXJmzwshjxLAIGz8IIIZLxIEPED2-BiAmxgoGvitOqDvmaMQHozJpTIEYJWDa1A1dcLAI6zKtxZCE+oKBjo2ZQIpVuG8xA1AJdBrYJGHDQwfehBx3GOlUAC0bUPvyFQOBzNa8l2Y6g+u3AdGNzgM3oXLc6HVzb0Il4CfoSd98l3-hnTu451zqgQe70wH94H7XUgcdDAx1ALH2Am+ohiFBGSf2+PVsQBfKQvqIAhfScgVMahkz4GTKlGmn8ovFRi+Pyf0-Z-kakqq3Azr8w8Fdd+vtHpWvb4gLvw6rMABScZIynnyHLcgsymGb0niINw2x9uIG4lwpyoNmde8wfLqgKGAadzYILWdfKSWEaLGTVSENE-dIK8Y-U-MgdfV+L6QgHyY9GSSAxfaAv7JBP4HQRKOIGuAAEk9EQAAl72lTxR4SgB-AxVrQEECFxQUi4XxRSgGkpRkkvVQW20aAOlKDHVCAnXQmQEnH4j+wnUSAkF8Hp0hysEWAUFZWQ10FwEuQ2lID+3APJX0GCHIC4KIzaxi0v2v1v0Oi7g3gnjAHyBf2IDf3ZU-yPkch-wVlZwZ0vCALEhAOpl2S4OyFtk9w+S3xdTP3+QBWxRVmxFQBqQAB8Yjgid9XV54OJBctw8sh5vYEiT8kiwj3U0jWseDSA+CBDR0nZhDJ0xCu5JC3B8AZC50IdSAxAFCwhkNNBtA9B1CiZNDtDelPAgwoB9Dv1X5v1sDRFcCkFYCkCWFcAyDEDXVKDkxMFWD5F8F70dDPQ8weB0gehUwrZ0g5jDohZ-4+MNFn4nArtkBKRkM7AmjeAnpbjSA+RFDkMZRQs7hHI6VrIOUbE5smhSFCBHhHiHBHJFg1CaBFBHIhQ+0lCBR2UrC2jFA8AX8tY34+jQhQsziFAYxVCtBXio5UIWoDU7j1tNttslBdt39uJUxzivAupPByANc7h0TvheB25HpJwHAFBiA6VHj1ZpRcBJFcAABzvAFov0ULFox6FQZ+LGGJB9fzWjBrbyfcTAgrcROTK9Tjbjdfb9fcGwrWOwyk4cJw-IEnCAMnaIrwiyAzfeeHByRyaXHKKVR1UXVAJQU2JUhjSTKTKA8KPA-AAzXAeJEgLacMMg60DcLaBYpY7BXBBRAhcAn0okq3DXFiDbc3GuSuejHyGwMAdIteW2SKawyM7AC4aUAEo6RyavfpE3DPC3KgFMm3O3Tw-Mk9X0iaf0ggnPXAB8WiWiOXdw3vGMtg2glTLAzINbfcUknbPbBw6wg4q6aVRs23LcRyP8GlDYNWPIRyeIYxBQUhCDGSIs9YdxHqYM4gLafU1-I0r-Zw3-Nw48Dw4AjzDiEwm-PrJib8KhT0PYhs7Pa3FcghRqQ8iA04RABcFYDkrgmSIdHgx0pYQfYfYRYjIdQwmSclaC26fLIVN+f8jXSMMIW3N4rM0TBjXM1sqSQs3M-IEs6ww8iAcsiCSs6srxU3DM0ILPHPR1PPQAgaCi0CycjbLbGco0-IBcybLqPC3PMINc3ADcgQVvKQHc2xfcsAEC48seBbf0c8y82w+wg7Y07-e8--dw3irwl83AN81BPtT8+gb8385cni4C4jKSIdNUlSf0n4JMdoQUJtC1fk-gRojaBpGYz0HgraS7M1EVZZHoaMmg+Msc2C75N2byjXSKxABtH2EkrbaUZXBMQ8ZMcK7AdKzKsSFZUjFyzY0gVBTMR8-iIqsAEq6KsqnYkJVMCVNQTgkCng6QBkxq01DK6KwSx1M06UQq5KiKga0qmGDoCq4jKqmq0oYGBqpq9VZZDoVMPodqnofALqlyoybITfR1NQMATwDiBqxCpo-1BvZCteIdbIY6069YJapYW6mCqSOCl6y6v1N6l+f8YjDCiDLCteDRQUN40hRxOUteRstMoi9JMqCDRsgixAOGxrBGteYbf+IbB0ERVbRMKcnKsAPK8UBQa6Z+E7M7C7FE67JQe7a7J7IUQ8KUYgd7T7KSb7KAc7XAAHNePHMoZNKSHQRgVi6gUOIdGSWPRwOzO6NtKSHoOzMxcMfoVMMAJFdIZyJcYtZ6KVBzcNP4TWsQdcUgGpXzAqNeDoBW0dcMDoLajDNW5ySdLonW0NcNVsdCJ2zzQdQKGSeVS21AcMeVW21Wq9DWmgLW0gF0i0LhbYZ2rDaVHcKOmIF-FQOHMOw2-0Y2z2mW8WqSAAFj9vDFzqDvtpAETu2EdXIHdtCEdRPABNjtzUcgrGEBRPZIUErsaOChNq9sKhkgAFYC7cBe7i6Q7jZkB67w1j5QgpA6UWgVB0xaqvpkpM7Tae6qVZaAIqBv0cdcc1Z4BZbgBuQeYxsgisJUI54Ig7pebT6cJs614haSdqBQZR1djQDEAWZpBcBIw1BzjuIpF-QYhlBXlkBzMxJN6zaZJ0gmZqBydL6ZI96ApebSh4Hva0cqc6AK8-8ASco3QdBbh0hdcrY3ZloGljLCHg6+dX7qAKdwG0dUI1B9wGkH6qBCHydcAhaHNqAyHQ1BhMg6H9xkHV6kcxABHebMhr6ZRt7ccFhYBv0hgkIcde9n5+9vqR9a5+559QLBQY8IIRRpi8AsGlgcGAlSFgkpA+AzFJAvB-19BUMo4ddTFhw+AmMcLuLLUJrsAJZLlBFaorzDS5yuE0zv9PcKADGcGoYn7UBPCuDN8JAOJuKlIPAVgglUxbdYU2lEAW4nx5YqExA9J-qZISd+I-wxAuA-xUniAn6WZrorbuLKmiHUxf99i+A6nf8p8IIcoUomm6mDGUpMb0Lej0NNj0gNrxtEBwxymiMAEsLRo8aSSvFSb58KbEAuaqBLstwBR5mUxn4OauaebcdS8wIsDtEhJpEAGrA0B0wwA6VkNcBZgYRBVsFSg1B1hNhMhsB8BMgRQVgzSHmuEnnGAvmzTGAOhe7MhbmVR7m5EnmXmthKIpAl5UBMgegABOVFsF2U5+DRPhqAaiHCdIdIZAegKOT0OSeHXNKgAAHUQGYHlQADYqAfxArmVQhwxNwnZDwfwlAiXC6+geAdAfxhwtjB6+WfwAIMWCmuEIAvRn1sJ6sLTGWLImIlb8x6DRJGDsVwwABiegZFnVnV+grhd7JWvlvwBSUdXATV-AHa61n8Bii86Qa2kUKVqE8x0JF1215AIWsiVAIJcMWlvoXl-l3xLSFYZViAUV5+M0yQWodBz0BgrFQILV+gZNg1lm4TMpE1sac1zV5F-AXN3NiNiVv1aDBvL0eNpg-21QNEMAWtcmBVneJVkJfIAAdhVe9d9bKQDYQVTaNZCULakijer3SG2wRTLbVYTcrfbFb37ajexa9GDcbb6HyF7vzCbZXalaXfXb7aIyjbQfiE9AXe0nDCXdbfDbtZWGkEYCHAA2PeXadZnclejep3SAMDHhUE9BVxLDGdwHlUzbNdMSndQH7a6CwHNDwBJkvfbZAB5cDb8lNMldtx3j4k9AtMYHEdpCwXHiTGtoDZNZ6HoGIB-FQ6lCFZ6FpZFdfng79UQ4ok8Dnc9AczN1KBWCkFZclHACI67xYLkAgFY7KTktwA6FFYFLNJo51xjabBE4Q4sj4mry9FQ8w94+toE-lVFaIxeDdyb13dQGoD7AfAAC17dUJC9idpOkO70wb6yKdUGJOMHWcP9DG+BcHE8q8jS082LM8qA+oK65yjB7d2myZu9cc52mH8A1AjTdtTw+AwA2BQ8DKiYo9nieA6UYgfAFAjAkdgH+HAcQuuFqAfW6x24IAjPHc1IcI2BtkbnUA6UJdMv6GZGbPqcXOCuiuPdOc-95nbgGKdBqAbbA6g4Xd5UjcvBpBeu+h+gBvGAhv3O6yiYndsBHV5mRrWu7hazUJtIaBKiKBAUPsm9cviB8uia+ASuTPOuYBKvfBGUpA6vsvGv0HdcfXlc2vK9OuvBPWxv+uehBvhvLgpAxuJuvupvhvWLZuOKvOFulvhwZv1uVhNvJxtuCPHIO8zSm8X1EwYAouZRwxkVGV1ZdGgTETVu54WjShLg54X9o8Foq6kwClLBp7lAXg1sFG+8RQVHwwnMNHv01BzwUpKuzZH8rDNkwA-glArDCxtgfh1kqyjTgCemgPv0WvNhWZLCt4toRfviwBxfJenJFeIBnzX6uDHvzH+ex5Be1fReeotepfdf9f2Zv1v1bZufIk+f-kMNLNY0IYBI7gwBCulfciqBbg4jvfldkiIxdJcBWzCjijghSiNoRCp0qipDaibnSAw8P9I9Hhnj5mwT6UNgASYd9G0IYS-A0-QstDoKdD+jBiMb8nlEv4BnWshn5VKNiM9jQZDyVfJ5zeNerenJwu5zZeAuUo+M15O-rDu+xeJfrefeivgDn1gGlBTFcjEN0u8iflwwx+hf1fJ-tfHIbfzLX6R+N0BfVfsBt-Lep+deju5-KQF--Fl-3eTBUj1+mTTfT-heLf-Re+9-r+D-qYINlUGNSlJVn4xboYwfHHyEenUZi1AoepPSjeRNKicZOSlK0jvBtJ2RD4TkedNpEQDOlXS7pVmHugwIwCKouNBaGAG2S+8IAqNPiCRVCw5k8yrWSit7GPK0Uyyb6Jit-hB7sU-u4PG3EtwI6bAzKFFTfBYlZh1hzcggekBUCebVUru6yY3uYD4BEN540qCxHtWIy2wxBuRCIldxSj8V3KqkJBD8D7B9g-gK4SMHtD+B6dCwtEP4LgGsF9hIwfYXAKeD+B-Bj4PZFcCuD+Bxg4wQZSMPGDPj2CHwEsCWLRB+ArgHw8SH4NflwB7QHwfYOML2BApVlx2FbbjmwQJR-giUqEHKImhArgF+mhSaClShcraDVuuwaqnEGIAd8T+XfM-p-016X8f+yuW3iiQ4ggULED+N-g0I-498Wh+-bwmARAp-0t03sRyN4H9AgBgCo1QzFQFGSLDRkjAMsGWEYDHxj4Y5KSOQCgD-RxKYqT0IINUab8J+F-XfkMKtgq0+A16eoeP0aEDDzhv-YYRQUAEoU0K7aEoUDWgpJkxsfUB8HBjypzk+enpBgRRSorFkQypZBihwMAbOFuBnnbzjsPT5+cWyTAoyEdTUDK9bhW-Jod-374GVB+DnFKKUPXjYjThX-QYTP02A383wcGJfr8i3xqAuhZI+4Tv2n5tCvC8-OkazHYCMjDyaFYGkc0s41wIa4rNeH1EoFFcaBXpaCn8IBF8AjS2yDAmnAqjDZmoB1QVDgXgRIJQgt6CwFcg4TLE4yqxQaKqO7pGRSsKWb9pAIkhQJaY6ogKHAINL6V0+t5KjtQOQHAEnW8KRAOgIPgOR-8iYScAgVFyt43ApogKJViGx-wZmxJKcnMKOzk1SElNaVGs30CStpQbNHZv9kBxIQBaQtEWlQDFprxJa8Ge0avXlroYranbdyBmLDSOQigwKFWi7WlSNilKWdGhhbSrGVsbatYv1NKHVr4BSANgcetQWHFd1b6MkWBmvRzob0t6sjXegLQPqfAe48QE+jvjPoK4RGaOdDpOMFqBg8uVACJi-Wpjv1PAX9H+tYR6gAMjopYvJGAwQYQMoGVAGBigwEb70kGe43HHuzs7-4HOODPBgQ1fpEM8GpDYCXMIobUwqG74nOsFyy7r8mGLDYhuw1DScNgJDmHhtixgmiNPxKDIYOh0kZDBFxojeRoNh7ws8B8oQYfOz1tHQIQaYLNCBhh0b7k56cuf8U52MZBIm45jc1hIF5RjZcedjTwOa0cY-D4grjc6u4zACeMrkPjeAf42ICBNnCwTUJk53CajoomEGGJqzHiZKBtIyTLfCQA9LtIsmyAHJnkwgyFNimpTQybCkqZHYamzTMQPsmfpNwFYXTZyZUAVhtMiR-tWpp5Ll59NihjcKDEM1zonitY4zIyYYSmbLZthxqKaiKivJax4YSjfGkJTJKIAKSc5PvOlMW44R10UMLwkEg8D8QBIPcNWHmWgHPxRBjqY+CJA-gcQJB3EKQW4HyBLBjOcg8iPxEUFqEVBrvRyPVKL4aCtBdUhqaTVd66Coi+ZQwdClMHmDLB1gh8LYPsGODnBrg9wZ4IfDeDfB-g+JIEKvxlgQhYQiIVEJiFxCEhSQlIWvDSE5R1WzBPFNkJaixliUOUY2t+nXyA0saG6MaUX2V6-TyAt+PtM-BeQVT1YzwzAjSj7TvgzSjwMDIOHOKq5PA5oCUpcRFDfojqKM1mGDOsKEMCUNAYGKAmTA6BaJAkT0JInHxTYyQmxKGOGDJBWxGoqYG6BJChnywkwUbBGenwwzmMUZQaMUHYQEhMx0gmxCKWMythzVN8pAHcJACgDUApSNzbkryVngMsMZc2XXm0g9TB9jea-LgiMTBaNF+QcuBdJoBSRLpUSa-VMASWz5KUzZ8s6tJ3HNnco4giAB3uEn4iLdjwoMeVOEz6BVNXeK-TAuvCpFSspIcTFGV7PCY9AZsxGI3kOjDmezvZoMDoNHLbJaiOySCHng43MZ7kieCgMgrr1fjcB85R3BYrIiNGjkUC9vAspkQ9n4BQYUcj3l8Frn1z9kL5V3n+S4p24Q4clMFg2jKQQYaUOc0uioATH0MTwOciGrFG0YKA88KlUxB-StACQScb8MBC1B4DbA5qZAu8YmJcqVioM1Y5WnbRDr+Aw6nKUcY5H1pp0jaE4lyl2P3k9jh66tduk7WbFx0I0jtTulnRcq+1uxAdR+aHXDqR1-A0dc+QnWAVJ0JsuAVOmBwzo3ziM+dX+bgCLoq0S6ZdHztTxrqVgII58puhT1bpU8O6SYOBWvH7qIKh6KCkeq0HPmT0pA9PAUPPSWrstlAxCmcbLSOr3YOIF49Pn-RsqAM7xLMsFoU14nnjv63C68fSFvF388kIcQwXeIiZFTX4HiG4goGeIQpZQ7xd2HoD-DIpe6b8MbPLL7QCAbAdKLSb8S7LW4qGf4SyV-j1hiAKAjqW7Ak30kgAg4xTGABQD6DWTGAIg34sGTgyngFYOk27JUxbk0UkUpQ2aZxlwo54rwpAPxUoACVYAihpAcxYyRhivkr875GytpC-IOpSxws+JYgESVWZWK16AGdaEbLxIkUyuN8rkkKXFK0owcxpcrjEhBSyh4o6WdAEsUQYpZMs9JX9mAB4AHucLBFrcF+gqx8uJudIA5gnKoRpAP4edJ2jAAUA6ATAZgMmHDIyA0unYPsJEM2D8AwgwGFJVJVaXMgRlmkTigBTIIJIkkOEWqABGuChA2Ay5a5dgESSIAlRrSx5ddwxAwA-s0FbIL0ugD9LgAPAGAFc3DyLLJwVhG5i8s9BmMqIcwpyEsNGSrCNhA0B5W2MdmWBqqkiIYGCv+Vrwhib8AYgoCgw0pmgASRMGKGiXW5fKSIt4ifTv4DzeGFobGcoEqnPCyyQiPQHaIdSJgxADFNDDoEajgEaUnwUsdzNpUa5TF4k27BQGmzQVJZIqR1I2R0nhzk5Vi7CmnJUi1zN5EGNQA2H7FgA3y6qz2bnX2TyCypvU5Qb-lUENiQoKA9YEP1QAGqjV0IlcHGD2hfB45dci1aaW6lqF1GtqwJQNKHEjivCcvCDI73dXShPVe0CioUyOp2LbajqCABQE2KqqpKTipJiAB-COoxAwANNWUzEAwxUYTAowtAUzWNlQYBaoqSSNtjVqpKtagKS6v4pSQHFt+YxEslr4uVPQNTfGCBQ3RTKPAGwLQDsr2Un488wGVAOUqkRSUqlUAZXPGtyQqqa1daryVgEaVUDmlfAXZEf2IyNMm1OeFtfslaZDqpILYh0uOIvXvCZIRQ9pRjSBrRrvYhqusW+UTVf5k1HilJumuPXW4c1QSfNYWuLVb5S15akCoYP-Ua5T1D6xtWuubUbq5e7aztQIiKJlSL1-avyYOpcqj8R1Wy8dbsovhTrDlhmKyh+RyV2VZkc6ypdUr4C1LoNYAU9Zuqsze8d1Ws3ZGJAPU-p3JjG5jeetw1Hk35bYxyLeqHUPr3hAoiDD0s6WyyqAwAXeirOIxJq5sBan9VvilZxNHFek3NSWqLXhswNZanxb1DrCoYiloa7mnCocX8aFYAER1K8qJq3KukXy2YsEo3WhpKCh5IFVAH6WHkgcwjECoMua7nK0AYyv6JMpwDTLQ0syy4hSkWV9QVlDAFgBss9DWaN1rFOcYJvejwsLlVAMgqQFM0JLbNbAVzTZqwAAR+IpW9zTmmcq4bAtvyvzayr+XPr5qsm9JfJukYwAlNWNb2jwV9RdwSBEtZMd+0cimbCA0glQCsDpTT1FZ7ACtI+I5o5jmodfNHPI3y2yaAIcjMoNhKkiKNwGPqK6t2izRXr6Ih4UMHNtgZ9MpmdUV+IZGAh2hOQged0HhA5rwAgAA",method:"decompressFromEncodedURIComponent"};var yn=function(){var p=String.fromCharCode,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function e(l,d){if(!a[l]){a[l]={};for(var c=0;c<l.length;c++)a[l][l.charAt(c)]=c}return a[l][d]}var t={compressToBase64:function(l){if(l==null)return"";var d=t._compress(l,6,function(c){return o.charAt(c)});switch(d.length%4){default:case 0:return d;case 1:return d+"===";case 2:return d+"==";case 3:return d+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:t._decompress(l.length,32,function(d){return e(o,l.charAt(d))})},compressToUTF16:function(l){return l==null?"":t._compress(l,15,function(d){return p(d+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:t._decompress(l.length,16384,function(d){return l.charCodeAt(d)-32})},compressToUint8Array:function(l){for(var d=t.compress(l),c=new Uint8Array(d.length*2),u=0,h=d.length;u<h;u++){var i=d.charCodeAt(u);c[u*2]=i>>>8,c[u*2+1]=i%256}return c},decompressFromUint8Array:function(l){if(l==null)return t.decompress(l);for(var d=new Array(l.length/2),c=0,u=d.length;c<u;c++)d[c]=l[c*2]*256+l[c*2+1];var h=[];return d.forEach(function(i){h.push(p(i))}),t.decompress(h.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":t._compress(l,6,function(d){return n.charAt(d)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),t._decompress(l.length,32,function(d){return e(n,l.charAt(d))}))},compress:function(l){return t._compress(l,16,function(d){return p(d)})},_compress:function(l,d,c){if(l==null)return"";var u,h,i={},w={},T="",f="",b="",g=2,A=3,M=2,D=[],S=0,v=0,m;for(m=0;m<l.length;m+=1)if(T=l.charAt(m),Object.prototype.hasOwnProperty.call(i,T)||(i[T]=A++,w[T]=!0),f=b+T,Object.prototype.hasOwnProperty.call(i,f))b=f;else{if(Object.prototype.hasOwnProperty.call(w,b)){if(b.charCodeAt(0)<256){for(u=0;u<M;u++)S=S<<1,v==d-1?(v=0,D.push(c(S)),S=0):v++;for(h=b.charCodeAt(0),u=0;u<8;u++)S=S<<1|h&1,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=h>>1}else{for(h=1,u=0;u<M;u++)S=S<<1|h,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=0;for(h=b.charCodeAt(0),u=0;u<16;u++)S=S<<1|h&1,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=h>>1}g--,g==0&&(g=Math.pow(2,M),M++),delete w[b]}else for(h=i[b],u=0;u<M;u++)S=S<<1|h&1,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=h>>1;g--,g==0&&(g=Math.pow(2,M),M++),i[f]=A++,b=String(T)}if(b!==""){if(Object.prototype.hasOwnProperty.call(w,b)){if(b.charCodeAt(0)<256){for(u=0;u<M;u++)S=S<<1,v==d-1?(v=0,D.push(c(S)),S=0):v++;for(h=b.charCodeAt(0),u=0;u<8;u++)S=S<<1|h&1,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=h>>1}else{for(h=1,u=0;u<M;u++)S=S<<1|h,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=0;for(h=b.charCodeAt(0),u=0;u<16;u++)S=S<<1|h&1,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=h>>1}g--,g==0&&(g=Math.pow(2,M),M++),delete w[b]}else for(h=i[b],u=0;u<M;u++)S=S<<1|h&1,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=h>>1;g--,g==0&&(g=Math.pow(2,M),M++)}for(h=2,u=0;u<M;u++)S=S<<1|h&1,v==d-1?(v=0,D.push(c(S)),S=0):v++,h=h>>1;for(;;)if(S=S<<1,v==d-1){D.push(c(S));break}else v++;return D.join("")},decompress:function(l){return l==null?"":l==""?null:t._decompress(l.length,32768,function(d){return l.charCodeAt(d)})},_decompress:function(l,d,c){var u=[],h,i=4,w=4,T=3,f="",b=[],g,A,M,D,S,v,m,s={val:c(0),position:d,index:1};for(g=0;g<3;g+=1)u[g]=g;for(M=0,S=Math.pow(2,2),v=1;v!=S;)D=s.val&s.position,s.position>>=1,s.position==0&&(s.position=d,s.val=c(s.index++)),M|=(D>0?1:0)*v,v<<=1;switch(h=M){case 0:for(M=0,S=Math.pow(2,8),v=1;v!=S;)D=s.val&s.position,s.position>>=1,s.position==0&&(s.position=d,s.val=c(s.index++)),M|=(D>0?1:0)*v,v<<=1;m=p(M);break;case 1:for(M=0,S=Math.pow(2,16),v=1;v!=S;)D=s.val&s.position,s.position>>=1,s.position==0&&(s.position=d,s.val=c(s.index++)),M|=(D>0?1:0)*v,v<<=1;m=p(M);break;case 2:return""}for(u[3]=m,A=m,b.push(m);;){if(s.index>l)return"";for(M=0,S=Math.pow(2,T),v=1;v!=S;)D=s.val&s.position,s.position>>=1,s.position==0&&(s.position=d,s.val=c(s.index++)),M|=(D>0?1:0)*v,v<<=1;switch(m=M){case 0:for(M=0,S=Math.pow(2,8),v=1;v!=S;)D=s.val&s.position,s.position>>=1,s.position==0&&(s.position=d,s.val=c(s.index++)),M|=(D>0?1:0)*v,v<<=1;u[w++]=p(M),m=w-1,i--;break;case 1:for(M=0,S=Math.pow(2,16),v=1;v!=S;)D=s.val&s.position,s.position>>=1,s.position==0&&(s.position=d,s.val=c(s.index++)),M|=(D>0?1:0)*v,v<<=1;u[w++]=p(M),m=w-1,i--;break;case 2:return b.join("")}if(i==0&&(i=Math.pow(2,T),T++),u[m])f=u[m];else if(m===w)f=A+A.charAt(0);else return null;b.push(f),u[w++]=A+f.charAt(0),i--,A=f,i==0&&(i=Math.pow(2,T),T++)}}};return t}();var Un=function(){var p=[{id:"/views/test-swal-sauvegarde",path:"views",file:"test-swal-sauvegarde",ptr:bn}],o=function(n){oCurView=p.find(t=>t.id==n),oCurView===void 0&&console.log(`%cError view ${n} could't be found`,ue),oCurView=oCurView.ptr;let a=oCurView.data;return yn[oCurView.method](a)};return Object.freeze({load:o})},qn=Un(),vn=qn;var Gn=function(){let p={},o="0",n="life-cycle-status=pending",a=function(){return`https://api.openclassrooms.com/users/${o}`},e=async function(){},t=async function(){if(p.length==0)throw new Error("_header is empty, no xhr have been trapped");o==0&&await e()},l=async function(f,b=0,g=19){await t(),typeof f=="string"&&(f=dayjs(f));let A=`${a()}/sessions?actor=expert&after=${encodeURIComponent(f.format("YYYY-MM-DDTHH:MM:ss[Z]"))}&life-cycle-status=pending`;return await w(A,{range:`items=${b}-${g}`})},d=async function(f){await t();let b=`https://api.openclassrooms.com/users/${f}`;return await w(b)},c=async function(f){await t();let b=`${a()}/paths/followed-path`;return await w(b)},u=async function(f){await t();let b=`${a()}/paths`;return await w(b)},h=function(f){o=f},i=function(f){return decodeURI(f)!==decodeURIComponent(f)},w=async function(f="",b={}){let g=Object.assign({"User-Agent":"Mozilla/5.0"},p,b),A=await it.XHR({method:"GET",url:f,responseType:"application/json",headers:g}).catch(m=>{console.error(`%cError ${m}`,ue)});return A.responseText;var v};return function(){var f=window.XMLHttpRequest.prototype.open,b=window.XMLHttpRequest.prototype.send,g=window.XMLHttpRequest.prototype.setRequestHeader,A=function(v,m,s,y,C){return this._url=m,this._requestHeaders={},this._knox=[],f.apply(this,arguments)},M=function(v){return this.onreadystatechange&&(this._onreadystatechange=this.onreadystatechange),this.onreadystatechange=D,b.apply(this,arguments)},D=function(){if(this.readyState===4&&this.status&&this.status>=200&&this.status<300&&this._url.match(/^https:\/\/api.openclassrooms.com/g))for(var v in this._knox)p[this._knox[v].key]=this._knox[v].value;if(this._onreadystatechange)return this._onreadystatechange.apply(this,arguments)},S=function(v,m){return this._url.match(/^https:\/\/api.openclassrooms.com/g)&&this._knox.push({key:v,value:m}),this._requestHeaders[v]=m,g.apply(this,arguments)};window.XMLHttpRequest.prototype.open=A,window.XMLHttpRequest.prototype.send=M,window.XMLHttpRequest.prototype.setRequestHeader=S}(),Object.freeze({forge:h,getPendingSessionFrom:l,getUser:d,getUserFollowedPath:c,getUserPath:u})},Qn=Gn(),Tt=Qn;var me={Cfg:{dbase:null},raf:null,start:async function(){await Kt();let p=me.checkSupport();console.log(`%cAre all functions supported ? : ${p}`,k);var o="header [class*=MuiAvatar-img]";document.querySelector(o)===null?(console.log(`%c All condition not met, waiting element '${o}' `,k),document.arrive(o,me._warmup)):(console.log("%c All condition already met go",k),me._warmup())},checkSupport:function(){return!0},_warmup:function(){console.log("%c in _warmup",k),document.unbindArrive(me._warmup),GM===void 0?(console.log("%cI am not in a tamper env",k),me._userscriptless()):console.log(`%cTamper environment detected the version is ${GM.info.version}`,k),GM_addStyle(GM_getResourceText("jspanelcss")),GM_addStyle(GM_getResourceText("toastifycss")),GM_addStyle(GM_getResourceText("simpledatatablecss")),GM_addStyle(GM_getResourceText("loading_barcss")),GM_config.init(mn),GM_registerMenuCommand("OC Facturier - configure",gn),GM_config.get("hackheaderzindex")===!0&&(document.getElementById("header").style.zIndex=0),GM_addStyle(".swal2-title{font-size:1.275em)");var p="table#sessions_2 tbody tr > td > div > div+p";document.querySelector(p)===null?(console.log(`%c All condition not met, waiting element '${p}' `,k),document.arrive(p,me._main)):(console.log("%c All condition already met go",k),me._main())},pathname:document.location.pathname,_eventMonitor:function(){var p=document.querySelector("body"),o=new MutationObserver(function(a){a.forEach(function(e){e.target.classList.contains("dom-services-3-MuiTouchRipple-root"),e.target.nodeName==="TBODY"&&e.target.parentElement.nodeName==="TABLE"&&kt(me._applyInjectionOnPathNameMutation()),e.target.ariaLabel==="Page pr\xE9c\xE9dente",me.pathname!=document.location.pathname&&(me.pathname=document.location.pathname,kt(me._applyInjectionOnPathNameMutation()))})}),n={childList:!0,subtree:!0};o.observe(p,n)},_applyInjectionOnPathNameMutation:function(){let p=!1;p===!1&&document.location.pathname.match(/\/sessions$/)&&(p=!0,console.log("%cgestion des sessions",k),me._applyInjectionForSessionsToComplete()),p===!1&&document.location.pathname.match(/\/booked-mentorship-sessions$/)&&(p=!0,console.log("%cgestion des sessions futures"),k,me._applyInjectionForSessionsBooked()),p===!1&&document.location.pathname.match(/\/mentorship-sessions-history$/)&&(p=!0,console.log("%cgestion de l'historique des sessions",k),me._applyInjectionForSessionsHistory()),p===!1&&console.log("%cUnknow Route so could't guess what to do",ue)},_applyInjectionForSessionsToComplete:function(){document.querySelector("table#sessions_2 thead")!==null&&(document.querySelector("table#sessions_2 thead").style.display="none");var p=Array.from(document.querySelectorAll("table#sessions_2 tbody a[href*=sessions]")),o;p.forEach(function(n){let a=n.querySelector("span span");a.innerText=".:"+a.innerText+":.",n.addEventListener("click",o=function(e){e.stopPropagation(),e.preventDefault();var t=n.parentElement.parentElement.parentElement,l=t.children[1].querySelector("time").dateTime.trim(),d=Ke(t.children[2],-2),c=t.children[3].querySelector("a").getAttribute("href-sav"),u=(c||"/").split("/"),h=u[u.length-1];l=dayjs(l).toISOString();var i=Ae.getHashId(l,d);let w=parseInt(h,10),T=xe.exists(w,1,xe.TYPE.SESSIONID_DATEREFID),f=xe.exists(i,2,xe.TYPE.SESSIONID_DATEREFID);T&&(f||(console.log(`[SESSIONID_DATEREFID] iSessionId ${w} est connu mais pas iHash${i}`),xe.updKey2(w,i,xe.TYPE.SESSIONID_DATEREFID))),f&&(T||(console.log(`[SESSIONID_DATEREFID] iHash${i} est connu mais pas iSessionId ${w}`),xe.updKey1(w,i,xe.TYPE.SESSIONID_DATEREFID))),!T&&!f&&(console.log(`[SESSIONID_DATEREFID] iHash${i} et iSessionId ${w} sont INconnus`),xe.add(w,i,xe.TYPE.SESSIONID_DATEREFID)),window.open(c,"blank").focus()}),n.setAttribute("href-sav",n.getAttribute("href")),n.removeAttribute("href")})},_applyInjectionForSessionsBooked:function(){document.querySelector("table#sessions_2 thead")!==null&&(document.querySelector("table#sessions_2 thead").style.display="none")},_applyInjectionForSessionsHistory:function(){document.querySelector("table#sessions_2 thead")!==null&&(document.querySelector("table#sessions_2 thead").style.display="block"),wt()},_addHeader:function(){let p=`
<a href="" class="dom-services-3-MuiButtonBase-root dom-services-3-MuiTab-root dom-services-3-dom-services73 dom-services-3-MuiTab-textColorInherit" style="
    margin-left: auto;
"><span class="dom-services-3-MuiTab-wrapper">En base de donn\xE9e (21/24)</span><span class="dom-services-3-MuiTouchRipple-root"></span></a>
		`,o=document.querySelector("#mainContent > :not(div:empty)").children,n=document.createElement("span");n.innerText="Facturier v."+GM.info.script.version,n.classList.add("dom-services-3-MuiTab-wrapper");let a;n.addEventListener("click",a=function(d){document.querySelectorAll("tbody input[type=checkbox]").forEach(c=>c.checked=!c.checked)});let e=document.createElement("span");e.classList.add("dom-services-3-MuiTouchRipple-root");let t=document.createElement("a");t.alt="tout s\xE9l\xE9ctionner",t.appendChild(n),t.appendChild(e),t.classList.add("dom-services-3-MuiButtonBase-root"),t.classList.add("dom-services-3-MuiTab-root"),t.classList.add("dom-services-3-MuiTab-textColorInherit");let l=`
font-size: 1rem;
max-width: 280px;
font-family: Montserrat;
font-weight: 400;
line-height: 1.625rem;
text-transform: inherit;
`;t.style=l+"margin-left: auto",o[2].querySelector("div:nth-child(2) > div").appendChild(t)},_userscriptless(){console.log("%cIm'not in a Tamper environment so i need to load js scripts",k)},_main:function(){console.log("\u200B\u200B\u200B%cMainLoaded\u200B\u200B\u200B",k),document.unbindArrive(me._main),me._eventMonitor(),Rt.paintTiming(),Rt.longTaskTiming();let p=new LocalStorage("db");var o=low(p);o.defaults({students:[],sessions:[],f_archives:[],history_session_cache:[],meta:[],refs:[],students_history:[]}).write(),me.Cfg.dbase=o,dayjs.extend(dayjs_plugin_isSameOrAfter),dayjs.extend(dayjs_plugin_isSameOrBefore),dayjs.extend(dayjs_plugin_isBetween),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_customParseFormat),dayjs.locale("fr"),xe.checkSupport(),Oe.checkSupport(),GM_config.get("userid")!=0?(Tt.forge(GM_config.get("userid")),Tt.getPendingSessionFrom(dayjs())):console.log("%cVotre num\xE9ro d'utilisateur openclassrooms n'a pas ete renseign\xE9 dans la configuration vous ne pourrez pas utiliser la collecte automatique d'information",ue),document.querySelector(".panel.menuBar.flex.draggable")===null&&hn.init(),me._addHeader(),me._applyInjectionOnPathNameMutation();let n=Oe.getDbVersion();if(bt(GM.info.script.version,n)==1&&(console.log(`%cDB is in version: ${Oe.getDbVersion()} need to go to version ${GM.info.script.version}`,k),nt.update(GM.info.script.version)),ot(["https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"]).then(async function(a){console.log("%cALPINE js fetched",k)}),ot(["https://unpkg.com/htmx.org@1.1.0","https://unpkg.com/htmx.org@1.1.0/dist/ext/debug.js"]).then(async function(a){htmx.on("htmx:configRequest",function(e){}),htmx.on("htmx:beforeRequest",function(e){if(e.detail.pathInfo.finalPath&&Vt(e.detail.pathInfo.finalPath)!=="html"){e.detail.xhr.addEventListener("abort",function(){}),e.detail.xhr.onloadstart=function(u){this.abort()};let d=vn.load(e.detail.pathInfo.finalPath),c=e.detail.target;var t=e.detail.elt.getAttribute("hx-select");if(t){let u=new DOMParser().parseFromString(d,"text/html");oNode=u.querySelector(t),oNode?d=oNode.outerHTML:console.log(`%cWanna select target ${t} in data received from calling ${e.detail.pathInfo.finalPath} but this node could'nt be found so return the whole string`,ue)}var l=function(u,h){var i=document.createRange(),w=i.createContextualFragment(u);console.log(w);for(var T=w.childNodes.length-1;T>=0;T--){var f=w.childNodes[T];h.appendChild(f),htmx.process(f)}return h.lastChild};l(d,e.detail.target)}}),htmx.on("htmx:xhr:loadstart",function(e){})}),ot(["https://cdn.jsdelivr.net/npm/sweetalert2@10"]).then(async function(a){console.log("%cSweetAlert fetched",k)}),GM_config.get("use_custom_css")===!0){let e=GM_config.get("custom_css_url").split(",");if(e.length!==0)console.log(`%cWanna inject Custom CSS from URL:${e}`,k),ot(e).then(()=>{console.log(`%cCustom CSS from URL:${e} loaded`,k)}).catch(t=>console.log(`%cError detected when loading dependencies ${t}`,ue));else{let t=GM_config.get("custom_css_data");if(t.length()>0){console.log(`%cNeed to inject a custom css in application content is ${t}`,k);let l=document.createElement("style");l.innerHTML=t,document.head.insertAdjacentElement("beforeend",l)}}}unsafeWindow.Facturier={libs:[],cfg:{dbase:null},klass:[]},unsafeWindow.Facturier.cfg.dbase=me.Cfg.dbase,unsafeWindow.Facturier.libs.push({id:"fetchInject",ptr:ot}),unsafeWindow.Facturier.libs.push({id:"dayjs",ptr:dayjs}),unsafeWindow.Facturier.klass.push({id:"Student",ptr:Ce}),unsafeWindow.Facturier.klass.push({id:"Session",ptr:Ae}),unsafeWindow.Facturier.klass.push({id:"Archive",ptr:et}),unsafeWindow.Facturier.klass.push({id:"History",ptr:ut}),unsafeWindow.Facturier.klass.push({id:"StudentHistory",ptr:Ye}),unsafeWindow.Facturier.klass.push({id:"Ref",ptr:xe}),unsafeWindow.Facturier.klass.push({id:"Dbase",ptr:nt}),unsafeWindow.Facturier.klass.push({id:"Meta",ptr:Oe}),unsafeWindow.Facturier.klass.push({id:"Ref",ptr:xe}),unsafeWindow.Facturier.klass.push({id:"Api",ptr:Tt}),GM.info.script.downloadURL==="http://localhost:8000/dist/app-facturier.iife.js"?(console.log("%cALERTE .... version locale !!!!!! ","background-color:coral;color:white"),console.log("%c test readfile",k),Jt("file:////media/pwyll/USB120Go/DevStt/UserScripts/SttAddon/src/update_data_base.js",function(a){console.log(a)}),me.loadDependencies()):console.log(`%c GM.info.script.downloadURL url : ${GM.info.script.downloadURL}`,k)},loadDependencies:function(){let p=[];p.push("http://localhost:8000/src/branch01/sandbox.js"),p.push("http://localhost:8000/src/branch01/sandbox.css"),ot(p).then(()=>{console.log(`dependencies ${p} loaded`)})},dbUpdate:function(){console.log("%c Need to update DB",k),bt(GM.info.script.version,"1.00.0006")==0&&(console.log("%c Need to update DB to version '1.00.0006'",k),nt.update("1.00.0006"))},patchxhr:function(){var p=window.XMLHttpRequest.prototype.open,o=window.XMLHttpRequest.prototype.send,n=window.XMLHttpRequest.prototype.setRequestHeader,a=function(l,d,c,u,h){return this._url=d,this._requestHeaders={},this._knox=[],p.apply(this,arguments)},e=function(l){return this.onreadystatechange&&(this._onreadystatechange=this.onreadystatechange),this.onreadystatechange=onReadyStateChangeReplacement,o.apply(this,arguments)},t=function(l,d){return this._url.match(/^https:\/\/api.openclassrooms.com/g)&&this._knox.push({key:l,value:d}),this._requestHeaders[l]=d,n.apply(this,arguments)};window.XMLHttpRequest.prototype.open=a,window.XMLHttpRequest.prototype.send=e,window.XMLHttpRequest.prototype.setRequestHeader=t},overrideDebug:function(){var p=window.XMLHttpRequest.prototype.open,o=window.XMLHttpRequest.prototype.send;function n(t,l,d,c,u){return this._url=l,p.apply(this,arguments)}function a(t){return this.onreadystatechange&&(this._onreadystatechange=this.onreadystatechange),console.log(`%c Request sent : ${t}`,k),this.onreadystatechange=e,o.apply(this,arguments)}function e(){if(console.log(`%c Ready state changed to: ${this.readyState}`,k),this._onreadystatechange)return this._onreadystatechange.apply(this,arguments)}window.XMLHttpRequest.prototype.open=n,window.XMLHttpRequest.prototype.send=a}};window.Facturier!==void 0?window.Facturier.start():me.start();var z=me;})();
/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
/**
 * Fetch Inject module.
 *
 * @module fetchInject
 * @license Zlib
 * @param {(USVString[]|Request[])} inputs Resources you wish to fetch.
 * @param {Promise} [promise] A promise to await before attempting injection.
 * @throws {Promise<ReferenceError>} Rejects with error when given no arguments.
 * @throws {Promise<TypeError>} Rejects with error on invalid arguments.
 * @throws {Promise<Error>} Whatever `fetch` decides to throw.
 * @throws {SyntaxError} Via DOM upon attempting to parse unexpected tokens.
 * @returns {Promise<Object[]>} A promise which resolves to an `Array` of
 *     Objects containing `Response` `Body` properties used by the module.
 */
//# sourceMappingURL=app.min.js.map
