// ==UserScript==
// @name         Facturier
// @namespace    http://tampermonkey.net/
// @version      1.10.0012.20220314
// @description  Un addon pour vous aider dans votre facturation
// @author       Stéphane TORCHY
// @updateURL    https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @downloadURL  https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @icon         https://mirrors.creativecommons.org/presskit/icons/heart.red.png
// multiple usage
// @match        https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history*
// @match        https://openclassrooms.com/fr/mentorship/dashboard/sessions
// @match        https://openclassrooms.com/fr/mentorship/dashboard/booked-mentorship-sessions

// Start at document start https://www.tampermonkey.net/documentation.php#_run_at
// @run-at document-start   

// @grant        unsafeWindow
// @grant        GM_addStyle
// @grant        GM_getResourceText
// @grant        GM_registerMenuCommand
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        GM.xmlHttpRequest
// @grant        GM_notification

// @require      https://cdn.jsdelivr.net/npm/lodash@4.17.19/lodash.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/low.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/LocalStorage.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/dayjs.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/locale/fr.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isBetween.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrBefore.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrAfter.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/customParseFormat.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/localeData.min.js


//// GM_Compat : Portable monkey-patching for userscripts  
// SRC 				https://github.com/chocolateboy/gm-compat
// permet notamment d'utiliser GMCompat.unsafeWindow.notify('loaded', { value: 42 }) sous chrome
// @require       	https://unpkg.com/gm-compat@1.1.0 

//// GM_Config
// SRC 			https://github.com/sizzlemctwizzle/GM_config/wiki
// require      https://openuserjs.org/src/libs/sizzle/GM_config.js (cassé ce jour 28/08/2020);
// @require      https://raw.githubusercontent.com/sizzlemctwizzle/GM_config/master/gm_config.js

//// sweetalert 2
// require      https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.all.min.js
// @require      https://cdn.jsdelivr.net/npm/sweetalert2@10

//// draggabilly
// @require      https://cdnjs.cloudflare.com/ajax/libs/draggabilly/2.2.0/draggabilly.pkgd.min.js

//// toastify 
// @require     https://cdn.jsdelivr.net/npm/toastify-js@1.8.0/src/toastify.min.js
// @resource    toastifycss https://raw.githubusercontent.com/apvarun/toastify-js/master/src/toastify.css

// https://github.com/uzairfarooq/arrive --> included manually
// require     https://raw.githubusercontent.com/uzairfarooq/arrive/master/minified/arrive.min.js

////simple-datatables
//// https://github.com/fiduswriter/Simple-DataTables
// @require     https://cdn.jsdelivr.net/npm/simple-datatables@latest
// @resource    simpledatatablecss https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css


//// MEMOIZATION
//// TODO : check best function
// require https://raw.githubusercontent.com/anywhichway/nano-memoize/master/dist/nano-memoize.min.js
// https://github.com/planttheidea/moize#usage
// @require https://cdn.jsdelivr.net/npm/moize@5.4.7/dist/moize.min.js
// require https://cdn.jsdelivr.net/npm/moize@6.0.2/dist/moize.min.js -> probleme 20210701
// require https://cdn.jsdelivr.net/npm/moize@6.0.3/dist/moize.min.js -> probleme 20210701
// USAGE OF https://caolan.github.io/async/v3/docs.html
// FONCTIONNE PAS require https://cdn.jsdelivr.net/npm/async@3.2.0/memoize.min.js probleme export
// @require https://cdn.jsdelivr.net/npm/async@3.2.0/dist/async.min.js
// TOTEST https://github.com/sindresorhus/p-memoize
// Ne fonctionne pasrequire https://cdn.skypack.dev/p-memoize

//// FETCH INJECT --> included manually
// require https://cdn.jsdelivr.net/npm/fetch-inject

//// PARSER MKDOWN
// @require 	 https://cdn.jsdelivr.net/npm/showdown@1.9.1/dist/showdown.min.js

//// PDF https://pdf-lib.js.org/docs/api/
// @require      https://unpkg.com/pdf-lib@1.9.0/dist/pdf-lib.min.js
// @require      https://unpkg.com/downloadjs@1.4.7/download.js

//// HTMX https://htmx.org --> included dynamically
// require https://unpkg.com/htmx.org@1.1.0/dist/htmx.min.js

//// ALPINE JS --> included dynamically
// require https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js


// ProgressBar 
// https://loading.io/progress/
// require https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.js
// resource loading_barcss https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.css
// @require https://loadingio.github.io/loading-bar/dist/loading-bar.js
// @resource loading_barcss https://loadingio.github.io/loading-bar/dist/loading-bar.min.css

// https://www.cssscript.com/demo/text-progress-bar-ascii-loader/
// https://github.com/kimmobrunfeldt/progressbar.js - fonctionne mais probleme avec le easing dans mon popup progress bar
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.min.js
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.js
// https://pvdlg.github.io/uprogress/js-api/#UProgress+start
// https://ricostacruz.com/nprogress


// @require https://unpkg.com/nprogress@0.2.0/nprogress.js
// @resource nprogress_css https://unpkg.com/nprogress@0.2.0/nprogress.css


// semble cassé
// https://github.com/webosorg/Process
// https://unpkg.com/@webos/process@0.2.0/dist/process.js
// https://cdn.jsdelivr.net/npm/@webos/process@0.2.0/dist/process.min.js
// bof ... je ne parviens pas à faire fonctionner l'exemple
// https://cdn.jsdelivr.net/npm/worker-function@2.0.1/WorkerFunction.min.js
// Threading 
// require  https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/Thread.js
// require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadPool.js
// require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadQueue.js
// semble cassé
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// https://unpkg.com/paralleljs@1.0/lib/parallel.js
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// Freelancer
// https://github.com/Wildhoney/Freelancer
// fonctionne require https://raw.githubusercontent.com/arqex/worker-function/master/WorkerFunction.js
// ne fonctonne pas https://raw.githubusercontent.com/duart38/Thread/master/Thread.bundle.js
// require      https://cdn.jsdelivr.net/npm/paralleljs@1.0.1/lib/parallel.min.js


/*
 * History
 * cf https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/blob/master/CHANGELOG.md
 */
// ==/UserScript==
(()=>{var Cr=Object.create;var Gt=Object.defineProperty;var Tr=Object.getOwnPropertyDescriptor;var Dr=Object.getOwnPropertyNames;var Or=Object.getPrototypeOf,Mr=Object.prototype.hasOwnProperty;var Nr=(d,t,e)=>t in d?Gt(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e;var Ir=d=>Gt(d,"__esModule",{value:!0});var jr=(d,t)=>()=>(t||d((t={exports:{}}).exports,t),t.exports);var kr=(d,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Dr(t))!Mr.call(d,s)&&s!=="default"&&Gt(d,s,{get:()=>t[s],enumerable:!(e=Tr(t,s))||e.enumerable});return d},Br=d=>kr(Ir(Gt(d!=null?Cr(Or(d)):{},"default",d&&d.__esModule&&"default"in d?{get:()=>d.default,enumerable:!0}:{value:d,enumerable:!0})),d);var G=(d,t,e)=>(Nr(d,typeof t!="symbol"?t+"":t,e),e);var nr=jr((cn,fn)=>{(function(d,t){typeof define=="function"&&define.amd?define([],t):typeof fn=="object"&&typeof cn!="undefined"?fn.exports=t():d.Papa=t()})(cn,function d(){"use strict";var t=typeof self!="undefined"?self:typeof window!="undefined"?window:t!==void 0?t:{},e=!t.document&&!!t.postMessage,s=e&&/blob:/i.test((t.location||{}).protocol),n={},o=0,c={parse:function(b,u){var C=(u=u||{}).dynamicTyping||!1;if(w(C)&&(u.dynamicTypingFunction=C,C={}),u.dynamicTyping=C,u.transform=!!w(u.transform)&&u.transform,u.worker&&c.WORKERS_SUPPORTED){var g=function(){if(!c.WORKERS_SUPPORTED)return!1;var L=(I=t.URL||t.webkitURL||null,N=d.toString(),c.BLOB_URL||(c.BLOB_URL=I.createObjectURL(new Blob(["(",N,")();"],{type:"text/javascript"})))),k=new t.Worker(L),I,N;return k.onmessage=S,k.id=o++,n[k.id]=k}();return g.userStep=u.step,g.userChunk=u.chunk,g.userComplete=u.complete,g.userError=u.error,u.step=w(u.step),u.chunk=w(u.chunk),u.complete=w(u.complete),u.error=w(u.error),delete u.worker,void g.postMessage({input:b,config:u,workerId:g.id})}var M=null;return c.NODE_STREAM_INPUT,typeof b=="string"?M=u.download?new l(u):new a(u):b.readable===!0&&w(b.read)&&w(b.on)?M=new A(u):(t.File&&b instanceof File||b instanceof Object)&&(M=new p(u)),M.stream(b)},unparse:function(b,u){var C=!1,g=!0,M=",",L=`\r
`,k='"',I=k+k,N=!1,$=null,R=!1;(function(){if(typeof u=="object"){if(typeof u.delimiter!="string"||c.BAD_DELIMITERS.filter(function(Y){return u.delimiter.indexOf(Y)!==-1}).length||(M=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(C=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(N=u.skipEmptyLines),typeof u.newline=="string"&&(L=u.newline),typeof u.quoteChar=="string"&&(k=u.quoteChar),typeof u.header=="boolean"&&(g=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");$=u.columns}u.escapeChar!==void 0&&(I=u.escapeChar+k),typeof u.escapeFormulae=="boolean"&&(R=u.escapeFormulae)}})();var U=new RegExp(y(k),"g");if(typeof b=="string"&&(b=JSON.parse(b)),Array.isArray(b)){if(!b.length||Array.isArray(b[0]))return F(null,b,N);if(typeof b[0]=="object")return F($||P(b[0]),b,N)}else if(typeof b=="object")return typeof b.data=="string"&&(b.data=JSON.parse(b.data)),Array.isArray(b.data)&&(b.fields||(b.fields=b.meta&&b.meta.fields),b.fields||(b.fields=Array.isArray(b.data[0])?b.fields:P(b.data[0])),Array.isArray(b.data[0])||typeof b.data[0]=="object"||(b.data=[b.data])),F(b.fields||[],b.data||[],N);throw new Error("Unable to serialize unrecognized input");function P(Y){if(typeof Y!="object")return[];var H=[];for(var te in Y)H.push(te);return H}function F(Y,H,te){var le="";typeof Y=="string"&&(Y=JSON.parse(Y)),typeof H=="string"&&(H=JSON.parse(H));var ue=Array.isArray(Y)&&0<Y.length,ce=!Array.isArray(H[0]);if(ue&&g){for(var K=0;K<Y.length;K++)0<K&&(le+=M),le+=j(Y[K],K);0<H.length&&(le+=L)}for(var J=0;J<H.length;J++){var he=ue?Y.length:H[J].length,fe=!1,pe=ue?Object.keys(H[J]).length===0:H[J].length===0;if(te&&!ue&&(fe=te==="greedy"?H[J].join("").trim()==="":H[J].length===1&&H[J][0].length===0),te==="greedy"&&ue){for(var ye=[],re=0;re<he;re++){var z=ce?Y[re]:re;ye.push(H[J][z])}fe=ye.join("").trim()===""}if(!fe){for(var ve=0;ve<he;ve++){0<ve&&!pe&&(le+=M);var Ee=ue&&ce?Y[ve]:ve;le+=j(H[J][Ee],ve)}J<H.length-1&&(!te||0<he&&!pe)&&(le+=L)}}return le}function j(Y,H){if(Y==null)return"";if(Y.constructor===Date)return JSON.stringify(Y).slice(1,25);R===!0&&typeof Y=="string"&&Y.match(/^[=+\-@].*$/)!==null&&(Y="'"+Y);var te=Y.toString().replace(U,I),le=typeof C=="boolean"&&C||typeof C=="function"&&C(Y,H)||Array.isArray(C)&&C[H]||function(ue,ce){for(var K=0;K<ce.length;K++)if(-1<ue.indexOf(ce[K]))return!0;return!1}(te,c.BAD_DELIMITERS)||-1<te.indexOf(M)||te.charAt(0)===" "||te.charAt(te.length-1)===" ";return le?k+te+k:te}}};if(c.RECORD_SEP=String.fromCharCode(30),c.UNIT_SEP=String.fromCharCode(31),c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!e&&!!t.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=x,c.ParserHandle=E,c.NetworkStreamer=l,c.FileStreamer=p,c.StringStreamer=a,c.ReadableStreamStreamer=A,t.jQuery){var f=t.jQuery;f.fn.parse=function(b){var u=b.config||{},C=[];return this.each(function(L){if(!(f(this).prop("tagName").toUpperCase()==="INPUT"&&f(this).attr("type").toLowerCase()==="file"&&t.FileReader)||!this.files||this.files.length===0)return!0;for(var k=0;k<this.files.length;k++)C.push({file:this.files[k],inputElem:this,instanceConfig:f.extend({},u)})}),g(),this;function g(){if(C.length!==0){var L,k,I,N,$=C[0];if(w(b.before)){var R=b.before($.file,$.inputElem);if(typeof R=="object"){if(R.action==="abort")return L="AbortError",k=$.file,I=$.inputElem,N=R.reason,void(w(b.error)&&b.error({name:L},k,I,N));if(R.action==="skip")return void M();typeof R.config=="object"&&($.instanceConfig=f.extend($.instanceConfig,R.config))}else if(R==="skip")return void M()}var U=$.instanceConfig.complete;$.instanceConfig.complete=function(P){w(U)&&U(P,$.file,$.inputElem),M()},c.parse($.file,$.instanceConfig)}else w(b.complete)&&b.complete()}function M(){C.splice(0,1),g()}}}function m(b){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(u){var C=D(u);C.chunkSize=parseInt(C.chunkSize),u.step||u.chunk||(C.chunkSize=null),this._handle=new E(C),(this._handle.streamer=this)._config=C}.call(this,b),this.parseChunk=function(u,C){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var g=this._config.beforeFirstChunk(u);g!==void 0&&(u=g)}this.isFirstChunk=!1,this._halted=!1;var M=this._partialLine+u;this._partialLine="";var L=this._handle.parse(M,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var k=L.meta.cursor;this._finished||(this._partialLine=M.substring(k-this._baseIndex),this._baseIndex=k),L&&L.data&&(this._rowCount+=L.data.length);var I=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)t.postMessage({results:L,workerId:c.WORKER_ID,finished:I});else if(w(this._config.chunk)&&!C){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);L=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!I||!w(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),I||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(u){w(this._config.error)?this._config.error(u):s&&this._config.error&&t.postMessage({workerId:c.WORKER_ID,error:u,finished:!1})}}function l(b){var u;(b=b||{}).chunkSize||(b.chunkSize=c.RemoteChunkSize),m.call(this,b),this._nextChunk=e?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(C){this._input=C,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),e||(u.onload=v(this._chunkLoaded,this),u.onerror=v(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!e),this._config.downloadRequestHeaders){var C=this._config.downloadRequestHeaders;for(var g in C)u.setRequestHeader(g,C[g])}if(this._config.chunkSize){var M=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+M)}try{u.send(this._config.downloadRequestBody)}catch(L){this._chunkError(L.message)}e&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(C){var g=C.getResponseHeader("Content-Range");return g===null?-1:parseInt(g.substring(g.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(C){var g=u.statusText||C;this._sendError(new Error(g))}}function p(b){var u,C;(b=b||{}).chunkSize||(b.chunkSize=c.LocalChunkSize),m.call(this,b);var g=typeof FileReader!="undefined";this.stream=function(M){this._input=M,C=M.slice||M.webkitSlice||M.mozSlice,g?((u=new FileReader).onload=v(this._chunkLoaded,this),u.onerror=v(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var M=this._input;if(this._config.chunkSize){var L=Math.min(this._start+this._config.chunkSize,this._input.size);M=C.call(M,this._start,L)}var k=u.readAsText(M,this._config.encoding);g||this._chunkLoaded({target:{result:k}})},this._chunkLoaded=function(M){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(M.target.result)},this._chunkError=function(){this._sendError(u.error)}}function a(b){var u;m.call(this,b=b||{}),this.stream=function(C){return u=C,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var C,g=this._config.chunkSize;return g?(C=u.substring(0,g),u=u.substring(g)):(C=u,u=""),this._finished=!u,this.parseChunk(C)}}}function A(b){m.call(this,b=b||{});var u=[],C=!0,g=!1;this.pause=function(){m.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){m.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(M){this._input=M,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){g&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):C=!0},this._streamData=v(function(M){try{u.push(typeof M=="string"?M:M.toString(this._config.encoding)),C&&(C=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(L){this._streamError(L)}},this),this._streamError=v(function(M){this._streamCleanUp(),this._sendError(M)},this),this._streamEnd=v(function(){this._streamCleanUp(),g=!0,this._streamData("")},this),this._streamCleanUp=v(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function E(b){var u,C,g,M=Math.pow(2,53),L=-M,k=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,I=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,N=this,$=0,R=0,U=!1,P=!1,F=[],j={data:[],errors:[],meta:{}};if(w(b.step)){var Y=b.step;b.step=function(K){if(j=K,le())te();else{if(te(),j.data.length===0)return;$+=K.data.length,b.preview&&$>b.preview?C.abort():(j.data=j.data[0],Y(j,N))}}}function H(K){return b.skipEmptyLines==="greedy"?K.join("").trim()==="":K.length===1&&K[0].length===0}function te(){if(j&&g&&(ce("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),g=!1),b.skipEmptyLines)for(var K=0;K<j.data.length;K++)H(j.data[K])&&j.data.splice(K--,1);return le()&&function(){if(!j)return;function J(fe,pe){w(b.transformHeader)&&(fe=b.transformHeader(fe,pe)),F.push(fe)}if(Array.isArray(j.data[0])){for(var he=0;le()&&he<j.data.length;he++)j.data[he].forEach(J);j.data.splice(0,1)}else j.data.forEach(J)}(),function(){if(!j||!b.header&&!b.dynamicTyping&&!b.transform)return j;function J(fe,pe){var ye,re=b.header?{}:[];for(ye=0;ye<fe.length;ye++){var z=ye,ve=fe[ye];b.header&&(z=ye>=F.length?"__parsed_extra":F[ye]),b.transform&&(ve=b.transform(ve,z)),ve=ue(z,ve),z==="__parsed_extra"?(re[z]=re[z]||[],re[z].push(ve)):re[z]=ve}return b.header&&(ye>F.length?ce("FieldMismatch","TooManyFields","Too many fields: expected "+F.length+" fields but parsed "+ye,R+pe):ye<F.length&&ce("FieldMismatch","TooFewFields","Too few fields: expected "+F.length+" fields but parsed "+ye,R+pe)),re}var he=1;return!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(J),he=j.data.length):j.data=J(j.data,0),b.header&&j.meta&&(j.meta.fields=F),R+=he,j}()}function le(){return b.header&&F.length===0}function ue(K,J){return he=K,b.dynamicTypingFunction&&b.dynamicTyping[he]===void 0&&(b.dynamicTyping[he]=b.dynamicTypingFunction(he)),(b.dynamicTyping[he]||b.dynamicTyping)===!0?J==="true"||J==="TRUE"||J!=="false"&&J!=="FALSE"&&(function(fe){if(k.test(fe)){var pe=parseFloat(fe);if(L<pe&&pe<M)return!0}return!1}(J)?parseFloat(J):I.test(J)?new Date(J):J===""?null:J):J;var he}function ce(K,J,he,fe){var pe={type:K,code:J,message:he};fe!==void 0&&(pe.row=fe),j.errors.push(pe)}this.parse=function(K,J,he){var fe=b.quoteChar||'"';if(b.newline||(b.newline=function(re,z){re=re.substring(0,1048576);var ve=new RegExp(y(z)+"([^]*?)"+y(z),"gm"),Ee=(re=re.replace(ve,"")).split("\r"),Re=re.split(`
`),Ie=1<Re.length&&Re[0].length<Ee[0].length;if(Ee.length===1||Ie)return`
`;for(var qe=0,De=0;De<Ee.length;De++)Ee[De][0]===`
`&&qe++;return qe>=Ee.length/2?`\r
`:"\r"}(K,fe)),g=!1,b.delimiter)w(b.delimiter)&&(b.delimiter=b.delimiter(K),j.meta.delimiter=b.delimiter);else{var pe=function(re,z,ve,Ee,Re){var Ie,qe,De,Qe;Re=Re||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Ne=0;Ne<Re.length;Ne++){var ht=Re[Ne],Tt=0,Ae=0,Xe=0;De=void 0;for(var Pe=new x({comments:Ee,delimiter:ht,newline:z,preview:10}).parse(re),et=0;et<Pe.data.length;et++)if(ve&&H(Pe.data[et]))Xe++;else{var Fe=Pe.data[et].length;Ae+=Fe,De!==void 0?0<Fe&&(Tt+=Math.abs(Fe-De),De=Fe):De=Fe}0<Pe.data.length&&(Ae/=Pe.data.length-Xe),(qe===void 0||Tt<=qe)&&(Qe===void 0||Qe<Ae)&&1.99<Ae&&(qe=Tt,Ie=ht,Qe=Ae)}return{successful:!!(b.delimiter=Ie),bestDelimiter:Ie}}(K,b.newline,b.skipEmptyLines,b.comments,b.delimitersToGuess);pe.successful?b.delimiter=pe.bestDelimiter:(g=!0,b.delimiter=c.DefaultDelimiter),j.meta.delimiter=b.delimiter}var ye=D(b);return b.preview&&b.header&&ye.preview++,u=K,C=new x(ye),j=C.parse(u,J,he),te(),U?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return U},this.pause=function(){U=!0,C.abort(),u=w(b.chunk)?"":u.substring(C.getCharIndex())},this.resume=function(){N.streamer._halted?(U=!1,N.streamer.parseChunk(u,!0)):setTimeout(N.resume,3)},this.aborted=function(){return P},this.abort=function(){P=!0,C.abort(),j.meta.aborted=!0,w(b.complete)&&b.complete(j),u=""}}function y(b){return b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function x(b){var u,C=(b=b||{}).delimiter,g=b.newline,M=b.comments,L=b.step,k=b.preview,I=b.fastMode,N=u=b.quoteChar===void 0?'"':b.quoteChar;if(b.escapeChar!==void 0&&(N=b.escapeChar),(typeof C!="string"||-1<c.BAD_DELIMITERS.indexOf(C))&&(C=","),M===C)throw new Error("Comment character same as delimiter");M===!0?M="#":(typeof M!="string"||-1<c.BAD_DELIMITERS.indexOf(M))&&(M=!1),g!==`
`&&g!=="\r"&&g!==`\r
`&&(g=`
`);var $=0,R=!1;this.parse=function(U,P,F){if(typeof U!="string")throw new Error("Input must be a string");var j=U.length,Y=C.length,H=g.length,te=M.length,le=w(L),ue=[],ce=[],K=[],J=$=0;if(!U)return Ne();if(I||I!==!1&&U.indexOf(u)===-1){for(var he=U.split(g),fe=0;fe<he.length;fe++){if(K=he[fe],$+=K.length,fe!==he.length-1)$+=g.length;else if(F)return Ne();if(!M||K.substring(0,te)!==M){if(le){if(ue=[],Ie(K.split(C)),ht(),R)return Ne()}else Ie(K.split(C));if(k&&k<=fe)return ue=ue.slice(0,k),Ne(!0)}}return Ne()}for(var pe=U.indexOf(C,$),ye=U.indexOf(g,$),re=new RegExp(y(N)+y(u),"g"),z=U.indexOf(u,$);;)if(U[$]!==u)if(M&&K.length===0&&U.substring($,$+te)===M){if(ye===-1)return Ne();$=ye+H,ye=U.indexOf(g,$),pe=U.indexOf(C,$)}else{if(pe!==-1&&(pe<ye||ye===-1)){if(!(pe<z)){K.push(U.substring($,pe)),$=pe+Y,pe=U.indexOf(C,$);continue}var ve=Tt(pe,z,ye);if(ve&&ve.nextDelim!==void 0){pe=ve.nextDelim,z=ve.quoteSearch,K.push(U.substring($,pe)),$=pe+Y,pe=U.indexOf(C,$);continue}}if(ye===-1)break;if(K.push(U.substring($,ye)),Qe(ye+H),le&&(ht(),R))return Ne();if(k&&ue.length>=k)return Ne(!0)}else for(z=$,$++;;){if((z=U.indexOf(u,z+1))===-1)return F||ce.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ue.length,index:$}),De();if(z===j-1)return De(U.substring($,z).replace(re,u));if(u!==N||U[z+1]!==N){if(u===N||z===0||U[z-1]!==N){pe!==-1&&pe<z+1&&(pe=U.indexOf(C,z+1)),ye!==-1&&ye<z+1&&(ye=U.indexOf(g,z+1));var Ee=qe(ye===-1?pe:Math.min(pe,ye));if(U[z+1+Ee]===C){K.push(U.substring($,z).replace(re,u)),U[$=z+1+Ee+Y]!==u&&(z=U.indexOf(u,$)),pe=U.indexOf(C,$),ye=U.indexOf(g,$);break}var Re=qe(ye);if(U.substring(z+1+Re,z+1+Re+H)===g){if(K.push(U.substring($,z).replace(re,u)),Qe(z+1+Re+H),pe=U.indexOf(C,$),z=U.indexOf(u,$),le&&(ht(),R))return Ne();if(k&&ue.length>=k)return Ne(!0);break}ce.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ue.length,index:$}),z++}}else z++}return De();function Ie(Ae){ue.push(Ae),J=$}function qe(Ae){var Xe=0;if(Ae!==-1){var Pe=U.substring(z+1,Ae);Pe&&Pe.trim()===""&&(Xe=Pe.length)}return Xe}function De(Ae){return F||(Ae===void 0&&(Ae=U.substring($)),K.push(Ae),$=j,Ie(K),le&&ht()),Ne()}function Qe(Ae){$=Ae,Ie(K),K=[],ye=U.indexOf(g,$)}function Ne(Ae){return{data:ue,errors:ce,meta:{delimiter:C,linebreak:g,aborted:R,truncated:!!Ae,cursor:J+(P||0)}}}function ht(){L(Ne()),ue=[],ce=[]}function Tt(Ae,Xe,Pe){var et={nextDelim:void 0,quoteSearch:void 0},Fe=U.indexOf(u,Xe+1);if(Xe<Ae&&Ae<Fe&&(Fe<Pe||Pe===-1)){var Xt=U.indexOf(C,Fe);if(Xt===-1)return et;Fe<Xt&&(Fe=U.indexOf(u,Fe+1)),et=Tt(Xt,Fe,Pe)}else et={nextDelim:Ae,quoteSearch:Xe};return et}},this.abort=function(){R=!0},this.getCharIndex=function(){return $}}function S(b){var u=b.data,C=n[u.workerId],g=!1;if(u.error)C.userError(u.error,u.file);else if(u.results&&u.results.data){var M={abort:function(){g=!0,O(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:T,resume:T};if(w(C.userStep)){for(var L=0;L<u.results.data.length&&(C.userStep({data:u.results.data[L],errors:u.results.errors,meta:u.results.meta},M),!g);L++);delete u.results}else w(C.userChunk)&&(C.userChunk(u.results,M,u.file),delete u.results)}u.finished&&!g&&O(u.workerId,u.results)}function O(b,u){var C=n[b];w(C.userComplete)&&C.userComplete(u),C.terminate(),delete n[b]}function T(){throw new Error("Not implemented.")}function D(b){if(typeof b!="object"||b===null)return b;var u=Array.isArray(b)?[]:{};for(var C in b)u[C]=D(b[C]);return u}function v(b,u){return function(){b.apply(u,arguments)}}function w(b){return typeof b=="function"}return s&&(t.onmessage=function(b){var u=b.data;if(c.WORKER_ID===void 0&&u&&(c.WORKER_ID=u.workerId),typeof u.input=="string")t.postMessage({workerId:c.WORKER_ID,results:c.parse(u.input,u.config),finished:!0});else if(t.File&&u.input instanceof File||u.input instanceof Object){var C=c.parse(u.input,u.config);C&&t.postMessage({workerId:c.WORKER_ID,results:C,finished:!0})}}),(l.prototype=Object.create(m.prototype)).constructor=l,(p.prototype=Object.create(m.prototype)).constructor=p,(a.prototype=Object.create(a.prototype)).constructor=a,(A.prototype=Object.create(m.prototype)).constructor=A,c})});var ft={async XHR(d){let t=window.GM_xmlhttpRequest||(GM?GM.xmlHttpRequest:null);return t?new Promise((e,s)=>{Object.assign(d,{onabort:s,onerror:s,onload:e,ontimeout:s}),t(d)}):Promise.reject()},async getValue(d,t=null){return window.GM_getValue?Promise.resolve(GM_getValue(d)||t):await GM.getValue(d)||t},async setValue(d,t){window.GM_setValue?GM_setValue(d,t):GM.setValue(d,t)}};var xn="OC-Addons",no="St\xE9phane TORCHY",B="background-color:green;color:white",ro="background-color:black;color:white",tt="background-color:coral;color:white",io="background-color:cyan;color:white",ge="background-color:red;color:white",ze="background-color:blue;color:white",nt="auto-financ\xE9",$e="financ\xE9 par un tiers",gt="autre",yt="r\xE9alis\xE9e",pt="annul\xE9e",bt="annul\xE9e tardivement",vt="\xE9tudiant absent",Bt="\xE9tudiante absente",_t=6,En=30,Cn=35,Tn=40,Dn=45,On=50,Mn=55,Z=0,X=1,ee=2,oo=[{pathId:158,path:"158-trouvez-lemploi-qui-vous-correspond",value:2}],oe=0,se=1,ne=2,ae=3,q=0,V=1,Q=2,Nn=0,In="completed",jn="canceled",kn="late canceled",Bn="marked student as absent",$t="ol";var $n=function(){return new Promise(d=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",d):d()})},Vt=async function(d="",t="",e=!1){console.info(`%cfetch() waiting return from : ${d}`,B);let s=await ft.XHR({method:"GET",url:d,responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"},onprogress:function(m){}}).catch(m=>{console.error(`%cError ${m}`,ge)}),o=new DOMParser().parseFromString(s.responseText.replace(/\n/mg,""),"text/html");if(o.querySelector("meta[id=captcha-bypass]")!==null)throw console.error(`%cError CloudFlare CAPTCHA : ${o.querySelector("title").innerText}`,B),new Error("Must Respond to Cloudflare Captcha or waiting....");var f={};return e===!0?f=o.querySelectorAll(t):f=o.querySelector(t),f};var mt=function(d,t=-1){try{var e=(d.querySelector("a").href||"/").split("/");return e[e.length+t]}catch(s){console.error(`%cError in getkey${s.stack||s}`,ge)}},Yn=function(d){var t=d.trim().split(" ");try{var e=dayjs_locale_fr.months.findIndex(s=>s===t[1])+1}catch(s){console.error(`%cError in extractDate${s.stack||s}`,ge)}return`${t[2]}-${e}-${t[0]}T${t[4]}`};var We=function(d){return new Promise(t=>setTimeout(t,d))},Ln=function(d){return d.substring(d.lastIndexOf(".")+1,d.length)||d},Yt=function(d,t){for(var e=d.split("."),s=t.split("."),n=0;n<3;n++){var o=Number(e[n]),c=Number(s[n]);if(o>c)return 1;if(c>o)return-1;if(!isNaN(o)&&isNaN(c))return 1;if(isNaN(o)&&!isNaN(c))return-1}return 0},Rn=function(t,e){return console.info("Reading:",t),fetch(t,{mode:"same-origin"}).then(function(s){return s.blob()}).then(function(s){var n=new FileReader;n.addEventListener("loadend",function(){e(this.result)}),n.readAsText(s)})},Pn=function(d){let t=d,e=d.reduce(function(p,a){return p*a});var s=new Array(e);let n=function(...p){let a=p.pop();if(p.length!==d.length)throw"Wrong matrix dimensions, need "+d.length+", you provide "+a.length+"!";if(l(p)===0)throw"Wrong type for set need one or more int has dimension, check type of!";let A=m(p);return s[A]=a,a},o=function(...p){if(p.length!==d.length)throw"Wrong matrix dimensions, need "+d.length+", you provide "+p.length+"!";if(l(p)===0)throw"Wrong type for set need one or more int has dimension, check type of!";let a=m(p);return s[a]},c=function(...p){let a=m(p);return s[a]=void 0,s[a]===void 0},f=function(){console.group("dump table"),console.table(s),console.groupEnd("dump table")},m=function(p){return p.reduce(function(a,A,E,y){let x=t.slice(E+1),S=x.length>0?x.reduce(function(O,T){return O*T}):1;return a+A*S},0)},l=function(p){return p.reduce((a,A)=>a&typeof A=="number",1)};return Object.freeze({set:n,get:o,del:c,toConsole:f})},Fn=function(d,t=0){let e=3735928559^t,s=1103547991^t;for(let n=0,o;n<d.length;n++)o=d.charCodeAt(n),e=Math.imul(e^o,2654435761),s=Math.imul(s^o,1597334677);return e=Math.imul(e^e>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507)^Math.imul(e^e>>>13,3266489909),4294967296*(2097151&s)+(e>>>0)},me=function(d,t,e=Error){if(!d)throw new e(t)};var Hn=d=>d==null;var en=d=>Array.isArray(d),Un=d=>d.toString().trim().length<="function(){}".length;var Dt=function(d){var t;return function(){var e=this,s=arguments;t&&window.cancelAnimationFrame(t),t=window.requestAnimationFrame(function(){d.apply(e,s)})}};var qn=function(d){let t=Date.now(),e=null;do e=Date.now();while(e-t<d)};HTMLElement.prototype.appendFirst=function(d){this.firstChild?this.insertBefore(d,this.firstChild):this.appendChild(d)};var Ot=async function(d=null,t=null,e=!0){var s="";s+="<style>",s+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",s+="form input {background: #fff;border: 1px solid #9c9c9c;}",s+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",s+="form button:hover {background: gold;}",s+="form label {padding: 0.5em 0.5em 0.5em 0;}",s+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",s+="form input:focus {outline: 3px solid gold;}",s+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}form label {text-align: right;grid-column: 1 / 2;}form input, form button {grid-column: 2 / 3;}}",s+="</style>",s+='<form class="form1" action="">',s+='<label for="dtFrom" class="date">Date de d\xE9but</label>',d?s+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(d).format("YYYY-MM-DD")+'">':s+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',s+='<label for="dtTo" class="date">Date de fin</label>',d?s+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(t).format("YYYY-MM-DD")+'">':s+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',s+="</form>";let{value:n}=await Swal.fire({title:"<strong>Choix de la p\xE9riode</strong>",icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez la p\xE9riode pour la s\xE9lection des temps factur\xE9s",showLoaderOnConfirm:!0,preConfirm:()=>[document.getElementById("dtFrom").value,document.getElementById("dtTo").value],onRender:o=>{},onOpen:o=>{e===!0&&o.querySelector("#dtFrom").addEventListener("change",_handler=function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:o=>{e===!0&&o.querySelector("#dtFrom").removeEventListener("change",_handler)},onAfterClose:o=>{},onDestroy:o=>{}});return d=dayjs(n[0]),t=dayjs(n[1]),await We(250),[d,t]},Mt=async function(d){await Swal.fire({position:"top-end",icon:"success",title:d,showConfirmButton:!1,timer:1500})};var rt=class{},wt=rt;G(wt,"tbl_name","f_archives"),G(wt,"add",async function(t){let e=W.Cfg.dbase,s=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]"),n={id:t[0].to.format("YYYYMM"),data:t,created_at:t[0].now};console.log(`%cWill create archive for id ${t[0].to.format("YYYYMM")} (YYYYMM)`,B),e.get(rt.tbl_name).push(JSON.parse(JSON.stringify(n))).write()}),G(wt,"exists",function(t){return W.Cfg.dbase.get(rt.tbl_name).find({id:t}).value()!==void 0}),G(wt,"get",function(t){var s=W.Cfg.dbase.get(rt.tbl_name).find({id:t}).value();if(s===void 0)throw Error("Erreur qui ne devrait jamais arriver en Archive.get");return console.log(`%cWill use archive for id ${t} (YYYYMM)`,B),s}),G(wt,"delete",function(t=null,e=null){let s=W.Cfg.dbase;if(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),t===null&&e==null){console.log("%cWanna suppress ALL Archives from DB ",B),s.get(rt.tbl_name).remove().write();return}if(e==null){s.get(rt.tbl_name).remove(function(n){return dayjs(n.id,"YYYYMM").isBefore(e),"month"}).write();return}if(t==null){s.get(rt.tbl_name).remove(function(n){return dayjs(n.id,"YYYYMM").isAfter(t,"month")}).write();return}s.get(rt.tbl_name).remove(function(n){return dayjs(n.id,"YYYYMM").isBetween(t,e,"month","[]")}).write()});var At=wt;var tn=class{},Lt=tn;G(Lt,"isInOldMode",function(t){var e=null;typeof t=="string"?e=dayjs(t):e=t;try{return e.isBefore(tn.getOldModeDate())}catch(s){throw Error("Erreur qui ne devrait jamais arriver en IsInOldMode (probablement un probleme sur la conversion de la date en objet dayjs:"+s.stack||s)}}),G(Lt,"getOldModeDate",function(){return dayjs("2020-06-01")}),G(Lt,"getAppVersion",function(){return GM.info.script.version});var Ce=Lt;var $r=function(){let d="students_history",t=1,e=2,s=function(A){if(A.toUpperCase()==="FUNDING")return t;if(A.toUpperCase()==="PATH")return e;throw Error("Erreur qui ne devrait jamais arriver en getype")},n=function(A,E,y=null){return c(A,t,E,y)},o=function(A,E,y=null){return c(A,e,E,y)},c=function(A,E,y,x=null){let S=!1;typeof A=="number"&&(A=A.toString(10)),me(typeof A=="string","You must provide a string.",TypeError);let O=W.Cfg.dbase;typeof x=="string"&&(x=dayjs(x)),x===null&&(x=dayjs()),me(x instanceof dayjs,"created date must be a string, a dayjs instance or null.",TypeError);let T={id:A,type:0|E,value:y,date:x.valueOf(),humanDate:x.format("YYYY-MM-DDTHH:mm:ssZZ")};return S===!0&&console.log(`%cAdd in student history at date ${dayjs(T.date).format("YYYY-MM-DDTHH:mm:ssZZ")} data ${y} with type:${E} cf const of object`,B),O.get(d).push(JSON.parse(JSON.stringify(T))).write()},f=function(A,E=null,y=null){let x=W.Cfg.dbase;return A==null&&E==null&&y==null?(console.log("%cRemove all in student history",B),x.get(d).remove().write()):(typeof y=="string"&&(y=dayjs(y)),y==null?E==null?(console.log(`%cRemove for student id:${A} history for all type of event`,B),x.get(d).remove({id:A}).write()):(console.log(`%cRemove for student id:${A} history with event type:${E} cf const of object`,B),x.get(d).remove({id:A,type:E}).write()):(console.log(`%cRemove for student id:${A} history at date ${y.format("DD/MM/YYYY")} with event type:${E} cf const of object`,B),x.get(d).remove({id:A,type:E,date:y.valueOf()}).write()))},m=function(A,E,y=null){let x=!1,S=W.Cfg.dbase;typeof y=="string"&&(y=dayjs(y)),y===null&&(y=dayjs()),x===!0&&console.log("%cSearching in student history at date %o ",B,y),x===!0&&console.log(`%cSearching in student history at date ${y.format("DD/MM/YYYY")} any data with type:${E} cf const of object`,B);var O=+y.valueOf(),T=S.get(d).filter(w=>w.id===A&&w.type&E).map(w=>w.date-O).filter(w=>w>=0).value();if(T.length==0){x===!0&&console.log(`%cThere is no data in student history at date ${y.format("DD/MM/YYYY")} with type:${E} cf const of object`,B);return}let v=O+(w=>Math.min(...w))(T);return S.get(d).filter(w=>w.id===A&&w.type&E&&w.date==v).value()[0]},l=function(A){return a(A,t)},p=function(A){return a(A,e)},a=function(A,E){return A.type&E};return Object.freeze({addFunding:n,addPath:o,getType:s,remove:f,find:m,isFunding:l,isPath:p,tbl_name:d})},Yr=$r(),Ge=Yr;var Lr=function(){let d={},t="0",e=!0,s="https://api.openclassrooms.com",n="pending",o="canceled",c="completed",f="late canceled",m="marked student as absent",l=async function(){let j=await a();return j=JSON.parse(j),t=j.id,t},p=async function(){if(d.length==0)throw new Error("_header is empty, no xhr have been trapped so could't do some api request")},a=async function(){let j=s+"/me";return await R(j)},A=async function(j){let Y=`${s}/mentors/${j}`;return await R(Y)},E=function(j,Y){return{Range:`items=${j}-${Y}`}},y=async(j=dayjs(),Y=0,H=19)=>await O("AFTER",j,[n],Y,H),x=async(j=dayjs(),Y=0,H=19)=>await O("BEFORE",j,[n],Y,H),S=async(j,Y=0,H=19)=>await T(j,Y,H),O=async function(j="BEFORE",Y,H=[o,c,f,m],te=0,le=19){bDebug=!0,typeof Y=="string"&&(Y=dayjs(Y)),me(en(H)===!0,"You must provide an array as param aFilter.",TypeError),me(Y instanceof dayjs,"date must be a string or a dayjs object.",TypeError);let ue=H.join(","),ce=encodeURIComponent(Y.format("YYYY-MM-DDTHH:MM:ss[Z]"));ue=encodeURIComponent(ue);let K="";t==0&&await l(),j==="AFTER"?(K=`${s}/users/${t}/sessions?actor=expert&after=${ce}&life-cycle-status=${ue}`,console.log("URL IS %s",K)):(K=`${s}/users/${t}/sessions?actor=expert&before=${ce}&life-cycle-status=${ue}`,console.log("URL IS %s",K));let J=E(te,le);return bDebug&&console.log("%c_getSessionOnDate url to call is:%s , params are %o",B,K,J),await k(K,E(te,le))},T=async function(j=[],Y=0,H=19){bDebug=!0,me(en(j)===!0,"You must provide an array as param aFilter.",TypeError),j.length==0&&(j=[o,c,f,m]);let te=j.join(",");te=encodeURIComponent(te),t==0&&await l();let le=`${s}/users/${t}/sessions?actor=expert&life-cycle-status=${te}`,ue=E(Y,H);bDebug&&console.log("%cUrl to call is:%o , params are %o",B,le,ue);let ce=await k(le,ue);if(ce==null)throw console.error("%cAPI have a problem returned value %o is null|undefined",ge,ce),new Error(`Request:${s}/users/${t}/sessions?actor=expert&life-cycle-status=${te} have a problem`);return ce.errors&&console.log("%cAPI return an error %s",ge,ce.errors.message),ce},D=async function(j){let Y=`${s}/users/${j}`;return await k(Y)},v=async function(j){let Y=`${s}/users/${j}/availabilities`;return await k(Y)},w=async function(j,Y=0,H=19){let te=`${s}/users/${j}/events`;return await k(te,E(Y,H))},b=async function(j,Y){typeof Y=="string"&&(Y=dayjs(Y)),me(Y instanceof dayjs,"date must be a string or a dayjs object.",TypeError);let H=encodeURIComponent(Y.format("YYYY-MM-DDTHH:MM:ss[Z]")),te=`${s}/users/${j}/events?after=${H}`;return await k(te)},u=async function(j,Y){typeof Y=="string"&&(Y=dayjs(Y)),me(Y instanceof dayjs,"date must be a string or a dayjs object.",TypeError);let H=encodeURIComponent(Y.format("YYYY-MM-DDTHH:MM:ss[Z]")),te=`${s}/users/${j}/events?before=${H}`;return await k(te)},C=async function(j){await p();let Y=`${s}/users/${j}/paths/followed-path`;return await k(Y)},g=async function(j){let Y=`${s}/users/${j}/paths`;return await k(Y)},M=async function(j=null){if(j===null){let te=await a();te=JSON.parse(te),j=te.id}let Y=`${s}/mentors/${j}/students`,H;try{H=await k(Y)}catch(te){console.error("%c[getUserStudents()] Trapped error %o",ge,te)}finally{return H}},L=async function(j=null,Y,H,te){if(j===null){let J=await a();J=JSON.parse(J),j=J.id}let le=`${s}/mentoring-sessions`,ce=await I(le,{},{mentorId:j,projectId:Y,studentId:H,sessionDate:te});if(typeof ce=="string"){let J=JSON.parse(ce);if("errors"in J&&J.errors.length==1&&J.errors[0].code==="SESSION_ALREADY_EXISTS"){let he=J.errors[0];console.error("%c[Api.bookStudent()] call bookStudent error[%s] :%s ",ge,he.code,he.message)}else console.log("%c[Api.bookStudent()] return an unknow value :%o",ge,J);return J}let K=await ce.json();console.log("%c[Api.bookStudent()] return :%o ",B,K)},k=async function(j,Y={}){await p();let H=await R(j,Y);if(typeof H=="string"){let te=JSON.parse(H);if(typeof te.errors!="undefined"){let le=te.errors.reduce((ue,ce)=>`${ue}{v.message}`);throw console.error("%c[Api.xGet()] call _fetchGet error :%s ",ge,le.message),new Error(`[Api.xGet()] Irrecoverable error :' ${le.message}'`)}return H}throw new Error(`[Api.xGet()] Irrecoverable error result is not a string but a :' ${typeof H}'`)},I=async function(j,Y={},H={},te=!0){await p();let le=await U(j,Y,H);if(console.log("%c[Api.xPost()] call _fetchPost with url :%s and with data:%o",B,j,H),typeof le=="string"){let ue=JSON.parse(le);if(typeof ue.errors!="undefined"){if(ue.errors.length==1&&ue.errors[0].code==="SESSION_ALREADY_EXISTS"||ue.errors.length==1&&ue.errors[0].code==="TOO_LOW_ERROR"&&ue.errors[0].field==="sessionDate")return le;console.error("%c[Api.xPost()] raw list of error :%o ",ge,ue);let ce=ue.errors.reduce((K,J)=>`${K}{v.message}`);if(console.error("%c[Api.xPost()] call _fetchPost error :%s ",ge,ce.message),te===!0)throw new Error(`[Api.xPost()] Irrecoverable error :' ${ce.message}'`);return}return le}if(te===!0)throw new Error(`[Api.xPost()] Irrecoverable error result is not a string but a :' ${typeof le}'`)},N=function(j){t=j},$=function(j){return decodeURI(j)!==decodeURIComponent(j)},R=async function(j="",Y={},H="json",te="",le=!0,ue=!1){let ce=Object.assign({"User-Agent":"Mozilla/5.0"},d,Y);if(H.toLowerCase()==="json"){let J=await ft.XHR({method:"GET",url:j,responseType:"application/json",headers:ce}).catch(he=>{if(Hn(J)){if(ue===!0)throw new Error(`[Api._fetchGet()] Repsponse is undefined : ${he}'`);return null}return console.error("%c[_fetchGet()]Error is %o",ge,he),null});return J.responseText}if(H.toLowerCase==="html"){let J=await ft.XHR({method:"GET",url:j,responseType:"application/json",headers:ce}).catch(pe=>{console.error("%c[Api_fetchGet()]Error is %o",ge,pe)}),fe=new DOMParser().parseFromString(J.responseText.replace(/\n/mg,""),"text/html");var K={};return le===!0?K=fe.querySelectorAll(te):K=fe.querySelector(te),K}},U=async function(j="",Y={},H={}){console.info(`%c[Api._fetchPost()] waiting return from : ${j}`,B,j);let te=Object.assign({"User-Agent":"Mozilla/5.0"},d,Y);return console.log("%c[Api._fetchPost()]final header is %o",B,te),console.log("%c[Api._fetchPost()]data is %o",B,H),(await ft.XHR({method:"POST",url:j,responseType:"application/json",headers:te,data:JSON.stringify(H)}).catch(ue=>{console.error("%c[Api_fetchPost()]Error is %o",ge,ue)})).responseText},P=function(){let j=/^https:\/\/api.openclassrooms.com/g;var Y=window.XMLHttpRequest.prototype.open,H=window.XMLHttpRequest.prototype.send,te=window.XMLHttpRequest.prototype.setRequestHeader,le=function(J,he,fe,pe,ye){return this._url=he,this._requestHeaders={},this._knox=[],Y.apply(this,arguments)},ue=function(){if(this.readyState===4&&this.status&&this.status>=200&&this.status<300&&this._url.match(j))for(var J in this._knox)d[this._knox[J].key]=this._knox[J].value},ce=function(J){return this.onreadystatechange=ue,H.apply(this,arguments)},K=function(J,he){return this._url.match(j)&&this._knox.push({key:J,value:he}),this._requestHeaders[J]=he,te.apply(this,arguments)};window.XMLHttpRequest.prototype.open=le,window.XMLHttpRequest.prototype.send=ce,window.XMLHttpRequest.prototype.setRequestHeader=K},F=function(){let j=!1,Y=/^https:\/\/api.openclassrooms.com/g,H="color:DarkSalmon;background-color:AliceBlue;";var te=window.XMLHttpRequest.prototype.open,le=window.XMLHttpRequest.prototype.send,ue=window.XMLHttpRequest.prototype.setRequestHeader,ce=function(fe,pe,ye,re,z){return j===!0&&console.log("%cmethod %o url:%o, async:%o, user %o, password:%o",H,fe,pe,ye,re,z),this._url=pe,this._requestHeaders={},this._knox=[],te.apply(this,arguments)},K=function(){if(j===!0&&console.log("%cReady state changed to: %o",H,this.readyState),this.readyState===4&&this.status&&this.status>=200&&this.status<300){if(this._url.match(Y)){j===!0&&console.log("%cOPENCLASSROOMS API",H);for(var fe in this._knox)d[this._knox[fe].key]=this._knox[fe].value;j===!0&&console.log("%c _header is %o",H,d),j===!0&&($(this._url)?console.log("%cDECODED URL:%s",H,decodeURIComponent(this._url)):console.log("%c DECODED URL:%s",H,decodeURI(this._url)))}j===!0&&console.log("%cResponse is :%o",H,this.response)}},J=function(fe){return j===!0&&console.log("%csendReplacement(%o)",H,fe),this.onreadystatechange=K,le.apply(this,arguments)},he=function(fe,pe){return this._url.match(Y)&&this._knox.push({key:fe,value:pe}),this._requestHeaders[fe]=pe,ue.apply(this,arguments)};window.XMLHttpRequest.prototype.open=ce,window.XMLHttpRequest.prototype.send=J,window.XMLHttpRequest.prototype.setRequestHeader=he};return P(),Object.freeze({bookStudent:L,forge:N,getMe:a,getMentor:A,getPendingSessionAfter:y,getPendingSessionBefore:x,getHistorySession:S,getUser:D,getUserAvailabilities:v,getUserEvents:w,getUserEventsAfter:b,getUserEventsBefore:u,getUserFollowedPath:C,getUserPath:g,getUserStudents:M,xGet:k,xPost:I})},Rr=Lr(),Nt=Rr;var de=(d,t)=>function(){return t||(0,d[Object.keys(d)[0]])((t={exports:{}}).exports,t),t.exports},Ye=de({"src/lib/isFunction.js"(d,t){t.exports=function(s){return typeof s=="function"}}}),Je=de({"src/lib/isNil.js"(d,t){t.exports=function(s){return s==null}}}),Pr=de({"src/lib/fail.js"(d,t){t.exports=function(s){throw new TypeError("[tcomb] "+s)}}}),Rt=de({"src/lib/getFunctionName.js"(d,t){t.exports=function(s){return s.displayName||s.name||"<function"+s.length+">"}}}),Gn=de({"src/lib/stringify.js"(d,t){var e=Rt();function s(n,o){return typeof o=="function"?e(o):o}t.exports=function(o){try{return JSON.stringify(o,s,2)}catch(c){return String(o)}}}}),Se=de({"src/lib/assert.js"(d,t){var e=Ye(),s=Je(),n=Pr(),o=Gn();function c(f,m){f!==!0&&(e(m)?m=m():s(m)&&(m='Assert failed (turn on "Pause on exceptions" in your Source panel)'),c.fail(m))}c.fail=n,c.stringify=o,t.exports=c}}),Qt=de({"src/lib/isString.js"(d,t){t.exports=function(s){return typeof s=="string"}}}),it=de({"src/lib/isArray.js"(d,t){t.exports=function(s){return Array.isArray?Array.isArray(s):s instanceof Array}}}),ot=de({"src/lib/isObject.js"(d,t){var e=Je(),s=it();t.exports=function(o){return!e(o)&&typeof o=="object"&&!s(o)}}}),Le=de({"src/lib/isType.js"(d,t){var e=Ye(),s=ot();t.exports=function(o){return e(o)&&s(o.meta)}}}),je=de({"src/lib/getTypeName.js"(d,t){var e=Le(),s=Rt();t.exports=function(o){return e(o)?o.displayName:s(o)}}}),Pt=de({"src/lib/forbidNewOperator.js"(d,t){var e=Se(),s=je();t.exports=function(o,c){e(!(o instanceof c),function(){return"Cannot use the new operator to instantiate the type "+s(c)})}}}),He=de({"src/lib/irreducible.js"(d,t){var e=Se(),s=Qt(),n=Ye(),o=Pt();t.exports=function(f,m){function l(p,a){return p}return l.meta={kind:"irreducible",name:f,predicate:m,identity:!0},l.displayName=f,l.is=m,l}}}),nn=de({"src/lib/Any.js"(d,t){var e=He();t.exports=e("Any",function(){return!0})}}),Fr=de({"src/lib/Array.js"(d,t){var e=He(),s=it();t.exports=e("Array",s)}}),zt=de({"src/lib/isBoolean.js"(d,t){t.exports=function(s){return s===!0||s===!1}}}),Vn=de({"src/lib/Boolean.js"(d,t){var e=He(),s=zt();t.exports=e("Boolean",s)}}),Hr=de({"src/lib/Date.js"(d,t){var e=He();t.exports=e("Date",function(s){return s instanceof Date})}}),Ur=de({"src/lib/Error.js"(d,t){var e=He();t.exports=e("Error",function(s){return s instanceof Error})}}),Wt=de({"src/lib/Function.js"(d,t){var e=He(),s=Ye();t.exports=e("Function",s)}}),Qn=de({"src/lib/Nil.js"(d,t){var e=He(),s=Je();t.exports=e("Nil",s)}}),rn=de({"src/lib/isNumber.js"(d,t){t.exports=function(s){return typeof s=="number"&&isFinite(s)&&!isNaN(s)}}}),zn=de({"src/lib/Number.js"(d,t){var e=He(),s=rn();t.exports=e("Number",s)}}),Ve=de({"src/lib/isTypeName.js"(d,t){var e=Je(),s=Qt();t.exports=function(o){return e(o)||s(o)}}}),st=de({"src/lib/isIdentity.js"(d,t){var e=Se(),s=Vn(),n=Le(),o=je();t.exports=function(f){return n(f)?f.meta.identity:!0}}}),at=de({"src/lib/create.js"(d,t){var e=Le(),s=Rt(),n=Se(),o=Gn();t.exports=function(f,m,l){return e(f)?!f.meta.identity&&typeof m=="object"&&m!==null?new f(m,l):f(m,l):m}}}),dt=de({"src/lib/is.js"(d,t){var e=Le();t.exports=function(n,o){return e(o)?o.is(n):n instanceof o}}}),on=de({"src/lib/refinement.js"(d,t){var e=Se(),s=Ve(),n=Ye(),o=Pt(),c=st(),f=at(),m=dt(),l=je(),p=Rt();function a(E,y){return"{"+l(E)+" | "+p(y)+"}"}function A(E,y,x){var S=x||a(E,y),O=c(E);function T(D,v){var w=f(E,D,v);return w}return T.meta={kind:"subtype",type:E,predicate:y,name:x,identity:O},T.displayName=S,T.is=function(D){return m(D,E)&&y(D)},T.update=function(D,v){return T(e.update(D,v))},T}A.getDefaultName=a,t.exports=A}}),qr=de({"src/lib/Integer.js"(d,t){var e=on(),s=zn();t.exports=e(s,function(n){return n%1==0},"Integer")}}),Gr=de({"src/lib/Object.js"(d,t){var e=He(),s=ot();t.exports=e("Object",s)}}),Vr=de({"src/lib/RegExp.js"(d,t){var e=He();t.exports=e("RegExp",function(s){return s instanceof RegExp})}}),sn=de({"src/lib/String.js"(d,t){var e=He(),s=Qt();t.exports=e("String",s)}}),Qr=de({"src/lib/Type.js"(d,t){var e=He(),s=Le();t.exports=e("Type",s)}}),an=de({"src/lib/dict.js"(d,t){var e=Se(),s=Ve(),n=Ye(),o=je(),c=st(),f=ot(),m=at(),l=dt();function p(A,E){return"{[key: "+o(A)+"]: "+o(E)+"}"}function a(A,E,y){var x=y||p(A,E),S=o(A),O=o(E),T=c(A)&&c(E);function D(v,w){if(T)return v;var b=!0,u={};for(var C in v)if(v.hasOwnProperty(C)){C=m(A,C,null);var g=v[C],M=m(E,g,null);b=b&&g===M,u[C]=M}return b&&(u=v),u}return D.meta={kind:"dict",domain:A,codomain:E,name:y,identity:T},D.displayName=x,D.is=function(v){if(!f(v))return!1;for(var w in v)if(v.hasOwnProperty(w)&&(!l(w,A)||!l(v[w],E)))return!1;return!0},D.update=function(v,w){return D(e.update(v,w))},D}a.getDefaultName=p,t.exports=a}}),dn=de({"src/lib/mixin.js"(d,t){var e=Je(),s=Se();t.exports=function(o,c,f){if(e(c))return o;for(var m in c)c.hasOwnProperty(m)&&(o[m]=c[m]);return o}}}),Wn=de({"src/lib/isUnion.js"(d,t){var e=Le();t.exports=function(n){return e(n)&&n.meta.kind==="union"}}}),zr=de({"src/lib/declare.js"(d,t){var e=Se(),s=Ve(),n=Le(),o=Je(),c=dn(),f=je(),m=Wn(),l=1;t.exports=function(a){var A;function E(y,x){return A(y,x)}return E.define=function(y){return m(y)&&E.hasOwnProperty("dispatch")&&(y.dispatch=E.dispatch),A=y,c(E,A,!0),a&&(A.displayName=E.displayName=a,E.meta.name=a),E.meta.identity=A.meta.identity,E.prototype=A.prototype,E},E.displayName=a||f(E)+"$"+l++,E.meta={identity:!1},E.prototype=null,E}}}),Wr=de({"src/lib/enums.js"(d,t){var e=Se(),s=Ve(),n=Pt(),o=rn(),c=Qt(),f=ot();function m(p){return Object.keys(p).map(function(a){return e.stringify(a)}).join(" | ")}function l(p,a){var A=a||m(p);function E(y,x){return y}return E.meta={kind:"enums",map:p,name:a,identity:!0},E.displayName=A,E.is=function(y){return(c(y)||o(y))&&p.hasOwnProperty(y)},E}l.of=function(p,a){p=c(p)?p.split(" "):p;var A={};return p.forEach(function(E){A[E]=E}),l(A,a)},l.getDefaultName=m,t.exports=l}}),Kn=de({"src/lib/list.js"(d,t){var e=Se(),s=Ve(),n=Ye(),o=je(),c=st(),f=at(),m=dt(),l=it();function p(A){return"Array<"+o(A)+">"}function a(A,E){var y=E||p(A),x=o(A),S=c(A);function O(T,D){if(S)return T;for(var v=!0,w=[],b=0,u=T.length;b<u;b++){var C=T[b],g=f(A,C,null);v=v&&C===g,w.push(g)}return v&&(w=T),w}return O.meta={kind:"list",type:A,name:E,identity:S},O.displayName=y,O.is=function(T){return l(T)&&T.every(function(D){return m(D,A)})},O.update=function(T,D){return O(e.update(T,D))},O}a.getDefaultName=p,t.exports=a}}),Kr=de({"src/lib/isMaybe.js"(d,t){var e=Le();t.exports=function(n){return e(n)&&n.meta.kind==="maybe"}}}),Jr=de({"src/lib/maybe.js"(d,t){var e=Se(),s=Ve(),n=Ye(),o=Kr(),c=st(),f=nn(),m=at(),l=Qn(),p=Pt(),a=dt(),A=je();function E(x){return"?"+A(x)}function y(x,S){if(o(x)||x===f||x===l)return x;var O=S||E(x),T=c(x);function D(v,w){return l.is(v)?v:m(x,v,w)}return D.meta={kind:"maybe",type:x,name:S,identity:T},D.displayName=O,D.is=function(v){return l.is(v)||a(v,x)},D}y.getDefaultName=E,t.exports=y}}),Jn=de({"src/lib/getDefaultInterfaceName.js"(d,t){var e=je();function s(n){return"{"+Object.keys(n).map(function(o){return o+": "+e(n[o])}).join(", ")+"}"}t.exports=s}}),Zr=de({"src/lib/isStruct.js"(d,t){var e=Le();t.exports=function(n){return e(n)&&n.meta.kind==="struct"}}}),Xr=de({"src/lib/isInterface.js"(d,t){var e=Le();t.exports=function(n){return e(n)&&n.meta.kind==="interface"}}}),ei=de({"src/lib/decompose.js"(d,t){var e=Le();function s(f){return e(f)&&f.meta.kind==="subtype"}function n(f){return s(f)?[f.meta.predicate].concat(n(f.meta.type)):[]}function o(f){return s(f)?o(f.meta.type):f}function c(f){return{predicates:n(f),unrefinedType:o(f)}}t.exports=c}}),Zn=de({"src/lib/extend.js"(d,t){var e=Se(),s=Ye(),n=it(),o=dn(),c=Zr(),f=Xr(),m=ot(),l=on(),p=ei();function a(S,O,T){var D=S.reduce(function(v,w){return l(v,w)},O);return T&&(D.displayName=T,D.meta.name=T),D}function A(S){return m(S)?S:S.meta.props}function E(S){return m(S)?null:S.meta.defaultProps}function y(S,O){Array.prototype.push.apply(S,O)}function x(S,O,T){var D={},v={},w=[],b={};O.forEach(function(C,g){var M=p(C),L=M.unrefinedType;y(w,M.predicates),o(D,A(L)),o(v,L.prototype),o(b,E(L),!0)}),T=S.getOptions(T),T.defaultProps=o(b,T.defaultProps,!0);var u=a(w,S(D,{strict:T.strict,defaultProps:T.defaultProps}),T.name);return o(u.prototype,v),u}t.exports=x}}),ti=de({"src/lib/struct.js"(d,t){var e=Se(),s=Ve(),n=sn(),o=Wt(),c=zt(),f=ot(),m=Je(),l=at(),p=je(),a=an(),A=Jn(),E=Zn();function y(T){return"Struct"+A(T)}function x(T,D){return E(O,T,D)}function S(T){return f(T)||(T=m(T)?{}:{name:T}),T.hasOwnProperty("strict")||(T.strict=O.strict),T.hasOwnProperty("defaultProps")||(T.defaultProps={}),T}function O(T,D){D=S(D);var v=D.name,w=D.strict,b=D.defaultProps,u=v||y(T);function C(g,M){if(C.is(g))return g;if(!(this instanceof C))return new C(g,M);for(var L in T)if(T.hasOwnProperty(L)){var k=T[L],I=g[L];I===void 0&&(I=b[L]),this[L]=l(k,I,null)}}return C.meta={kind:"struct",props:T,name:v,identity:!1,strict:w,defaultProps:b},C.displayName=u,C.is=function(g){return g instanceof C},C.update=function(g,M){return new C(e.update(g,M))},C.extend=function(g,M){return x([C].concat(g),M)},C}O.strict=!1,O.getOptions=S,O.getDefaultName=y,O.extend=x,t.exports=O}}),Xn=de({"src/lib/tuple.js"(d,t){var e=Se(),s=Ve(),n=Ye(),o=je(),c=st(),f=it(),m=at(),l=dt();function p(A){return"["+A.map(o).join(", ")+"]"}function a(A,E){var y=E||p(A),x=A.every(c);function S(O,T){if(x)return O;for(var D=!0,v=[],w=0,b=A.length;w<b;w++){var u=A[w],C=O[w],g=m(u,C,null);D=D&&C===g,v.push(g)}return D&&(v=O),v}return S.meta={kind:"tuple",types:A,name:E,identity:x},S.displayName=y,S.is=function(O){return f(O)&&O.length===A.length&&A.every(function(T,D){return l(O[D],T)})},S.update=function(O,T){return S(e.update(O,T))},S}a.getDefaultName=p,t.exports=a}}),ni=de({"src/lib/union.js"(d,t){var e=Se(),s=Ve(),n=Ye(),o=je(),c=st(),f=it(),m=at(),l=dt(),p=Pt(),a=Wn(),A=Je();function E(x){return x.map(o).join(" | ")}function y(x,S){var O=S||E(x),T=x.every(c);function D(v,w){if(T)return v;var b=D.dispatch(v);return!b&&D.is(v)?v:m(b,v,w)}return D.meta={kind:"union",types:x,name:S,identity:T},D.displayName=O,D.is=function(v){return x.some(function(w){return l(v,w)})},D.dispatch=function(v){for(var w=0,b=x.length;w<b;w++){var u=x[w];if(a(u)){var C=u.dispatch(v);if(!A(C))return C}else if(l(v,u))return u}},D.update=function(v,w){return D(e.update(v,w))},D}y.getDefaultName=E,t.exports=y}}),ri=de({"src/lib/func.js"(d,t){var e=Se(),s=Ve(),n=Wt(),o=it(),c=Kn(),f=ot(),m=at(),l=Je(),p=zt(),a=Xn(),A=Rt(),E=je(),y=Le();function x(D,v){return"("+D.map(E).join(", ")+") => "+E(v)}function S(D){return n.is(D)&&f(D.instrumentation)}function O(D){for(var v=D.length,w=!1,b=v-1;b>=0;b--){var u=D[b];if(!y(u)||u.meta.kind!=="maybe")return b+1;w=!0}return w?0:v}function T(D,v,w){D=o(D)?D:[D];var b=w||x(D,v),u=D.length,C=O(D);function g(M,L){return S(M)?M:g.of(M)}return g.meta={kind:"func",domain:D,codomain:v,name:w,identity:!0},g.displayName=b,g.is=function(M){return S(M)&&M.instrumentation.domain.length===u&&M.instrumentation.domain.every(function(L,k){return L===D[k]})&&M.instrumentation.codomain===v},g.of=function(M,L){if(g.is(M))return M;function k(){var I=Array.prototype.slice.call(arguments),N=I.length;if(!1)var $;if(L&&N<u){var R=Function.prototype.bind.apply(M,[this].concat(I)),U=T(D.slice(N),v);return U.of(R,!0)}else return m(v,M.apply(this,I))}return k.instrumentation={domain:D,codomain:v,f:M},k.displayName=A(M),k},g}T.getDefaultName=x,T.getOptionalArgumentsIndex=O,t.exports=T}}),ii=de({"src/lib/intersection.js"(d,t){var e=Se(),s=Ve(),n=Ye(),o=it(),c=st(),f=dt(),m=je(),l=st();function p(A){return A.map(m).join(" & ")}function a(A,E){var y=E||p(A),x=A.every(l);function S(O,T){return O}return S.meta={kind:"intersection",types:A,name:E,identity:x},S.displayName=y,S.is=function(O){return A.every(function(T){return f(O,T)})},S.update=function(O,T){return S(e.update(O,T))},S}a.getDefaultName=p,t.exports=a}}),er=de({"src/lib/assign.js"(d,t){function e(s,n){for(var o in n)n.hasOwnProperty(o)&&(s[o]=n[o]);return s}t.exports=e}}),oi=de({"src/lib/interface.js"(d,t){var e=Se(),s=Ve(),n=sn(),o=Wt(),c=zt(),f=ot(),m=Je(),l=at(),p=je(),a=an(),A=Jn(),E=st(),y=dt(),x=Zn(),S=er();function O(v,w){return x(D,v,w)}function T(v){return f(v)||(v=m(v)?{}:{name:v}),v.hasOwnProperty("strict")||(v.strict=D.strict),v}function D(v,w){w=T(w);var b=w.name,u=w.strict,C=b||A(v),g=Object.keys(v).map(function(L){return v[L]}).every(E);function M(L,k){if(g)return L;if(!1&&u)for(var I in L);var N=!0,$=g?{}:S({},L);for(var R in v){var U=v[R],P=L[R],F=l(U,P,null);N=N&&P===F,$[R]=F}return N&&($=L),$}return M.meta={kind:"interface",props:v,name:b,identity:g,strict:u},M.displayName=C,M.is=function(L){if(m(L))return!1;if(u){for(var k in L)if(!v.hasOwnProperty(k))return!1}for(var I in v)if(!y(L[I],v[I]))return!1;return!0},M.update=function(L,k){return M(e.update(L,k))},M.extend=function(L,k){return O([M].concat(L),k)},M}D.strict=!1,D.getOptions=T,D.getDefaultName=A,D.extend=O,t.exports=D}}),si=de({"src/lib/update.js"(d,t){var e=Se(),s=ot(),n=Ye(),o=it(),c=rn(),f=er();function m(v){return s(v)?v instanceof Date||v instanceof RegExp?v:f({},v):o(v)?v.concat():v}function l(v){return a.commands.hasOwnProperty(v)}function p(v){return a.commands[v]}function a(v,w){var b=v,u=!1,C;for(var g in w)w.hasOwnProperty(g)&&(l(g)?(C=p(g)(w[g],b),C!==v?(u=!0,b=C):b=v):(b===v&&(b=m(v)),C=a(b[g],w[g]),u=u||C!==b[g],b[g]=C));return u?b:v}function A(v,w){return v(w)}function E(v,w){return v.length>0?w.concat(v):w}function y(v,w){if(v.length>0){w=m(w);for(var b=0,u=v.length;b<u;b++)delete w[v[b]]}return w}function x(v){return v}function S(v,w){return v.length>0?(w=m(w),v.reduce(function(b,u){return b.splice.apply(b,u),b},w)):w}function O(v,w){if(v.from!==v.to){w=m(w);var b=w[v.to];w[v.to]=w[v.from],w[v.from]=b}return w}function T(v,w){return v.length>0?v.concat(w):w}function D(v,w){var b=!1,u=m(w);for(var C in v)v.hasOwnProperty(C)&&(u[C]=v[C],b=b||u[C]!==w[C]);return b?u:w}a.commands={$apply:A,$push:E,$remove:y,$set:x,$splice:S,$swap:O,$unshift:T,$merge:D},t.exports=a}}),ai=de({"src/lib/match.js"(d,t){var e=Se(),s=Ye(),n=Le(),o=nn();t.exports=function(f){for(var m,l,p,a,A=1,E=arguments.length;A<E;)if(m=arguments[A],l=arguments[A+1],p=arguments[A+2],s(p)&&!n(p)?A=A+3:(p=l,l=o.is,A=A+2),m.is(f)&&l(f))return p(f);e.fail("Match error")}}}),di=de({"src/index.js"(d,t){var e=Se();e.Any=nn(),e.Array=Fr(),e.Boolean=Vn(),e.Date=Hr(),e.Error=Ur(),e.Function=Wt(),e.Nil=Qn(),e.Number=zn(),e.Integer=qr(),e.IntegerT=e.Integer,e.Object=Gr(),e.RegExp=Vr(),e.String=sn(),e.Type=Qr(),e.TypeT=e.Type,e.Arr=e.Array,e.Bool=e.Boolean,e.Dat=e.Date,e.Err=e.Error,e.Func=e.Function,e.Num=e.Number,e.Obj=e.Object,e.Re=e.RegExp,e.Str=e.String,e.dict=an(),e.declare=zr(),e.enums=Wr(),e.irreducible=He(),e.list=Kn(),e.maybe=Jr(),e.refinement=on(),e.struct=ti(),e.tuple=Xn(),e.union=ni(),e.func=ri(),e.intersection=ii(),e.subtype=e.refinement,e.inter=oi(),e.interface=e.inter,e.assert=e,e.update=si(),e.mixin=dn(),e.isType=Le(),e.is=dt(),e.getTypeName=je(),e.match=ai(),t.exports=e}}),Te=di();var li=Te.struct({id:Te.String,fullname:Te.String,path:Te.String,funding:Te.String,created:Te.String},"StudentData"),be=class{static modifyFunding(t,e,s){typeof e=="string"&&(e=dayjs(e)),me(created instanceof dayjs,"modifyFunding date must be a string, a dayjs instance or null.",TypeError);let n=be.getFunding(t,e);if(s.toLower()===n.toLower()){console.log(`%cFundingMode ${s} is identical as current: ${sCurrent}, nothing to do`,B);return}(s!==nt||s!=$e||s!==gt)&&console.log(`%cWarning this state is unknown ${s}`,tt);let o=W.Cfg.dbase,c=dayjs().format("YYYY-MM-DDTHH:mm:ssZZ");if(e===null&&(e=c),oLastHistory=Ge.find(t,Ge.getType("FUNDING"),e),o.get(be.tbl_name).find({id:t}).assign({funding:s}).write(),Ge.addFunding(t,n,c),e.isSameOrAfter(Ce.getOldModeDate()))var f=o.get("sessions").filter(function(l){return l.who_id===t&&dayjs(l.when).isSameOrAfter(e,"day")});else var f=o.get("sessions").filter(function(p){p.who_id===t&&dayjs(p.when).isSameOrAfter(Ce.getOldModeDate(),"day")});for(var m=f.value().length;m-=1;)console.log(`There is ${m} elements left to update`,B),f.get(m).assign({funding:s}).write()}},_e=be;G(_e,"tbl_name","students"),G(_e,"ocmapper",async function(t){let e=!1;try{let s=await be.getFundingFomDashboard(t.id);e===!0&&console.log("%cocmapper() funding is %o",B,s);let n=t.id.toString(10),o=t.displayName,c=t.followedLearningPath.learningPathTitle,f;c.length==0?f="non d\xE9fini":f=c;let m=s.toLowerCase(),l=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");return li({id:n,fullname:o,path:f,funding:m,created:l})}catch(s){console.error("%c,IRRECOVERABLE ERROR in StudentData.ocmapper: %o",ge,s)}}),G(_e,"add",function(t,e="noname",s="nopath",n="unknown",o){let c=W.Cfg.dbase;var f=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let m={id:t,fullname:e,path:s,funding:n,created:f};be._save(m)}),G(_e,"_checkObject",function(t){!1===!0&&console.log("%cChecking object student:%o ",B,t),me(typeof t.id=="string","Student object id need to be a string.",TypeError),me(typeof t.fullname=="string","Student object fullname need to be a number.",TypeError),me(typeof t.path=="string","Student object path need to be a string.",TypeError),me(typeof t.funding=="string","Student object funding need to be a string.",TypeError),me(typeof t.created=="string","Student object created need to be a string.",TypeError)}),G(_e,"_save",function(t){let e=!1;be._checkObject(t),e===!0&&console.log("%cSaving student %o to DB",B,t),W.Cfg.dbase.get(be.tbl_name).push(JSON.parse(JSON.stringify(t))).write()}),G(_e,"exists",function(t,e=null){let s=!1,n=be.findById(t,e);return s===!0&&console.log(`%cStudent ${t} exists in db ? ${n!==void 0}`,B),n!==void 0}),G(_e,"findById",function(t,e=null){let s=GM_config.get("use_student_cache");return s===!1&&console.log("%cache \xE9tudiant desactiv\xE9 dans les options",B),typeof t=="number"&&(t=t.toString(10)),me(typeof t=="string","You must provide a string.",TypeError),typeof e=="string"&&(e=dayjs(e)),e==null?s===!1?be._findById(t,e):be.m_findById(t,"null"):s===!1?be._findById(t,e.toISOString()):be.m_findById(t,e.toISOString())}),G(_e,"_findById",function(t,e=null){let s=!1,n=W.Cfg.dbase;typeof e=="string"&&(e=dayjs(e)),s===!0&&console.log(`%c_findById() searching student with id:(${typeof t})${t} in db`,B);var o=n.get(be.tbl_name).find({id:t}).value();if(s===!0&&console.log("%c_findById() student %o is found",B,o),o!==void 0){if(e!==null){var c={...o},f=Ge.find(t,Ge.getType("FUNDING"),e);f!==void 0&&(c.funding=f.value);var m=Ge.find(t,Ge.getType("PATH"),e);return m!==void 0&&(c.path=m.value),c}return s===!0&&console.log("%c_findById() student final %o is found",B,o),o}}),G(_e,"m_findById",moize.default(be._findById,{maxAge:6e5,isSerialized:!0})),G(_e,"findByFullName",function(t){let e=GM_config.get("use_student_cache");return e===!1&&console.log("%cache \xE9tudiant desactiv\xE9 dans les options",B),me(typeof t=="string","You must provide a string.",TypeError),e===!1?be._findByFullName(t):be.m_findByFullName(t)}),G(_e,"_findByFullName",function(t){let e=!1,s=W.Cfg.dbase;e===!0&&console.log(`%c[_findByFullName()] searching student with name:(${typeof t})${t} in db`,B);var n=s.get(be.tbl_name).find({fullname:t}).value();if(e===!0&&console.log("%c[_findByFullName()] student %o is found",B,n),n!==void 0)return n}),G(_e,"m_findByFullName",moize.default(be._findByFullName,{maxAge:6e5,isSerialized:!0})),G(_e,"getFunding",async function(t,e=null){return typeof e=="string"&&(e=dayjs(e)),await be.m_getFunding(t,e)}),G(_e,"_getFunding",async function(t,e=null){let s=be.findById(t,e);return s===void 0?(console.log('%c[Student._getFunding()]Student %s is not in db, fetching data:"funded mode" from webpage',B,t),s=await be.getFundingFomDashboard(t),console.log("%c[Student._getFunding()]Student %s funding is %o",B,t,s),s.toLowerCase()):s.funding.toLowerCase()}),G(_e,"m_getFunding",moize.default(be._getFunding,{maxAge:6e5,isSerialized:!0,isPromise:!0})),G(_e,"isAutoFunded",function(t){return console.log("%cFUNCTION DEPRECATED !!!!!!!!!!!!!!!!!!!!!! ",ge),be.getFunded(t).toLowerCase()===nt}),G(_e,"getFundingFomDashboard",async function(t){return(await Vt(`https://openclassrooms.com/fr/mentorship/students/${t}/dashboard`,".mentorshipStudent__details > p")).innerText.trim()}),G(_e,"getPath",async function(t,e=null){let s=be.findById(t,e);if(s==null){console.log(`%cStudent ${t} is not in db, fetching data: 'path' from webpage ....`,B);let n=await Vt(`https://openclassrooms.com/fr/mentorship/students/${t}/dashboard`,"a[href*='paths/']");return n.innerText.length==0&&console.error(`%cStudent path is not readable from url : https://openclassrooms.com/fr/mentorship/students/${t}/dashboard`,ge),n.innerText.trim()}else return s.path}),G(_e,"delete",function(t=null,e=null){let s=W.Cfg.dbase;if(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),t===null&&e==null){console.log("%cWanna suppress ALL Students from DB",B),s.get(be.tbl_name).remove().write();return}if(e==null){s.get(be.tbl_name).remove(function(n){return dayjs(n.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBefore(e,"day")}).write();return}if(t==null){s.get(be.tbl_name).remove(function(n){return dayjs(n.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isAfter(t,"day")}).write();return}s.get(be.tbl_name).remove(function(n){return dayjs(n.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBetween(t,e,"day","[]")}).write()}),G(_e,"deleteById",function(t,e=null){W.Cfg.dbase.get("students").remove(n=>n.id===t).write(),console.log(`%cAll students with id:${t} are removed from DataBase`,B)}),G(_e,"getAll",async(t,e)=>{let s=!0;var n=!1;let o=W.Cfg.dbase;var c="table.crud-list tbody";s===!0&&console.log("%c[getAll()] Enter function",B);let f=await Nt.getUserStudents();var m=JSON.parse(f);s===!0&&console.log("%cgetAll() collect this array of stundent %o",B,m);let l=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var p=performance.now();await be.ocmapper(m[0]),s===!0&&console.log(`%cEstimated time for updating : ${(performance.now()-p)*m.length} ms`,B),Swal.fire({position:"top-end",icon:"info",toast:!0,title:`mise \xE0 jour de la base de donn\xE9e des \xE9tudiants...
cela peut prendre du temps ~ ${(performance.now()-p)*m.length/1e3} s`,showConfirmButton:!1,timer:1e3}),await We(1e3),s===!0&&console.log("%cWill process all students of board",B);for(let A of m){let E=await be.ocmapper(A);s===!0&&console.log('%c Working on student "%s"',B,E.fullname),Mt(`Collecte les donn\xE9es de l'\xE9tudiant : ${E.fullname}`);var a=be.m_findById(E.id,null);if(a===void 0){s===!0&&console.log(`%cStudent ${E.fullname} (id:${E.id}) not present in student database will create it`,B),be.add(E.id,E.fullname,E.path,E.funding,E.created);continue}E.funding.toLowerCase()!==a.funding.toLowerCase()&&(o.get(be.tbl_name).find({id:E.id}).assign({funding:E.funding}).write(),Ge.addFunding(E.id,a.funding,dayjs()),console.log(`%c[Student.getAll]Student ${E.fullname}(id:${E.id}) was already present in database but change of funding was detected (from ${a.funding.toLowerCase()} to ${E.funding.toLowerCase()})`,B)),E.path!==a.path&&(o.get(be.tbl_name).find({id:E.id}).assign({path:E.path}).write(),Ge.addPath(E.id,a.path,dayjs()),console.log(`%c[Student.getAll]Student ${E.fullname}(id:${E.id}) was already present in database but change of path was detected (from ${a.path} to ${E.path})`,B))}}),G(_e,"showList",function(){let e=W.Cfg.dbase.get(be.tbl_name).value();var s="";s+="<table>",s+="<caption>Liste des \xE9tudiant</caption>",s+="<thead>",s+="<tr>",s+="<th>Nom</th><th>Parcours</th><th>Financement</th><th>Date de cr\xE9ation</th><th>Edition</th>",s+="</tr>",s+="</thead>",s+="<tbody>";for(var n in e)s+="<tr>",s+=`<td>${e[n].fullname}</td><td>${e[n].path}</td><td>${e[n].funding}</td>`,s+=`<td>${dayjs(e[n].created,"YYYY-MM-DDTHH:mm:ssZ[Z]").format("DD/MM/YYYY \xE0 HH:mm")}</td>`,s+=`<td><a href="https://openclassrooms.com/fr/mentorship/students/${e[n].id}/dashboard">${e[n].id}</a></td>`,s+="</tr>";s+="</tbody>",s+="</table>",Swal.fire({title:"<strong>Liste des Etudiants</strong>",icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"fullscreen",onOpen:o=>{var c=o.querySelector("table"),f=new simpleDatatables.DataTable(c)}})}),G(_e,"createManually",async function(t,e,s){let n=["non pr\xE9sent dans la liste","Chef de projet digital","Chef de projet SI","D\xE9veloppeur d'application - Frontend","D\xE9veloppeur Web","Expert en strat\xE9gie marketing et communication ","Production de contenu web avec CMS et Content Marketing ","Tech lead"];var o="";o+="<style>",o+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",o+="form input {background: #fff;border: 1px solid #9c9c9c;}",o+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",o+="form button:hover {background: gold;}",o+="form label {padding: 0.5em 0.5em 0.5em 0;}",o+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",o+="form input:focus {outline: 3px solid gold;}",o+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",o+="</style>",o+='<form class="form1" action="">',o+='<label for="student_id" class="name">Reference</label>',o+='<input id="student_id" type="text" value="'+t+'">',o+='<label for="student_name" class="name">Name</label>',o+='<input id="student_name" type="text" value="'+e+'">',o+='<label for="funding">Autofinanc\xE9</label>',o+='<input id="funding" type="checkbox" value="autofunded">',o+='<label for="student_path">Parcours</label>',o+='<input id="student_path" name="student_path" type="text" list="student_path-list">',o+='<datalist id="student_path-list">';for(var c in n)o+=`<option>${n[c]}</option>`;o+="/<datalist>",o+='<label for="session_date">Date</label>',o+='<input id="session_date" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(s).format("YYYY-MM-DD")+'">',o+="</form>";let{value:f}=await Swal.fire({title:"<strong>Ajout d'un \xE9tudiant en mode manuel</strong>",icon:"info",html:o,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:`votre \xE9tudiant(e) ${e} n'a pas \xE9t\xE9 trouv\xE9`,preConfirm:()=>({student_id:document.getElementById("student_id").value,student_name:document.getElementById("student_name").value,student_path:document.getElementById("student_path").value,student_funding:document.getElementById("funding").checked,session_date:document.getElementById("session_date").value})});if(f&&f.hasOwnProperty("student_id")){var m="";f.student_funding===!0?m=nt:m=$e,be.add(f.student_id,f.student_name,f.student_path,m,f.session_date)}});var we=_e;var ui=function(){let d="refs",t=0,e=1,s=2,n={DEFAULT:0,SESSIONID_DATEREFID:1},o=function(){W.Cfg.dbase.get("refs").value()===void 0&&(console.log("%cDb dont' contain ref table create it",B),W.Cfg.dbase.assign({refs:[]}).write())},c=function(A,E,y=n.DEFAULT){let x=W.Cfg.dbase;var S=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let T=f({key1:A,key2:E,type:y,created:S,updated:S});qn(50),me(Array.isArray(T)&&T.length>0,"Database insertion fail")},f=function(A){return W.Cfg.dbase.get(St.tbl_name).push(JSON.parse(JSON.stringify(A))).write()};return Object.freeze({tbl_name:d,TYPE:n,add:c,updKey1:function(A,E,y=n.DEFAULT){let x=W.Cfg.dbase,S;S=x.get(St.tbl_name).find(O=>O.key2===A&&O.type===y).assign({key1:E}).write(),console.log("%cNeedle  %o mValue %o sType %o",B,A,E,y),console.log("%c_r %o",B,S),me(Array.isArray(S)&&S.length>0,"Database insertion fail")},updKey2:function(A,E,y=n.DEFAULT){let x=W.Cfg.dbase,S;S=x.get(St.tbl_name).find(O=>O.key1===A&&O.type===y).assign({key2:E}).write(),console.log("%cNeedle  %o mValue %o sType %o",B,A,E,y),console.log("%c_r %o",B,S),me(Array.isArray(S)&&S.length>0,"Database insertion fail")},checkSupport:o,exists:function(A,E,y=n.DEFAULT){let x=St.getByKey(A,E,y);return console.log(`%cRef ${A} exists in db ? ${x!==void 0}`,B),x!==void 0},getByKey:function(A,E=1,y=n.DEFAULT){me(typeof E=="number","You must provide a number as index of key.",TypeError);let x=W.Cfg.dbase,S=null;if(E==1&&(S=x.get(St.tbl_name).find(O=>O.key1===A&&O.type===y).value()),E==2&&(S=x.get(St.tbl_name).find(O=>O.key2===A&&O.type===y).value()),S!=null)return S}})},St=ui(),Oe=St;var ci=function(){let d="meta",t=function(l){return me(typeof l=="string","You must provide a string.",TypeError),W.Cfg.dbase.get(Ft.tbl_name).find({key:"dbVersion"}).assign({value:l}).write().value},e=function(){let l=W.Cfg.dbase.get(Ft.tbl_name).find({key:"dbVersion"}).value();return typeof l=="undefined"?-1:l.value},s=function(){return W.Cfg.dbase.get("meta").remove(l=>!0).write()},n=function(){return console.log("%c resetDbVersion NE FONCTIONNE PAS",ge),W.Cfg.dbase.get("meta").find({key:"dbVersion"}).remove(l=>!0).write()},o=function(l){return me(typeof l=="string","You must provide a string.",TypeError),W.Cfg.dbase.get(Ft.tbl_name).find({key:"studentLstUpd"}).assign({value:l}).write().value},c=function(){let l=W.Cfg.dbase.get(Ft.tbl_name).find({key:"studentLstUpd"}).value();return typeof l=="undefined"?-1:l.value};return Object.freeze({checkSupport:function(){W.Cfg.dbase.get("meta").value()===void 0&&(console.log("%cDb dont' contain meta table create it",B),W.Cfg.dbase.assign({meta:[]}).write()),e()==-1&&W.Cfg.dbase.get("meta").push({key:"dbVersion",value:"1.0.0"}).write(),c()==-1&&W.Cfg.dbase.get("meta").push({key:"studentLstUpd",value:dayjs("19701006").toISOString()}).write()},getDbVersion:e,setDbVersion:t,delDbVersion:n,setStudentListUpd:o,getStudentListUpd:c,remStudentListUpd:function(){return o(dayjs("19701006").toISOString())},tbl_name:d})},Ft=ci(),ke=Ft;var lt=function(){let t="history_session_cache",e=!1,s=function(){e===!0&&console.log("%cDb dont' contain table history_session_cache table, will create it",B),W.Cfg.dbase.assign({history_session_cache:[]}).write()},n=function(){return W.Cfg.dbase.get(t).value()!==void 0};return{find:function(a){if(n===!1)throw new Error("%c_HistoryDb:DBFindInTable() failed reason : table is not defined",B);return e===!0&&console.log('%c_HistoryDb:DBFindInTable()  Request is App.Cfg.dbase.get("%s").find(%o).value()',B,t,a),W.Cfg.dbase.get(t).find(a).value()},getAll:function(){if(n===!1)throw new Error("%c_HistoryDb:DBGetAll() failed reason : table is not defined",B);return e===!0&&console.log('%c_HistoryDb:DBGetAll()  Request is App.Cfg.dbase.get("%s").value()',B,t),W.Cfg.dbase.get(t).value()},insert:function(a){return n===!1&&s(),e===!0&&console.log("%c_HistoryDb:DBInsertInTable table:%s data:%o)",B,t,a),W.Cfg.dbase.get(t).push(a).write()},remove:function(a={}){if(n===!1)throw new Error("%c_HistoryDb:DBRemove() failed reason : table is not defined",B);return e===!0&&console.log("%c_HistoryDb:DBRemove with filter",B),Un(a)===!0&&console.log("%c_HistoryDb:DBRemove /! filter is empty",B),W.Cfg.dbase.get(t).remove(a).write()},reset:function(){return e===!0&&console.log("%c_History:DBResetTable",B),W.Cfg.dbase.get(t).remove().write()},update:function(a,A){if(n===!1)throw new Error("%c_HistoryDb:DBUpdateInTable() failed reason : table is not defined",B);return W.Cfg.dbase.get(t).find(a).assign(A).write()}}}(),fi=function(){let d="history_session_cache",t=function(){let l=!0;W.Cfg.dbase.get("history_session_cache").value()===void 0&&(l&&console.log("%cDb dont' contain history_session_cache table create it",B),W.Cfg.dbase.assign({history_session_cache:[]}).write())},e=function(l){let p=!0;typeof l=="string"&&(l=dayjs(l)),me(l instanceof dayjs,"date must be a string or a dayjs object.",TypeError);let a=lt.find({id:+l.format("YYYYMMDD")});return p&&console.log(`%cHistory:_exists ${l.format("YYYYMMDD")} in db ? ${a!==void 0}`,B),a!==void 0},s=function(l){let p=!0;if(typeof l=="string"&&(l=dayjs(l)),me(l instanceof dayjs,"date must be a string or a dayjs object.",TypeError),l.get("day")<l.daysInMonth()&&(l=l.endOf("month")),p===!0&&console.log(`%cSearch in history session cache data for id: ${l.format("DD/MM/YYYY")}`,B),e(l)===!0){if(_r=lt.find({id:+l.format("YYYYMMDD")}),typeof _r.index!==void 0)return _r.index;throw new Error("_getSessionIndex() failed reason : property index is unknown")}return-1},n=function(l){let p=!1;typeof l=="string"&&(l=dayjs(l)),me(l instanceof dayjs,"date must be a string or a dayjs object.",TypeError),p===!0&&console.log(`%cSearch in history session cache NEAREST cached data for id: ${l.format("DD/MM/YYYY")}`,B);let a=+l.format("YYYYMMDD"),A=lt.getAll();if(A.length===0)return p===!0&&console.log("%cHistory session cache is empty",B),-1;A=A.map(x=>+x.id-a).filter(x=>x>0);let E=x=>Math.min(...x);if(A.length==0)return p===!0&&console.log("%cAll indexes  %o are later than your date:%s",B,lt.getAll(),l.format("DD/MM/YYYY")),-1;let y=E(A)+a;if(p===!0&&console.log("%cNearest data in history session cache is data with id: %o",B,y),e(y)===!0){if(A=lt.find({id:+y.format("YYYYMMDD")}),typeof A.index!==void 0)return A.index;throw new Error("[History._getNearestSessionIndex()] failed reason : property index is unknown")}return-1};return Object.freeze({tbl_name:d,getSameOrNearestSessionIndex:function(l){let p=s(l);return p===-1&&(p=n(l)),p},remove:function(l=null,p=null){typeof l=="string"&&(l=dayjs(l)),typeof p=="string"&&(p=dayjs(p));let a=function(){};return l!==null&&p!==null&&(a=function(A){return dayjs(A.id.toString(10)).isBetween(l,p,"day","[]")}),l==null&&p!==null&&(a=function(A){return dayjs(A.id.toString(10)).isBefore(p,"day")}),l!=null&&p==null&&(a=function(A){return dayjs(A.id.toString(10)).isAfter(l,"day")}),lt.remove(a)},reset:function(){return lt.reset()},setSessionIndex:function(l,p=0){typeof l=="string"&&(l=dayjs(l)),me(l instanceof dayjs,"date must be a string or a dayjs object.",TypeError),l.get("day")<l.daysInMonth()&&(l=l.endOf("month"));let a=s(l);return a==-1?a=lt.insert({id:+l.format("YYYYMMDD"),index:p}):a=lt.update({id:+l.format("YYYYMMDD")},{index:p}),a}})},pi=fi(),xt=pi;var mi=Te.struct({id:Te.String,cid:Te.maybe(Te.Integer),who_id:Te.String,who_name:Te.String,type:Te.String,lvl:Te.Integer,when:Te.Date,path:Te.String,funding:Te.String},"SessionData");mi.prototype.ocmapper=function(d){};var xe=class{static getBetween(t,e){return typeof t=="string"&&(t=dayjs(t)),typeof e=="string"&&(t=dayjs(e)),W.Cfg.dbase.get(xe.tbl_name).filter(o=>dayjs(o.when).isSameOrBefore(e,"day")&&dayjs(o.when).isSameOrAfter(t,"day")).value()}},Be=xe;G(Be,"tbl_name","sessions"),G(Be,"_checkObject",function(t){!1===!0&&console.log("%cChecking object session:%o ",B,t),me(typeof t.id=="string","Session object id need to be a string.",TypeError),me(typeof t.cid=="number","Session object cid need to be a number.",TypeError),me(typeof t.who_id=="string","Session object who_id need to be a string.",TypeError),me(typeof t.who_name=="string","Session object who_name need to be a string.",TypeError),me(typeof t.status=="string","Session object status need to be a string.",TypeError),me(typeof t.type=="string","Session object type need to be a string.",TypeError),me(typeof t.lvl=="string","Session object lvl need to be a string.",TypeError),me(typeof t.when=="string","Session object when need to be a string.",TypeError),me(typeof t.path=="string","Session object path need to be a string.",TypeError),me(typeof t.funding=="string","Session object funding need to be a string.",TypeError)}),G(Be,"add",async function(t){let e=30,s=!0;s===!0&&console.log("%cSession.add() so you wanna add a session %o to database",B,t);let n=W.Cfg.dbase;if(GM_config.get("checksessionalreadyexists")===!0)var o=!0;if(s===!0&&console.log("%cSession.add() will search if session %o is already in database",B,t),t.id.length>0){if(o===!0&&xe.exists(t.id)===!0){s===!0&&console.info(`%cSession.add() session id:${t.id} already present in database table sessions, skip it!`,B);return}}else if(o===!0&&xe.exists(t.cid)===!0){s===!0&&console.info(`%cSession.add() session cid:${t.cid} already present in database table sessions, skip it!`,B);return}t.type.toLowerCase()==="presentation"&&(t.type="soutenance"),Ce.isInOldMode(dayjs(t.when))?(t.funding=$e,t.type.toLowerCase()==="soutenance"?t.path="n/a (defense)":t.path="n/a (old mode)"):t.type.toLowerCase()==="soutenance"?(t.funding=$e,t.path="n/a (defense)"):(we.exists(t.who_id)===!1&&(console.warn("%cStudent %s not in Db, will updating student db by fetching students list from dashboard",tt,t.who_id),s===!0&&console.log("%cLast Update of Student BDD was %i min ago",B,dayjs(ke.getStudentListUpd()).diff(dayjs(),"m")),dayjs(ke.getStudentListUpd()).diff(dayjs(),"m")<-e?(await we.getAll(),ke.setStudentListUpd(dayjs().toISOString())):(console.log("%c[Session.add()]last Update of database DB was less than %i min ago",B,e),await we.createManually(t.who_id,t.who_name,t.when),moize.default.isMoized(we.m_findById)&&we.m_findById.has([t.who_id,null])&&(we.m_findById.remove([t.who_id,null]),s===!0&&console.log("%c[Session.add()]student %s removed from the m_findById function cache",B,t.who_id))),console.log("%c[Student.add()] pr\xE9c\xE9demment notre \xE9tudiant %o  n'existait pas existe t'il maintenant ?",B,t.who_id),console.log("%c[Student.add()] la r\xE9ponse est :%o",B,we.exists(t.who_id,t.when)),we.exists(t.who_id,t.when)==!1&&(console.warn(`%c[Session.add()] Student ${t.who_id} which exists at ${t.when} still not exit in Db, have to manually create him/her`,tt),await we.createManually(t.who_id,t.who_name,t.when),moize.default.isMoized(we.m_findById)&&we.m_findById.has([t.who_id,t.when])&&(we.m_findById.remove([t.who_id,t.when]),s===!0&&console.log("%c[Session.add()]student %s removed from the m_findById function cache",B,t.who_id)))),t.funding=await we.getFunding(t.who_id,t.when),t.path=await we.getPath(t.who_id,t.when)),t.cid===void 0&&(s===!0&&console.log("%c[Session.add()] need to calculate a cid]",B),t.cid=xe.getHashId(t.when,t.who_id)),s===!0&&console.log("%cSession.add() calculated id:%s",B,t.cid),_r=Oe.getByKey(t.cid,2,Oe.TYPE.SESSIONID_DATEREFID),_r!==void 0&&(s===!0&&console.log("%cSession.add() I've found a ref %d by using key (%s)%d",B,_r.key1,typeof t.cid,t.cid),t.id=_r.key1.toString()),xe._save(t)}),G(Be,"_save",function(t){var e=!1;xe._checkObject(t),t.lvl==""&&(t.lvl="2"),t.lvl.lvl=parseInt(t.lvl.lvl,10),bDebug===!0&&console.log(`%c[Session._save()] saving session id:${t.id} of ${t.who_name}[cid:${t.cid}](${t.who_id}) at ${t.when} to DB`,B),W.Cfg.dbase.get(xe.tbl_name).push(JSON.parse(JSON.stringify(t))).write()}),G(Be,"exists",function(t){let e=W.Cfg.dbase;var s=!1;s===!0&&console.log(`%c[Session.exist()] will search existence of session id:(${typeof t})${t} in database`,B);var n=xe.findById(t);return n!==void 0}),G(Be,"findById",function(t){let e=W.Cfg.dbase;var s=e.get(xe.tbl_name).find({id:t}).value();return s===void 0&&(s=e.get(xe.tbl_name).find({cid:t}).value()),s}),G(Be,"delete",function(t=null,e=null){let s=W.Cfg.dbase;if(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),t===null&&e==null){console.log("%cWanna suppress ALL Sessions from DB",B),s.get(xe.tbl_name).remove().write();return}if(e==null){s.get(xe.tbl_name).remove(function(n){return dayjs(n.when).isBefore(e),"day"}).write();return}if(t==null){s.get(xe.tbl_name).remove(function(n){return dayjs(n.when).isAfter(t,"day")}).write();return}s.get(xe.tbl_name).remove(function(n){return dayjs(n.when).isBetween(t,e,"day","[]")}).write()}),G(Be,"deleteById",function(t){W.Cfg.dbase.get("sessions").remove(s=>s.id===t).write(),console.log(`%cSession ${t} suppressed from DB`,B)}),G(Be,"parseTable",function(t){var e=t.children[0].children[0].innerText,s=mt(t.children[0]),n=t.children[1].children[0].innerText.trim(),o=mt(t.children[1],-2),c=t.children[2].innerText.trim().toLowerCase(),f=t.children[3].children.length?t.children[3].children[0].innerText.trim().toLowerCase():"session",m=-1;t.children[4].children.length>0&&(m=t.children[4].children[0].innerText.trim()),e=Yn(e);var l={id:s,when:e,who_id:o,who_name:n,status:c,type:f,lvl:m};return l}),G(Be,"getHashId",function(t,e){return t instanceof dayjs&&(t=t.toISOString()),typeof e=="number"&&(e=e.toString(10)),me(typeof t=="string"&&typeof e=="string","getId need two string",TypeError),Fn(t+e)}),G(Be,"parseRow",function(t){!0===!0&&console.log("%cparseRow() Row is %o",B,t);var s=t.children[0].innerText.length>0?t.children[0].innerText.trim().toLowerCase():"session",n=t.children[0].querySelector("svg").getAttribute("aria-label").trim().toLowerCase(),o=t.children[1].querySelector("time").dateTime;o=dayjs(o).toISOString();var c=mt(t.children[2],-2),f=t.children[2].innerText.trim(),m=xe.getHashId(o,c),l=t.children[3].innerText.trim();l=l.replace(/[^\d]/gmis,"");var p={id:"",cid:m,when:o,who_id:c,who_name:f,status:n,type:s,lvl:l};return p}),G(Be,"getSessionsFromAPI",async function(t,e){let s=!1,n=999,o=0,c=!0,f=0,m=20;typeof t=="string"&&(t=dayjs(t)),me(t instanceof dayjs,"dtFrom must be a string or a dayjs object.",TypeError),typeof e=="string"&&(e=dayjs(e)),me(e instanceof dayjs,"dtTo must be a string or a dayjs object.",TypeError);let l=xt.getSameOrNearestSessionIndex(e);l!==void 0&&typeof l=="number"&&l>f&&(f=l);var p=e.diff(t,"d")+1;for(NProgress.start();c===!0;){if(o>n){console.error("%c[Session.getSessionsFromAPI()] EMERGENCY EXIT LOOP",ge);break}o+=1;var a=f+(m-1),A=await Nt.getHistorySession([],f,a);if(A===null)throw new Error("Api.getHistorySession is null");var E=JSON.parse(A);if(E.errors)throw Object.entries(oSession.errors).forEach(S=>console.log("%cApi.getHistorySession send us some errors : %s",tt,S[1].message)),new Error("Api.getHistorySession send us some errors ");s===!0&&console.log("%cgetSessionsFromAPI() Sessions are %o",B,E),f=a+1,oSession=xe.parseRowFromApi(E[E.length-1]),console.log("%c[Session.getSessionsFromAPI()]La derni\xE8re session r\xE9cuper\xE9e par api date de:%s et nous collectons les sessions entre %s et %s",B,dayjs(oSession.when).format("DD/MM/YYYY"),dayjs(t).format("DD/MM/YYYY"),dayjs(e).format("DD/MM/YYYY")),s===!0&&console.log("%cgetSessionsFromAPI() last session of loaded page is %o",B,oSession),console.log("%c[Session.getSessionsFromAPI()] compare last session date %s avec la date de d\xE9but %s est ce ant\xE9rieur  %o",B,dayjs(oSession.when).format("DD/MM/YYYY"),dayjs(t).format("DD/MM/YYYY"),dayjs(oSession.when).isBefore(t)),dayjs(oSession.when).isBefore(t)===!0&&(c=!1,s===!0&&console.log("%cgetSessionsFromAPI() last session is before start date of parsing %s STOP browsing....",B,dayjs(oSession.dtFrom).format("DD/MM/YYYY")),xt.setSessionIndex(oSession.when,f));let x=E.filter(S=>dayjs(S.sessionDate).isBetween(t,e,"day","[]"));s===!0&&console.log("%cgetSessionsFromAPI() Filtered on date Sessions are %o",B,x);for(let S of x){oSession=xe.parseRowFromApi(S),s===!0&&console.log("%cgetSessionsFromAPI()  will call Session.add() on %o",B,oSession);let O=await xe.add(oSession);var y=dayjs(e).diff(oSession.when,"d")+1;NProgress.set(y/p)}f=a+1}NProgress.done(),await Mt(`Collecte des sessions du ${t.format("DD/MM/YYYY")} au ${e.format("DD/MM/YYYY")} termin\xE9e`)}),G(Be,"parseRowFromApi",function(t){bDebug=!1,bDebug===!0&&console.log("%cparseRowFromApi() oSession is %o",B,t);let e={};return e.id="",e.who_id=t.recipient.id,typeof e.who_id=="number"&&(e.who_id=e.who_id.toString(10)),e.who_name=t.recipient.displayableName,t.status===In&&(e.status=yt),t.status===jn&&(e.status=pt),t.status===kn&&(e.status=bt),t.status===Bn&&(e.status=vt),e.status===void 0&&(e.status=t.status),e.type=t.type,e.type.toLowerCase()==="mentoring"&&(e.type="mentorat"),e.lvl=t.projectLevel,e.lvl==null&&(e.lvl=""),e.when=dayjs(t.sessionDate).toISOString(),e.path=null,e.funding=null,e.cid=xe.getHashId(e.when,e.who_id),e});var Me=Be;var Ht=class{},It=Ht;G(It,"calculateBill",function(t,e){let s=e.format("YYYYMM");return At.exists(s)===!0?(console.log(`%cUse Archived version ${s} of accounting`,B),At.get(s).data):(typeof t=="string"&&(t=t.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),Ht.m_calculateBill(t,e))}),G(It,"_calculateBill",function(t,e){typeof t=="string"&&(t=dayjs(t)),typeof e=="string"&&(e=dayjs(e));let s=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var n=0,o=0,c=performance.now();let l=W.Cfg.dbase.get(Me.tbl_name).filter(u=>dayjs(u.when).isSameOrBefore(e,"day")&&dayjs(u.when).isSameOrAfter(t,"day")).value(),p=l.length,a={from:t,to:e,created_at:null,maxLevel:_t,number:0,amount:0,errors:{funding:[],level:[],path:[],status:[],type:[]},flatFee:[]},A=0,E=0,y=[];n=performance.now();let x=Ht.getPriceList(t);o=performance.now(),console.log("%cGetPriceList took "+(o-n)+" milliseconds.",ze);let S=Pn([_t+1,_t+1,_t+1,_t+1]);for(var O=0;O<p;O+=1){let u=l[O];var T=0;u.status===yt&&(T=oe),u.status===pt&&(T=se),u.status===bt&&(T=ne),(u.status===vt||u.status===Bt)&&(T=ae);var D=0;u.type.toLowerCase()==="session"&&(D=q),u.type.toLowerCase()==="mentorat"&&(D=Nn),u.type.toLowerCase()==="soutenance"&&(D=V),u.path!=null&&u.path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&u.type!=="soutenance"&&(D=Q);var v=0;let C=Ce.isInOldMode(t);if(C===!0&&(v=u.isFunded===!0?X:Z),u.funding===nt&&(v=Z),u.funding===$e&&(v=X),u.funding===gt&&(v=ee),u.lvl==""){a.errors.level.push(u);continue}if(typeof u.lvl=="string"&&(u.lvl=parseInt(u.lvl,10)),u.lvl<0){a.errors.level.push(u);continue}if(C===!1&&u.funding!==nt&&u.funding!==$e&&u.funding!==gt){a.errors.funding.push(u);continue}if(u.type.toLowerCase()!=="session"&&u.type.toLowerCase()!=="mentorat"&&D!==V&&D!==Q){a.errors.type.push(u);continue}if(u.status!==yt&&u.status!==pt&&u.status!==bt&&u.status!==vt&&u.status!==Bt){a.errors.status.push(u);continue}let g=S.get(D,T,v,+u.lvl);g===void 0&&(g={number:0,amount:0,data:[]}),g.number+=1,A+=1,u.lvl<0?(g.amount+=0,E+=0):(g.amount+=1*x[u.lvl][D][T][v],E+=1*x[u.lvl][D][T][v]),g.data.push(u),S.set(D,T,v,+u.lvl,g),D===q&&v===Z&&u.status!==pt&&y.push({id:+u.who_id,who_id:u.who_id,who_name:u.who_name})}var w=[];n=performance.now(),w=_.uniqBy(y,"id"),a.flatFee=w,a.number=A,a.amount=E,a.number+a.errors.funding.length+a.errors.level.length+a.errors.path.length+a.errors.status.length+a.errors.type.length<p&&(console.log(`%cError total number of sessions is ${p} and total number of sessions in bill ${A} + all errors are different`,ge),console.log("errors are",a.errors),console.log("sessions are",l)),a.created_at=s,S.set(0,0,0,0,a);var b=performance.now();return console.log("%cFunction took "+(b-c)+" milliseconds.",ze),a.errors.funding.length+a.errors.level.length+a.errors.path.length+a.errors.status.length+a.errors.type.length>0&&console.log("%cWarning some errors found %o",tt,a.errors),S}),G(It,"m_calculateBill",moize.default(Ht._calculateBill,{maxAge:12e4,isSerialized:!0})),G(It,"getPriceList",function(t){typeof t=="string"&&(t=dayjs(t));var e=[0,En,Cn,Tn,Dn,On,Mn];let s=Ce.isInOldMode(t);var n=new Array(7);for(let o=1;o<=_t;o+=1){let c=e[o],f=e[o]/2,m=e[o]/4;s?(n[o]=new Array(3),n[o][q]=new Array(5),n[o][q][oe]=new Array(4),n[o][q][oe][Z]=c,n[o][q][oe][X]=c,n[o][q][oe][ee]=c,n[o][q][se]=new Array(4),n[o][q][se][Z]=0,n[o][q][se][X]=0,n[o][q][se][ee]=0,n[o][q][ne]=new Array(4),n[o][q][ne][Z]=f,n[o][q][ne][X]=f,n[o][q][ne][ee]=f,n[o][q][ae]=new Array(4),n[o][q][ae][Z]=f,n[o][q][ae][X]=f,n[o][q][ae][ee]=f,n[o][V]=new Array(5),n[o][V][oe]=new Array(4),n[o][V][oe][Z]=c,n[o][V][oe][X]=c,n[o][V][oe][ee]=c,n[o][V][se]=new Array(4),n[o][V][se][Z]=0,n[o][V][se][X]=0,n[o][V][se][ee]=0,n[o][V][ne]=new Array(4),n[o][V][ne][Z]=f,n[o][V][ne][X]=f,n[o][V][ne][ee]=f,n[o][V][ae]=new Array(4),n[o][V][ae][Z]=f,n[o][V][ae][X]=f,n[o][V][ae][ee]=f,n[o][Q]=new Array(5),n[o][Q][oe]=new Array(4),n[o][Q][oe][Z]=c,n[o][Q][oe][X]=c,n[o][Q][oe][ee]=c,n[o][Q][se]=new Array(4),n[o][Q][se][Z]=0,n[o][Q][se][X]=0,n[o][Q][se][ee]=0,n[o][Q][ne]=new Array(4),n[o][Q][ne][Z]=f,n[o][Q][ne][X]=f,n[o][Q][ne][ee]=f,n[o][Q][ae]=new Array(4),n[o][Q][ae][Z]=f,n[o][Q][ae][X]=f,n[o][Q][ae][ee]=f):(n[o]=new Array(3),n[o][q]=new Array(5),n[o][q][oe]=new Array(4),n[o][q][oe][Z]=f,n[o][q][oe][X]=c,n[o][q][oe][ee]=c,n[o][q][se]=new Array(4),n[o][q][se][Z]=0,n[o][q][se][X]=0,n[o][q][se][ee]=0,n[o][q][ne]=new Array(4),n[o][q][ne][Z]=0,n[o][q][ne][X]=0,n[o][q][ne][ee]=0,n[o][q][ae]=new Array(4),n[o][q][ae][Z]=m,n[o][q][ae][X]=f,n[o][q][ae][ee]=f,n[o][V]=new Array(5),n[o][V][oe]=new Array(4),n[o][V][oe][Z]=c,n[o][V][oe][X]=c,n[o][V][oe][ee]=c,n[o][V][se]=new Array(4),n[o][V][se][Z]=0,n[o][V][se][X]=0,n[o][V][se][ee]=0,n[o][V][ne]=new Array(4),n[o][V][ne][Z]=0,n[o][V][ne][X]=0,n[o][V][ne][ee]=0,n[o][V][ae]=new Array(4),n[o][V][ae][Z]=f,n[o][V][ae][X]=f,n[o][V][ae][ee]=f,n[o][Q]=new Array(5),n[o][Q][oe]=new Array(4),n[o][Q][oe][Z]=c,n[o][Q][oe][X]=c,n[o][Q][oe][ee]=c,n[o][Q][se]=new Array(4),n[o][Q][se][Z]=0,n[o][Q][se][X]=0,n[o][Q][se][ee]=0,n[o][Q][ne]=new Array(4),n[o][Q][ne][Z]=0,n[o][Q][ne][X]=0,n[o][Q][ne][ee]=0,n[o][Q][ae]=new Array(4),n[o][Q][ae][Z]=f,n[o][Q][ae][X]=f,n[o][Q][ae][ee]=f)}return n});var Ze=It;var ln=function(d,t){let e=[[0,1,2,3,4,5,5],[5,1,2,3,4,5,5],[4,5,1,2,3,4,4],[3,4,5,1,2,3,3],[2,3,4,5,1,2,2],[1,2,3,4,5,1,1],[0,1,2,3,4,5,0]];return Math.trunc(t.diff(d,"days")/7)*5+e[d.day()][t.day()]};var jt=class{};G(jt,"detail_bill","truc"),G(jt,"getListDetailBill",function(t,e){let n=W.Cfg.dbase.get(Me.tbl_name).filter(O=>dayjs(O.when).isSameOrBefore(e,"day")&&dayjs(O.when).isSameOrAfter(t,"day")).sortBy(function(O){return dayjs(O.when).valueOf()}).value(),o=Ce.getOldModeDate(),c=Ze.getPriceList(o.subtract(1,"day")),f=Ze.getPriceList(o),m=0;var l=_.cloneDeep(n);for(var p in l){var a=0,A=0,E=!0,y=0;l[p].status===yt&&(y=oe),l[p].status===pt&&(y=se),l[p].status===bt&&(y=ne),(l[p].status===vt||l[p].status===Bt)&&(y=ae);var x=0;l[p].type.toLowerCase()==="session"&&(x=q),l[p].type.toLowerCase()==="soutenance"&&(x=V),l[p].path!=null&&l[p].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&l[p].type!=="soutenance"&&(x=Q);var S=0;l[p].funding===nt&&(S=Z),l[p].funding===$e&&(S=X),l[p].funding===gt&&(S=ee),Ce.isInOldMode(dayjs(l[p].when))?a=+l[p].lvl>0?c[+l[p].lvl][x][y][S]:0:(E=!1,a=+l[p].lvl>0?f[+l[p].lvl][x][y][S]:0),m+=a,l[p].iPu=a,l[p].oldMode=E,l[p].iCumul=m}return l}),G(jt,"getListStatistic",function(t,e){let s=t.clone(),n=s.endOf("month"),o=[],c=[],f=0,m=e.diff(t,"month");for(var l=performance.now();s.isSameOrBefore(e,"day");)o.push(Ze.calculateBill(s,n)),s=s.add(1,"month"),n=s.endOf("month");var p=performance.now();console.log("%cComputed data between the two dates in"+(p-l)+" milliseconds.",ze),s=t.clone(),n=s.endOf("month");let a=0,A=0,E=0,y=0,x=0,S=0,O=0;for(;f<=m;){let D=o[f].get(0,0,0,0),v=D.maxLevel;c[f]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let w=1;for(;w<v;){let u=0,C=0,g=0,M=0;a=o[f].get(q,oe,Z,w),E=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(q,oe,X,w),A=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(q,oe,ee,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=typeof a=="undefined"?0:a.number,Ce.isInOldMode(s)?(c[f].kpi.hrs+=(a+A+E)*(45/60),c[f].kpi.hrsp+=(a+A+E)*(GM_config.get("nbHrsS")/60)):(c[f].kpi.hrs+=E*(30/60),c[f].kpi.hrsp+=E*(GM_config.get("nbHrsAfM")/60),c[f].kpi.hrs+=(a+A)*(45/60),c[f].kpi.hrsp+=(a+A)*(GM_config.get("nbHrsfM")/60)),a=o[f].get(q,se,Z,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(q,se,X,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(q,se,ee,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,Ce.isInOldMode(s)?(a=o[f].get(q,ne,Z,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(q,ne,X,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(q,ne,ee,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount):(a=o[f].get(q,ne,Z,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(q,ne,X,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(q,ne,ee,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount),a=o[f].get(q,ae,Z,w),E=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(q,ae,X,w),A=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(q,ae,ee,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=typeof a=="undefined"?0:a,c[f].kpi.hrs+=(a+A+E)*(15/60),c[f].kpi.hrsp+=(a+A+E)*(15/60),u=c[f].sessions.total,C=c[f].sessions.nb,g=c[f].sessions.pu,M=c[f].sessions.nbc,c[f].sessions={total:x+u,nb:y+C,pu:(x+u)/(y+C),nbc:S+M},u=0,C=0,g=0,M=0,y=0,x=0,S=0,O=0,a=o[f].get(V,oe,Z,w),E=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(V,oe,X,w),A=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(V,oe,ee,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=typeof a=="undefined"?0:a.number,c[f].kpi.hrs+=(a+A+E)*(45/60),c[f].kpi.hrsp+=(a+A+E)*(GM_config.get("nbHrsD")/60),a=o[f].get(V,se,Z,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(V,se,X,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(V,se,ee,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(V,ne,Z,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(V,ne,X,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(V,ne,ee,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(V,ae,Z,w),E=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(V,ae,X,w),A=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(V,ae,ee,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=typeof a=="undefined"?0:a.number,c[f].kpi.hrs+=(a+A+E)*(15/60),c[f].kpi.hrsp+=(a+A+E)*(15/60),u=c[f].defenses.total,C=c[f].defenses.nb,g=c[f].defenses.pu,M=c[f].defenses.nbc,c[f].defenses={total:x+u,nb:y+C,pu:(x+u)/(y+C),nbc:S+M},u=0,u=0,C=0,g=0,M=0,y=0,x=0,S=0,O=0,a=o[f].get(Q,oe,Z,w),E=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(Q,oe,X,w),A=typeof a=="undefined"?0:a.number,y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(Q,oe,ee,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=typeof a=="undefined"?0:a.number,c[f].kpi.hrs+=(a+A+E)*(45/60),c[f].kpi.hrsp+=(a+A+E)*(GM_config.get("nbHrsC")/60),a=o[f].get(Q,se,Z,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(Q,se,X,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(Q,se,ee,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(Q,ne,Z,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(Q,ne,X,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(Q,ne,ee,w),S=typeof a=="undefined"?S:S+a.number,O=typeof a=="undefined"?O:O+a.amount,a=o[f].get(Q,ae,Z,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(Q,ae,X,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,a=o[f].get(Q,ae,ee,w),y=typeof a=="undefined"?y:y+a.number,x=typeof a=="undefined"?x:x+a.amount,u=c[f].coaches.total,C=c[f].coaches.nb,g=c[f].coaches.pu,M=c[f].coaches.nbc,a=typeof a=="undefined"?0:a.number,c[f].kpi.hrs+=a*(15/60),c[f].kpi.hrsp+=a*(15/60),c[f].coaches={total:x+u,nb:y+C,pu:(x+u)/(y+C),nbc:S+M},w+=1}let b=D.flatFee.length;for(var T=0;T<b;T+=1)c[f].bonus+=30;n.isAfter(e,"day")&&(n=e.clone()),c[f].kpi.jrs=ln(s,n),c[f].header.dtFrom=s.format("YYYY-MM-DD"),c[f].header.dtTo=n.format("YYYY-MM-DD"),c[f].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),s=s.add(1,"month"),n=s.endOf("month"),f+=1}return c}),G(jt,"getListStatisticOld",function(t,e){let s=t.clone(),n=s.endOf("month"),o=[],c=[],f=e.get("month")-t.get("month");for(var m=performance.now();s.isSameOrBefore(e,"day");)o.push(Ze.calculateBill(s,n)),s=s.add(1,"month"),n=s.endOf("month");var l=performance.now();console.log("%cComputed data between the two dates in"+(l-m)+" milliseconds.",ze);let p=0;for(s=t.clone(),n=s.endOf("month"),console.log(o);p<=f;){let a=o[p][0].max_level;c[p]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let A=1;for(;A<a;){let E=[...Array(8).keys()];for(let y=0;y<E.length;y+=1)c[p].sessions.total+=o[p][A].sessions.number[y]*o[p][A].sessions.pu[y],c[p].sessions.nb+=o[p][A].sessions.number[y],c[p].defenses.total+=o[p][A].defenses.number[y]*o[p][A].defenses.pu[y],c[p].defenses.nb+=o[p][A].defenses.number[y],Ce.isInOldMode(s)?[1,5].includes(y)&&(c[p].sessions.nbc+=o[p][A].sessions.number[y],c[p].defenses.nbc+=o[p][A].defenses.number[y]):[1,2,5,6].includes(y)&&(c[p].sessions.nbc+=o[p][A].sessions.number[y],c[p].defenses.nbc+=o[p][A].defenses.number[y]),Ce.isInOldMode(s)?(c[p].kpi.hrs+=(o[p][A].sessions.number[y]-o[p][A].defenses.number[y])*(45/60),c[p].kpi.hrsp+=(o[p][A].sessions.number[y]-o[p][A].defenses.number[y])*(GM_config.get("nbHrsfM")/60)):([4,5,6,7].includes(y)&&(c[p].kpi.hrs+=(o[p][A].sessions.number[y]-o[p][A].defenses.number[y])*(30/60),c[p].kpi.hrsp+=(o[p][A].sessions.number[y]-o[p][A].defenses.number[y])*(GM_config.get("nbHrsAfM")/60)),[0,1,2,3].includes(y)&&(c[p].kpi.hrs+=(o[p][A].sessions.number[y]-o[p][A].defenses.number[y])*(45/60),c[p].kpi.hrsp+=(o[p][A].sessions.number[y]-o[p][A].defenses.number[y])*(GM_config.get("nbHrsfM")/60))),c[p].kpi.hrs+=o[p][A].defenses.number[y]*(45/60),c[p].kpi.hrsp+=o[p][A].defenses.number[y]*(GM_config.get("nbHrsD")/60);A+=1}c[p].sessions.pu=c[p].sessions.total/(c[p].sessions.nb-c[p].sessions.nbc),c[p].defenses.pu=c[p].defenses.total/(c[p].defenses.nb-c[p].defenses.nbc),c[p].coaches.total=c[p].sessions.total-c[p].defenses.total,c[p].coaches.nb=c[p].sessions.nb-c[p].defenses.nb,c[p].coaches.nbc=c[p].sessions.nbc-c[p].defenses.nbc,c[p].coaches.pu=c[p].coaches.total/(c[p].coaches.nb-c[p].coaches.nbc);for(let E=0;E<o[p][0].bonus.length;E+=1)c[p].bonus+=o[p][0].bonus[E].sessions>0?30:0;n.isAfter(e,"day")&&(n=e.clone()),c[p].kpi.jrs=ln(s,n),c[p].header.dtFrom=s.format("YYYY-MM-DD"),c[p].header.dtTo=n.format("YYYY-MM-DD"),c[p].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),s=s.add(1,"month"),n=s.endOf("month"),p+=1}return c});var Kt=jt;var un=class{static changePgIfNeeded(t,e,s,n){var o=n.getPageCount(),c=n.getPages()[o-1],f=c.fontSize,m=c.getFont(),l=c.lineHeight;return t<e&&(s=1,c=n.addPage(),c.font=m,c.setFontSize(f),c.lineHeight=l),[s,c]}};G(un,"addFooter",async function(t,e,s={}){let{degrees:n,PDFDocument:o,rgb:c,StandardFonts:f}=PDFLib,m=t.getPageCount(),l="8".repeat(m),p=await t.embedFont(f.TimesRoman),a=12,A=p.widthOfTextAtSize(`page ${l} / ${l}`,a),E=10,y=10,x=1,S=c(0/255,0/255,0/255),O=c(253/255,246/255,227/255),T=5,D=5,v=3,w=3,b=!0;t.getPages().forEach((u,C)=>{if(!(b===!0&&C==0)){let{width:g,height:M}=u.getSize(),L=a+2*x+v+w;u.moveTo(E+T,a+w),u.setFont(p),u.setFontSize(a),u.setFontColor(c(1,0,0)),e!==void 0&&u.drawText(`${e}`),u.drawText(`page ${C+1} / ${m}`,{x:g-A-D}),u.drawRectangle({x:E,y:10,width:g-(E+y),height:L,color:O,opacity:.6,borderColor:S,borderWidth:x})}})});var ut=un;var tr=async function(){let d=W.Cfg.dbase;return await Swal.mixin({confirmButtonText:"Suivant &rarr;",showCancelButton:!0,progressSteps:["0","1","2","3","4","5"],onOpen:function(a){console.log("...onOpen")},onRender:function(a){console.log("....onUpdate")},onClose:function(a){console.log(".....onClose")},onAfterClose:function(a){console.log("......onAfterClose")},onDestroy:function(a){console.log(".......onDestroy")}}).queue([{title:"Migration de la base",html:"<p>Cette migration va corriger la base et ajouter les nouveaux champs n\xE9cessaires, l`interrpuption du traitement est sans danger (mais ce n' est pas une raison !)</p>"},{title:"Correction de la table \xE9tudiant",html:"<p>Correction de la liste des \xE9tudiants (who_id)",onOpen:async function(a){console.log("%cMigration table des \xE9tudiants correction du who_id",B),Swal.showLoading();var A=dayjs("2020-06-01"),E=d.get("students"),y=E.value(),x=d.get("sessions").filter(v=>dayjs(v.when).isSameOrAfter(A,"day")),S=E.size().value(),O=Swal.getContent().textContent;for(m=0;m<S;m+=1){var T=x.find(w=>w.who_name===y[m].fullname).value();T!==void 0&&E.get(m).assign({who_id:T.who_id}).write();let v=Swal.getContent();v!=null&&(v.innerHTML=`${O}<br /><p>Traitement en cours : ${m}/${y.length}</p>`),await We(1)}Swal.hideLoading();let D=Swal.getContent();D!=null&&(D.textContent=`Traitement termin\xE9 : ${y.length}/${y.length}`)}},{title:"Correction de la table \xE9tudiant",html:"<p>Correction de la liste des \xE9tudiants funded devient funding</p>",onOpen:async function(a){console.log("%cMigration : table des \xE9tudiants suppression de l'ancien champs et ajout du champs funding",B),Swal.showLoading();for(var A=d.get("students"),E=A.size().value(),y=Swal.getContent().textContent,x=0;x<E;x+=1){var S=A.get(x).value().fundedby;if(S===void 0){console.log("%cStudent ${oListStudents.get(i).who_name} already converted, skip it",B);continue}A.get(x).unset(["fundedby"]).assign({funding:S}).write(),console.log("%cStudent ${oListStudents.get(i).who_name} create field funding and remove fundedby",B);let T=Swal.getContent();T!=null&&(T.innerHTML=`${y}<br /><p>Traitement en cours : ${x}/${E}</p>`),await We(1)}Swal.hideLoading();let O=Swal.getContent();O!=null&&(O.textContent=`Traitement termin\xE9 : ${E}/${E}`)}},{title:"Correction table Etudiants",html:"<p>Correction de la liste des sessions, ajout du path dans la session</p>",onOpen:async function(a){console.log("%cMigration table des sessions correction de id_who",B),Swal.showLoading();var A=dayjs("2020-06-01"),E=d.get("students"),y=E.value(),x=d.get("sessions").filter(w=>dayjs(w.when).isSameOrAfter(A,"day")),S=x.filter(w=>w.type!="soutenance").value(),O=Swal.getContent().textContent;for(m=0;m<S.length;m+=1){var T=E.find({who_id:S[m].who_id}).value();console.log("found",T);var D=T!==void 0&&T.path.length>0?T.path:"0-unknown";d.get("sessions").find({id:S[m].id}).assign({path:D}).write();let w=Swal.getContent();w!=null&&(w.innerHTML=`${O}<br /><p>Traitement en cours : ${m}/${S.length}</p>`),await We(1)}Swal.hideLoading();let v=Swal.getContent();v!=null&&(v.textContent=`Traitement termin\xE9 : ${m}/${S.length}`)}},{title:"Migration de la table des Sessions",html:'<p>Correction de la liste des sessions, suppression du champs "isFunded"</p>',onOpen:async function(a){console.log("%cMigration : table des sessions suppression de isFunded",B),Swal.showLoading();for(var A=dayjs("2020-06-01"),E=d.get("students").value(),y=d.get("sessions").filter(D=>dayjs(D.when).isSameOrAfter(A,"day")),x=Swal.getContent().textContent,S=y.value().length;S-=1;){var O=y.get(S);O.value().isFunded===void 0||O.value().isFunded===void 0?console.log(`%cSkip ${O.value()} already converted`,B):O.unset(["isFunded"]).write();let D=Swal.getContent();D!=null&&(D.innerHTML=`${x}<br /><p>Traitement en cours : il reste ${S} \xE9lements \xE0 convertir</p>`),await We(1)}Swal.hideLoading();let T=Swal.getContent();T!=null&&(T.textContent=`Traitement en termin\xE9 : ${y.value().length}/${y.value().length}`)}},{title:"Migration de la table des Sessions",html:"<p>Correction de la liste des sessions, ajout de funding</p>",onOpen:async function(a){console.log("%cMigration : table des sessions ajout de fundedBy",B),Swal.showLoading();for(var A=dayjs("2020-06-01"),E=d.get("students").value(),y=d.get("sessions").filter(w=>dayjs(w.when).isSameOrAfter(A,"day")),x=y.filter(w=>w.type!="soutenance"),S=Swal.getContent().textContent,O=x.value().length;O-=1;){var T=x.get(O);T.value().funding!==void 0?console.log(`%cSkip ${T.value()} already converted`,B):T.assign({funding:we.getFunding(T.value().who_id)}).write();let w=Swal.getContent();w.innerHTML=`${S}<br /><p>Traitement en cours : il rest ${O}\xE9lements \xE0 convertir</p>`,await We(1)}for(var D=O,x=y.filter(w=>w.type=="soutenance"),O=0;O<x.value().length;O+=1){x.get(O).assign({funding:$e}).write();let b=Swal.getContent();b!=null&&(b.innerHTML=`${S}<br /><p>Traitement en cours : ${D+O}/${y.value().length}</p>`),await We(1)}Swal.hideLoading();let v=Swal.getContent();v!=null&&(v.textContent=`Traitement termin\xE9 :  ${y.value().length}/${y.value().length}`)}}]).then(a=>{if(a.value){let A=JSON.stringify(a.value);Swal.fire({title:"Traitement termin\xE9!",html:`
			Your answers:
			<pre><code>${A}</code></pre>
		  `,confirmButtonText:"Lovely!"})}else return console.log("%c resultat en erreur",B,a,a.dismiss===Swal.DismissReason.cancel),-1});var e,s,n;for(m=0;m<s.length;m+=1){var o;o!==void 0&&d.get("students").find({fullname:o.who_name}).assign({who_id:o.who_id}).write()}var c;for(m=0;m<c.length;m+=1){var o,f;d.get("sessions").find({id:c[m].id}).assign({path:f}).write()}for(var m;m<n.value().length;m+=1)n.get(m).unset(["isFunded"]).write();for(var l,m;m<l.value().length;m+=1){var p=l.get(m);p.assign({fundedBy:we.getFunded(p.value().who_id)}).write()}for(var l,m;m<l.value().length;m+=1)l.get(m).assign({fundedBy:$e}).write()};var rr=Br(nr()),pn=class{},Ke=pn;G(Ke,"save",function(){return console.log("%cWanna save DBASE",B),JSON.stringify(W.Cfg.dbase.getState())}),G(Ke,"load",function(t){return console.log(`%cWanna load ${t} in DBASE`,B),console.log("%c !!!!!! TYPE NOT CHECKED BE CARREFULL",B),W.Cfg.dbase.setState(JSON.parse(t)).write()}),G(Ke,"update",async function(t){console.log(`%cIs there any update to DB to go to version ${t}`,B);let e=[{version:"1.00.0006",action:tr}];for(let n=0,o=e.length;n<o;n++)if(Yt(t,e[n].version)==0)if(console.log(`%cFound an update to DB version '${e[n].version}' proceed conversion...`,B),await e[n].action()==-1)console.log(`%cError something was wrong during update of database from version: ${ke.getVersion()} to version:${e[n].version}.... you have canceled it`,ge),Swal.fire({icon:"error",title:"Oops...",text:`Quelque chose s'est mal pass\xE9 ou vous avez annul\xE9 l'update 

Utiliser l'application dans ces conditions n'est pas garanti  !`,footer:'<a href="https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/issues">G\xE9n\xE9rer un bug?</a>'});else{let f=ke.setDbVersion(t);console.log(`%cChanged DB to version ${f}`,B)}let s=ke.setDbVersion(t);console.log(`%cChanged DB to version ${s}`,B)}),G(Ke,"erase",function(t){return console.log(`%cErase all data of table: ${t}`,B),W.Cfg.dbase.get(t).remove().write()}),G(Ke,"loadTable",function(t,e){if(table_exist(t))return W.Cfg.dbase.set(t,e).write();throw"Table :"+t+", not exists in DB !"}),G(Ke,"table_exist",t=>W.Cfg.dbase.has(t).value),G(Ke,"table_export",function(t){if(table_exist(t))return JSON.stringify(W.Cfg.dbase.get(t).value());throw"Table :"+t+", not exists id DB !"}),G(Ke,"exportTblToCSV",function(t="",e,s){let n=pn.exportTblToJSON(t,e,s),o={quotes:!1,quoteChar:'"',escapeChar:'"',delimiter:",",header:!0,newline:`\r
`,skipEmptyLines:!1,columns:null};return rr.default.unparse(n,o)}),G(Ke,"exportTblToJSON",function(t="",e,s){if(t=="")return console.log("%cIrrecoverable Error: You forget to define a data table name",ge),-1;if(e!==null&&e!==""&&(dtFrom=dayjs(e)),s!==null&&s!==""&&(dtTo=dayjs(s)),W.Cfg.dbase.has(t).value==!1)return console.log(`%cIrrecoverable Error: table ${t} don't exist`,ge),-1;if(t===Me.tbl_name){if(typeof dtFrom=="object"&&dtTo==="object")return W.Cfg.dbase.get(t).filter(n=>dayjs(n.when).isSameOrBefore(dtTo,"day")&&dayjs(n.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtFrom=="object")return W.Cfg.dbase.get(t).filter(n=>dayjs(n.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtTo=="object")return W.Cfg.dbase.get(t).filter(n=>dayjs(n.when).isSameOrBefore(dtTo,"day")).value()}return W.Cfg.dbase.get(t).value()});var Et=Ke;var Ut=async function(){var d="";d+="<style>div.about_content {background-color: #fed9ff;/*width: 600px;*/height: var(--heigth, 80%);overflow-x: hidden;overflow-y: auto;text-align: left;padding: 20px;}</style>",d+='<div class="about_content" style="--heigth: 600px;">',d+='<div class="about_content__wrapper">';var e=(await ft.XHR({method:"GET",url:"https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/README.md",responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"}})).responseText,s=new showdown.Converter,n=s.makeHtml(e);d+=n,d+="</div>",d+="</div>",Swal.fire({title:`<strong>A propos de ${xn}</strong>`,icon:"info",html:d,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})};var hi=function(d){if(d.querySelector(".Facturier__cbox input[type=checkbox]")===null){var t=mn(d);typeof t!="undefined"&&d.appendChild(t)}else ir(d)};var mn=function(d,t=!0){if(d.childElementCount===1)return;if(t===!0){let x=window.location.pathname.split("/");if(x[x.length-1]!=="mentorship-sessions-history")return}var e=null,s=d.children[0].querySelector("svg").getAttribute("aria-label"),n=d.children[0].querySelector("p").innerText;d.children[0].childElementCount===2&&(e=d.children[2].getAttribute("aria-label"));var o=d.children[1].querySelector("time").getAttribute("datetime").trim(),c=d.children[2].querySelector("a").innerText,f=mt(d.children[2],-2),m=null;d.childElementCount>3&&d.children[3].childElementCount!==0&&d.children[3].querySelector("span")!==null&&(m=d.children[3].querySelector("span").innerText);var l=document.createElement("input");l.type="checkbox",l.name="name";var p=dayjs(o).toISOString(),a=Me.getHashId(p,f);l.value=a,l.onclick=function(x){x.stopPropagation()},bChecked=Me.exists(a),bChecked===!0&&(l.checked=!0);let A=d.children[1].classList,E=d.lastChild.classList;d.lastChild.classList=A;var y=document.createElement("div");return y.appendChild(l),y.classList.add(...E),y.classList.add("Facturier__cbox"),y},ir=function(d){try{oInput=d.querySelector("input")}catch(e){throw Error("IRRECOVERABLE ERROR: no input element")}let t=parseInt(oInput.value,10);bChecked=Me.exists(t),bChecked===!0?oInput.checked=!0:oInput.checked=!1},Jt=function(){var d=$t,t=document.querySelector(d),e=!1;if(t===null)throw console.log(`%cERROR:Could'nt find the table which display sessions : ${t}`,ge),new Error("!!!! IRRECOVERABLE ERROR NO TABLE OF SESSIONS FOUNDED");if(t.querySelector(".Facturier__cbox input[type=checkbox]")===null){var t=document.querySelector(`${d}`).children;for(let[m,l]of Object.entries(t)){if(l.firstChild.nodeName!=="A")continue;let p=l.firstChild;p.appendChild(mn(p))}if(document.querySelector(`${d} .Facturier__cbox_all`)===null){let m=(p,a)=>a.insertAdjacentElement("beforebegin",p);var s=document.querySelector(`${d} li`);let l=s.firstChild.classList;var n=document.createElement("input");n.type="checkbox",n.name="name",n.value="value",n.id="id",n.onclick=function(){document.querySelectorAll(".Facturier__cbox input[type=checkbox]").forEach(p=>p.checked=!p.checked)},n.style="visibility: hidden;";var o=document.createElement("label");o.innerText="in DB",o.style="display:block;text-align:right;",o.onMouseOver="this.style.cursor=pointer;",o.onMouseOut="this.style.cursor=auto;",o.appendChild(n);var c=document.createElement("div");c.classList=l,c.classList.add("Facturier__cbox_all"),c.appendChild(o),m(c,document.querySelector(`${d} li`))}}else{var t=document.querySelector(`${d}`).children;for(let[m,l]of Object.entries(t)){if(l.firstChild.nodeName!=="A")continue;let p=l.firstChild;p.querySelector(".Facturier__cbox input[type=checkbox]")===null?p.appendChild(mn(p)):ir(p)}}},or=function(d){return hi(d)},sr=async function(){var[d,t]=await Ot(dayjs().startOf("month"),dayjs().endOf("month"));let e=Kt.getListDetailBill(d,t),s="";s+="<table>",s+="<thead>",s+="<tr><th>Quand</th><th>Qui</th><th>Financ\xE9 ?</th><th>Type</th><th>Niveau</th><th>Ancien Mode ?</th><th>Statut</th><th>PU HT</th><th>Cumul</th></tr>",s+="<thead>",s+="<tbody>";for(let n=0;n<e.length;n+=1)s+="<tr>",s+=`<td>${dayjs(e[n].when).format("DD/MM/YYYY \xE0 HH:mm:ss")}</td>`,s+=`<td>${e[n].who_name}</td><td>${e[n].funding}</td>`,sType=e[n].type,e[n].path!=null&&e[n].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&e[n].type!=="soutenance"&&(sType="Coaching"),s+=`<td>${sType}</td><td>${e[n].lvl}</td>`,s+=`<td>${e[n].oldMode===!0?"Oui":"Non"}</td>`,s+=`<td>${e[n].status}</td>`,s+=`<td>${e[n].iPu}</td><td>${e[n].iCumul}\u20AC</td>`,s+="</tr>";s+="</tbody>",s+="</table>",Swal.fire({title:`<strong>Liste d\xE9taill\xE9es des sessions du ${d.format("DD/MM/YYYY")} au ${t.format("DD/MM/YYYY")}</strong>`,icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:n=>{var o=n.querySelector("table"),c=new simpleDatatables.DataTable(o)}})},ar=async function(){var d=!0,[t,e]=await Ot(dayjs().startOf("month"),dayjs().endOf("month"));d==!0&&console.log("%ccollectAuto() Wanna collect from %s to %s",B,t.format("DD/MM/YYYY"),e.format("DD/MM/YYYY"));var s=await Me.getSessionsFromAPI(t,e);d==!0&&console.log("%ccollectAuto() Sessions are is %o",B,s)};var dr=async function(){var d=$t,t=document.querySelectorAll(d);GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let e='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';Swal.fire({title:"Traitement en cours!",html:e,confirmButtonText:"Lovely!",onBeforeOpen:function(s){var n=new ldBar("#pbar")},onRender:function(s){},onOpen:async function(s){for(var n=document.getElementById("pbar").ldBar,o=0;o<t.length;o+=1){var c=t[o].parentElement.parentElement,f=Me.parseRow(c);await Me.add(f),n.set(o/t.length*100,!1)}n.set(100,!1),Swal.getTitle()&&(Swal.getTitle().innerText="Traitement termin\xE9 !")},onClose:function(s){},onAfterClose:function(s){},onDestroy:function(s){}})},lr=function(){let d=unsafeWindow.Facturier.cfg.dbase,t=unsafeWindow.Facturier.libs.find(m=>m.id=="dayjs").ptr,e=unsafeWindow.Facturier.libs.find(m=>m.id=="fetchInject").ptr,s=unsafeWindow.Facturier.klass.find(m=>m.id=="Session").ptr,n=unsafeWindow.Facturier.klass.find(m=>m.id=="Student").ptr,o=unsafeWindow.Facturier.klass.find(m=>m.id=="History").ptr,c=unsafeWindow.Facturier.klass.find(m=>m.id=="Archive").ptr,f=unsafeWindow.Facturier.klass.find(m=>m.id=="StudentHistory").ptr;console.log("%cd_dbase, d_dayjs, d_Session, d_Student, d_History, d_Archive, d_StudentHistory are exported",B),console.log("%cfor examples write all code after $>",B),console.group("%cd_dbase",B),console.log("example : get last session in db $>d_dbase.get(d_Session.tbl_name).last().value();"),console.log("          get first student in db $>d_dbase.get(d_Student.tbl_name).first().value()"),console.log("          or d_dbase.get(d_Student.tbl_name).get(0).value()"),console.log("          get all sessions grouped by month/yyyy in db $>d_dbase.get(d_Session.tbl_name).groupBy( v => d_dayjs(v.when).format('MM/YYYY')).value()"),console.log("          get all table $> d_dbase.value()"),console.groupEnd(),console.group("%cd_fetchInject",B),console.log("same as fetchInject libs : https://habd.as/code/fetch-inject/"),console.groupEnd(),console.group("%cd_dayjs",B),console.log("same as dayjs libs"),console.groupEnd(),console.group("%cd_Student",B),console.log("find a student by id \xA4 d_Student.findById(STUDENT_ID, (DATE) ); // date is optionnal"),console.groupEnd(),console.group("%cd_Session",B),console.log("get a list of session \xA4 d_Session.getBetween('2020-08-01','2020-08-31')"),console.log("delete a session by id \xA4 d_Session.deleteById(SESSION_ID);"),console.groupEnd(),console.group("%cSome combinated example",B),console.log("Delete last saved session :  d_Session.deleteById( d_dbase.get(d_Session.tbl_name).last().value().id ); "),console.log("Find all session between 01/08/2020 and 31/08/2020 :  d_dbase.get(d_Session.tbl_name).filter( v => d_dayjs(v.when).isSameOrBefore('20200831', 'day') && d_dayjs(v.when).isSameOrAfter('20200801', 'day')).value(); "),console.groupEnd();debugger};var ur=function(){let{degrees:d,PDFDocument:t,rgb:e,StandardFonts:s}=PDFLib;async function n(){let m=await fetch("https://pdf-lib.js.org/assets/with_update_sections.pdf").then(S=>S.arrayBuffer()),l=await t.load(m),p=await l.embedFont(s.Helvetica),A=l.getPages()[0],{width:E,height:y}=A.getSize();A.drawText("This text was added with JavaScript!",{x:5,y:y/2+300,size:50,font:p,color:e(.95,.1,.1),rotate:d(-45)});let x=await l.save();download(x,"pdf-lib_modification_example.pdf","application/pdf")}async function o(){let f=await t.create(),m=await f.embedFont(s.TimesRoman),l=f.addPage(),{width:p,height:a}=l.getSize(),A=30;l.drawText("Creating PDFs in JavaScript is awesome!",{x:50,y:a-4*A,size:A,font:m,color:e(0,.53,.71)});let E=await f.save();download(E,"pdf-lib_modification_example.pdf","application/pdf")}async function c(){var[f,m]=await Ot(dayjs().startOf("month"),dayjs().endOf("month"));let l=Kt.getListDetailBill(f,m),p=await t.create(),a=await p.embedFont(s.TimesRoman),A=p.addPage(),{width:E,height:y}=A.getSize(),x=30;A.drawText(`Prestations en d\xE9tail 

 du ${f.format("DD/MM/YYYY")} au ${m.format("DD/MM/YYYY")}`,{x:50,y:y/2-x,size:x,font:a,color:e(116/255,81/255,235/255)});let S=12,O=1.25,T=p.addPage();T.setFontSize(S),T.line_space=O,T.font=a;let D=1,v=20,w=O*S+v,b=y/2,u=function(re){let z="LOrEm ipsum DOLor sit aMet, conSEc/tetUr 25 porttitor. ";return re*1.0925*(a.widthOfTextAtSize(z,S)/z.length)},C=[0,18,36,10,13,8,5,7],g=[C[0],u(C[1]),u(C[2]),u(C[3]),u(C[4]),u(C[5]),u(C[6]),u(C[7])],M=A.lineHeight,L=25;for(let re=1;re<l.length;re+=1){if(b=y-O*S*D,b<w&&(D=1,T=p.addPage(),T.font=a,T.setFontSize(S),T.line_space=O,b=y-O*S*D),D===1){let qe=["","Quand","Qui","Financ\xE9","Type-Niv.","Statut","Pu","Cumul"],De=L;T.moveTo(De,b);for(let Qe=1;Qe<qe.length;Qe+=1)T.drawText(qe[Qe],{x:De}),De+=g[Qe];D+=1,b=y-O*S*D}let z=L;T.drawText(dayjs(l[re].when).format("DD/MM/YYYY \xE0 HH:mm"),{font:a,size:S,y:b,x:z,lineHeight:M}),z+=g[1],T.drawText(l[re].who_name.trim().slice(0,C[2]),{font:a,size:S,y:b,x:z,lineHeight:M}),z+=g[2];let ve=l[re].funding.trim().slice(0,C[3]);l[re].funding==="auto-financ\xE9"&&(ve="Au. Fin."),l[re].funding==="financ\xE9 par un tiers"&&(ve="Fin."),T.drawText(ve,{font:a,size:S,y:b,x:z,lineHeight:M}),z+=g[3];let Ee=l[re].type;l[re].path!=null&&l[re].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&l[re].type!=="soutenance"&&(Ee="Coaching");let Re=`${Ee.trim().slice(0,C[4]-2)}-${l[re].lvl.toString()}`;T.drawText(Re,{font:a,size:S,y:b,x:z,lineHeight:M}),z+=g[4];let Ie=l[re].status;l[re].status==="\xE9tudiant absent"&&(Ie="absent"),l[re].status==="\xE9tudiante absente"&&(Ie="absente"),l[re].status==="annul\xE9e tardivement"&&(Ie="an. tard."),T.drawText(Ie,{font:a,size:S,y:b,x:z,lineHeight:M}),z+=g[5],T.drawText(l[re].iPu.toString(),{font:a,size:S,y:b,x:z,lineHeight:M}),z+=g[6],T.drawText(l[re].iCumul.toString(),{font:a,size:S,y:b,x:z,lineHeight:M}),D+=1}var k=await Ze.calculateBill(f,m);let N=k.get(0,0,0,0).maxLevel,$=Ce.getOldModeDate(),R=Ze.getPriceList($.subtract(1,"day")),U=Ze.getPriceList($);var P=1;let F=!1;var j=[q,V,Q],Y=["Sessions","Soutenance","Coaching"],H=[0,1,2,3],te=["R\xE9alis\xE9e","Annul\xE9e","Annul\xE9e tardivement","Etudiant(e) absent(e)"],le=[Z,X,ee],ue=["Autofinanc\xE9s","Financ\xE9s","Autres"];D=1,T=p.addPage();let ce=["","Quand","Qui","Nb","Pu","Cumul"],K=[0,18,50,3,5,7],J=[C[0],u(C[1]),u(C[2]),u(C[3]),u(C[4]),u(C[5])],he="";for(_iSessionType=0,_iSessionTypeLength=j.length;_iSessionType<_iSessionTypeLength;_iSessionType+=1){for(;P<=N;){for([D,T]=ut.changePgIfNeeded(b,w,D,p),b=y-O*S*D,_iSessionQuality=0,_iSessionQualityLength=H.length;_iSessionQuality<_iSessionQualityLength;_iSessionQuality+=1)for(_iFunding=0,_iFundingLength=le.length;_iFunding<_iFundingLength;_iFunding+=1){if(_i0=k.get(j[_iSessionType],H[_iSessionQuality],le[_iFunding],P),typeof _i0=="undefined"&&F===!1)continue;_i0.data=_i0.data.reverse();let re=L;if(he=`${Y[_iSessionType]} de Niveau ${P} Etudiants ${ue[_iFunding]}`,T.moveTo(re,b),T.drawText(he,{font:a,size:S+4,y:b,x:re,lineHeight:M}),re+=15,D+=1,[D,T]=ut.changePgIfNeeded(b,w,D,p),b=y-O*S*D,T.moveTo(re,b),T.drawText(te[_iSessionQuality],{font:a,size:S+2,y:b,x:re,lineHeight:M}),re+=15,D+=1,[D,T]=ut.changePgIfNeeded(b,w,D,p),b=y-O*S*D,typeof _i0=="undefined"){T.drawText(`d\xE9sol\xE9 pas de r\xE9sultat pour cette section au niveau de facturation (${P})`,{font:a,size:S,y:b,x:re,lineHeight:M}),D+=1,[D,T]=ut.changePgIfNeeded(b,w,D,p),b=y-O*S*D;continue}let z=re,ve=0;T.moveTo(re,b);for(let Ee=1;Ee<ce.length;Ee+=1)T.drawText(ce[Ee],{font:a,size:S+2,y:b,x:z,lineHeight:M}),z+=J[Ee];D+=1,[D,T]=ut.changePgIfNeeded(b,w,D,p),b=y-O*S*D,z=re;for(var fe=0,pe=_i0.data.length;fe<pe;fe+=1)z=re,T.drawText(dayjs(_i0.data[fe].when).format("DD/MM/YYYY \xE0 HH:mm"),{font:a,size:S,y:b,x:z,lineHeight:M}),z+=J[1],T.drawText(_i0.data[fe].who_name.trim().slice(0,K[1]),{font:a,size:S,y:b,x:z,lineHeight:M}),z+=J[2],T.drawText((fe+1).toString(),{font:a,size:S,y:b,x:z,lineHeight:M}),z+=J[3],Ce.isInOldMode(dayjs(_i0.data[fe].when))?iPu=+_i0.data[fe].lvl>0?R[P][j[_iSessionType]][H[_iSessionQuality]][le[_iFunding]]:0:iPu=+_i0.data[fe].lvl>0?U[P][j[_iSessionType]][H[_iSessionQuality]][le[_iFunding]]:0,T.drawText(iPu.toString(),{font:a,size:S,y:b,x:z,lineHeight:M}),z+=J[4],ve+=iPu,T.drawText(ve.toString(),{font:a,size:S,y:b,x:z,lineHeight:M}),D+=1,[D,T]=ut.changePgIfNeeded(b,w,D,p),b=y-O*S*D}P+=1,D+=1,[D,T]=ut.changePgIfNeeded(b,w,D,p),b=y-O*S*D}P=1}ut.addFooter(p,`G\xE9n\xE9r\xE9 avec Facturier version ${Ce.getAppVersion()}`);let ye=await p.save();download(ye,`prestations_facturees_detail_${f.format("YYYYMMDD")}-${m.format("YYYYMMDD")}.pdf`,"application/pdf")}c()},cr=async function(){GM_addStyle('.formgrid{font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", Helvetica, Arial, sans-serif;}'),GM_addStyle(`
.swal2-styled[type=button]{background-color:#3085d6;border-radius:.75em;color:#fff;font-size:1.0625em;border-left-color:#3085d6;border-right-color:#3085d6;display:inline-block}
.formgrid{display:grid;grid-template-columns:1fr 1em 1fr;grid-gap:.3em .6em;grid-auto-flow:dense;align-items:center}
.formgrid input,.formgrid output,.formgrid textarea,.formgrid select,.formgrid button{grid-column:2 / 4;width:auto;margin:0}
.formgrid legend{font-size:1.2em;width:100%;border-bottom:1px dotted #99c}
.formgrid fieldset{max-width:40em;padding:4px;margin:2em auto;border:0 none}
`);let d="";d+="<legend>Que voulez vous faire ?</legend>",d+="<fieldset>",d+='<div class="formgrid">',d+='Epurer<button id="answer1" data-action="raz" class="swal2-styled" type="button">RAZ</button>',d+='Sauvegarder toute la base<button id="answer2" data-action="export" class="swal2-styled" type="button">Sauvegarder</button>',d+='Charger toute la base<button id="answer3" data-action="import" class="swal2-styled" type="button">Charger</button>',d+=`Exporter les tables
    <button class="swal2-styled" type="button"
    	hx-get="/views/test-swal-sauvegarde"
		hx-select="body"
        hx-target="#sttPlaceHolder"
        hx-include="[name='email']"
        hx-swap="innerHTML"> Exporter
    </button>
		`,d+="</fieldset>",d+="</div>";let{value:t}=await Swal.fire({title:"Gestion de la base de donn\xE9e",html:d,focusConfirm:!1,preConfirm:()=>[document.getElementById("answer1").value,document.getElementById("answer2").value],didOpen:e=>{console.log("%conOpen popup","color:coral"),htmx.process(document.querySelector(".swal2-container")),console.log("%cHtmx Process done","color:coral"),e.querySelector(".formgrid").addEventListener("click",_handler=function(s){let n=function(f){f.target.matches('button[data-action="raz"]')&&(Swal.close(),bi())},o=function(f){f.target.matches('button[data-action="export"]')&&(Swal.close(),gi())},c=function(f){f.target.matches('button[data-action="import"]')&&(Swal.close(),yi())};n(s),o(s),c(s)})},onClose:e=>{e.querySelector(".formgrid").removeEventListener("click",_handler),console.log("%conClose popup","color:coral")}});t&&Swal.fire(JSON.stringify(t))},gi=async function(){let d=Et.save();console.log(`%cWanna save : ${d}`,B);let t=dayjs(),e="";e+=`<a id="download" href="data:text/plain;charset=utf-8,${encodeURIComponent(d)}" download="save_${t.format("YYYYMMDD")}.json">save_${t.format("YYYYMMDD")}.json</a>`,Swal.fire({title:"Sauvegarde de la base de donn\xE9e",html:e,focusConfirm:!1,onOpen:s=>{s.querySelector("#download").click()},onClose:s=>{}})};var yi=async function(){console.log("%cWanna load DATABASE",B);let{value:d}=await Swal.fire({title:"Selection de la sauvegarde (json)",input:"file",inputAttributes:{accept:".json","aria-label":"Upload your database"}});if(d){let t=new FileReader;t.onload=e=>{Et.load(e.target.result),Jt(),Mt("Chargement de la base termin\xE9")},t.readAsText(d)}},bi=async function(){GM_addStyle(".form_addon {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}"),GM_addStyle(".form_addon input {background: #fff;border: 1px solid #9c9c9c;}"),GM_addStyle(".form_addon button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}"),GM_addStyle(".form_addon button:hover {background: gold;}"),GM_addStyle(".form_addon label {padding: 0.5em 0.5em 0.5em 0;}"),GM_addStyle(".form_addon input {padding: 0.7em;margin-bottom: 0.5rem;}"),GM_addStyle(".form_addon input:focus {outline: 3px solid gold;}"),GM_addStyle("@media (min-width: 400px) {.form_addon {grid-template-columns: 200px 1fr;grid-gap: 16px;} .form_addon label {text-align: right;grid-column: 1 / 2;} .form_addon input, .form_addon button {grid-column: 2 / 3;}}");var d="";d+='<form id="RAZ" class="form_addon" action="">',d+='<label for="students" class="cbox">Etudiants</label>',d+='<input id="students" type="checkbox" value="del_students_true" checked>',d+='<label for="sessions" class="cbox">Sessions</label>',d+='<input id="sessions" type="checkbox" value="del_sessions_true" checked>',d+='<label for="archives" class="cbox">Archives : factures</label>',d+='<input id="archives" type="checkbox" value="del_archives_true" checked>',d+='<label for="history_cache" class="cbox">Signet historique</label>',d+='<input id="history_cache" type="checkbox" value="del_history_cache_true" checked>',d+='<label for="radio1">filtrer la date</label>',d+='<input type="radio" id="radio1" name="date_filter" value="false" checked>',d+='<label for="radio2">ne pas filtrer</label>',d+='<input type="radio" id="radio2" name="date_filter" value="true">',d+='<label for="dtFrom" class="date">Date de d\xE9but</label>',d+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',d+='<label for="dtTo" class="date">Date de fin</label>',d+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',d+="<!-- Switch -->",d+='<input type="checkbox" class="switch" name="s1" id="s1">',d+='<label for="s1">Switch</label>',d+="</form>";let{value:t}=await Swal.fire({title:"<strong>RAZ des donn\xE9es</strong>",icon:"info",html:d,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez ce que vous allez supprimer de la base de donn\xE9e",preConfirm:()=>{let m=document.getElementsByName("date_filter"),l="notfound";for(var p in m)m[p].checked===!0&&(l=m[p].value);return console.log(document.getElementById("s1")),[document.getElementById("students").checked,document.getElementById("sessions").checked,document.getElementById("archives").checked,document.getElementById("history_cache").checked,document.getElementById("dtFrom").disabled===!0?null:document.getElementById("dtFrom").value,document.getElementById("dtTo").disabled===!0?null:document.getElementById("dtTo").value,l]},onOpen:m=>{m.querySelector("#radio1").addEventListener("change",function(){console.log(document.getElementById("radio1").checked);let l=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!l,document.getElementById("dtTo").disabled=!l}),m.querySelector("#radio2").addEventListener("change",function(){let l=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!l,document.getElementById("dtTo").disabled=!l}),m.querySelector("#dtFrom").addEventListener("change",function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:m=>{m.querySelector("#radio1").removeEventListener("change"),m.querySelector("#radio2").removeEventListener("change"),m.querySelector("#dtFrom").removeEventListener("change")}}),e=t[0],s=t[1],n=t[2],o=t[3];console.log(`%cWanna raz students ? ${e}, wanna raz sessions ? ${s}, wanna raz archives ? ${n}`,B);let c=t[4]?dayjs(t[4]):null,f=t[5]?dayjs(t[5]):null;e===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des \xE9tudiants",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),we.delete(c,f),ke.remStudentListUpd()),s===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des sessions",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),Me.delete(c,f),Jt()),n===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des archives (financi\xE8res)",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),At.delete(c,f)),o===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base du cache des historique de session",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),xt.remove(c,f))};var fr=async function(){var d="";d+="<style>",d+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",d+="form input {background: #fff;border: 1px solid #9c9c9c;}",d+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",d+="form button:hover {background: gold;}",d+="form label {padding: 0.5em 0.5em 0.5em 0;}",d+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",d+="form input:focus {outline: 3px solid gold;}",d+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",d+="</style>",d+='<form class="form1" action="">',d+='<label for="dd" class="date">Date de d\xE9but</label>',d+='<input id="dd" type="date" max="2030-12-31" min="2010-12-31">',d+='<label for="df" class="date">Date de fin</label>',d+='<input id="df" type="date" max="2030-12-31" min="2010-12-31">',d+="</form>";var[t,e]=await Ot(dayjs().startOf("month"),dayjs().endOf("month")),s=await Ze.calculateBill(t,e);Ce.isInOldMode(t)?vi(t,e,s):_i(t,e,s)};var vi=function(d,t,e){let s=e.get(0,0,0,0),n=4;var o="",c=null,f=0,m=0,l=0,p=[[4,"Groupe"],[1,"Niveau 1"],[2,"Niveau 2"],[3,"Niveau 3"]],a=0,A=0,E=!1,y=0,x=0,S=0,O=0,T=0,D=0,v=0,w=0,b=0,u=0,C=0,g=0,M=0,L=0,k=0,I=0,N=0,$=0,R=1;e.toConsole(),o+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",o+='<div class="wrapper">',o+="<table>",o+="<thead>",o+="<tr>",o+='<th>Type</th><th><abbr title="nombre">nb</abbr></th><th>PU(<abbr title="hors taxes">HT</abbr>)</th><th>Total(<abbr title="hors taxes">HT</abbr>)</th>',o+="</tr>",o+="</thead>",o+="<tbody>",o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Mentorat</th>',o+="</tr>";for(var a=performance.now();R<=n;)_i0=e.get(q,oe,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(q,oe,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(q,oe,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : r\xE9alis\xE9es</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(q,se,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(q,se,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(q,se,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : annul\xE9es</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(q,ne,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(q,ne,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(q,ne,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : annul\xE9es tard.</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(q,ae,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(q,ae,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(q,ae,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : \xE9tudiant abs.</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),R+=1;var A=performance.now();console.log("%cCalculate first array"+(A-a)+" milliseconds.",ze),o+="<tr>",o+="<td>Total</td>",o+=`<td>${f}</td><td></td><td>${m}\u20AC</td>`,o+="</tr>",o+="<tr>",o+="</tr>",l+=m,f=0,m=0,o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',o+="</tr>",R=1;for(var a=performance.now();R<=n;)_i0=e.get(V,oe,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(V,oe,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(V,oe,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : r\xE9alis\xE9es</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(V,se,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(V,se,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(V,se,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : annul\xE9es</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(V,ne,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(V,ne,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(V,ne,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : annul\xE9es tard.</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(V,ae,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(V,ae,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(V,ae,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : \xE9tudiant abs.</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),R+=1;var A=performance.now();console.log("%cCalculate second array"+(A-a)+" milliseconds.",ze),o+="<tr>",o+="<td>Total</td>",o+=`<td>${f}</td><td></td><td>${m}\u20AC</td>`,o+="</tr>",o+="<tr>",o+="</tr>",l+=m,f=0,m=0,o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',o+="</tr>",R=1;for(var a=performance.now();R<=n;)_i0=e.get(Q,oe,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(Q,oe,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(Q,oe,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : r\xE9alis\xE9es</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(Q,se,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(Q,se,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(Q,se,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : annul\xE9es</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(Q,ne,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ne,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ne,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : annul\xE9es tard.</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),_i0=e.get(Q,ae,Z,R),u=_i0===void 0?0:_i0.number,I=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ae,X,R),C=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ae,ee,R),g=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,M=u>0?I/u:I,L=C>0?N/C:N,k=g>0?$/g:$,(E===!0||u+C+g>0)&&(f+=u,f+=C,f+=g,m+=I,m+=N,m+=$,o+="<tr>",o+=`<td>Niveau ${R} : \xE9tudiant abs.</td>`,o+=`<td>${u+C+g}</td><td>${L}</td><td>${I+N+$}\u20AC</td>`,o+="</tr>"),R+=1;var A=performance.now();console.log("%cCalculate third array"+(A-a)+" milliseconds.",ze),o+="<tr>",o+="<td>Total</td>",o+=`<td>${f}</td><td></td><td>${m}\u20AC</td>`,o+="</tr>",o+="<tr>",o+="</tr>",l+=m,o+="<tr>",o+='<th colspan="4" class="pseudoheader" scope="colgroup">Total G\xE9n\xE9ral</th>',o+="</tr>",o+=`<td colspan="3"></td><td>${l}\u20AC</td>`,o+="</tr>",o+="<tr>",o+="</tr>",o+="</tbody>",o+="<tfoot>",o+="</tfoot>",o+="</table>",o+=`<p>Soit un total g\xE9n\xE9ral \xE0 facturer de ${l}\u20AC`,Swal.fire({title:`<strong>Liste des formations tarif\xE9es du ${d.format("DD/MM/YYYY")} au ${t.format("DD/MM/YYYY")}</strong>`,html:o,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},_i=function(d,t,e){console.log("%cEnter computation bill",B);let s=!1;var n="",o=0,c=0,f=0,m=0,l=0,p=0,a=0,A=0,E=0,y=0,x=0,S=0;let O=e.get(0,0,0,0),T=O.maxLevel;var D=0,v=0,w=0,b=0,u=0,C=0,g=0,M=0,L=0,k=0,I=0,N=0,$=0,R=0,U=0,P=0,F=0,j=0,Y=1;n+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",n+='<div class="wrapper">',n+="<table>",n+="<thead>",n+="<tr>",n+='<th rowspan="2">Type</th><th colspan="3" scope="colgroup">Auto Financ\xE9s</th><th colspan="3" scope="colgroup">Financ\xE9s</th><th colspan="3" scope="colgroup">Autres</th><th colspan="2" scope="colgroup">Total</th>',n+="</tr>",n+="<tr>",n+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',n+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',n+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',n+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',n+="</tr>",n+="</thead>",n+="<tbody>",n+="<tr>",n+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de mentorat</th>',n+="</tr>";for(var H=performance.now();Y<=T;)_i0=e.get(q,oe,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(q,oe,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(q,oe,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : r\xE9alis\xE9es</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(q,se,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(q,se,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(q,se,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : annul\xE9es</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(q,ne,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(q,ne,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(q,ne,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : annul\xE9es tard.</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(q,ae,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(q,ae,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(q,ae,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : \xE9tud. absent</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),Y+=1;var te=performance.now();for(console.log("%cCalculate first array"+(te-H)+" milliseconds.",ze),n+="<tr>",n+="<td>Total</td>",n+=`<td>${o}</td><td></td><td>${m}\u20AC</td>`,n+=`<td>${c}</td><td></td><td>${l}\u20AC</td>`,n+=`<td>${f}</td><td></td><td>${p}\u20AC</td>`,n+=`<td>${o+c+f}</td><td>${m+l+p}\u20AC</td>`,n+="</tr>",n+="<tr>",n+="</tr>",a+=o,A+=c,E+=f,y+=m,x+=l,S+=p,o=0,c=0,f=0,m=0,l=0,p=0,n+="<tr>",n+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',n+="</tr>",Y=1;Y<=T;)_i0=e.get(V,oe,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(V,oe,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(V,oe,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : r\xE9alis\xE9es</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(V,se,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(V,se,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(V,se,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : annul\xE9es</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(V,ne,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(V,ne,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(V,ne,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : annul\xE9es tard.</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(V,ae,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(V,ae,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(V,ae,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : \xE9tud. absent</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),Y+=1;n+="<tr>",n+="<td>Total</td>",n+=`<td>${o}</td><td></td><td>${m}\u20AC</td>`,n+=`<td>${c}</td><td></td><td>${l}\u20AC</td>`,n+=`<td>${f}</td><td></td><td>${p}\u20AC</td>`,n+=`<td>${o+c+f}</td><td>${m+l+p}\u20AC</td>`,n+="</tr>",n+="<tr>",n+="</tr>",a+=o,A+=c,E+=f,y+=m,x+=l,S+=p,o=0,c=0,f=0,m=0,l=0,p=0,n+="<tr>",n+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',n+="</tr>";for(var Y=1;Y<=T;)_i0=e.get(Q,oe,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(Q,oe,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(Q,oe,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : r\xE9alis\xE9es</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(Q,se,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(Q,se,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(Q,se,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : annul\xE9es</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(Q,ne,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ne,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ne,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : annul\xE9es tard.</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),_i0=e.get(Q,ae,Z,Y),k=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ae,X,Y),I=_i0===void 0?0:_i0.number,F=_i0===void 0?0:_i0.amount,_i0=e.get(Q,ae,ee,Y),N=_i0===void 0?0:_i0.number,j=_i0===void 0?0:_i0.amount,$=k>0?P/k:P,R=I>0?F/I:F,U=N>0?j/N:j,(s===!0||k+I+N>0)&&(o+=k,c+=I,f+=N,m+=P,l+=F,p+=j,n+="<tr>",n+=`<td>Niveau ${Y} : \xE9tud. absent</td>`,n+=`<td>${k}</td><td>${$}</td><td>${P}\u20AC</td>`,n+=`<td>${I}</td><td>${R}</td><td>${F}\u20AC</td>`,n+=`<td>${N}</td><td>${U}</td><td>${j}\u20AC</td>`,n+=`<td>${k+I+N}</td><td>${P+F+j}\u20AC</td>`,n+="</tr>"),Y+=1;a+=o,A+=c,E+=f,y+=m,x+=l,S+=p,n+="<tr>",n+="<td>Total</td>",n+=`<td>${o}</td><td></td><td>${m}\u20AC</td>`,n+=`<td>${c}</td><td></td><td>${l}\u20AC</td>`,n+=`<td>${f}</td><td></td><td>${p}\u20AC</td>`,n+=`<td>${o+c+f}</td><td>${m+l+p}\u20AC</td>`,n+="</tr>",n+="<tr>",n+="</tr>",n+="</tbody>",n+="<tfoot>",n+="</tfoot>",n+="</table>";var le=0,ue="";let ce=O.flatFee.length;for(var K=0;K<ce;K+=1)le+=30,ue+=O.flatFee[K].who_name+", ";ce>1?n+=`<p class="flat_fee">Calcul du forfait "autofinanc\xE9". Ce mois ci ${ce} \xE9tudiants ont eu au moins une session il s'agit de : ${ue.slice(0,-1)}`:n+=`<p class="flat_fee">Calcul du forfait "autofinanc\xE9". Ce mois ci ${ce} \xE9tudiant a eu au moins une session il s'agit de : ${ue.slice(0,-1)}`,n+=`. Le forfait est donc de ${le}\u20AC</p>`,n+=`<p>Soit un total g\xE9n\xE9ral \xE0 facturer de ${y+x+S+le}\u20AC</p>`,Swal.fire({title:`<strong>Liste des formations tarif\xE9es du ${d.format("DD/MM/YYYY")} au ${t.format("DD/MM/YYYY")}</strong>`,html:n,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},pr=async function(){var[d,t]=await Ot(dayjs().startOf("month"),dayjs().endOf("month"),!1);if(d===null||t===null)throw console.log("%cError need date from, date to",ge),new Error;let e=Kt.getListStatistic(d,t),s="",n=new Array(22),o=Array.apply(null,Array(22)).map(Number.prototype.valueOf,0),c=d.clone(),f=c.endOf("month"),m="";n[0]="<thead><tr><th>Sessions</th>",n[1]="<tbody><tr><td>Sessions</td>",n[2]='<tr class="header"><td>Montant</td>',n[3]="<tr><td>Nb.",n[4]="<tr><td>Pu",n[5]='<tr class="header"><td>Soutenances</td>',n[6]="<tr><td>Montant</td>",n[7]="<tr><td>Nb.",n[8]="<tr><td>Pu",n[9]='<tr class="header"><td>Coaching</td>',n[10]="<tr><td>Montant</td>",n[11]="<tr><td>Nb.",n[12]="<tr><td>Pu",n[13]='<tr class="header"><td>Bonus</td>',n[14]="<tr><td>Bonus AF</td>",n[15]="<tr><td>Total G\xE9n\xE9ral</td>",n[16]='<tr class="header"><td>KPI</td>',n[17]="<tr><td>NbJrs</td>",n[18]="<tr><td>TJM</td>",n[19]="<tr><td>Nb hrs</td>",n[20]="<tr><td>THM</td>",n[21]="<tr><td>Nb hrs (p.)</td>",n[22]="<tr><td>THM (p)</td>";for(var l=0;l<e.length;l+=1){o[2]+=e[l].sessions.total,o[3]+=e[l].sessions.nb-e[l].sessions.nbc,o[4]+=e[l].sessions.pu,o[6]+=e[l].defenses.total,o[7]+=e[l].defenses.nb-e[l].defenses.nbc,o[8]+=e[l].defenses.pu,o[10]+=e[l].coaches.total,o[11]+=e[l].coaches.nb-e[l].coaches.nbc,o[12]+=e[l].coaches.pu,o[14]+=e[l].bonus;let p=e[l].sessions.total+e[l].defenses.total+e[l].coaches.total+e[l].bonus;o[15]+=p,o[16]+=e[l].kpi.jrs,o[18]+=e[l].kpi.hrs,o[20]+=e[l].kpi.hrsp,e.length==1&&(m="</tr>"),l===e.length-1&&e.length>1?f.isAfter(t,"day")?(o[2]-=e[l].sessions.total,o[3]-=e[l].sessions.nb-e[l].sessions.nbc,o[4]-=e[l].sessions.pu,o[6]-=e[l].defenses.total,o[7]-=e[l].defenses.nb-e[l].defenses.nbc,o[8]-=e[l].defenses.pu,o[10]-=e[l].coaches.total,o[11]-=e[l].coaches.nb-e[l].coaches.nbc,o[12]-=e[l].coaches.pu,o[14]-=e[l].bonus,o[15]-=p,o[16]-=e[l].kpi.jrs,o[18]-=e[l].kpi.hrs,o[20]-=e[l].kpi.hrsp,n[0]+=`<td>Total(moy)</td><td>${dayjs(e[l].header.dtTo).format("MMMM")}</td></thead></tr>`,n[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",n[2]+=`<td>${o[2]} (${(o[2]/(e.length-1)).toFixed(2)})</td><td>${e[l].sessions.total}</td></tr>`,n[3]+=`<td>${o[3]} (${(o[3]/(e.length-1)).toFixed(2)})</td><td>${e[l].sessions.nb} (${e[l].sessions.nbc})</td></tr>`,n[4]+=`<td> n/a (${(o[4]/(e.length-1)).toFixed(2)})</td><td>${e[l].sessions.pu.toFixed(2)}</td></tr>`,n[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",n[6]+=`<td>${o[6]} (${(o[6]/(e.length-1)).toFixed(2)})</td><td>${e[l].defenses.total}</td></tr>`,n[7]+=`<td>${o[7]} (${(o[7]/(e.length-1)).toFixed(2)})</td><td>${e[l].defenses.nb} (${e[l].defenses.nbc})</td></tr>`,n[8]+=`<td> n/a (${(o[8]/(e.length-1)).toFixed(2)})</td><td>${e[l].defenses.pu.toFixed(2)}</td></tr>`,n[9]+=`<td>&nbsp;</td>${m}`,n[10]+=`<td>${o[10]} (${(o[10]/(e.length-1)).toFixed(2)})</td><td>${e[l].coaches.total}</td></tr>`,n[11]+=`<td>${o[11]} (${(o[11]/(e.length-1)).toFixed(2)})</td><td>${e[l].coaches.nb} (${e[l].coaches.nbc})</td></tr>`,n[12]+=`<td> n/a (${(o[12]/(e.length-1)).toFixed(2)})</td><td>${e[l].coaches.pu.toFixed(2)}</td></tr>`,n[13]+="<td>&nbsp;</td></tr>",n[14]+=`<td>${o[14]} (${(o[14]/(e.length-1)).toFixed(2)})</td><td>${e[l].bonus}</td></tr>`,n[15]+=`<td>${o[15]} (${(o[15]/(e.length-1)).toFixed(2)})</td><td>${p}</td></tr>`,n[16]+="<td>&nbsp;</td></tr>",n[17]+=`<td>${o[16]} (${(o[16]/(e.length-1)).toFixed(2)})</td><td>${e[l].kpi.jrs}</td></tr>`,n[18]+=`<td> n/a (${(o[15]/o[16]).toFixed(2)})</td><td>${(p/e[l].kpi.jrs).toFixed(2)}</td></tr>`,n[19]+=`<td>${o[18]} (${(o[18]/(e.length-1)).toFixed(2)})</td><td>${e[l].kpi.hrs.toFixed(2)}</td></tr>`,n[20]+=`<td> n/a  (${(o[15]/o[18]).toFixed(2)})</td><td>${(p/e[l].kpi.hrs).toFixed(2)}</td></tr>`,n[21]+=`<td>${o[20].toFixed(2)} (${(o[20]/(e.length-1)).toFixed(2)})</td><td>${e[l].kpi.hrsp.toFixed(2)}</td></tr>`,n[22]+=`<td> n/a  (${(o[15]/o[20]).toFixed(2)})</td><td>${(p/e[l].kpi.hrsp).toFixed(2)}</td></tr>`):(n[0]+=`<td>${dayjs(e[l].header.dtTo).format("MMMM")}</td><td>Tot.</td></thead></tr>`,n[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",n[2]+=`<td>${e[l].sessions.total}</td><td>${o[2]} (${(o[2]/e.length).toFixed(2)})</td></tr>`,n[3]+=`<td>${e[l].sessions.nb} (${e[l].sessions.nbc})</td><td>${o[3]} (${(o[3]/e.length).toFixed(2)})</td></tr>`,n[4]+=`<td>${e[l].sessions.pu.toFixed(2)}</td><td> n/a (${(o[4]/e.length).toFixed(2)})</td></tr>`,n[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",n[6]+=`<td>${e[l].defenses.total}</td><td>${o[6]} (${(o[6]/e.length).toFixed(2)})</td></tr>`,n[7]+=`<td>${e[l].defenses.nb} (${e[l].defenses.nbc})</td><td>${o[7]} (${(o[7]/e.length).toFixed(2)})</td></tr>`,n[8]+=`<td>${e[l].defenses.pu.toFixed(2)}</td><td> n/a (${(o[8]/e.length).toFixed(2)})</td></tr>`,n[9]+=`<td>&nbsp;</td>${m}`,n[10]+=`<td>${e[l].coaches.total}</td><td>${o[10]} (${(o[10]/e.length).toFixed(2)})</td></tr>`,n[11]+=`<td>${e[l].coaches.nb} (${e[l].coaches.nbc})</td><td>${o[11]} (${(o[11]/e.length).toFixed(2)})</td></tr>`,n[12]+=`<td>${e[l].coaches.pu.toFixed(2)}</td><td> n/a (${(o[12]/e.length).toFixed(2)})</td></tr>`,n[13]+="<td>&nbsp;</td></tr>",n[14]+=`<td>${e[l].bonus}</td><td>${o[14]} (${(o[14]/e.length).toFixed(2)})</td></tr>`,n[15]+=`<td>${p}</td><td>${o[15]} (${(o[15]/e.length).toFixed(2)})</td></tr>`,n[16]+="<td>&nbsp;</td></tr>",n[17]+=`<td>${e[l].kpi.jrs}</td><td>${o[16]} (${(o[16]/e.length).toFixed(2)})</td></tr>`,n[18]+=`<td>${(p/e[l].kpi.jrs).toFixed(2)}</td><td> n/a (${(o[15]/o[16]).toFixed(2)})</td></tr>`,n[19]+=`<td>${e[l].kpi.hrs.toFixed(2)}</td><td>${o[18]} (${(o[18]/e.length).toFixed(2)})</td></tr>`,n[20]+=`<td>${(p/e[l].kpi.hrs).toFixed(2)}</td><td> n/a  (${(o[15]/o[18]).toFixed(2)})</td></tr>`,n[21]+=`<td>${e[l].kpi.hrsp.toFixed(2)}</td><td>${o[20].toFixed(2)} (${(o[20]/e.length).toFixed(2)})</td></tr>`,n[22]+=`<td>${(p/e[l].kpi.hrsp).toFixed(2)}</td><td> n/a  (${(o[15]/o[20]).toFixed(2)})</td></tr>`):(n[0]+=`<td>${dayjs(e[l].header.dtTo).format("MMMM")}</td>${m}`,n[1]+=`<td>&nbsp;</td>${m}`,n[2]+=`<td>${e[l].sessions.total}</td>${m}`,n[3]+=`<td>${e[l].sessions.nb} (${e[l].sessions.nbc})</td>${m}`,n[4]+=`<td>${e[l].sessions.pu.toFixed(2)}</td>${m}`,n[5]+=`<td>&nbsp;</td>${m}`,n[6]+=`<td>${e[l].defenses.total}</td>${m}`,n[7]+=`<td>${e[l].defenses.nb} (${e[l].defenses.nbc})</td>${m}`,n[8]+=`<td>${e[l].defenses.pu.toFixed(2)}</td>${m}`,n[9]+=`<td>&nbsp;</td>${m}`,n[10]+=`<td>${e[l].coaches.total}</td>${m}`,n[11]+=`<td>${e[l].coaches.nb} (${e[l].coaches.nbc})</td>${m}`,n[12]+=`<td>${e[l].coaches.pu.toFixed(2)}</td>${m}`,n[13]+=`<td>&nbsp;</td>${m}`,n[14]+=`<td>${e[l].bonus}</td>${m}`,n[15]+=`<td>${p}</td>${m}`,n[16]+=`<td>&nbsp;</td>${m}`,n[17]+=`<td>${e[l].kpi.jrs}</td>${m}`,n[18]+=`<td>${(p/e[l].kpi.jrs).toFixed(2)}</td>${m}`,n[19]+=`<td>${e[l].kpi.hrs.toFixed(2)}</td>${m}`,n[20]+=`<td>${(p/e[l].kpi.hrs).toFixed(2)}</td>${m}`,n[21]+=`<td>${e[l].kpi.hrsp.toFixed(2)}</td>${m}`,n[22]+=`<td>${(p/e[l].kpi.hrsp).toFixed(2)}</td>${m}`),c=c.add(1,"month"),f=c.endOf("month")}s="<table>"+n.join(" ")+`</tbody><tfoot><tr><td colspan=${e.length+1}>la valeur entre parenth\xE8se fait reference aux annul\xE9s</td></tr></tfoot></table>`,Swal.fire({title:`<strong>Statistiques du ${d.format("DD/MM/YYYY")} au ${t.format("DD/MM/YYYY")}</strong>`,icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:p=>{}})};var Ue=class{},qt=Ue;G(qt,"init",function(){console.log("%cin initUI",B),Ue.build();var t=new Draggabilly(".draggable",{handle:".handle"})}),G(qt,"build",function(){console.log("%c in buildUI","background-color:green;color:white"),GM_addStyle(`
.flow > * + * {
  margin-top: var(--flow-space, 1em);
}
		`),GM_addStyle(".panel {/* because of stacking context : https://stackoverflow.com/questions/5218927/z-index-not-working-with-fixed-positioning */position: relative;z-index: 666; /*seems that 4 is good*/}"),GM_addStyle(".menuBar {padding:7px;/*for handler*/font-size: 1rem; pointer-events: inherit;}"),GM_addStyle(".draggable {background: transparent;border-radius: 10px;padding: 20px;}"),GM_addStyle(".draggable.is-pointer-down {background: #09F;}"),GM_addStyle(".draggable.is-dragging { opacity: 0.7; }"),GM_addStyle(".handle {background: #555;background: hsla(0, 0%, 0%, 0.4);width: 20px;height: 20px; border-radius: 10px; position: relative; top:10px; left:-10px;}"),GM_addStyle(`
.menuBar{
/*Smol Responsive CSS Grid*/
--min: 15ch;
--gap: 1rem;
display: grid;
grid-gap: var(--gap);
/* min() with 100% prevents overflow
in extra narrow spaces */
grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--min)), 1fr)); /* 20 px is size of handle*/ 
}
		`);var t=document.createElement("div"),e=document.createElement("div");e.classList.add("handle"),t.appendChild(e),t.classList.add("panel","draggable"),document.body.insertAdjacentElement("beforeend",t),t.setAttribute("style",`top:-${document.body.offsetHeight-t.offsetHeight}px`);var s=document.createElement("div");s.classList.add("menuBar"),t.appendChild(s),Ue.addButton("collectChecked",dr,{},s),Ue.addButton("CollectAuto",ar,{},s),Ue.addButton("showBill",fr,{},s),Ue.addButton("billInDetails",sr,{},s),Ue.addButton("PDF",ur,{},s),Ue.addButton("SList",we.showList,{},s),Ue.addButton("DbgMode",lr,{},s),Ue.addButton("statistics",pr,{},s),Ue.addButton("Database",cr,{},s),Ue.addButton("about",Ut,{},s);let n=document.createElement("div"),o=n.style;n.id="sttPlaceHolder";let c={position:"absolute",bottom:"7%",left:"4%","z-index":999,display:"hidden"};document.body.insertAdjacentElement("beforeend",n),Object.keys(c).forEach(f=>o[f]=c[f])}),G(qt,"addButton",function(t,e,s,n){n=n||document.body,s=s||{position:"absolute",bottom:"7%",left:"4%","z-index":3};let o=document.createElement("button"),c=o.style;return o.classList.add("button--primary","button"),n.appendChild(o),o.innerHTML=t,o.onclick=e,Object.keys(s).forEach(f=>c[f]=s[f]),o});var hn=class{};G(hn,"start",function(t){let e=document.getElementById(t),s=m=>e.style.transform=`translateX(${m}px)`,n=0,o=7,c=m=>{s(n),n+=o,n>100?requestAnimationFrame(f):requestAnimationFrame(c)},f=m=>{s(n),n-=o,n<-100?requestAnimationFrame(c):requestAnimationFrame(f)};return requestAnimationFrame(c)}),G(hn,"stop",function(t){window.cancelAnimationFrame(t)});var mr=qt;var wi="#OCAddonsCfg {background-color: lightblue;} #OCAddonsCfg .reset_holder {float: left; position: relative; bottom: -1em;} #OCAddonsCfg .saveclose_buttons {margin: .7em;}",Ai="height: 16.7em; width: 30em; border: 1px solid; border-radius: 3px; position: fixed; z-index: 999;";var hr={id:"OCAddonsCfg",title:"Configuration du module",fields:{nbHrsAfM:{section:["Statistiques","param\xE8tres"],label:"Nombre de minutes pour une session d'\xE9tudiant auto financ\xE9",title:"Dur\xE9e moyenne d'une session AF (calcul du THM)",labelPos:"left",type:"input",default:30},nbHrsfM:{label:"Nombre de minutes pour une session d'\xE9tudiant financ\xE9",title:"Dur\xE9e moyenne d'une session Financ\xE9e (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsS:{label:"Nombre de minutes pour une session (avant 01/07/2020)",title:"Dur\xE9e moyenne d'une session avant la s\xE9paration auto financ\xE9 | financ\xE9 (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsD:{label:"Nombre de minutes pour une session de soutenance",title:"Dur\xE9e moyenne d'une sessionde soutenance AF (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsC:{label:"Nombre de minutes pour une session de coaching",title:"Dur\xE9e moyenne d'une session de coachine (calcul du THM)",labelPos:"left",type:"input",default:45},maxfetchpg:{section:["Application","optimisation"],label:"Maximum de page recherch\xE9es dans l'historique",labelPos:"left",type:"input",default:1e3},datacachelifetime:{label:"Temps de conservation des donn\xE9es dans le cache (en ms)",labelPos:"left",type:"input",default:12e4},checksessionalreadyexists:{section:["Application","Base de donn\xE9e"],label:"sessions: v\xE9rifier existence avant insertion",labelPos:"left",type:"checkbox",default:!0},sizeofcontentlist:{section:["Interface","th\xE8me"],label:"taille de la police des listes",labelPos:"left",type:"input",default:"1em;"},use_custom_css:{label:"utiliser des styles personnalis\xE9s",labelPos:"left",type:"checkbox",default:!1},custom_css_url:{label:"url de la feuille de style (si plusieurs les s\xE9parer par des virgules)",labelPos:"left",type:"input",default:""},custom_css_data:{label:"code css \xE0 injecter ?",title:"saisir ici le code css \xE0 injecter directement dans la page web g\xE9n\xE9r\xE9e",labelPos:"left",type:"input",default:""},alwaysaddcbox:{section:["Interface","Gadget"],label:"Toujours ajouter les checkbox sur l'interface",labelPos:"left",type:"checkbox",default:!0},hackheaderzindex:{section:["","Hack"],label:"Changer le zindex du bandeau haut",title:"le bandeau haut \xE0 un z-index  (1000) qui le place au dessus de tout ce qui est pr\xE9sent \xE0 l'\xE9cran, ce qui g\xEAne la barre de menu ; activer cette option r\xE9duit ce chiffre \xE0 0",labelPos:"left",type:"checkbox",default:!0},use_student_cache:{section:["Avanc\xE9es",""],label:"Utiliser le cache \xE9tudiant",title:"Lorsque l' application recherche si un \xE9tudiant est pr\xE9sent on utilise un cache pour \xE9viter de passer trop de temps dans les requ\xEAtes, d\xE9sactiver le cache permettra de toujours faire une requete en base ",labelPos:"left",type:"checkbox",default:!0},support:{section:["","Support"],label:"StephaneTy-Pro.github.io",title:"more info on https://github.com/StephaneTy-Pro",type:"button",click:()=>{GM_openInTab("https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon",{active:!0,insert:!0,setParent:!0})}}},css:wi,events:{save:function(){GM_config.close()}}},gn=function(){GM_config.open(),OCAddonsCfg.style=Ai};var yn=class{};G(yn,"longTaskTiming",function(){if(window.self===window.top){console.log("LongTasks: Initializing");var t=new window.PerformanceObserver(function(e){for(var s=e.getEntries(),n=0;n<s.length;n++)console.log("LongTasks: ",s[n].name,s[n].duration,s[n].attribution.length,s[n].attribution.length>0?s[n].attribution[0].containerType:null,s[n].attribution.length>0?s[n].attribution[0].containerName:null,s[n].attribution.length>0?s[n].attribution[0].containerSrc:null,s[n].attribution.length>0?s[n].attribution[0].containerId:null,s[n])});typeof window.PerformanceLongTaskTiming!="undefined"?console.log("LongTasks: Appears to be supported"):console.log("LongTasks: Not supported");try{t.observe({entryTypes:["longtask"]})}catch(e){console.log("LongTasks: Not supported")}}}),G(yn,"paintTiming",function(){if(window.self===window.top){console.log("PaintTiming: Initializing");var t=new window.PerformanceObserver(function(e){for(var s=e.getEntries(),n=0;n<s.length;n++)console.log("PaintTiming: ",s[n].name,s[n].startTime)});if(typeof window.PerformancePaintTiming!="undefined")console.log("PaintTiming: Appears to be supported");else{console.log("PaintTiming: Not supported");return}try{t.observe({entryTypes:["paint"],buffered:!0})}catch(e){console.log("PaintTiming: Not supported")}}});var bn=function(d,t,e,s,n,o,c){o=t.createElement(e),c=t.getElementsByTagName(e)[0],o.appendChild(t.createTextNode(s.text)),o.onload=n(s),c?c.parentNode.insertBefore(o,c):t.head.appendChild(o)};var Si=function(d,t){if(!arguments.length)return Promise.reject(new ReferenceError("Failed to execute 'fetchInject': 1 argument required but only 0 present."));if(arguments[0]&&arguments[0].constructor!==Array)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 1 must be of type 'Array'."));if(arguments[1]&&arguments[1].constructor!==Promise)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 2 must be of type 'Promise'."));let e=[],s=t?[].concat(t):[],n=[];return d.forEach(o=>s.push(window.fetch(o).then(c=>[c.clone().text(),c.blob()]).then(c=>Promise.all(c).then(f=>{e.push({text:f[0],blob:f[1]})})))),Promise.all(s).then(()=>(e.forEach(o=>{n.push({then:c=>{o.blob.type.includes("text/css")?bn(window,document,"style",o,c):bn(window,document,"script",o,c)}})}),Promise.all(n)))},Ct=Si;var Za=function(d,t,e){"use strict";if(!d.MutationObserver||typeof HTMLElement=="undefined")return;var s=0,n=function(){var y=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(x,S){return x instanceof HTMLElement&&y.call(x,S)},addMethod:function(x,S,O){var T=x[S];x[S]=function(){if(O.length==arguments.length)return O.apply(this,arguments);if(typeof T=="function")return T.apply(this,arguments)}},callCallbacks:function(x,S){S&&S.options.onceOnly&&S.firedElems.length==1&&(x=[x[0]]);for(var O=0,T;T=x[O];O++)T&&T.callback&&T.callback.call(T.elem,T.elem);S&&S.options.onceOnly&&S.firedElems.length==1&&S.me.unbindEventWithSelectorAndCallback.call(S.target,S.selector,S.callback)},checkChildNodesRecursively:function(x,S,O,T){for(var D=0,v;v=x[D];D++)O(v,S,T)&&T.push({callback:S.callback,elem:v}),v.childNodes.length>0&&n.checkChildNodesRecursively(v.childNodes,S,O,T)},mergeArrays:function(x,S){var O={},T;for(T in x)x.hasOwnProperty(T)&&(O[T]=x[T]);for(T in S)S.hasOwnProperty(T)&&(O[T]=S[T]);return O},toElementsArray:function(x){return typeof x!="undefined"&&(typeof x.length!="number"||x===d)&&(x=[x]),x}}}(),o=function(){var y=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return y.prototype.addEvent=function(x,S,O,T){var D={target:x,selector:S,options:O,callback:T,firedElems:[]};return this._beforeAdding&&this._beforeAdding(D),this._eventsBucket.push(D),D},y.prototype.removeEvent=function(x){for(var S=this._eventsBucket.length-1,O;O=this._eventsBucket[S];S--)if(x(O)){this._beforeRemoving&&this._beforeRemoving(O);var T=this._eventsBucket.splice(S,1);T&&T.length&&(T[0].callback=null)}},y.prototype.beforeAdding=function(x){this._beforeAdding=x},y.prototype.beforeRemoving=function(x){this._beforeRemoving=x},y}(),c=function(y,x){var S=new o,O=this,T={fireOnAttributesModification:!1};return S.beforeAdding(function(D){var v=D.target,w;(v===d.document||v===d)&&(v=document.getElementsByTagName("html")[0]),w=new MutationObserver(function(u){x.call(this,u,D)});var b=y(D.options);w.observe(v,b),D.observer=w,D.me=O}),S.beforeRemoving(function(D){D.observer.disconnect()}),this.bindEvent=function(D,v,w){v=n.mergeArrays(T,v);for(var b=n.toElementsArray(this),u=0;u<b.length;u++)S.addEvent(b[u],D,v,w)},this.unbindEvent=function(){var D=n.toElementsArray(this);S.removeEvent(function(v){for(var w=0;w<D.length;w++)if(this===e||v.target===D[w])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(D){var v=n.toElementsArray(this),w=D,b;typeof D=="function"?b=function(u){for(var C=0;C<v.length;C++)if((this===e||u.target===v[C])&&u.callback===w)return!0;return!1}:b=function(u){for(var C=0;C<v.length;C++)if((this===e||u.target===v[C])&&u.selector===D)return!0;return!1},S.removeEvent(b)},this.unbindEventWithSelectorAndCallback=function(D,v){var w=n.toElementsArray(this);S.removeEvent(function(b){for(var u=0;u<w.length;u++)if((this===e||b.target===w[u])&&b.selector===D&&b.callback===v)return!0;return!1})},this},f=function(){var y={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function x(D){var v={attributes:!1,childList:!0,subtree:!0};return D.fireOnAttributesModification&&(v.attributes=!0),v}function S(D,v){D.forEach(function(w){var b=w.addedNodes,u=w.target,C=[],g;b!==null&&b.length>0?n.checkChildNodesRecursively(b,v,O,C):w.type==="attributes"&&O(u,v,C)&&C.push({callback:v.callback,elem:u}),n.callCallbacks(C,v)})}function O(D,v,w){return n.matchesSelector(D,v.selector)&&(D._id===e&&(D._id=s++),v.firedElems.indexOf(D._id)==-1)?(v.firedElems.push(D._id),!0):!1}l=new c(x,S);var T=l.bindEvent;return l.bindEvent=function(D,v,w){typeof w=="undefined"?(w=v,v=y):v=n.mergeArrays(y,v);var b=n.toElementsArray(this);if(v.existing){for(var u=[],C=0;C<b.length;C++)for(var g=b[C].querySelectorAll(D),M=0;M<g.length;M++)u.push({callback:w,elem:g[M]});if(v.onceOnly&&u.length)return w.call(u[0].elem,u[0].elem);setTimeout(n.callCallbacks,1,u)}T.call(this,D,v,w)},l},m=function(){var y={};function x(){var D={childList:!0,subtree:!0};return D}function S(D,v){D.forEach(function(w){var b=w.removedNodes,u=[];b!==null&&b.length>0&&n.checkChildNodesRecursively(b,v,O,u),n.callCallbacks(u,v)})}function O(D,v){return n.matchesSelector(D,v.selector)}p=new c(x,S);var T=p.bindEvent;return p.bindEvent=function(D,v,w){typeof w=="undefined"?(w=v,v=y):v=n.mergeArrays(y,v),T.call(this,D,v,w)},p},l=new f,p=new m;function a(y,x,S){n.addMethod(x,S,y.unbindEvent),n.addMethod(x,S,y.unbindEventWithSelectorOrCallback),n.addMethod(x,S,y.unbindEventWithSelectorAndCallback)}function A(y){y.arrive=l.bindEvent,a(l,y,"unbindArrive"),y.leave=p.bindEvent,a(p,y,"unbindLeave")}t&&A(t.fn),A(HTMLElement.prototype),A(NodeList.prototype),A(HTMLCollection.prototype),A(HTMLDocument.prototype),A(Window.prototype);var E={};return a(l,E,"unbindAllArrive"),a(p,E,"unbindAllLeave"),E}(window,typeof jQuery=="undefined"?null:jQuery,void 0);var gr={data:"DwCwLgtgNgfAUKApgQwCb2BRZkAIDGIyATgM7YC8ARAK5gBmAtABxUYCEjjuADgPY1iARxp8AlrjEA7fFEGJcURKUViARitSIaAD1z1xKgPy5GMXgOIWaAN3FWlKgFYDEVxFNwQ+W3KRxSqMhQfFIKXBik+MRiPGB+xPjU4GA8pABcAPSZ+KhSAHROpFpQYjbE+WFgmVI8EJmkAO6I2MFuYABMAAIAjAAMbMAN0bFgkSNxCUlUKWlZmTS1ANYA5vn4fPVBAJ5FvfnM+R09mTtF+RDShaRUuFr0brgwQ1ExcRxcuNZWAJIAoj0eqYzAhXqMpskwKkMtlcgUiiUyhUqpkViBMsEeNJEEUMVAsWEujYOvkdKTTmJ-HiCYhGGJEIDrrd7m5nsM3mMEJxuPxBIplLhkHRiAKpMgbGIVsgwNoyMDxhyITMoXNYXlrojypVsKj0Zjsbj9YTiaTyahKdUjYgmWywe84KCwNslPA1D5trgAN5wL4GKRgRj0ZCXKDbdK4KgAeR4HlwAGVkFIbgAaUzIHg8JSMUjbfyICCpgBCpSkSwAssh8HHczKIAAxUJgVNUOOIFZ8BQAVR+VFTACU+G6wHxU5GdNsVh5GAmk6nO2pFmAaKmAMKJnAiqBQZsACUQUBs2DE+DwADltIhe7g9wejyfUwBBGLBVOkROkbNuMT0ADcuDgAC+CANE6LrASAKDoA6wBuqg2zwAg5o2AQUDIKQpDULWmbSpeGAUjYCGghMnJwI00ioHwjT5CyxAADJ8Gg0grA++LYrgFD6Is+BgGIoS4AAFCeW5qJWSwAJRenAACQUkbEmfBKPkIQrPxVA0YoDHmlIKxUGJP4+l8hlfGRgSUfkaCoH8h7+rRFoeG4-EAORNMEjmpvQXE8Xx-GIBJ3pGUZsmhKQCnWspqmINZ8TOY0rm4CK+CIGUiCoKmFEEMEUAifgSy6fpAWGUF8mKeFvn5QVAVCVlon8XpBkFQBdUVQQwWhUpfAqY5kUePE5BgI5TWGQB+lySFJUdapNH0Yx2ksTSfjYDKqB5XAHkyF5niTmAnbEFAABqJCkLVklGTYJC4GdcocZ6w31Rd508CQYAqBxJkUVRIQnht+QgCK9D5CK2GJfxmQANpGAAZAAugA1PxoMAHoUNDMNiRQ8MI9DABUYmomI7mebxUj8QWSyINsyZnXIvknRVl2kKDZPbFD7H3dT5VfI1HPxdggiePT+lAathN8VtO1QAACiQwb8Y9xDBtgbhpYgQY0FAYBUzQvn+YZl24II+LS1gMpWBx9xCurmuINz378W9ZmfdKRM-X9+TkYgOiRvQstG4rxASeYjA9GJOsFQbcsKybrNi7tB1kLVoMR8bbhQ9zRlAUZIpLsQnjh77JuCw6esURAfaQR6HFrdxRMCX50lZ3zuBhI0uAS8QmyUog-EimNh7seY3oyd+AkUfgNBYP6APl3GOAyuxHFUCEM06XXMlSaP489eZqCWVFtl5mExCqQAIpGZYro2PXTVoy2pj3CmHmJ0lSQBuD7uQklr-ft61fpMlAS-J+t04D8TQtsGQx0KAD2kqNNq4UqAAFJ8D5HyP4J6V4qAbBCMQdIGx5ZQBWlJZAsUxDxBLmXNA2xf4wNauNFSiDch8HwJIFQIpKEYKwXwHBeDgiEP4DwGgPBqFFTGmFCaDCUH5A8LfCMnDuFcN4XVKSgExLULgJkLGPosb6x4qUJ0nF1o1xoOQVAkhTFnBUJSRy-p9YmK0f+XA2ivgNxzgQQQIobFBBlKmR6O8Uq4DImAEAuA+iSHoE3FoN8tGZDgHrLaAAVCCx8cLsSrhtY6g80k118fxUgfkebZ08Lk3AwBcD9AkiYRyfRHK4Bhn4XA4ZSB-gAcXVmzdcDJJlLVeuvNXGg1QPkLadY1ZQAAJooCPhJHxaB+IDK2mWRsIBaow2DtM1AszBnYE6V3MSYkoaFHEMTRyjABqASLg9PgAieCszATIAx1dQi1UHsPfiToYx8HCXGWKUBcDsAoBxRyWTQgDUHiItqbh25HwYT8YgCU+CHnlmoJQb9YVcIwdlVY7dFioEYHI9IIpUp4qRaJQhUkXFSD-i-aS2RgR3AAJf0GkKQmuWgVD7nzD1FQGwIAQEWKQalORgq9RlGkVmoNHI9DcrgRyHQpWOQAMyOShtJJQwrECio4uKyVyYZVKpoUmXq3yACKWstYz3VazL5wQLhiB0NIfioKAD6WE44ZCbiM5MBkZJyUZcQCAhY6DDikPEj2YBwyOTjDQMo65cAQ3lrCn8bkvWyUTIlKAAaoShBDToMN0q250vwHSrQNiIaoQTUmr4MkeDtxWD3Ug5q5h+BFaQT1layXdTIIgDNQa3VgGIFrVtuAZJUzEF4omZZlBvknOGlcChCDBlFcoeIIoRBWM9TJc0qBoweHDECop3gghQFXmvWBdDVKSKtVAdIm7t1SFJTJe2VFzSkEemAQgVker8WfmvdpK5jHDggB+-0TkXJQCld+mSnpcALjUEi5Q4Y+0DruK0MQV6vS4BlDm8MUYADS+RbivwAWvKST9iNKJfqmZ+ZEty3t3SLYm2tv2nrEfQi93z0jUagLe0lAF13r1HWXQIbg6OGO8ge4IIcIPMfaqxtjwRr0CekW4e9UlH3UUpK+99UV+K-v-ZsIDYAQPfKlVBmDcHe39sQMrHAqHwxQcw7myB5gHMkBQPkK2uBCO7OfrxqjqGoArhCOQETDzibiaPaC71tCWPnskfkS9HH-OBb4OQHjfHN3JeC-c9J4XJPEek-AuLKCEsZaC5ecjvmN2juPku9uYZstExJj4CTkWwVnqoEV4r7HN01f8HVtLz9pJc2kvq-wbMtYvVwKDVOKrsBuNhT1Btf9RvxEemEKAjrGggFCpGYgrYlDcVZqCniYBkVSXDSahQdg1aIAAF4XQECoN8tg2wkC0MQJNMlwDQCMuGAABs-YAShJyBBgCubblJKTkHu2BulMpAhayGMD6R8AZLAEZfuVAfVUdSWAEhFCaEMJUAMH62to62CA+kAI+Io7qCEHEIlW4YosB04h4zjD2wYzJFHcW24VtqBSBGYMbkRBAjIoXJmzwshjxLAIGz8IIIZLxIEPED2-BiAmxgoGvitOqDvmaMQHozJpTIEYJWDa1A1dcLAI6zKtxZCE+oKBjo2ZQIpVuG8xA1AJdBrYJGHDQwfehBx3GOlUAC0bUPvyFQOBzNa8l2Y6g+u3AdGNzgM3oXLc6HVzb0Il4CfoSd98l3-hnTu451zqgQe70wH94H7XUgcdDAx1ALH2Am+ohiFBGSf2+PVsQBfKQvqIAhfScgVMahkz4GTKlGmn8ovFRi+Pyf0-Z-kakqq3Azr8w8Fdd+vtHpWvb4gLvw6rMABScZIynnyHLcgsymGb0niINw2x9uIG4lwpyoNmde8wfLqgKGAadzYILWdfKSWEaLGTVSENE-dIK8Y-U-MgdfV+L6QgHyY9GSSAxfaAv7JBP4HQRKOIGuAAEk9EQAAl72lTxR4SgB-AxVrQEECFxQUi4XxRSgGkpRkkvVQW20aAOlKDHVCAnXQmQEnH4j+wnUSAkF8Hp0hysEWAUFZWQ10FwEuQ2lID+3APJX0GCHIC4KIzaxi0v2v1v0Oi7g3gnjAHyBf2IDf3ZU-yPkch-wVlZwZ0vCALEhAOpl2S4OyFtk9w+S3xdTP3+QBWxRVmxFQBqQAB8Yjgid9XV54OJBctw8sh5vYEiT8kiwj3U0jWseDSA+CBDR0nZhDJ0xCu5JC3B8AZC50IdSAxAFCwhkNNBtA9B1CiZNDtDelPAgwoB9Dv1X5v1sDRFcCkFYCkCWFcAyDEDXVKDkxMFWD5F8F70dDPQ8weB0gehUwrZ0g5jDohZ-4+MNFn4nArtkBKRkM7AmjeAnpbjSA+RFDkMZRQs7hHI6VrIOUbE5smhSFCBHhHiHBHJFg1CaBFBHIhQ+0lCBR2UrC2jFA8AX8tY34+jQhQsziFAYxVCtBXio5UIWoDU7j1tNttslBdt39uJUxzivAupPByANc7h0TvheB25HpJwHAFBiA6VHj1ZpRcBJFcAABzvAFov0ULFox6FQZ+LGGJB9fzWjBrbyfcTAgrcROTK9Tjbjdfb9fcGwrWOwyk4cJw-IEnCAMnaIrwiyAzfeeHByRyaXHKKVR1UXVAJQU2JUhjSTKTKA8KPA-AAzXAeJEgLacMMg60DcLaBYpY7BXBBRAhcAn0okq3DXFiDbc3GuSuejHyGwMAdIteW2SKawyM7AC4aUAEo6RyavfpE3DPC3KgFMm3O3Tw-Mk9X0iaf0ggnPXAB8WiWiOXdw3vGMtg2glTLAzINbfcUknbPbBw6wg4q6aVRs23LcRyP8GlDYNWPIRyeIYxBQUhCDGSIs9YdxHqYM4gLafU1-I0r-Zw3-Nw48Dw4AjzDiEwm-PrJib8KhT0PYhs7Pa3FcghRqQ8iA04RABcFYDkrgmSIdHgx0pYQfYfYRYjIdQwmSclaC26fLIVN+f8jXSMMIW3N4rM0TBjXM1sqSQs3M-IEs6ww8iAcsiCSs6srxU3DM0ILPHPR1PPQAgaCi0CycjbLbGco0-IBcybLqPC3PMINc3ADcgQVvKQHc2xfcsAEC48seBbf0c8y82w+wg7Y07-e8--dw3irwl83AN81BPtT8+gb8385cni4C4jKSIdNUlSf0n4JMdoQUJtC1fk-gRojaBpGYz0HgraS7M1EVZZHoaMmg+Msc2C75N2byjXSKxABtH2EkrbaUZXBMQ8ZMcK7AdKzKsSFZUjFyzY0gVBTMR8-iIqsAEq6KsqnYkJVMCVNQTgkCng6QBkxq01DK6KwSx1M06UQq5KiKga0qmGDoCq4jKqmq0oYGBqpq9VZZDoVMPodqnofALqlyoybITfR1NQMATwDiBqxCpo-1BvZCteIdbIY6069YJapYW6mCqSOCl6y6v1N6l+f8YjDCiDLCteDRQUN40hRxOUteRstMoi9JMqCDRsgixAOGxrBGteYbf+IbB0ERVbRMKcnKsAPK8UBQa6Z+E7M7C7FE67JQe7a7J7IUQ8KUYgd7T7KSb7KAc7XAAHNePHMoZNKSHQRgVi6gUOIdGSWPRwOzO6NtKSHoOzMxcMfoVMMAJFdIZyJcYtZ6KVBzcNP4TWsQdcUgGpXzAqNeDoBW0dcMDoLajDNW5ySdLonW0NcNVsdCJ2zzQdQKGSeVS21AcMeVW21Wq9DWmgLW0gF0i0LhbYZ2rDaVHcKOmIF-FQOHMOw2-0Y2z2mW8WqSAAFj9vDFzqDvtpAETu2EdXIHdtCEdRPABNjtzUcgrGEBRPZIUErsaOChNq9sKhkgAFYC7cBe7i6Q7jZkB67w1j5QgpA6UWgVB0xaqvpkpM7Tae6qVZaAIqBv0cdcc1Z4BZbgBuQeYxsgisJUI54Ig7pebT6cJs614haSdqBQZR1djQDEAWZpBcBIw1BzjuIpF-QYhlBXlkBzMxJN6zaZJ0gmZqBydL6ZI96ApebSh4Hva0cqc6AK8-8ASco3QdBbh0hdcrY3ZloGljLCHg6+dX7qAKdwG0dUI1B9wGkH6qBCHydcAhaHNqAyHQ1BhMg6H9xkHV6kcxABHebMhr6ZRt7ccFhYBv0hgkIcde9n5+9vqR9a5+559QLBQY8IIRRpi8AsGlgcGAlSFgkpA+AzFJAvB-19BUMo4ddTFhw+AmMcLuLLUJrsAJZLlBFaorzDS5yuE0zv9PcKADGcGoYn7UBPCuDN8JAOJuKlIPAVgglUxbdYU2lEAW4nx5YqExA9J-qZISd+I-wxAuA-xUniAn6WZrorbuLKmiHUxf99i+A6nf8p8IIcoUomm6mDGUpMb0Lej0NNj0gNrxtEBwxymiMAEsLRo8aSSvFSb58KbEAuaqBLstwBR5mUxn4OauaebcdS8wIsDtEhJpEAGrA0B0wwA6VkNcBZgYRBVsFSg1B1hNhMhsB8BMgRQVgzSHmuEnnGAvmzTGAOhe7MhbmVR7m5EnmXmthKIpAl5UBMgegABOVFsF2U5+DRPhqAaiHCdIdIZAegKOT0OSeHXNKgAAHUQGYHlQADYqAfxArmVQhwxNwnZDwfwlAiXC6+geAdAfxhwtjB6+WfwAIMWCmuEIAvRn1sJ6sLTGWLImIlb8x6DRJGDsVwwABiegZFnVnV+grhd7JWvlvwBSUdXATV-AHa61n8Bii86Qa2kUKVqE8x0JF1215AIWsiVAIJcMWlvoXl-l3xLSFYZViAUV5+M0yQWodBz0BgrFQILV+gZNg1lm4TMpE1sac1zV5F-AXN3NiNiVv1aDBvL0eNpg-21QNEMAWtcmBVneJVkJfIAAdhVe9d9bKQDYQVTaNZCULakijer3SG2wRTLbVYTcrfbFb37ajexa9GDcbb6HyF7vzCbZXalaXfXb7aIyjbQfiE9AXe0nDCXdbfDbtZWGkEYCHAA2PeXadZnclejep3SAMDHhUE9BVxLDGdwHlUzbNdMSndQH7a6CwHNDwBJkvfbZAB5cDb8lNMldtx3j4k9AtMYHEdpCwXHiTGtoDZNZ6HoGIB-FQ6lCFZ6FpZFdfng79UQ4ok8Dnc9AczN1KBWCkFZclHACI67xYLkAgFY7KTktwA6FFYFLNJo51xjabBE4Q4sj4mry9FQ8w94+toE-lVFaIxeDdyb13dQGoD7AfAAC17dUJC9idpOkO70wb6yKdUGJOMHWcP9DG+BcHE8q8jS082LM8qA+oK65yjB7d2myZu9cc52mH8A1AjTdtTw+AwA2BQ8DKiYo9nieA6UYgfAFAjAkdgH+HAcQuuFqAfW6x24IAjPHc1IcI2BtkbnUA6UJdMv6GZGbPqcXOCuiuPdOc-95nbgGKdBqAbbA6g4Xd5UjcvBpBeu+h+gBvGAhv3O6yiYndsBHV5mRrWu7hazUJtIaBKiKBAUPsm9cviB8uia+ASuTPOuYBKvfBGUpA6vsvGv0HdcfXlc2vK9OuvBPWxv+uehBvhvLgpAxuJuvupvhvWLZuOKvOFulvhwZv1uVhNvJxtuCPHIO8zSm8X1EwYAouZRwxkVGV1ZdGgTETVu54WjShLg54X9o8Foq6kwClLBp7lAXg1sFG+8RQVHwwnMNHv01BzwUpKuzZH8rDNkwA-glArDCxtgfh1kqyjTgCemgPv0WvNhWZLCt4toRfviwBxfJenJFeIBnzX6uDHvzH+ex5Be1fReeotepfdf9f2Zv1v1bZufIk+f-kMNLNY0IYBI7gwBCulfciqBbg4jvfldkiIxdJcBWzCjijghSiNoRCp0qipDaibnSAw8P9I9Hhnj5mwT6UNgASYd9G0IYS-A0-QstDoKdD+jBiMb8nlEv4BnWshn5VKNiM9jQZDyVfJ5zeNerenJwu5zZeAuUo+M15O-rDu+xeJfrefeivgDn1gGlBTFcjEN0u8iflwwx+hf1fJ-tfHIbfzLX6R+N0BfVfsBt-Lep+deju5-KQF--Fl-3eTBUj1+mTTfT-heLf-Re+9-r+D-qYINlUGNSlJVn4xboYwfHHyEenUZi1AoepPSjeRNKicZOSlK0jvBtJ2RD4TkedNpEQDOlXS7pVmHugwIwCKouNBaGAG2S+8IAqNPiCRVCw5k8yrWSit7GPK0Uyyb6Jit-hB7sU-u4PG3EtwI6bAzKFFTfBYlZh1hzcggekBUCebVUru6yY3uYD4BEN540qCxHtWIy2wxBuRCIldxSj8V3KqkJBD8D7B9g-gK4SMHtD+B6dCwtEP4LgGsF9hIwfYXAKeD+B-Bj4PZFcCuD+Bxg4wQZSMPGDPj2CHwEsCWLRB+ArgHw8SH4NflwB7QHwfYOML2BApVlx2FbbjmwQJR-giUqEHKImhArgF+mhSaClShcraDVuuwaqnEGIAd8T+XfM-p-016X8f+yuW3iiQ4ggULED+N-g0I-498Wh+-bwmARAp-0t03sRyN4H9AgBgCo1QzFQFGSLDRkjAMsGWEYDHxj4Y5KSOQCgD-RxKYqT0IINUab8J+F-XfkMKtgq0+A16eoeP0aEDDzhv-YYRQUAEoU0K7aEoUDWgpJkxsfUB8HBjypzk+enpBgRRSorFkQypZBihwMAbOFuBnnbzjsPT5+cWyTAoyEdTUDK9bhW-Jod-374GVB+DnFKKUPXjYjThX-QYTP02A383wcGJfr8i3xqAuhZI+4Tv2n5tCvC8-OkazHYCMjDyaFYGkc0s41wIa4rNeH1EoFFcaBXpaCn8IBF8AjS2yDAmnAqjDZmoB1QVDgXgRIJQgt6CwFcg4TLE4yqxQaKqO7pGRSsKWb9pAIkhQJaY6ogKHAINL6V0+t5KjtQOQHAEnW8KRAOgIPgOR-8iYScAgVFyt43ApogKJViGx-wZmxJKcnMKOzk1SElNaVGs30CStpQbNHZv9kBxIQBaQtEWlQDFprxJa8Ge0avXlroYranbdyBmLDSOQigwKFWi7WlSNilKWdGhhbSrGVsbatYv1NKHVr4BSANgcetQWHFd1b6MkWBmvRzob0t6sjXegLQPqfAe48QE+jvjPoK4RGaOdDpOMFqBg8uVACJi-Wpjv1PAX9H+tYR6gAMjopYvJGAwQYQMoGVAGBigwEb70kGe43HHuzs7-4HOODPBgQ1fpEM8GpDYCXMIobUwqG74nOsFyy7r8mGLDYhuw1DScNgJDmHhtixgmiNPxKDIYOh0kZDBFxojeRoNh7ws8B8oQYfOz1tHQIQaYLNCBhh0b7k56cuf8U52MZBIm45jc1hIF5RjZcedjTwOa0cY-D4grjc6u4zACeMrkPjeAf42ICBNnCwTUJk53CajoomEGGJqzHiZKBtIyTLfCQA9LtIsmyAHJnkwgyFNimpTQybCkqZHYamzTMQPsmfpNwFYXTZyZUAVhtMiR-tWpp5Ll59NihjcKDEM1zonitY4zIyYYSmbLZthxqKaiKivJax4YSjfGkJTJKIAKSc5PvOlMW44R10UMLwkEg8D8QBIPcNWHmWgHPxRBjqY+CJA-gcQJB3EKQW4HyBLBjOcg8iPxEUFqEVBrvRyPVKL4aCtBdUhqaTVd66Coi+ZQwdClMHmDLB1gh8LYPsGODnBrg9wZ4IfDeDfB-g+JIEKvxlgQhYQiIVEJiFxCEhSQlIWvDSE5R1WzBPFNkJaixliUOUY2t+nXyA0saG6MaUX2V6-TyAt+PtM-BeQVT1YzwzAjSj7TvgzSjwMDIOHOKq5PA5oCUpcRFDfojqKM1mGDOsKEMCUNAYGKAmTA6BaJAkT0JInHxTYyQmxKGOGDJBWxGoqYG6BJChnywkwUbBGenwwzmMUZQaMUHYQEhMx0gmxCKWMythzVN8pAHcJACgDUApSNzbkryVngMsMZc2XXm0g9TB9jea-LgiMTBaNF+QcuBdJoBSRLpUSa-VMASWz5KUzZ8s6tJ3HNnco4giAB3uEn4iLdjwoMeVOEz6BVNXeK-TAuvCpFSspIcTFGV7PCY9AZsxGI3kOjDmezvZoMDoNHLbJaiOySCHng43MZ7kieCgMgrr1fjcB85R3BYrIiNGjkUC9vAspkQ9n4BQYUcj3l8Frn1z9kL5V3n+S4p24Q4clMFg2jKQQYaUOc0uioATH0MTwOciGrFG0YKA88KlUxB-StACQScb8MBC1B4DbA5qZAu8YmJcqVioM1Y5WnbRDr+Aw6nKUcY5H1pp0jaE4lyl2P3k9jh66tduk7WbFx0I0jtTulnRcq+1uxAdR+aHXDqR1-A0dc+QnWAVJ0JsuAVOmBwzo3ziM+dX+bgCLoq0S6ZdHztTxrqVgII58puhT1bpU8O6SYOBWvH7qIKh6KCkeq0HPmT0pA9PAUPPSWrstlAxCmcbLSOr3YOIF49Pn-RsqAM7xLMsFoU14nnjv63C68fSFvF388kIcQwXeIiZFTX4HiG4goGeIQpZQ7xd2HoD-DIpe6b8MbPLL7QCAbAdKLSb8S7LW4qGf4SyV-j1hiAKAjqW7Ak30kgAg4xTGABQD6DWTGAIg34sGTgyngFYOk27JUxbk0UkUpQ2aZxlwo54rwpAPxUoACVYAihpAcxYyRhivkr875GytpC-IOpSxws+JYgESVWZWK16AGdaEbLxIkUyuN8rkkKXFK0owcxpcrjEhBSyh4o6WdAEsUQYpZMs9JX9mAB4AHucLBFrcF+gqx8uJudIA5gnKoRpAP4edJ2jAAUA6ATAZgMmHDIyA0unYPsJEM2D8AwgwGFJVJVaXMgRlmkTigBTIIJIkkOEWqABGuChA2Ay5a5dgESSIAlRrSx5ddwxAwA-s0FbIL0ugD9LgAPAGAFc3DyLLJwVhG5i8s9BmMqIcwpyEsNGSrCNhA0B5W2MdmWBqqkiIYGCv+Vrwhib8AYgoCgw0pmgASRMGKGiXW5fKSIt4ifTv4DzeGFobGcoEqnPCyyQiPQHaIdSJgxADFNDDoEajgEaUnwUsdzNpUa5TF4k27BQGmzQVJZIqR1I2R0nhzk5Vi7CmnJUi1zN5EGNQA2H7FgA3y6qz2bnX2TyCypvU5Qb-lUENiQoKA9YEP1QAGqjV0IlcHGD2hfB45dci1aaW6lqF1GtqwJQNKHEjivCcvCDI73dXShPVe0CioUyOp2LbajqCABQE2KqqpKTipJiAB-COoxAwANNWUzEAwxUYTAowtAUzWNlQYBaoqSSNtjVqpKtagKS6v4pSQHFt+YxEslr4uVPQNTfGCBQ3RTKPAGwLQDsr2Un488wGVAOUqkRSUqlUAZXPGtyQqqa1daryVgEaVUDmlfAXZEf2IyNMm1OeFtfslaZDqpILYh0uOIvXvCZIRQ9pRjSBrRrvYhqusW+UTVf5k1HilJumuPXW4c1QSfNYWuLVb5S15akCoYP-Ua5T1D6xtWuubUbq5e7aztQIiKJlSL1-avyYOpcqj8R1Wy8dbsovhTrDlhmKyh+RyV2VZkc6ypdUr4C1LoNYAU9Zuqsze8d1Ws3ZGJAPU-p3JjG5jeetw1Hk35bYxyLeqHUPr3hAoiDD0s6WyyqAwAXeirOIxJq5sBan9VvilZxNHFek3NSWqLXhswNZanxb1DrCoYiloa7mnCocX8aFYAER1K8qJq3KukXy2YsEo3WhpKCh5IFVAH6WHkgcwjECoMua7nK0AYyv6JMpwDTLQ0syy4hSkWV9QVlDAFgBss9DWaN1rFOcYJvejwsLlVAMgqQFM0JLbNbAVzTZqwAAR+IpW9zTmmcq4bAtvyvzayr+XPr5qsm9JfJukYwAlNWNb2jwV9RdwSBEtZMd+0cimbCA0glQCsDpTT1FZ7ACtI+I5o5jmodfNHPI3y2yaAIcjMoNhKkiKNwGPqK6t2izRXr6Ih4UMHNtgZ9MpmdUV+IZGAh2hOQged0HhA5rwAgAA",method:"decompressFromEncodedURIComponent"};var yr=function(){var d=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function n(c,f){if(!s[c]){s[c]={};for(var m=0;m<c.length;m++)s[c][c.charAt(m)]=m}return s[c][f]}var o={compressToBase64:function(c){if(c==null)return"";var f=o._compress(c,6,function(m){return t.charAt(m)});switch(f.length%4){default:case 0:return f;case 1:return f+"===";case 2:return f+"==";case 3:return f+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:o._decompress(c.length,32,function(f){return n(t,c.charAt(f))})},compressToUTF16:function(c){return c==null?"":o._compress(c,15,function(f){return d(f+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:o._decompress(c.length,16384,function(f){return c.charCodeAt(f)-32})},compressToUint8Array:function(c){for(var f=o.compress(c),m=new Uint8Array(f.length*2),l=0,p=f.length;l<p;l++){var a=f.charCodeAt(l);m[l*2]=a>>>8,m[l*2+1]=a%256}return m},decompressFromUint8Array:function(c){if(c==null)return o.decompress(c);for(var f=new Array(c.length/2),m=0,l=f.length;m<l;m++)f[m]=c[m*2]*256+c[m*2+1];var p=[];return f.forEach(function(a){p.push(d(a))}),o.decompress(p.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":o._compress(c,6,function(f){return e.charAt(f)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),o._decompress(c.length,32,function(f){return n(e,c.charAt(f))}))},compress:function(c){return o._compress(c,16,function(f){return d(f)})},_compress:function(c,f,m){if(c==null)return"";var l,p,a={},A={},E="",y="",x="",S=2,O=3,T=2,D=[],v=0,w=0,b;for(b=0;b<c.length;b+=1)if(E=c.charAt(b),Object.prototype.hasOwnProperty.call(a,E)||(a[E]=O++,A[E]=!0),y=x+E,Object.prototype.hasOwnProperty.call(a,y))x=y;else{if(Object.prototype.hasOwnProperty.call(A,x)){if(x.charCodeAt(0)<256){for(l=0;l<T;l++)v=v<<1,w==f-1?(w=0,D.push(m(v)),v=0):w++;for(p=x.charCodeAt(0),l=0;l<8;l++)v=v<<1|p&1,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=p>>1}else{for(p=1,l=0;l<T;l++)v=v<<1|p,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=0;for(p=x.charCodeAt(0),l=0;l<16;l++)v=v<<1|p&1,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=p>>1}S--,S==0&&(S=Math.pow(2,T),T++),delete A[x]}else for(p=a[x],l=0;l<T;l++)v=v<<1|p&1,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=p>>1;S--,S==0&&(S=Math.pow(2,T),T++),a[y]=O++,x=String(E)}if(x!==""){if(Object.prototype.hasOwnProperty.call(A,x)){if(x.charCodeAt(0)<256){for(l=0;l<T;l++)v=v<<1,w==f-1?(w=0,D.push(m(v)),v=0):w++;for(p=x.charCodeAt(0),l=0;l<8;l++)v=v<<1|p&1,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=p>>1}else{for(p=1,l=0;l<T;l++)v=v<<1|p,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=0;for(p=x.charCodeAt(0),l=0;l<16;l++)v=v<<1|p&1,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=p>>1}S--,S==0&&(S=Math.pow(2,T),T++),delete A[x]}else for(p=a[x],l=0;l<T;l++)v=v<<1|p&1,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=p>>1;S--,S==0&&(S=Math.pow(2,T),T++)}for(p=2,l=0;l<T;l++)v=v<<1|p&1,w==f-1?(w=0,D.push(m(v)),v=0):w++,p=p>>1;for(;;)if(v=v<<1,w==f-1){D.push(m(v));break}else w++;return D.join("")},decompress:function(c){return c==null?"":c==""?null:o._decompress(c.length,32768,function(f){return c.charCodeAt(f)})},_decompress:function(c,f,m){var l=[],p,a=4,A=4,E=3,y="",x=[],S,O,T,D,v,w,b,u={val:m(0),position:f,index:1};for(S=0;S<3;S+=1)l[S]=S;for(T=0,v=Math.pow(2,2),w=1;w!=v;)D=u.val&u.position,u.position>>=1,u.position==0&&(u.position=f,u.val=m(u.index++)),T|=(D>0?1:0)*w,w<<=1;switch(p=T){case 0:for(T=0,v=Math.pow(2,8),w=1;w!=v;)D=u.val&u.position,u.position>>=1,u.position==0&&(u.position=f,u.val=m(u.index++)),T|=(D>0?1:0)*w,w<<=1;b=d(T);break;case 1:for(T=0,v=Math.pow(2,16),w=1;w!=v;)D=u.val&u.position,u.position>>=1,u.position==0&&(u.position=f,u.val=m(u.index++)),T|=(D>0?1:0)*w,w<<=1;b=d(T);break;case 2:return""}for(l[3]=b,O=b,x.push(b);;){if(u.index>c)return"";for(T=0,v=Math.pow(2,E),w=1;w!=v;)D=u.val&u.position,u.position>>=1,u.position==0&&(u.position=f,u.val=m(u.index++)),T|=(D>0?1:0)*w,w<<=1;switch(b=T){case 0:for(T=0,v=Math.pow(2,8),w=1;w!=v;)D=u.val&u.position,u.position>>=1,u.position==0&&(u.position=f,u.val=m(u.index++)),T|=(D>0?1:0)*w,w<<=1;l[A++]=d(T),b=A-1,a--;break;case 1:for(T=0,v=Math.pow(2,16),w=1;w!=v;)D=u.val&u.position,u.position>>=1,u.position==0&&(u.position=f,u.val=m(u.index++)),T|=(D>0?1:0)*w,w<<=1;l[A++]=d(T),b=A-1,a--;break;case 2:return x.join("")}if(a==0&&(a=Math.pow(2,E),E++),l[b])y=l[b];else if(b===A)y=O+O.charAt(0);else return null;x.push(y),l[A++]=O+y.charAt(0),a--,O=y,a==0&&(a=Math.pow(2,E),E++)}}};return o}();var xi=function(){var d=[{id:"/views/test-swal-sauvegarde",path:"views",file:"test-swal-sauvegarde",ptr:gr}],t=function(e){oCurView=d.find(o=>o.id==e),oCurView===void 0&&console.log(`%cError view ${e} could't be found`,ge),oCurView=oCurView.ptr;let s=oCurView.data;return yr[oCurView.method](s)};return Object.freeze({load:t})},Ei=xi(),br=Ei;var Ci=Object.create,vn=Object.defineProperty,Ti=Object.getOwnPropertyDescriptor,Di=Object.getOwnPropertyNames,Oi=Object.getPrototypeOf,Mi=Object.prototype.hasOwnProperty,Ni=d=>vn(d,"__esModule",{value:!0}),Ii=(d,t)=>function(){return t||(0,d[Object.keys(d)[0]])((t={exports:{}}).exports,t),t.exports},ji=(d,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Di(t))!Mi.call(d,s)&&s!=="default"&&vn(d,s,{get:()=>t[s],enumerable:!(e=Ti(t,s))||e.enumerable});return d},ki=d=>ji(Ni(vn(d!=null?Ci(Oi(d)):{},"default",d&&d.__esModule&&"default"in d?{get:()=>d.default,enumerable:!0}:{value:d,enumerable:!0})),d),Bi=Ii({"vendor/cross-fetch.js"(d){(function(t){(function(e){var s="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,o="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(g){return!1}}(),c="FormData"in t,f="ArrayBuffer"in t;if(f)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(g){return g&&m.indexOf(Object.prototype.toString.call(g))>-1};function p(g){if(typeof g!="string"&&(g=String(g)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(g))throw new TypeError("Invalid character in header field name");return g.toLowerCase()}function a(g){return typeof g!="string"&&(g=String(g)),g}function A(g){var M={next:function(){var L=g.shift();return{done:L===void 0,value:L}}};return n&&(M[Symbol.iterator]=function(){return M}),M}function E(g){this.map={},g instanceof E?g.forEach(function(M,L){this.append(L,M)},this):Array.isArray(g)?g.forEach(function(M){this.append(M[0],M[1])},this):g&&Object.getOwnPropertyNames(g).forEach(function(M){this.append(M,g[M])},this)}function y(g){if(g.bodyUsed)return Promise.reject(new TypeError("Already read"));g.bodyUsed=!0}function x(g){return new Promise(function(M,L){g.onload=function(){M(g.result)},g.onerror=function(){L(g.error)}})}function S(g){var M=new FileReader,L=x(M);return M.readAsArrayBuffer(g),L}function O(g){if(g.slice)return g.slice(0);var M=new Uint8Array(g.byteLength);return M.set(new Uint8Array(g)),M.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(g){var M;this._bodyInit=g,g?typeof g=="string"?this._bodyText=g:o&&Blob.prototype.isPrototypeOf(g)?this._bodyBlob=g:c&&FormData.prototype.isPrototypeOf(g)?this._bodyFormData=g:s&&URLSearchParams.prototype.isPrototypeOf(g)?this._bodyText=g.toString():f&&o&&(M=g)&&DataView.prototype.isPrototypeOf(M)?(this._bodyArrayBuffer=O(g.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f&&(ArrayBuffer.prototype.isPrototypeOf(g)||l(g))?this._bodyArrayBuffer=O(g):this._bodyText=g=Object.prototype.toString.call(g):this._bodyText="",this.headers.get("content-type")||(typeof g=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):s&&URLSearchParams.prototype.isPrototypeOf(g)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var g=y(this);if(g)return g;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(S)}),this.text=function(){var g,M,L,k=y(this);if(k)return k;if(this._bodyBlob)return g=this._bodyBlob,M=new FileReader,L=x(M),M.readAsText(g),L;if(this._bodyArrayBuffer)return Promise.resolve(function(I){for(var N=new Uint8Array(I),$=new Array(N.length),R=0;R<N.length;R++)$[R]=String.fromCharCode(N[R]);return $.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}E.prototype.append=function(g,M){g=p(g),M=a(M);var L=this.map[g];this.map[g]=L?L+", "+M:M},E.prototype.delete=function(g){delete this.map[p(g)]},E.prototype.get=function(g){return g=p(g),this.has(g)?this.map[g]:null},E.prototype.has=function(g){return this.map.hasOwnProperty(p(g))},E.prototype.set=function(g,M){this.map[p(g)]=a(M)},E.prototype.forEach=function(g,M){for(var L in this.map)this.map.hasOwnProperty(L)&&g.call(M,this.map[L],L,this)},E.prototype.keys=function(){var g=[];return this.forEach(function(M,L){g.push(L)}),A(g)},E.prototype.values=function(){var g=[];return this.forEach(function(M){g.push(M)}),A(g)},E.prototype.entries=function(){var g=[];return this.forEach(function(M,L){g.push([L,M])}),A(g)},n&&(E.prototype[Symbol.iterator]=E.prototype.entries);var D=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(g,M){var L,k,I=(M=M||{}).body;if(g instanceof v){if(g.bodyUsed)throw new TypeError("Already read");this.url=g.url,this.credentials=g.credentials,M.headers||(this.headers=new E(g.headers)),this.method=g.method,this.mode=g.mode,this.signal=g.signal,I||g._bodyInit==null||(I=g._bodyInit,g.bodyUsed=!0)}else this.url=String(g);if(this.credentials=M.credentials||this.credentials||"same-origin",!M.headers&&this.headers||(this.headers=new E(M.headers)),this.method=(L=M.method||this.method||"GET",k=L.toUpperCase(),D.indexOf(k)>-1?k:L),this.mode=M.mode||this.mode||null,this.signal=M.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&I)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(I)}function w(g){var M=new FormData;return g.trim().split("&").forEach(function(L){if(L){var k=L.split("="),I=k.shift().replace(/\+/g," "),N=k.join("=").replace(/\+/g," ");M.append(decodeURIComponent(I),decodeURIComponent(N))}}),M}function b(g,M){M||(M={}),this.type="default",this.status=M.status===void 0?200:M.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in M?M.statusText:"OK",this.headers=new E(M.headers),this.url=M.url||"",this._initBody(g)}v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},T.call(v.prototype),T.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new E(this.headers),url:this.url})},b.error=function(){var g=new b(null,{status:0,statusText:""});return g.type="error",g};var u=[301,302,303,307,308];b.redirect=function(g,M){if(u.indexOf(M)===-1)throw new RangeError("Invalid status code");return new b(null,{status:M,headers:{location:g}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(g){e.DOMException=function(M,L){this.message=M,this.name=L;var k=Error(M);this.stack=k.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function C(g,M){return new Promise(function(L,k){var I=new v(g,M);if(I.signal&&I.signal.aborted)return k(new e.DOMException("Aborted","AbortError"));var N=new XMLHttpRequest;function $(){N.abort()}N.onload=function(){var R,U,P={status:N.status,statusText:N.statusText,headers:(R=N.getAllResponseHeaders()||"",U=new E,R.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(j){var Y=j.split(":"),H=Y.shift().trim();if(H){var te=Y.join(":").trim();U.append(H,te)}}),U)};P.url="responseURL"in N?N.responseURL:P.headers.get("X-Request-URL");var F="response"in N?N.response:N.responseText;L(new b(F,P))},N.onerror=function(){k(new TypeError("Network request failed"))},N.ontimeout=function(){k(new TypeError("Network request failed"))},N.onabort=function(){k(new e.DOMException("Aborted","AbortError"))},N.open(I.method,I.url,!0),I.credentials==="include"?N.withCredentials=!0:I.credentials==="omit"&&(N.withCredentials=!1),"responseType"in N&&o&&(N.responseType="blob"),I.headers.forEach(function(R,U){N.setRequestHeader(U,R)}),I.signal&&(I.signal.addEventListener("abort",$),N.onreadystatechange=function(){N.readyState===4&&I.signal.removeEventListener("abort",$)}),N.send(I._bodyInit===void 0?null:I._bodyInit)})}C.polyfill=!0,t.fetch||(t.fetch=C,t.Headers=E,t.Request=v,t.Response=b),e.Headers=E,e.Request=v,e.Response=b,e.fetch=C,Object.defineProperty(e,"__esModule",{value:!0})})({})})(typeof self!="undefined"?self:d)}}),_n={url:"",query:"",target:null,fetchSize:0,labels:[],rowTemplate:null,callback:null,reset:!1},vr={sql:"query",resetStatus:"reset",chunkSize:"fetchSize",rowHandler:"rowTemplate"},wr={2014:{apiEndpoint:"https://docs.google.com/spreadsheets/d/%key%/gviz/tq?",keyFormat:new RegExp("spreadsheets/d/([^/#]+)","i"),gidFormat:new RegExp("gid=([^/&#]+)","i")},2010:{apiEndpoint:"https://spreadsheets.google.com/tq?key=%key%&",keyFormat:new RegExp("key=([^&#]+)","i"),gidFormat:new RegExp("gid=([^/&#]+)","i")}};function Ar(d){let t=d?d.f||d.v||d:"";return t instanceof Array&&(t=t.join("")),typeof t=="object"?"":`${t}`.replace(/^\s+|\s+$/,"")}function $i(d){let t=d;return typeof t=="object"&&t.jquery&&t.length&&([t]=t),t&&t.nodeType&&t.nodeType===1?t:null}function Yi(d,t){d&&d.insertAdjacentHTML&&d.insertAdjacentHTML("beforeEnd",t)}function Li(d,t){return` ${d.className} `.indexOf(` ${t} `)!==-1}function Ri(d){return d&&d.tagName==="TABLE"}function Zt(d,t){return`<${t}>${d}</${t}>`}function Pi(d){let t=d.num?"td":"th",e="";return Object.keys(d.cells).forEach(s=>{e+=Zt(d.cells[s],t)}),Zt(e,"tr")}function Fi(d,t){if(typeof Event=="function"){let e=new Event(t);d.dispatchEvent(e)}}var ct=class extends Error{constructor(d="",t=null){super();this.name="SheetrockError",this.code=t,this.message=d}};function Hi(d){let t={};return Object.keys(d).forEach(e=>{({}).hasOwnProperty.call(vr,e)?t[vr[e]]=d[e]:t[e]=d[e]}),t}function Ui(d){let t={};if(t.target=$i(d.target),t.fetchSize=Math.max(0,parseInt(d.fetchSize,10)||0),!t.target&&!d.callback&&!_n.callback)throw new ct("No element targeted or callback provided.");return{..._n,...d,...t}}function qi(d,t){if(t)return{data:t};let e=null;if(Object.keys(wr).forEach(s=>{let n=wr[s];n.keyFormat.test(d.url)&&n.gidFormat.test(d.url)&&(e=n)}),e){let s=d.url.match(e.keyFormat)[1];return{key:s,gid:d.url.match(e.gidFormat)[1],apiEndpoint:e.apiEndpoint.replace("%key%",s)}}throw new ct("No key/gid in the provided URL.")}var Gi=class{constructor(d={},t=!1){this.user=Ui(Hi(d)),this.request=qi(this.user,t),this.requestIndex=`${this.request.key}_${this.request.gid}_${this.user.query}`}},kt={defaults:{failed:!1,header:0,labels:null,loaded:!1,offset:0},store:{}},Vi=class{constructor(d){if(this.options=d,this.index=d.requestIndex,this.state.failed)throw new ct("A previous request for this resource failed.");if(this.state.loaded)throw new ct("No more rows to load!")}get state(){let d={}.hasOwnProperty.call(kt.store,this.index),t=this.options.user.reset||this.options.request.data;if(!d||t){let e={labels:d?kt.store[this.index].labels:null};kt.store[this.index]={...kt.defaults,...e}}return kt.store[this.index]}get url(){let d=this.options.user.fetchSize,t=d?` limit ${d+1} offset ${this.state.offset}`:"",e=[`gid=${encodeURIComponent(this.options.request.gid)}`,`tq=${encodeURIComponent(this.options.user.query+t)}`];return this.options.request.apiEndpoint+e.join("&")}update(d={}){kt.store[this.index]=Object.assign(this.state,d)}},Sr=class{constructor(d,t,e){this.num=d,this.cellsArray=t.map(Ar),this.labels=e}get cells(){let d={};return this.labels.forEach((t,e)=>{d[t]=this.cellsArray[e]}),d}},Qi=class{constructor(d){this.request=d,this.options=d.options}setAttributes(){let{fetchSize:d}=this.options.user,{rows:t}=this.raw.table,{cols:e}=this.raw.table,s={last:t.length-1,rowNumberOffset:this.request.state.header||0},n=this.request.state.labels;this.request.state.offset||(n=e.map((f,m)=>f.label?f.label.replace(/\s/g,""):(s.last+=1,s.rowNumberOffset=1,Ar(t[0].c[m])||f.id)),this.request.update({header:s.rowNumberOffset,labels:n,offset:this.request.state.offset+s.rowNumberOffset})),(!d||t.length-s.rowNumberOffset<d)&&(s.last+=1,this.request.update({loaded:!0}));let o=this.options.user.labels,c=o&&o.length===n.length;s.labels=c?o:n,this.attributes=s}setOutput(){this.rows=[],!this.request.state.offset&&!this.attributes.rowNumberOffset&&this.rows.push(new Sr(0,this.attributes.labels,this.attributes.labels)),this.raw.table.rows.forEach((d,t)=>{if(d.c&&t<this.attributes.last){let e=this.request.state.offset+t+1-this.attributes.rowNumberOffset;this.rows.push(new Sr(e,d.c,this.attributes.labels))}}),this.request.update({offset:this.request.state.offset+this.options.user.fetchSize})}setHTML(){let{target:d}=this.options.user;if(typeof d=="undefined"||d===null)return;let t=this.options.user.rowTemplate||Pi,e=Ri(d),s=d&&Li(d,"sheetrock-header"),n="",o="";this.rows.forEach(c=>{c.num?o+=t(c):(e||s)&&(n+=t(c))}),e&&(n=Zt(n,"thead"),o=Zt(o,"tbody")),Yi(d,n+o),Fi(d,"sheetrock:loaded"),this.html=n+o}loadData(d,t){this.raw=d;try{this.setAttributes(),this.setOutput()}catch(e){t(new ct("Unexpected API response format."));return}this.setHTML(),t(null)}},zi=ki(Bi());function Wi(d,t){let e={headers:{"X-DataSource-Auth":"true"}};(0,zi.default)(d.request.url,e).then(s=>{if(!s.ok)throw new ct("Request failed.",s.status);return s.text()}).then(s=>{let n=JSON.parse(s.replace(/^\)]\}'\n/,""));d.loadData(n,t)}).catch(s=>{if(s instanceof ct)return t(s);let n=s&&s.message?s.message:"Request failed.";return t(new ct(n,500))})}var xr=0;function Ki(d,t){let e=window.document.getElementsByTagName("head")[0],s=window.document.createElement("script"),n=`_sheetrock_callback_${xr}`;xr+=1;function o(){e.removeChild(s),delete window[n]}function c(m){o(),d.loadData(m,t)}function f(){o(),t(new ct("Request failed."))}unsafeWindow[n]=c,s.addEventListener&&(s.addEventListener("error",f,!1),s.addEventListener("abort",f,!1)),s.type="text/javascript",s.src=`${d.request.url}&tqx=responseHandler:${n}`,e.appendChild(s)}var Ji="1.2.0";function wn(d={},t=null){let e=null,s=null,n=null;function o(c){if(c&&c.name==="SheetrockError"&&s&&s.update&&s.update({failed:!0}),d.callback){d.callback(c,e,n);return}if(c)throw c}try{e=new Gi({target:this,...d},!!t),s=new Vi(e),n=new Qi(s)}catch(c){o(c)}return t?n.loadData(t,o):e&&s&&n&&(typeof window=="object"&&"document"in window?Ki(n,o):Wi(n,o)),this}Object.assign(wn,{defaults:_n,version:Ji});try{window.jQuery.fn.sheetrock=wn}catch(d){}var An=wn;var Er="https://docs.google.com/spreadsheets/d/1hn8gBDB-7l02Gp0jAnFq15ogCjpDixKrsxLqAIk3Gt0/edit#gid=0",Zi=function(){var d=function(s,n,o){if(!s)for(insert="",console.log("my callback"),console.dir(o),i=0;i<o.raw.table.rows.length;i++){for(insert="insert into data (`Team`,`Pos`,`First`,`Last`,`Bats`,`AB`,`R`,`H`,`HR`,`RBI`,`SB`,`BA`) values (",datos="",h=0;h<o.raw.table.rows[i].c.length;h++)o.raw.table.rows[i].c[h]==null?val="":val=o.raw.table.rows[i].c[h].v,datos+="'"+val+"'",h<o.raw.table.rows[i].c.length-1&&(datos+=",");insert+=datos,insert+=");",console.log(insert)}};return Object.freeze({test_1:function(){An({url:Er,query:"select A,B,C",callback:d},null)},test_dbg:function(){let s=!1;An({url:Er,callback:function(n,o,c){console.log(n,o,c)}},{});debugger}})},Xi=Zi(),Sn=Xi;var ie={Cfg:{dbase:null},raf:null,cssMainDataSelector:$t,ID_MENU_FORCE_LOADING:null,ID_MENU_FORCE_ADDTOLEFTMENU:null,ID_MENU_FORCE_BAR_ON_TOP:null,_isStarted:!1,start:async function(){if(console.log(`%cIn start check Facturier._isStarted: ${ie._isStarted}`,B),ie._isStarted===!0)return;await $n();let d=ie.checkSupport();console.log(`%cAre all functions supported ? : ${d}`,B);var t="header [class*=MuiAvatar-img]";document.querySelector(t)===null?(console.log(`%c All condition not met, waiting element '${t}' `,B),document.arrive(t,ie._warmup),ie.ID_MENU_FORCE_LOADING=GM_registerMenuCommand("force - loading",ie._warmup),ie.ID_MENU_FORCE_ADDTOLEFTMENU=GM_registerMenuCommand("force - populate menuleft",ie._addLinkToMenu)):(console.log("%c All condition already met go",B),ie._warmup())},checkSupport:function(){return!0},_warmup:function(){if(document.unbindArrive(ie._warmup),ie._isStarted!==!0){ie._isStarted=!0,GM_unregisterMenuCommand(ie.ID_MENU_FORCE_LOADING),GM===void 0?(console.log("%cI am not in a tamper env",B),ie._userscriptless()):console.log(`%cTamper environment detected the version is ${GM.info.version}`,B),GM_addStyle(GM_getResourceText("jspanelcss")),GM_addStyle(GM_getResourceText("toastifycss")),GM_addStyle(GM_getResourceText("simpledatatablecss")),GM_addStyle(GM_getResourceText("loading_barcss")),GM_addStyle(GM_getResourceText("nprogress_css")),GM_config.init(hr),GM_registerMenuCommand("collectauto",gn,"a"),GM_registerMenuCommand("configure",gn,"a"),ie.ID_MENU_FORCE_BAR_ON_TOP=GM_registerMenuCommand("Menu Bar on Top",function(){document.querySelector(".panel.draggable").scrollIntoView()}),GM_config.get("hackheaderzindex")===!0&&(document.getElementById("header").style.zIndex=0),GM_addStyle(".swal2-title{font-size:1.275em}"),GM_addStyle(`
		.button {
			display: inline-flex;
			-webkit-box-align: center;
			align-items: center;
			-webkist-box-pack: center;
			justify-content: center;
			text-decoration: none;
			cursor: pointer;
			font-weight: 700;
		}
		.button--primary{
			font-family: "Montserrat";
			font-size: .875rem;
			font-weight: 700;
			text-align: center;
			line-height: 1.5rem;
			border-radius: 4px;
			border-width: 1px;
			border-style: solid;
			outline: none;
			padding: 8px 16px;
			text-transform: uppercase;
			position: relative;
			overflow: hidden;
			color: #fff;
			background-color: #7451eb;
			border-color: #7451eb;
			box-shadow: 0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.2);
		}
		.button--primary:hover{
			color: #fff;
			background-color: #7451eb;
			border-color: #7451eb;
			box-shadow: 0 6px 6px 0 rgba(0,0,0,0.26),0 10px 20px 0 rgba(0,0,0,0.19);
		}
		.button--primary:active{
			color: #fff;
			background-color: #7451eb;
			border-color: #7451eb;
			-webkistbox-shadow: none;
			box-shadow: none;
		}
		.button--primary:after{
			content: '';
			position: 'absolute';
			top: 50%;
			left: 50%;
			width: 5px;
			height: 5px;
			background-color: #fff;
			opacity: 0;
			border-radius: 100%;
			-webkit-transform:scale(1,1) translate(-50%);
			transform:scale(1,1) translate(-50%);
			-webkit-transform-origin: 50% 50%;
			transform-origin: 50% 50%;
		}
		.button--primary:disabled{
			color: #545454;
			background-color: #d2d2d2;
			border-color: #d2d2d2;
			-webkit-box-shadow: none;
			box-shadow: none;
		}`);var d=ie.cssMainDataSelector;document.querySelector(d)===null?(console.log(`%c All condition not met, waiting element '${d}' `,B),document.arrive(d,ie._main)):(console.log("%c All condition already met go",B),ie._main())}},_forceCbox:function(){ie._applyInjectionForSessionsHistory()},pathname:document.location.pathname,_getOCMainClass:function(){try{let t=document.querySelector(ie.cssMainDataSelector).classList.value.match(/webapp-(\d)/);if(t.length==2)return`webapp-${t[1]}`;throw new Error("_aOCMainSrvId.length must be 2")}catch(d){return console.error("%cError in _getOCMainClass():%s",ge,d),""}},_sOCMainSrvClassName:"",_eventMonitor:function(){var d=document.querySelector("body"),t=new MutationObserver(function(s){s.forEach(function(n){n.target.classList.contains(`${ie._sOCMainSrvClassName}-MuiTouchRipple-root`),n.target.nodeName==="TBODY"&&n.target.parentElement.nodeName==="TABLE"&&Dt(ie._applyInjectionOnPathNameMutation()),n.target.nodeName==="OL"&&Dt(ie._applyInjectionOnPathNameMutation()),function(c){if(typeof c=="undefined")return null;c.nodeName==="A"&&c.children[0].querySelector("p")!==null&&c.children[0].querySelector("p").innerText.toUpperCase().trim()=="SOUTENANCE"&&(Dt(or(c)),ie._lastMutation=dayjs().valueOf())}(n.addedNodes[0]),n.target.nodeName==="BUTTON"&&n.target.parentElement.parentElement.parentElement.firstElementChild.nodeName==="TABLE"&&Dt(ie._applyInjectionOnPathNameMutation()),n.target.ariaLabel==="Page pr\xE9c\xE9dente",ie.pathname!=document.location.pathname&&(ie.pathname=document.location.pathname,Dt(ie._applyInjectionOnPathNameMutation()))})}),e={childList:!0,subtree:!0};t.observe(d,e)},_applyInjectionOnPathNameMutation:function(){let d=!1;d===!1&&document.location.pathname.match(/\/sessions$/)&&(d=!0,ie._applyInjectionForSessionsToComplete()),d===!1&&document.location.pathname.match(/\/booked-mentorship-sessions$/)&&(d=!0,ie._applyInjectionForSessionsBooked()),d===!1&&document.location.pathname.match(/\/mentorship-sessions-history$/)&&(d=!0,ie._applyInjectionForSessionsHistory()),d===!1&&console.log("%cUnknow Route so could't guess what to do",ge)},_lastMutation:0,_applyInjectionForSessionsToComplete:function(){document.querySelector(`${ie.cssMainDataSelector} .Facturier__cbox_all`)!==null&&(document.querySelector(`${ie.cssMainDataSelector} .Facturier__cbox_all`).style.display="none"),console.log("%cWill Patch All Buttons corresponding to this CSS PATH %s",B,`${ie.cssMainDataSelector} a a[href*=sessions]`);var d=Array.from(document.querySelectorAll(`${ie.cssMainDataSelector} a a[href*=sessions]`)),t;d.forEach(function(e){console.log("%cWill Patch Button %o",B,e),e.innerText=".:"+e.innerText+":.",e.addEventListener("click",t=function(s){s.stopPropagation(),s.preventDefault();var n=e.parentElement.parentElement.parentElement,o=n.children[1].querySelector("time").getAttribute("datetime").trim(),c=mt(n.children[2],-2),f=n.children[3].querySelector("a").getAttribute("href-sav"),m=(f||"/").split("/"),l=m[m.length-1],p=dayjs(o).toISOString(),a=Me.getHashId(p,c);let A=parseInt(l,10),E=Oe.exists(A,1,Oe.TYPE.SESSIONID_DATEREFID),y=Oe.exists(a,2,Oe.TYPE.SESSIONID_DATEREFID);E&&(y||(console.log(`[SESSIONID_DATEREFID] iSessionId ${A} est connu mais pas iHash${a}`),Oe.updKey2(A,a,Oe.TYPE.SESSIONID_DATEREFID))),y&&(E||(console.log(`[SESSIONID_DATEREFID] iHash${a} est connu mais pas iSessionId ${A}`),Oe.updKey1(A,a,Oe.TYPE.SESSIONID_DATEREFID))),!E&&!y&&(console.log(`[SESSIONID_DATEREFID] iHash${a} et iSessionId ${A} sont INconnus`),Oe.add(A,a,Oe.TYPE.SESSIONID_DATEREFID)),window.open(f,"blank").focus()}),e.setAttribute("href-sav",e.getAttribute("href")),e.removeAttribute("href")})},_applyInjectionForSessionsBooked:function(){document.querySelector(`${ie.cssMainDataSelector} .Facturier__cbox_all`)!==null&&(document.querySelector(`${ie.cssMainDataSelector} .Facturier__cbox_all`).style.display="none")},_applyInjectionForSessionsHistory:function(d=100){document.querySelector(`${ie.cssMainDataSelector} .Facturier__cbox_all`)!==null&&(document.querySelector(`${ie.cssMainDataSelector} .Facturier__cbox_all`).style.display="block"),!(dayjs().valueOf()-ie._lastMutation<d)&&(Jt(),ie._lastMutation=dayjs().valueOf())},_addHeader:function(){ie._sOCMainSrvClassName.length===0&&(ie._sOCMainSrvClassName=ie._getOCMainClass()),ie._sOCMainSrvClassName.length===0&&(console.error("%c[index._addHeader()] _sOCMainSrvClassName is still unknow",ge),console.log("[index._addHeader()]check this %o",document.querySelector(ie.cssMainDataSelector)));let d=document.querySelector("#mainContent > :not(div:empty)").children,t=0;for(t=d.length-1;t>=0&&(console.log(t,d[t].nodeName),d[t].nodeName!=="SECTION");t--);if(t===0){console.error("IRRECOVERABLE ERROR element <section> not found");return}t=t-1;let e=document.querySelector('#mainContent[class*="webapp"]'),s=document.querySelector('[role="tablist"]');var n=function(p){let a=document.querySelector('[role="tablist"]'),A=document.createElement("span");if(A.innerText="Facturier v."+GM.info.script.version,A.classList.add(...p.classList),A.classList.add("Facturier__header"),p.children.length>1){let y=document.createElement("span");y.classList.add(...p.children[1].classList),y.classList.add("Facturier__header")}let E=document.createElement("a");E.onclick=Ut,E.classList.add(...p.classList),E.classList.add("Facturier__header"),E.appendChild(A),p.children.length>1&&E.appendChild(m),E.style="margin-left: auto",a.appendChild(E)},o=new MutationObserver(function(p,a){let A=s.querySelector("a[aria-selected=false]");if(A.children){n(A),a.disconnect();return}});o.observe(document,{childList:!0,subtree:!0})},_userscriptless(){console.log("%cIm'not in a Tamper environment so i need to load js scripts",B)},_main:function(){console.log("\u200B\u200B\u200B%c[index._main()]MainLoaded\u200B\u200B\u200B",B),document.unbindArrive(ie._main),ie._eventMonitor();let d=new LocalStorage("db");var t=low(d);t.defaults({students:[],sessions:[],f_archives:[],history_session_cache:[],meta:[],refs:[],students_history:[]}).write(),ie.Cfg.dbase=t,dayjs.extend(dayjs_plugin_isSameOrAfter),dayjs.extend(dayjs_plugin_isSameOrBefore),dayjs.extend(dayjs_plugin_isBetween),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_customParseFormat),dayjs.locale("fr"),Oe.checkSupport(),ke.checkSupport(),document.querySelector(".panel.menuBar.flex.draggable")===null&&mr.init(),ie._addHeader(),ie._applyInjectionOnPathNameMutation(),console.log("%cWait for side menu to add element to it",B),sCSSObserved="nav:not([role])",document.arrive(sCSSObserved,ie._addLinkToMenu);let e=ke.getDbVersion();if(Yt(GM.info.script.version,e)==1&&(console.log(`%cDB is in version: ${ke.getDbVersion()} need to go to version ${GM.info.script.version}`,B),Et.update(GM.info.script.version)),Ct(["https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"]).then(async function(s){console.log("%cALPINE js fetched",B)}),Ct(["https://unpkg.com/htmx.org@1.1.0","https://unpkg.com/htmx.org@1.1.0/dist/ext/debug.js"]).then(async function(s){htmx.on("htmx:configRequest",function(n){}),htmx.on("htmx:beforeRequest",function(n){if(n.detail.pathInfo.finalPath&&Ln(n.detail.pathInfo.finalPath)!=="html"){n.detail.xhr.addEventListener("abort",function(){}),n.detail.xhr.onloadstart=function(l){this.abort()};let f=br.load(n.detail.pathInfo.finalPath),m=n.detail.target;var o=n.detail.elt.getAttribute("hx-select");if(o){let l=new DOMParser().parseFromString(f,"text/html");oNode=l.querySelector(o),oNode?f=oNode.outerHTML:console.log(`%cWanna select target ${o} in data received from calling ${n.detail.pathInfo.finalPath} but this node could'nt be found so return the whole string`,ge)}var c=function(l,p){for(var a=document.createRange(),A=a.createContextualFragment(l),E=A.childNodes.length-1;E>=0;E--){var y=A.childNodes[E];p.appendChild(y),htmx.process(y)}return p.lastChild};c(f,n.detail.target)}}),htmx.on("htmx:xhr:loadstart",function(n){})}),Ct(["https://cdn.jsdelivr.net/npm/sweetalert2@10"]).then(async function(s){console.log("%cSweetAlert fetched",B)}),GM_config.get("use_custom_css")===!0){let n=GM_config.get("custom_css_url").split(",");if(n.length!==0)console.log(`%cWanna inject Custom CSS from URL:${n}`,B),Ct(n).then(()=>{console.log(`%cCustom CSS from URL:${n} loaded`,B)}).catch(o=>console.log(`%cError detected when loading dependencies ${o}`,ge));else{let o=GM_config.get("custom_css_data");if(o.length()>0){console.log(`%cNeed to inject a custom css in application content is ${o}`,B);let c=document.createElement("style");c.innerHTML=o,document.head.insertAdjacentElement("beforeend",c)}}}unsafeWindow.Facturier={libs:[],cfg:{dbase:null},klass:[]},unsafeWindow.Facturier.cfg.dbase=ie.Cfg.dbase,unsafeWindow.Facturier.libs.push({id:"fetchInject",ptr:Ct}),unsafeWindow.Facturier.libs.push({id:"dayjs",ptr:dayjs}),unsafeWindow.Facturier.klass.push({id:"Student",ptr:we}),unsafeWindow.Facturier.klass.push({id:"Session",ptr:Me}),unsafeWindow.Facturier.klass.push({id:"Archive",ptr:At}),unsafeWindow.Facturier.klass.push({id:"History",ptr:xt}),unsafeWindow.Facturier.klass.push({id:"StudentHistory",ptr:Ge}),unsafeWindow.Facturier.klass.push({id:"Ref",ptr:Oe}),unsafeWindow.Facturier.klass.push({id:"Dbase",ptr:Et}),unsafeWindow.Facturier.klass.push({id:"Meta",ptr:ke}),unsafeWindow.Facturier.klass.push({id:"Ref",ptr:Oe}),unsafeWindow.Facturier.klass.push({id:"Api",ptr:Nt}),unsafeWindow.Facturier.libs.push({id:"NProgress",ptr:NProgress}),Sn.test_1(),unsafeWindow.Facturier.klass.push({id:"SandBox_Google",ptr:Sn}),unsafeWindow.Facturier.libs.push({id:"Moise",ptr:moize}),GM.info.script.downloadURL==="http://localhost:8000/dist/app-facturier.iife.js"?(console.log("%cALERTE .... version locale !!!!!! ","background-color:coral;color:white"),console.log("%c test readfile",B),Rn("file:////media/pwyll/USB120Go/DevStt/UserScripts/SttAddon/src/update_data_base.js",function(s){console.log(s)}),ie.loadDependencies()):console.log(`%c GM.info.script.downloadURL url : ${GM.info.script.downloadURL}`,B)},_addLinkToMenu:function(){if(console.log("%cSide menu will be added",B),document.unbindArrive(ie._addLinkToMenu),document.querySelector("ul.Facturier__Menu-header")!==null){console.log("%cDirty Check no double launch",B);return}try{let d=document.querySelectorAll("nav:not([role])")[0],t=d.children[0].lastChild.cloneNode(!0);t.firstChild.innerText="Facturier",elMenu=document.querySelector(".panel.draggable"),t.firstChild.href="javascript::void(0);",t.firstChild.onclick=function(n){n.preventDefault(),n.stopPropagation(),elMenu=document.querySelector(".panel.draggable"),elMenu.style.display=elMenu.style.display!="block"?"block":"none"};let e=d.children[0].lastChild.firstChild;t.firstChild.appendChild(e.children[0].cloneNode(!0)),t.firstChild.appendChild(e.children[1].cloneNode(!1)),t.firstChild.appendChild(e.children[2].cloneNode(!1));let s=d.children[0].cloneNode(!1);s.appendChild(t),s.classList.add("Facturier__Menu-header"),d.appendChild(s),console.log("%cSide menu will added",B)}catch(d){console.log("%cInjecting menu encounter an error: %o",ge,d)}},loadDependencies:function(){let d=[];d.push("http://localhost:8000/src/branch01/sandbox.js"),d.push("http://localhost:8000/src/branch01/sandbox.css"),Ct(d).then(()=>{console.log(`dependencies ${d} loaded`)})},dbUpdate:function(){console.log("%c Need to update DB",B),Yt(GM.info.script.version,"1.00.0006")==0&&(console.log("%c Need to update DB to version '1.00.0006'",B),Et.update("1.00.0006"))}};window.Facturier!==void 0?window.Facturier.start():ie.start();var W=ie;})();
/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
/*!
 * Sheetrock
 * Quickly connect to, query, and lazy-load data from Google Sheets.
 * https://chriszarate.github.io/sheetrock/
 * License: MIT
 */
/*! @preserve
 *
 * tcomb.js - Type checking and DDD for JavaScript
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014-2016 Giulio Canti
 *
 */
/**
 * Fetch Inject module.
 *
 * @module fetchInject
 * @license Zlib
 * @param {(USVString[]|Request[])} inputs Resources you wish to fetch.
 * @param {Promise} [promise] A promise to await before attempting injection.
 * @throws {Promise<ReferenceError>} Rejects with error when given no arguments.
 * @throws {Promise<TypeError>} Rejects with error on invalid arguments.
 * @throws {Promise<Error>} Whatever `fetch` decides to throw.
 * @throws {SyntaxError} Via DOM upon attempting to parse unexpected tokens.
 * @returns {Promise<Object[]>} A promise which resolves to an `Array` of
 *     Objects containing `Response` `Body` properties used by the module.
 */
//# sourceMappingURL=app.min.js.map
