// ==UserScript==
// @name         Facturier
// @namespace    http://tampermonkey.net/
// @version      1.10.0009
// @description  Un addon pour vous aider dans votre facturation
// @author       Stéphane TORCHY
// @updateURL    https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @downloadURL  https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @icon         https://mirrors.creativecommons.org/presskit/icons/heart.red.png
// multiple usage
// @match        https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history*
// @match        https://openclassrooms.com/fr/mentorship/dashboard/sessions
// @match        https://openclassrooms.com/fr/mentorship/dashboard/booked-mentorship-sessions

// Start at document start https://www.tampermonkey.net/documentation.php#_run_at
// @run-at document-start   

// @grant        unsafeWindow
// @grant        GM_addStyle
// @grant        GM_getResourceText
// @grant        GM_registerMenuCommand
// @grant        GM_unregisterMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        GM.xmlHttpRequest
// @grant        GM_notification

// @require      https://cdn.jsdelivr.net/npm/lodash@4.17.19/lodash.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/low.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/LocalStorage.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/dayjs.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/locale/fr.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isBetween.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrBefore.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrAfter.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/customParseFormat.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/localeData.min.js


//// GM_Compat : Portable monkey-patching for userscripts  
// SRC 				https://github.com/chocolateboy/gm-compat
// permet notamment d'utiliser GMCompat.unsafeWindow.notify('loaded', { value: 42 }) sous chrome
// @require       	https://unpkg.com/gm-compat@1.1.0 

//// GM_Config
// SRC 			https://github.com/sizzlemctwizzle/GM_config/wiki
// require      https://openuserjs.org/src/libs/sizzle/GM_config.js (cassé ce jour 28/08/2020);
// @require      https://raw.githubusercontent.com/sizzlemctwizzle/GM_config/master/gm_config.js

//// sweetalert 2
// require      https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.all.min.js
// @require      https://cdn.jsdelivr.net/npm/sweetalert2@10

//// draggabilly
// @require      https://cdnjs.cloudflare.com/ajax/libs/draggabilly/2.2.0/draggabilly.pkgd.min.js

//// toastify 
// @require     https://cdn.jsdelivr.net/npm/toastify-js@1.8.0/src/toastify.min.js
// @resource    toastifycss https://raw.githubusercontent.com/apvarun/toastify-js/master/src/toastify.css

// https://github.com/uzairfarooq/arrive --> included manually
// require     https://raw.githubusercontent.com/uzairfarooq/arrive/master/minified/arrive.min.js

////simple-datatables
//// https://github.com/fiduswriter/Simple-DataTables
// @require     https://cdn.jsdelivr.net/npm/simple-datatables@latest
// @resource    simpledatatablecss https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css


//// MEMOIZATION
//// TODO : check best function
// require https://raw.githubusercontent.com/anywhichway/nano-memoize/master/dist/nano-memoize.min.js
// https://github.com/planttheidea/moize#usage
// @require https://cdn.jsdelivr.net/npm/moize@5.4.7/dist/moize.min.js
// require https://cdn.jsdelivr.net/npm/moize@6.0.2/dist/moize.min.js -> probleme 20210701
// require https://cdn.jsdelivr.net/npm/moize@6.0.3/dist/moize.min.js -> probleme 20210701
// USAGE OF https://caolan.github.io/async/v3/docs.html
// FONCTIONNE PAS require https://cdn.jsdelivr.net/npm/async@3.2.0/memoize.min.js probleme export
// @require https://cdn.jsdelivr.net/npm/async@3.2.0/dist/async.min.js
// TOTEST https://github.com/sindresorhus/p-memoize
// Ne fonctionne pasrequire https://cdn.skypack.dev/p-memoize

//// FETCH INJECT --> included manually
// require https://cdn.jsdelivr.net/npm/fetch-inject

//// PARSER MKDOWN
// @require 	 https://cdn.jsdelivr.net/npm/showdown@1.9.1/dist/showdown.min.js

//// PDF https://pdf-lib.js.org/docs/api/
// @require      https://unpkg.com/pdf-lib@1.9.0/dist/pdf-lib.min.js
// @require      https://unpkg.com/downloadjs@1.4.7/download.js

//// HTMX https://htmx.org --> included dynamically
// require https://unpkg.com/htmx.org@1.1.0/dist/htmx.min.js

//// ALPINE JS --> included dynamically
// require https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js


// ProgressBar 
// https://loading.io/progress/
// require https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.js
// resource loading_barcss https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.css
// @require https://loadingio.github.io/loading-bar/dist/loading-bar.js
// @resource loading_barcss https://loadingio.github.io/loading-bar/dist/loading-bar.min.css

// https://www.cssscript.com/demo/text-progress-bar-ascii-loader/
// https://github.com/kimmobrunfeldt/progressbar.js - fonctionne mais probleme avec le easing dans mon popup progress bar
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.min.js
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.js
// https://pvdlg.github.io/uprogress/js-api/#UProgress+start
// https://ricostacruz.com/nprogress


// @require https://unpkg.com/nprogress@0.2.0/nprogress.js
// @resource nprogress_css https://unpkg.com/nprogress@0.2.0/nprogress.css


// semble cassé
// https://github.com/webosorg/Process
// https://unpkg.com/@webos/process@0.2.0/dist/process.js
// https://cdn.jsdelivr.net/npm/@webos/process@0.2.0/dist/process.min.js
// bof ... je ne parviens pas à faire fonctionner l'exemple
// https://cdn.jsdelivr.net/npm/worker-function@2.0.1/WorkerFunction.min.js
// Threading 
// require  https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/Thread.js
// require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadPool.js
// require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadQueue.js
// semble cassé
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// https://unpkg.com/paralleljs@1.0/lib/parallel.js
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// Freelancer
// https://github.com/Wildhoney/Freelancer
// fonctionne require https://raw.githubusercontent.com/arqex/worker-function/master/WorkerFunction.js
// ne fonctonne pas https://raw.githubusercontent.com/duart38/Thread/master/Thread.bundle.js
// require      https://cdn.jsdelivr.net/npm/paralleljs@1.0.1/lib/parallel.min.js


/*
 * History
 * cf https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/blob/master/CHANGELOG.md
 */
// ==/UserScript==
(()=>{var or=Object.create;var Ft=Object.defineProperty;var sr=Object.getOwnPropertyDescriptor;var ar=Object.getOwnPropertyNames;var dr=Object.getPrototypeOf,lr=Object.prototype.hasOwnProperty;var ur=(f,n,e)=>n in f?Ft(f,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):f[n]=e;var cr=f=>Ft(f,"__esModule",{value:!0});var fr=(f,n)=>()=>(n||f((n={exports:{}}).exports,n),n.exports);var pr=(f,n,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of ar(n))!lr.call(f,s)&&s!=="default"&&Ft(f,s,{get:()=>n[s],enumerable:!(e=sr(n,s))||e.enumerable});return f},mr=f=>pr(cr(Ft(f!=null?or(dr(f)):{},"default",f&&f.__esModule&&"default"in f?{get:()=>f.default,enumerable:!0}:{value:f,enumerable:!0})),f);var q=(f,n,e)=>(ur(f,typeof n!="symbol"?n+"":n,e),e);var qn=fr((sn,an)=>{(function(f,n){typeof define=="function"&&define.amd?define([],n):typeof an=="object"&&typeof sn!="undefined"?an.exports=n():f.Papa=n()})(sn,function f(){"use strict";var n=typeof self!="undefined"?self:typeof window!="undefined"?window:n!==void 0?n:{},e=!n.document&&!!n.postMessage,s=e&&/blob:/i.test((n.location||{}).protocol),t={},i=0,u={parse:function(g,a){var A=(a=a||{}).dynamicTyping||!1;if(m(A)&&(a.dynamicTypingFunction=A,A={}),a.dynamicTyping=A,a.transform=!!m(a.transform)&&a.transform,a.worker&&u.WORKERS_SUPPORTED){var M=function(){if(!u.WORKERS_SUPPORTED)return!1;var L=(C=n.URL||n.webkitURL||null,D=f.toString(),u.BLOB_URL||(u.BLOB_URL=C.createObjectURL(new Blob(["(",D,")();"],{type:"text/javascript"})))),I=new n.Worker(L),C,D;return I.onmessage=b,I.id=i++,t[I.id]=I}();return M.userStep=a.step,M.userChunk=a.chunk,M.userComplete=a.complete,M.userError=a.error,a.step=m(a.step),a.chunk=m(a.chunk),a.complete=m(a.complete),a.error=m(a.error),delete a.worker,void M.postMessage({input:g,config:a,workerId:M.id})}var j=null;return u.NODE_STREAM_INPUT,typeof g=="string"?j=a.download?new d(a):new o(a):g.readable===!0&&m(g.read)&&m(g.on)?j=new v(a):(n.File&&g instanceof File||g instanceof Object)&&(j=new p(a)),j.stream(g)},unparse:function(g,a){var A=!1,M=!0,j=",",L=`\r
`,I='"',C=I+I,D=!1,N=null,Y=!1;(function(){if(typeof a=="object"){if(typeof a.delimiter!="string"||u.BAD_DELIMITERS.filter(function(P){return a.delimiter.indexOf(P)!==-1}).length||(j=a.delimiter),(typeof a.quotes=="boolean"||typeof a.quotes=="function"||Array.isArray(a.quotes))&&(A=a.quotes),typeof a.skipEmptyLines!="boolean"&&typeof a.skipEmptyLines!="string"||(D=a.skipEmptyLines),typeof a.newline=="string"&&(L=a.newline),typeof a.quoteChar=="string"&&(I=a.quoteChar),typeof a.header=="boolean"&&(M=a.header),Array.isArray(a.columns)){if(a.columns.length===0)throw new Error("Option columns is empty");N=a.columns}a.escapeChar!==void 0&&(C=a.escapeChar+I),typeof a.escapeFormulae=="boolean"&&(Y=a.escapeFormulae)}})();var F=new RegExp(h(I),"g");if(typeof g=="string"&&(g=JSON.parse(g)),Array.isArray(g)){if(!g.length||Array.isArray(g[0]))return B(null,g,D);if(typeof g[0]=="object")return B(N||k(g[0]),g,D)}else if(typeof g=="object")return typeof g.data=="string"&&(g.data=JSON.parse(g.data)),Array.isArray(g.data)&&(g.fields||(g.fields=g.meta&&g.meta.fields),g.fields||(g.fields=Array.isArray(g.data[0])?g.fields:k(g.data[0])),Array.isArray(g.data[0])||typeof g.data[0]=="object"||(g.data=[g.data])),B(g.fields||[],g.data||[],D);throw new Error("Unable to serialize unrecognized input");function k(P){if(typeof P!="object")return[];var ie=[];for(var ue in P)ie.push(ue);return ie}function B(P,ie,ue){var pe="";typeof P=="string"&&(P=JSON.parse(P)),typeof ie=="string"&&(ie=JSON.parse(ie));var me=Array.isArray(P)&&0<P.length,ye=!Array.isArray(ie[0]);if(me&&M){for(var re=0;re<P.length;re++)0<re&&(pe+=j),pe+=$(P[re],re);0<ie.length&&(pe+=L)}for(var oe=0;oe<ie.length;oe++){var he=me?P.length:ie[oe].length,ce=!1,ae=me?Object.keys(ie[oe]).length===0:ie[oe].length===0;if(ue&&!me&&(ce=ue==="greedy"?ie[oe].join("").trim()==="":ie[oe].length===1&&ie[oe][0].length===0),ue==="greedy"&&me){for(var de=[],ne=0;ne<he;ne++){var G=ye?P[ne]:ne;de.push(ie[oe][G])}ce=de.join("").trim()===""}if(!ce){for(var ge=0;ge<he;ge++){0<ge&&!ae&&(pe+=j);var Se=me&&ye?P[ge]:ge;pe+=$(ie[oe][Se],ge)}oe<ie.length-1&&(!ue||0<he&&!ae)&&(pe+=L)}}return pe}function $(P,ie){if(P==null)return"";if(P.constructor===Date)return JSON.stringify(P).slice(1,25);Y===!0&&typeof P=="string"&&P.match(/^[=+\-@].*$/)!==null&&(P="'"+P);var ue=P.toString().replace(F,C),pe=typeof A=="boolean"&&A||typeof A=="function"&&A(P,ie)||Array.isArray(A)&&A[ie]||function(me,ye){for(var re=0;re<ye.length;re++)if(-1<me.indexOf(ye[re]))return!0;return!1}(ue,u.BAD_DELIMITERS)||-1<ue.indexOf(j)||ue.charAt(0)===" "||ue.charAt(ue.length-1)===" ";return pe?I+ue+I:ue}}};if(u.RECORD_SEP=String.fromCharCode(30),u.UNIT_SEP=String.fromCharCode(31),u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!e&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=w,u.ParserHandle=S,u.NetworkStreamer=d,u.FileStreamer=p,u.StringStreamer=o,u.ReadableStreamStreamer=v,n.jQuery){var l=n.jQuery;l.fn.parse=function(g){var a=g.config||{},A=[];return this.each(function(L){if(!(l(this).prop("tagName").toUpperCase()==="INPUT"&&l(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var I=0;I<this.files.length;I++)A.push({file:this.files[I],inputElem:this,instanceConfig:l.extend({},a)})}),M(),this;function M(){if(A.length!==0){var L,I,C,D,N=A[0];if(m(g.before)){var Y=g.before(N.file,N.inputElem);if(typeof Y=="object"){if(Y.action==="abort")return L="AbortError",I=N.file,C=N.inputElem,D=Y.reason,void(m(g.error)&&g.error({name:L},I,C,D));if(Y.action==="skip")return void j();typeof Y.config=="object"&&(N.instanceConfig=l.extend(N.instanceConfig,Y.config))}else if(Y==="skip")return void j()}var F=N.instanceConfig.complete;N.instanceConfig.complete=function(k){m(F)&&F(k,N.file,N.inputElem),j()},u.parse(N.file,N.instanceConfig)}else m(g.complete)&&g.complete()}function j(){A.splice(0,1),M()}}}function c(g){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(a){var A=E(a);A.chunkSize=parseInt(A.chunkSize),a.step||a.chunk||(A.chunkSize=null),this._handle=new S(A),(this._handle.streamer=this)._config=A}.call(this,g),this.parseChunk=function(a,A){if(this.isFirstChunk&&m(this._config.beforeFirstChunk)){var M=this._config.beforeFirstChunk(a);M!==void 0&&(a=M)}this.isFirstChunk=!1,this._halted=!1;var j=this._partialLine+a;this._partialLine="";var L=this._handle.parse(j,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var I=L.meta.cursor;this._finished||(this._partialLine=j.substring(I-this._baseIndex),this._baseIndex=I),L&&L.data&&(this._rowCount+=L.data.length);var C=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)n.postMessage({results:L,workerId:u.WORKER_ID,finished:C});else if(m(this._config.chunk)&&!A){if(this._config.chunk(L,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);L=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(L.data),this._completeResults.errors=this._completeResults.errors.concat(L.errors),this._completeResults.meta=L.meta),this._completed||!C||!m(this._config.complete)||L&&L.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),C||L&&L.meta.paused||this._nextChunk(),L}this._halted=!0},this._sendError=function(a){m(this._config.error)?this._config.error(a):s&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:a,finished:!1})}}function d(g){var a;(g=g||{}).chunkSize||(g.chunkSize=u.RemoteChunkSize),c.call(this,g),this._nextChunk=e?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(A){this._input=A,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(a=new XMLHttpRequest,this._config.withCredentials&&(a.withCredentials=this._config.withCredentials),e||(a.onload=y(this._chunkLoaded,this),a.onerror=y(this._chunkError,this)),a.open(this._config.downloadRequestBody?"POST":"GET",this._input,!e),this._config.downloadRequestHeaders){var A=this._config.downloadRequestHeaders;for(var M in A)a.setRequestHeader(M,A[M])}if(this._config.chunkSize){var j=this._start+this._config.chunkSize-1;a.setRequestHeader("Range","bytes="+this._start+"-"+j)}try{a.send(this._config.downloadRequestBody)}catch(L){this._chunkError(L.message)}e&&a.status===0&&this._chunkError()}},this._chunkLoaded=function(){a.readyState===4&&(a.status<200||400<=a.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:a.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(A){var M=A.getResponseHeader("Content-Range");return M===null?-1:parseInt(M.substring(M.lastIndexOf("/")+1))}(a),this.parseChunk(a.responseText)))},this._chunkError=function(A){var M=a.statusText||A;this._sendError(new Error(M))}}function p(g){var a,A;(g=g||{}).chunkSize||(g.chunkSize=u.LocalChunkSize),c.call(this,g);var M=typeof FileReader!="undefined";this.stream=function(j){this._input=j,A=j.slice||j.webkitSlice||j.mozSlice,M?((a=new FileReader).onload=y(this._chunkLoaded,this),a.onerror=y(this._chunkError,this)):a=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var j=this._input;if(this._config.chunkSize){var L=Math.min(this._start+this._config.chunkSize,this._input.size);j=A.call(j,this._start,L)}var I=a.readAsText(j,this._config.encoding);M||this._chunkLoaded({target:{result:I}})},this._chunkLoaded=function(j){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(j.target.result)},this._chunkError=function(){this._sendError(a.error)}}function o(g){var a;c.call(this,g=g||{}),this.stream=function(A){return a=A,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var A,M=this._config.chunkSize;return M?(A=a.substring(0,M),a=a.substring(M)):(A=a,a=""),this._finished=!a,this.parseChunk(A)}}}function v(g){c.call(this,g=g||{});var a=[],A=!0,M=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(j){this._input=j,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){M&&a.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),a.length?this.parseChunk(a.shift()):A=!0},this._streamData=y(function(j){try{a.push(typeof j=="string"?j:j.toString(this._config.encoding)),A&&(A=!1,this._checkIsFinished(),this.parseChunk(a.shift()))}catch(L){this._streamError(L)}},this),this._streamError=y(function(j){this._streamCleanUp(),this._sendError(j)},this),this._streamEnd=y(function(){this._streamCleanUp(),M=!0,this._streamData("")},this),this._streamCleanUp=y(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S(g){var a,A,M,j=Math.pow(2,53),L=-j,I=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,C=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,D=this,N=0,Y=0,F=!1,k=!1,B=[],$={data:[],errors:[],meta:{}};if(m(g.step)){var P=g.step;g.step=function(re){if($=re,pe())ue();else{if(ue(),$.data.length===0)return;N+=re.data.length,g.preview&&N>g.preview?A.abort():($.data=$.data[0],P($,D))}}}function ie(re){return g.skipEmptyLines==="greedy"?re.join("").trim()==="":re.length===1&&re[0].length===0}function ue(){if($&&M&&(ye("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),M=!1),g.skipEmptyLines)for(var re=0;re<$.data.length;re++)ie($.data[re])&&$.data.splice(re--,1);return pe()&&function(){if(!$)return;function oe(ce,ae){m(g.transformHeader)&&(ce=g.transformHeader(ce,ae)),B.push(ce)}if(Array.isArray($.data[0])){for(var he=0;pe()&&he<$.data.length;he++)$.data[he].forEach(oe);$.data.splice(0,1)}else $.data.forEach(oe)}(),function(){if(!$||!g.header&&!g.dynamicTyping&&!g.transform)return $;function oe(ce,ae){var de,ne=g.header?{}:[];for(de=0;de<ce.length;de++){var G=de,ge=ce[de];g.header&&(G=de>=B.length?"__parsed_extra":B[de]),g.transform&&(ge=g.transform(ge,G)),ge=me(G,ge),G==="__parsed_extra"?(ne[G]=ne[G]||[],ne[G].push(ge)):ne[G]=ge}return g.header&&(de>B.length?ye("FieldMismatch","TooManyFields","Too many fields: expected "+B.length+" fields but parsed "+de,Y+ae):de<B.length&&ye("FieldMismatch","TooFewFields","Too few fields: expected "+B.length+" fields but parsed "+de,Y+ae)),ne}var he=1;return!$.data.length||Array.isArray($.data[0])?($.data=$.data.map(oe),he=$.data.length):$.data=oe($.data,0),g.header&&$.meta&&($.meta.fields=B),Y+=he,$}()}function pe(){return g.header&&B.length===0}function me(re,oe){return he=re,g.dynamicTypingFunction&&g.dynamicTyping[he]===void 0&&(g.dynamicTyping[he]=g.dynamicTypingFunction(he)),(g.dynamicTyping[he]||g.dynamicTyping)===!0?oe==="true"||oe==="TRUE"||oe!=="false"&&oe!=="FALSE"&&(function(ce){if(I.test(ce)){var ae=parseFloat(ce);if(L<ae&&ae<j)return!0}return!1}(oe)?parseFloat(oe):C.test(oe)?new Date(oe):oe===""?null:oe):oe;var he}function ye(re,oe,he,ce){var ae={type:re,code:oe,message:he};ce!==void 0&&(ae.row=ce),$.errors.push(ae)}this.parse=function(re,oe,he){var ce=g.quoteChar||'"';if(g.newline||(g.newline=function(ne,G){ne=ne.substring(0,1048576);var ge=new RegExp(h(G)+"([^]*?)"+h(G),"gm"),Se=(ne=ne.replace(ge,"")).split("\r"),ke=ne.split(`
`),Ne=1<ke.length&&ke[0].length<Se[0].length;if(Se.length===1||Ne)return`
`;for(var He=0,Ce=0;Ce<Se.length;Ce++)Se[Ce][0]===`
`&&He++;return He>=Se.length/2?`\r
`:"\r"}(re,ce)),M=!1,g.delimiter)m(g.delimiter)&&(g.delimiter=g.delimiter(re),$.meta.delimiter=g.delimiter);else{var ae=function(ne,G,ge,Se,ke){var Ne,He,Ce,Ge;ke=ke||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var Me=0;Me<ke.length;Me++){var ct=ke[Me],xt=0,ve=0,Je=0;Ce=void 0;for(var Le=new w({comments:Se,delimiter:ct,newline:G,preview:10}).parse(ne),Ze=0;Ze<Le.data.length;Ze++)if(ge&&ie(Le.data[Ze]))Je++;else{var Pe=Le.data[Ze].length;ve+=Pe,Ce!==void 0?0<Pe&&(xt+=Math.abs(Pe-Ce),Ce=Pe):Ce=Pe}0<Le.data.length&&(ve/=Le.data.length-Je),(He===void 0||xt<=He)&&(Ge===void 0||Ge<ve)&&1.99<ve&&(He=xt,Ne=ct,Ge=ve)}return{successful:!!(g.delimiter=Ne),bestDelimiter:Ne}}(re,g.newline,g.skipEmptyLines,g.comments,g.delimitersToGuess);ae.successful?g.delimiter=ae.bestDelimiter:(M=!0,g.delimiter=u.DefaultDelimiter),$.meta.delimiter=g.delimiter}var de=E(g);return g.preview&&g.header&&de.preview++,a=re,A=new w(de),$=A.parse(a,oe,he),ue(),F?{meta:{paused:!0}}:$||{meta:{paused:!1}}},this.paused=function(){return F},this.pause=function(){F=!0,A.abort(),a=m(g.chunk)?"":a.substring(A.getCharIndex())},this.resume=function(){D.streamer._halted?(F=!1,D.streamer.parseChunk(a,!0)):setTimeout(D.resume,3)},this.aborted=function(){return k},this.abort=function(){k=!0,A.abort(),$.meta.aborted=!0,m(g.complete)&&g.complete($),a=""}}function h(g){return g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function w(g){var a,A=(g=g||{}).delimiter,M=g.newline,j=g.comments,L=g.step,I=g.preview,C=g.fastMode,D=a=g.quoteChar===void 0?'"':g.quoteChar;if(g.escapeChar!==void 0&&(D=g.escapeChar),(typeof A!="string"||-1<u.BAD_DELIMITERS.indexOf(A))&&(A=","),j===A)throw new Error("Comment character same as delimiter");j===!0?j="#":(typeof j!="string"||-1<u.BAD_DELIMITERS.indexOf(j))&&(j=!1),M!==`
`&&M!=="\r"&&M!==`\r
`&&(M=`
`);var N=0,Y=!1;this.parse=function(F,k,B){if(typeof F!="string")throw new Error("Input must be a string");var $=F.length,P=A.length,ie=M.length,ue=j.length,pe=m(L),me=[],ye=[],re=[],oe=N=0;if(!F)return Me();if(C||C!==!1&&F.indexOf(a)===-1){for(var he=F.split(M),ce=0;ce<he.length;ce++){if(re=he[ce],N+=re.length,ce!==he.length-1)N+=M.length;else if(B)return Me();if(!j||re.substring(0,ue)!==j){if(pe){if(me=[],Ne(re.split(A)),ct(),Y)return Me()}else Ne(re.split(A));if(I&&I<=ce)return me=me.slice(0,I),Me(!0)}}return Me()}for(var ae=F.indexOf(A,N),de=F.indexOf(M,N),ne=new RegExp(h(D)+h(a),"g"),G=F.indexOf(a,N);;)if(F[N]!==a)if(j&&re.length===0&&F.substring(N,N+ue)===j){if(de===-1)return Me();N=de+ie,de=F.indexOf(M,N),ae=F.indexOf(A,N)}else{if(ae!==-1&&(ae<de||de===-1)){if(!(ae<G)){re.push(F.substring(N,ae)),N=ae+P,ae=F.indexOf(A,N);continue}var ge=xt(ae,G,de);if(ge&&ge.nextDelim!==void 0){ae=ge.nextDelim,G=ge.quoteSearch,re.push(F.substring(N,ae)),N=ae+P,ae=F.indexOf(A,N);continue}}if(de===-1)break;if(re.push(F.substring(N,de)),Ge(de+ie),pe&&(ct(),Y))return Me();if(I&&me.length>=I)return Me(!0)}else for(G=N,N++;;){if((G=F.indexOf(a,G+1))===-1)return B||ye.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:me.length,index:N}),Ce();if(G===$-1)return Ce(F.substring(N,G).replace(ne,a));if(a!==D||F[G+1]!==D){if(a===D||G===0||F[G-1]!==D){ae!==-1&&ae<G+1&&(ae=F.indexOf(A,G+1)),de!==-1&&de<G+1&&(de=F.indexOf(M,G+1));var Se=He(de===-1?ae:Math.min(ae,de));if(F[G+1+Se]===A){re.push(F.substring(N,G).replace(ne,a)),F[N=G+1+Se+P]!==a&&(G=F.indexOf(a,N)),ae=F.indexOf(A,N),de=F.indexOf(M,N);break}var ke=He(de);if(F.substring(G+1+ke,G+1+ke+ie)===M){if(re.push(F.substring(N,G).replace(ne,a)),Ge(G+1+ke+ie),ae=F.indexOf(A,N),G=F.indexOf(a,N),pe&&(ct(),Y))return Me();if(I&&me.length>=I)return Me(!0);break}ye.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:me.length,index:N}),G++}}else G++}return Ce();function Ne(ve){me.push(ve),oe=N}function He(ve){var Je=0;if(ve!==-1){var Le=F.substring(G+1,ve);Le&&Le.trim()===""&&(Je=Le.length)}return Je}function Ce(ve){return B||(ve===void 0&&(ve=F.substring(N)),re.push(ve),N=$,Ne(re),pe&&ct()),Me()}function Ge(ve){N=ve,Ne(re),re=[],de=F.indexOf(M,N)}function Me(ve){return{data:me,errors:ye,meta:{delimiter:A,linebreak:M,aborted:Y,truncated:!!ve,cursor:oe+(k||0)}}}function ct(){L(Me()),me=[],ye=[]}function xt(ve,Je,Le){var Ze={nextDelim:void 0,quoteSearch:void 0},Pe=F.indexOf(a,Je+1);if(Je<ve&&ve<Pe&&(Pe<Le||Le===-1)){var zt=F.indexOf(A,Pe);if(zt===-1)return Ze;Pe<zt&&(Pe=F.indexOf(a,Pe+1)),Ze=xt(zt,Pe,Le)}else Ze={nextDelim:ve,quoteSearch:Je};return Ze}},this.abort=function(){Y=!0},this.getCharIndex=function(){return N}}function b(g){var a=g.data,A=t[a.workerId],M=!1;if(a.error)A.userError(a.error,a.file);else if(a.results&&a.results.data){var j={abort:function(){M=!0,T(a.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:x,resume:x};if(m(A.userStep)){for(var L=0;L<a.results.data.length&&(A.userStep({data:a.results.data[L],errors:a.results.errors,meta:a.results.meta},j),!M);L++);delete a.results}else m(A.userChunk)&&(A.userChunk(a.results,j,a.file),delete a.results)}a.finished&&!M&&T(a.workerId,a.results)}function T(g,a){var A=t[g];m(A.userComplete)&&A.userComplete(a),A.terminate(),delete t[g]}function x(){throw new Error("Not implemented.")}function E(g){if(typeof g!="object"||g===null)return g;var a=Array.isArray(g)?[]:{};for(var A in g)a[A]=E(g[A]);return a}function y(g,a){return function(){g.apply(a,arguments)}}function m(g){return typeof g=="function"}return s&&(n.onmessage=function(g){var a=g.data;if(u.WORKER_ID===void 0&&a&&(u.WORKER_ID=a.workerId),typeof a.input=="string")n.postMessage({workerId:u.WORKER_ID,results:u.parse(a.input,a.config),finished:!0});else if(n.File&&a.input instanceof File||a.input instanceof Object){var A=u.parse(a.input,a.config);A&&n.postMessage({workerId:u.WORKER_ID,results:A,finished:!0})}}),(d.prototype=Object.create(c.prototype)).constructor=d,(p.prototype=Object.create(c.prototype)).constructor=p,(o.prototype=Object.create(o.prototype)).constructor=o,(v.prototype=Object.create(c.prototype)).constructor=v,u})});var ft={async XHR(f){let n=window.GM_xmlhttpRequest||(GM?GM.xmlHttpRequest:null);return n?new Promise((e,s)=>{Object.assign(f,{onabort:s,onerror:s,onload:e,ontimeout:s}),n(f)}):Promise.reject()},async getValue(f,n=null){return window.GM_getValue?Promise.resolve(GM_getValue(f)||n):await GM.getValue(f)||n},async setValue(f,n){window.GM_setValue?GM_setValue(f,n):GM.setValue(f,n)}};var pn="OC-Addons",ai="St\xE9phane TORCHY",O="background-color:green;color:white",di="background-color:black;color:white",Xe="background-color:coral;color:white",li="background-color:cyan;color:white",le="background-color:red;color:white",Ve="background-color:blue;color:white",et="auto-financ\xE9",$e="financ\xE9 par un tiers",pt="autre",mt="r\xE9alis\xE9e",lt="annul\xE9e",gt="annul\xE9e tardivement",ht="\xE9tudiant absent",Nt="\xE9tudiante absente",yt=6,mn=30,gn=35,hn=40,yn=45,bn=50,vn=55,Q=0,z=1,W=2,ui=[{pathId:158,path:"158-trouvez-lemploi-qui-vous-correspond",value:2}],Z=0,X=1,K=2,ee=3,R=0,H=1,U=2,_n=0,wn="completed",An="canceled",Sn="late canceled",xn="marked student as absent",Ot="ol";var En=function(){return new Promise(f=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",f):f()})},Rt=async function(f="",n="",e=!1){console.info(`%cfetch() waiting return from : ${f}`,O);let s=await ft.XHR({method:"GET",url:f,responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"},onprogress:function(c){}}).catch(c=>{console.error(`%cError ${c}`,le)}),i=new DOMParser().parseFromString(s.responseText.replace(/\n/mg,""),"text/html");if(i.querySelector("meta[id=captcha-bypass]")!==null)throw console.error(`%cError CloudFlare CAPTCHA : ${i.querySelector("title").innerText}`,O),new Error("Must Respond to Cloudflare Captcha or waiting....");var l={};return e===!0?l=i.querySelectorAll(n):l=i.querySelector(n),l};var ut=function(f,n=-1){try{var e=(f.querySelector("a").href||"/").split("/");return e[e.length+n]}catch(s){console.error(`%cError in getkey${s.stack||s}`,le)}},Cn=function(f){var n=f.trim().split(" ");try{var e=dayjs_locale_fr.months.findIndex(s=>s===n[1])+1}catch(s){console.error(`%cError in extractDate${s.stack||s}`,le)}return`${n[2]}-${e}-${n[0]}T${n[4]}`};var Qe=function(f){return new Promise(n=>setTimeout(n,f))},Tn=function(f){return f.substring(f.lastIndexOf(".")+1,f.length)||f},It=function(f,n){for(var e=f.split("."),s=n.split("."),t=0;t<3;t++){var i=Number(e[t]),u=Number(s[t]);if(i>u)return 1;if(u>i)return-1;if(!isNaN(i)&&isNaN(u))return 1;if(isNaN(i)&&!isNaN(u))return-1}return 0},Dn=function(n,e){return console.info("Reading:",n),fetch(n,{mode:"same-origin"}).then(function(s){return s.blob()}).then(function(s){var t=new FileReader;t.addEventListener("loadend",function(){e(this.result)}),t.readAsText(s)})},Mn=function(f){let n=f,e=f.reduce(function(p,o){return p*o});var s=new Array(e);let t=function(...p){let o=p.pop();if(p.length!==f.length)throw"Wrong matrix dimensions, need "+f.length+", you provide "+o.length+"!";if(d(p)===0)throw"Wrong type for set need one or more int has dimension, check type of!";let v=c(p);return s[v]=o,o},i=function(...p){if(p.length!==f.length)throw"Wrong matrix dimensions, need "+f.length+", you provide "+p.length+"!";if(d(p)===0)throw"Wrong type for set need one or more int has dimension, check type of!";let o=c(p);return s[o]},u=function(...p){let o=c(p);return s[o]=void 0,s[o]===void 0},l=function(){console.group("dump table"),console.table(s),console.groupEnd("dump table")},c=function(p){return p.reduce(function(o,v,S,h){let w=n.slice(S+1),b=w.length>0?w.reduce(function(T,x){return T*x}):1;return o+v*b},0)},d=function(p){return p.reduce((o,v)=>o&typeof v=="number",1)};return Object.freeze({set:t,get:i,del:u,toConsole:l})},Nn=function(f,n=0){let e=3735928559^n,s=1103547991^n;for(let t=0,i;t<f.length;t++)i=f.charCodeAt(t),e=Math.imul(e^i,2654435761),s=Math.imul(s^i,1597334677);return e=Math.imul(e^e>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507)^Math.imul(e^e>>>13,3266489909),4294967296*(2097151&s)+(e>>>0)},se=function(f,n,e=Error){if(!f)throw new e(n)};var Wt=f=>Array.isArray(f),On=f=>f.toString().trim().length<="function(){}".length;var jt=function(f){var n;return function(){var e=this,s=arguments;n&&window.cancelAnimationFrame(n),n=window.requestAnimationFrame(function(){f.apply(e,s)})}};var In=function(f){let n=Date.now(),e=null;do e=Date.now();while(e-n<f)};HTMLElement.prototype.appendFirst=function(f){this.firstChild?this.insertBefore(f,this.firstChild):this.appendChild(f)};var Et=async function(f=null,n=null,e=!0){var s="";s+="<style>",s+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",s+="form input {background: #fff;border: 1px solid #9c9c9c;}",s+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",s+="form button:hover {background: gold;}",s+="form label {padding: 0.5em 0.5em 0.5em 0;}",s+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",s+="form input:focus {outline: 3px solid gold;}",s+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}form label {text-align: right;grid-column: 1 / 2;}form input, form button {grid-column: 2 / 3;}}",s+="</style>",s+='<form class="form1" action="">',s+='<label for="dtFrom" class="date">Date de d\xE9but</label>',f?s+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(f).format("YYYY-MM-DD")+'">':s+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',s+='<label for="dtTo" class="date">Date de fin</label>',f?s+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(n).format("YYYY-MM-DD")+'">':s+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',s+="</form>";let{value:t}=await Swal.fire({title:"<strong>Choix de la p\xE9riode</strong>",icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez la p\xE9riode pour la s\xE9lection des temps factur\xE9s",showLoaderOnConfirm:!0,preConfirm:()=>[document.getElementById("dtFrom").value,document.getElementById("dtTo").value],onRender:i=>{},onOpen:i=>{e===!0&&i.querySelector("#dtFrom").addEventListener("change",_handler=function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:i=>{e===!0&&i.querySelector("#dtFrom").removeEventListener("change",_handler)},onAfterClose:i=>{},onDestroy:i=>{}});return f=dayjs(t[0]),n=dayjs(t[1]),await Qe(250),[f,n]},Ct=async function(f){await Swal.fire({position:"top-end",icon:"success",title:f,showConfirmButton:!1,timer:1500})};var tt=class{},bt=tt;q(bt,"tbl_name","f_archives"),q(bt,"add",async function(n){let e=V.Cfg.dbase,s=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]"),t={id:n[0].to.format("YYYYMM"),data:n,created_at:n[0].now};console.log(`%cWill create archive for id ${n[0].to.format("YYYYMM")} (YYYYMM)`,O),e.get(tt.tbl_name).push(JSON.parse(JSON.stringify(t))).write()}),q(bt,"exists",function(n){return V.Cfg.dbase.get(tt.tbl_name).find({id:n}).value()!==void 0}),q(bt,"get",function(n){var s=V.Cfg.dbase.get(tt.tbl_name).find({id:n}).value();if(s===void 0)throw Error("Erreur qui ne devrait jamais arriver en Archive.get");return console.log(`%cWill use archive for id ${n} (YYYYMM)`,O),s}),q(bt,"delete",function(n=null,e=null){let s=V.Cfg.dbase;if(typeof n=="string"&&(n=n.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),n===null&&e==null){console.log("%cWanna suppress ALL Archives from DB ",O),s.get(tt.tbl_name).remove().write();return}if(e==null){s.get(tt.tbl_name).remove(function(t){return dayjs(t.id,"YYYYMM").isBefore(e),"month"}).write();return}if(n==null){s.get(tt.tbl_name).remove(function(t){return dayjs(t.id,"YYYYMM").isAfter(n,"month")}).write();return}s.get(tt.tbl_name).remove(function(t){return dayjs(t.id,"YYYYMM").isBetween(n,e,"month","[]")}).write()});var vt=bt;var Kt=class{},$t=Kt;q($t,"isInOldMode",function(n){var e=null;typeof n=="string"?e=dayjs(n):e=n;try{return e.isBefore(Kt.getOldModeDate())}catch(s){throw Error("Erreur qui ne devrait jamais arriver en IsInOldMode (probablement un probleme sur la conversion de la date en objet dayjs:"+s.stack||s)}}),q($t,"getOldModeDate",function(){return dayjs("2020-06-01")}),q($t,"getAppVersion",function(){return GM.info.script.version});var xe=$t;var gr=function(){let f="students_history",n=1,e=2,s=function(v){if(v.toUpperCase()==="FUNDING")return n;if(v.toUpperCase()==="PATH")return e;throw Error("Erreur qui ne devrait jamais arriver en getype")},t=function(v,S,h=null){return u(v,n,S,h)},i=function(v,S,h=null){return u(v,e,S,h)},u=function(v,S,h,w=null){let b=!1;typeof v=="number"&&(v=v.toString(10)),se(typeof v=="string","You must provide a string.",TypeError);let T=V.Cfg.dbase;typeof w=="string"&&(w=dayjs(w)),w===null&&(w=dayjs()),se(w instanceof dayjs,"created date must be a string, a dayjs instance or null.",TypeError);let x={id:v,type:0|S,value:h,date:w.valueOf(),humanDate:w.format("YYYY-MM-DDTHH:mm:ssZZ")};return b===!0&&console.log(`%cAdd in student history at date ${dayjs(x.date).format("YYYY-MM-DDTHH:mm:ssZZ")} data ${h} with type:${S} cf const of object`,O),T.get(f).push(JSON.parse(JSON.stringify(x))).write()},l=function(v,S=null,h=null){let w=V.Cfg.dbase;return v==null&&S==null&&h==null?(console.log("%cRemove all in student history",O),w.get(f).remove().write()):(typeof h=="string"&&(h=dayjs(h)),h==null?S==null?(console.log(`%cRemove for student id:${v} history for all type of event`,O),w.get(f).remove({id:v}).write()):(console.log(`%cRemove for student id:${v} history with event type:${S} cf const of object`,O),w.get(f).remove({id:v,type:S}).write()):(console.log(`%cRemove for student id:${v} history at date ${h.format("DD/MM/YYYY")} with event type:${S} cf const of object`,O),w.get(f).remove({id:v,type:S,date:h.valueOf()}).write()))},c=function(v,S,h=null){let w=!1,b=V.Cfg.dbase;typeof h=="string"&&(h=dayjs(h)),h===null&&(h=dayjs()),w===!0&&console.log("%cSearching in student history at date %o ",O,h),w===!0&&console.log(`%cSearching in student history at date ${h.format("DD/MM/YYYY")} any data with type:${S} cf const of object`,O);var T=+h.valueOf(),x=b.get(f).filter(m=>m.id===v&&m.type&S).map(m=>m.date-T).filter(m=>m>=0).value();if(x.length==0){w===!0&&console.log(`%cThere is no data in student history at date ${h.format("DD/MM/YYYY")} with type:${S} cf const of object`,O);return}let y=T+(m=>Math.min(...m))(x);return b.get(f).filter(m=>m.id===v&&m.type&S&&m.date==y).value()[0]},d=function(v){return o(v,n)},p=function(v){return o(v,e)},o=function(v,S){return v.type&S};return Object.freeze({addFunding:t,addPath:i,getType:s,remove:l,find:c,isFunding:d,isPath:p,tbl_name:f})},hr=gr(),Ue=hr;var yr=function(){let f={},n="0",e=!0,s="https://api.openclassrooms.com",t="pending",i="canceled",u="completed",l="late canceled",c="marked student as absent",d=async function(){let C=await o();return C=JSON.parse(C),n=C.id,n},p=async function(){if(f.length==0)throw new Error("_header is empty, no xhr have been trapped so could't do some api request")},o=async function(){let C=s+"/me";return await j(C)},v=function(C,D){return{Range:`items=${C}-${D}`}},S=async(C=dayjs(),D=0,N=19)=>await b("AFTER",C,[t],D,N),h=async(C=dayjs(),D=0,N=19)=>await b("BEFORE",C,[t],D,N),w=async(C,D=0,N=19)=>await T(C,D,N),b=async function(C="BEFORE",D,N=[i,u,l,c],Y=0,F=19){bDebug=!0,typeof D=="string"&&(D=dayjs(D)),se(Wt(N)===!0,"You must provide an array as param aFilter.",TypeError),se(D instanceof dayjs,"date must be a string or a dayjs object.",TypeError);let k=N.join(","),B=encodeURIComponent(D.format("YYYY-MM-DDTHH:MM:ss[Z]"));k=encodeURIComponent(k);let $="";n==0&&await d(),C==="AFTER"?($=`${s}/users/${n}/sessions?actor=expert&after=${B}&life-cycle-status=${k}`,console.log("URL IS %s",$)):($=`${s}/users/${n}/sessions?actor=expert&before=${B}&life-cycle-status=${k}`,console.log("URL IS %s",$));let P=v(Y,F);return bDebug&&console.log("%c_getSessionOnDate url to call is:%s , params are %o",O,$,P),await g($,v(Y,F))},T=async function(C=[],D=0,N=19){bDebug=!0,se(Wt(C)===!0,"You must provide an array as param aFilter.",TypeError),C.length==0&&(C=[i,u,l,c]);let Y=C.join(",");Y=encodeURIComponent(Y),n==0&&await d();let F=`${s}/users/${n}/sessions?actor=expert&life-cycle-status=${Y}`,k=v(D,N);bDebug&&console.log("%cUrl to call is:%o , params are %o",O,F,k);let B=await g(F,k);if(B==null)throw console.error("%cAPI have a problem returned value %o is null|undefined",le,B),new Error(`Request:${s}/users/${n}/sessions?actor=expert&life-cycle-status=${Y} have a problem`);return B.errors&&console.log("%cAPI return an error %s",le,B.errors.message),B},x=async function(C){let D=`${s}/users/${C}`;return await g(D)},E=async function(C){await p();let D=`${s}/users/${C}/paths/followed-path`;return await g(D)},y=async function(C){let D=`${s}/users/${C}/paths`;return await g(D)},m=async function(C=null){if(C===null){let Y=await o();Y=JSON.parse(Y),C=Y.id}let D=`${s}/mentors/${C}/students`;return await g(D)},g=async function(C,D={}){return await p(),await j(C,D)},a=async function(C){return await p(),await L(C,mData)},A=function(C){n=C},M=function(C){return decodeURI(C)!==decodeURIComponent(C)},j=async function(C="",D={},N="json",Y="",F=!0){let k=Object.assign({"User-Agent":"Mozilla/5.0"},f,D);if(N.toLowerCase()==="json")return(await ft.XHR({method:"GET",url:C,responseType:"application/json",headers:k}).catch(P=>{console.error("%c[Api_fetchGer()]Error is %o",le,P)})).responseText;if(N.toLowerCase==="html"){let $=await ft.XHR({method:"GET",url:C,responseType:"application/json",headers:k}).catch(ue=>{console.error("%c[Api_fetchGer()]Error is %o",le,ue)}),ie=new DOMParser().parseFromString($.responseText.replace(/\n/mg,""),"text/html");var B={};return F===!0?B=ie.querySelectorAll(Y):B=ie.querySelector(Y),B}},L=async function(C="",D={},N={}){};return function(){let C=!1,D="color:DarkSalmon;background-color:AliceBlue;";var N=window.XMLHttpRequest.prototype.open,Y=window.XMLHttpRequest.prototype.send,F=window.XMLHttpRequest.prototype.setRequestHeader,k=function(ie,ue,pe,me,ye){return C===!0&&console.log("%cmethod %o url:%o, async:%o, user %o, password:%o",D,ie,ue,pe,me,ye),this._url=ue,this._requestHeaders={},this._knox=[],N.apply(this,arguments)},B=function(){if(C===!0&&console.log("%cReady state changed to: %o",D,this.readyState),this.readyState===4&&this.status&&this.status>=200&&this.status<300){if(this._url.match(/^https:\/\/api.openclassrooms.com/g)){C===!0&&console.log("%cOPENCLASSROOMS API",D);for(var ie in this._knox)f[this._knox[ie].key]=this._knox[ie].value;C===!0&&console.log("%c _header is %o",D,f),C===!0&&(M(this._url)?console.log("%cDECODED URL:%s",D,decodeURIComponent(this._url)):console.log("%c DECODED URL:%s",D,decodeURI(this._url)))}C===!0&&console.log("%cResponse is :%o",D,this.response)}if(this._onreadystatechange)return this._onreadystatechange.apply(this,arguments)},$=function(ie){return C===!0&&console.log("%csendReplacement(%o)",D,ie),this.onreadystatechange&&(this._onreadystatechange=this.onreadystatechange),this.onreadystatechange=B,Y.apply(this,arguments)},P=function(ie,ue){return this._url.match(/^https:\/\/api.openclassrooms.com/g)&&this._knox.push({key:ie,value:ue}),this._requestHeaders[ie]=ue,F.apply(this,arguments)};window.XMLHttpRequest.prototype.open=k,window.XMLHttpRequest.prototype.send=$,window.XMLHttpRequest.prototype.setRequestHeader=P}(),Object.freeze({forge:A,getPendingSessionAfter:S,getPendingSessionBefore:h,getHistorySession:w,getUserStudents:m,getUser:x,getUserFollowedPath:E,getUserPath:y,getMe:o,xGet:g,xPost:a})},br=yr(),Tt=br;var te=(f,n)=>function(){return n||(0,f[Object.keys(f)[0]])((n={exports:{}}).exports,n),n.exports},Ye=te({"src/lib/isFunction.js"(f,n){n.exports=function(s){return typeof s=="function"}}}),We=te({"src/lib/isNil.js"(f,n){n.exports=function(s){return s==null}}}),vr=te({"src/lib/fail.js"(f,n){n.exports=function(s){throw new TypeError("[tcomb] "+s)}}}),Yt=te({"src/lib/getFunctionName.js"(f,n){n.exports=function(s){return s.displayName||s.name||"<function"+s.length+">"}}}),jn=te({"src/lib/stringify.js"(f,n){var e=Yt();function s(t,i){return typeof i=="function"?e(i):i}n.exports=function(i){try{return JSON.stringify(i,s,2)}catch(u){return String(i)}}}}),we=te({"src/lib/assert.js"(f,n){var e=Ye(),s=We(),t=vr(),i=jn();function u(l,c){l!==!0&&(e(c)?c=c():s(c)&&(c='Assert failed (turn on "Pause on exceptions" in your Source panel)'),u.fail(c))}u.fail=t,u.stringify=i,n.exports=u}}),Ht=te({"src/lib/isString.js"(f,n){n.exports=function(s){return typeof s=="string"}}}),nt=te({"src/lib/isArray.js"(f,n){n.exports=function(s){return Array.isArray?Array.isArray(s):s instanceof Array}}}),rt=te({"src/lib/isObject.js"(f,n){var e=We(),s=nt();n.exports=function(i){return!e(i)&&typeof i=="object"&&!s(i)}}}),Be=te({"src/lib/isType.js"(f,n){var e=Ye(),s=rt();n.exports=function(i){return e(i)&&s(i.meta)}}}),Oe=te({"src/lib/getTypeName.js"(f,n){var e=Be(),s=Yt();n.exports=function(i){return e(i)?i.displayName:s(i)}}}),Bt=te({"src/lib/forbidNewOperator.js"(f,n){var e=we(),s=Oe();n.exports=function(i,u){e(!(i instanceof u),function(){return"Cannot use the new operator to instantiate the type "+s(u)})}}}),Fe=te({"src/lib/irreducible.js"(f,n){var e=we(),s=Ht(),t=Ye(),i=Bt();n.exports=function(l,c){function d(p,o){return p}return d.meta={kind:"irreducible",name:l,predicate:c,identity:!0},d.displayName=l,d.is=c,d}}}),Jt=te({"src/lib/Any.js"(f,n){var e=Fe();n.exports=e("Any",function(){return!0})}}),wr=te({"src/lib/Array.js"(f,n){var e=Fe(),s=nt();n.exports=e("Array",s)}}),Ut=te({"src/lib/isBoolean.js"(f,n){n.exports=function(s){return s===!0||s===!1}}}),$n=te({"src/lib/Boolean.js"(f,n){var e=Fe(),s=Ut();n.exports=e("Boolean",s)}}),Ar=te({"src/lib/Date.js"(f,n){var e=Fe();n.exports=e("Date",function(s){return s instanceof Date})}}),Sr=te({"src/lib/Error.js"(f,n){var e=Fe();n.exports=e("Error",function(s){return s instanceof Error})}}),qt=te({"src/lib/Function.js"(f,n){var e=Fe(),s=Ye();n.exports=e("Function",s)}}),Yn=te({"src/lib/Nil.js"(f,n){var e=Fe(),s=We();n.exports=e("Nil",s)}}),Zt=te({"src/lib/isNumber.js"(f,n){n.exports=function(s){return typeof s=="number"&&isFinite(s)&&!isNaN(s)}}}),Bn=te({"src/lib/Number.js"(f,n){var e=Fe(),s=Zt();n.exports=e("Number",s)}}),qe=te({"src/lib/isTypeName.js"(f,n){var e=We(),s=Ht();n.exports=function(i){return e(i)||s(i)}}}),it=te({"src/lib/isIdentity.js"(f,n){var e=we(),s=$n(),t=Be(),i=Oe();n.exports=function(l){return t(l)?l.meta.identity:!0}}}),ot=te({"src/lib/create.js"(f,n){var e=Be(),s=Yt(),t=we(),i=jn();n.exports=function(l,c,d){return e(l)?!l.meta.identity&&typeof c=="object"&&c!==null?new l(c,d):l(c,d):c}}}),st=te({"src/lib/is.js"(f,n){var e=Be();n.exports=function(t,i){return e(i)?i.is(t):t instanceof i}}}),Xt=te({"src/lib/refinement.js"(f,n){var e=we(),s=qe(),t=Ye(),i=Bt(),u=it(),l=ot(),c=st(),d=Oe(),p=Yt();function o(S,h){return"{"+d(S)+" | "+p(h)+"}"}function v(S,h,w){var b=w||o(S,h),T=u(S);function x(E,y){var m=l(S,E,y);return m}return x.meta={kind:"subtype",type:S,predicate:h,name:w,identity:T},x.displayName=b,x.is=function(E){return c(E,S)&&h(E)},x.update=function(E,y){return x(e.update(E,y))},x}v.getDefaultName=o,n.exports=v}}),xr=te({"src/lib/Integer.js"(f,n){var e=Xt(),s=Bn();n.exports=e(s,function(t){return t%1==0},"Integer")}}),Er=te({"src/lib/Object.js"(f,n){var e=Fe(),s=rt();n.exports=e("Object",s)}}),Cr=te({"src/lib/RegExp.js"(f,n){var e=Fe();n.exports=e("RegExp",function(s){return s instanceof RegExp})}}),en=te({"src/lib/String.js"(f,n){var e=Fe(),s=Ht();n.exports=e("String",s)}}),Tr=te({"src/lib/Type.js"(f,n){var e=Fe(),s=Be();n.exports=e("Type",s)}}),tn=te({"src/lib/dict.js"(f,n){var e=we(),s=qe(),t=Ye(),i=Oe(),u=it(),l=rt(),c=ot(),d=st();function p(v,S){return"{[key: "+i(v)+"]: "+i(S)+"}"}function o(v,S,h){var w=h||p(v,S),b=i(v),T=i(S),x=u(v)&&u(S);function E(y,m){if(x)return y;var g=!0,a={};for(var A in y)if(y.hasOwnProperty(A)){A=c(v,A,null);var M=y[A],j=c(S,M,null);g=g&&M===j,a[A]=j}return g&&(a=y),a}return E.meta={kind:"dict",domain:v,codomain:S,name:h,identity:x},E.displayName=w,E.is=function(y){if(!l(y))return!1;for(var m in y)if(y.hasOwnProperty(m)&&(!d(m,v)||!d(y[m],S)))return!1;return!0},E.update=function(y,m){return E(e.update(y,m))},E}o.getDefaultName=p,n.exports=o}}),nn=te({"src/lib/mixin.js"(f,n){var e=We(),s=we();n.exports=function(i,u,l){if(e(u))return i;for(var c in u)u.hasOwnProperty(c)&&(i[c]=u[c]);return i}}}),kn=te({"src/lib/isUnion.js"(f,n){var e=Be();n.exports=function(t){return e(t)&&t.meta.kind==="union"}}}),Dr=te({"src/lib/declare.js"(f,n){var e=we(),s=qe(),t=Be(),i=We(),u=nn(),l=Oe(),c=kn(),d=1;n.exports=function(o){var v;function S(h,w){return v(h,w)}return S.define=function(h){return c(h)&&S.hasOwnProperty("dispatch")&&(h.dispatch=S.dispatch),v=h,u(S,v,!0),o&&(v.displayName=S.displayName=o,S.meta.name=o),S.meta.identity=v.meta.identity,S.prototype=v.prototype,S},S.displayName=o||l(S)+"$"+d++,S.meta={identity:!1},S.prototype=null,S}}}),Mr=te({"src/lib/enums.js"(f,n){var e=we(),s=qe(),t=Bt(),i=Zt(),u=Ht(),l=rt();function c(p){return Object.keys(p).map(function(o){return e.stringify(o)}).join(" | ")}function d(p,o){var v=o||c(p);function S(h,w){return h}return S.meta={kind:"enums",map:p,name:o,identity:!0},S.displayName=v,S.is=function(h){return(u(h)||i(h))&&p.hasOwnProperty(h)},S}d.of=function(p,o){p=u(p)?p.split(" "):p;var v={};return p.forEach(function(S){v[S]=S}),d(v,o)},d.getDefaultName=c,n.exports=d}}),Ln=te({"src/lib/list.js"(f,n){var e=we(),s=qe(),t=Ye(),i=Oe(),u=it(),l=ot(),c=st(),d=nt();function p(v){return"Array<"+i(v)+">"}function o(v,S){var h=S||p(v),w=i(v),b=u(v);function T(x,E){if(b)return x;for(var y=!0,m=[],g=0,a=x.length;g<a;g++){var A=x[g],M=l(v,A,null);y=y&&A===M,m.push(M)}return y&&(m=x),m}return T.meta={kind:"list",type:v,name:S,identity:b},T.displayName=h,T.is=function(x){return d(x)&&x.every(function(E){return c(E,v)})},T.update=function(x,E){return T(e.update(x,E))},T}o.getDefaultName=p,n.exports=o}}),Nr=te({"src/lib/isMaybe.js"(f,n){var e=Be();n.exports=function(t){return e(t)&&t.meta.kind==="maybe"}}}),Or=te({"src/lib/maybe.js"(f,n){var e=we(),s=qe(),t=Ye(),i=Nr(),u=it(),l=Jt(),c=ot(),d=Yn(),p=Bt(),o=st(),v=Oe();function S(w){return"?"+v(w)}function h(w,b){if(i(w)||w===l||w===d)return w;var T=b||S(w),x=u(w);function E(y,m){return d.is(y)?y:c(w,y,m)}return E.meta={kind:"maybe",type:w,name:b,identity:x},E.displayName=T,E.is=function(y){return d.is(y)||o(y,w)},E}h.getDefaultName=S,n.exports=h}}),Pn=te({"src/lib/getDefaultInterfaceName.js"(f,n){var e=Oe();function s(t){return"{"+Object.keys(t).map(function(i){return i+": "+e(t[i])}).join(", ")+"}"}n.exports=s}}),Ir=te({"src/lib/isStruct.js"(f,n){var e=Be();n.exports=function(t){return e(t)&&t.meta.kind==="struct"}}}),jr=te({"src/lib/isInterface.js"(f,n){var e=Be();n.exports=function(t){return e(t)&&t.meta.kind==="interface"}}}),$r=te({"src/lib/decompose.js"(f,n){var e=Be();function s(l){return e(l)&&l.meta.kind==="subtype"}function t(l){return s(l)?[l.meta.predicate].concat(t(l.meta.type)):[]}function i(l){return s(l)?i(l.meta.type):l}function u(l){return{predicates:t(l),unrefinedType:i(l)}}n.exports=u}}),Fn=te({"src/lib/extend.js"(f,n){var e=we(),s=Ye(),t=nt(),i=nn(),u=Ir(),l=jr(),c=rt(),d=Xt(),p=$r();function o(b,T,x){var E=b.reduce(function(y,m){return d(y,m)},T);return x&&(E.displayName=x,E.meta.name=x),E}function v(b){return c(b)?b:b.meta.props}function S(b){return c(b)?null:b.meta.defaultProps}function h(b,T){Array.prototype.push.apply(b,T)}function w(b,T,x){var E={},y={},m=[],g={};T.forEach(function(A,M){var j=p(A),L=j.unrefinedType;h(m,j.predicates),i(E,v(L)),i(y,L.prototype),i(g,S(L),!0)}),x=b.getOptions(x),x.defaultProps=i(g,x.defaultProps,!0);var a=o(m,b(E,{strict:x.strict,defaultProps:x.defaultProps}),x.name);return i(a.prototype,y),a}n.exports=w}}),Yr=te({"src/lib/struct.js"(f,n){var e=we(),s=qe(),t=en(),i=qt(),u=Ut(),l=rt(),c=We(),d=ot(),p=Oe(),o=tn(),v=Pn(),S=Fn();function h(x){return"Struct"+v(x)}function w(x,E){return S(T,x,E)}function b(x){return l(x)||(x=c(x)?{}:{name:x}),x.hasOwnProperty("strict")||(x.strict=T.strict),x.hasOwnProperty("defaultProps")||(x.defaultProps={}),x}function T(x,E){E=b(E);var y=E.name,m=E.strict,g=E.defaultProps,a=y||h(x);function A(M,j){if(A.is(M))return M;if(!(this instanceof A))return new A(M,j);for(var L in x)if(x.hasOwnProperty(L)){var I=x[L],C=M[L];C===void 0&&(C=g[L]),this[L]=d(I,C,null)}}return A.meta={kind:"struct",props:x,name:y,identity:!1,strict:m,defaultProps:g},A.displayName=a,A.is=function(M){return M instanceof A},A.update=function(M,j){return new A(e.update(M,j))},A.extend=function(M,j){return w([A].concat(M),j)},A}T.strict=!1,T.getOptions=b,T.getDefaultName=h,T.extend=w,n.exports=T}}),Rn=te({"src/lib/tuple.js"(f,n){var e=we(),s=qe(),t=Ye(),i=Oe(),u=it(),l=nt(),c=ot(),d=st();function p(v){return"["+v.map(i).join(", ")+"]"}function o(v,S){var h=S||p(v),w=v.every(u);function b(T,x){if(w)return T;for(var E=!0,y=[],m=0,g=v.length;m<g;m++){var a=v[m],A=T[m],M=c(a,A,null);E=E&&A===M,y.push(M)}return E&&(y=T),y}return b.meta={kind:"tuple",types:v,name:S,identity:w},b.displayName=h,b.is=function(T){return l(T)&&T.length===v.length&&v.every(function(x,E){return d(T[E],x)})},b.update=function(T,x){return b(e.update(T,x))},b}o.getDefaultName=p,n.exports=o}}),Br=te({"src/lib/union.js"(f,n){var e=we(),s=qe(),t=Ye(),i=Oe(),u=it(),l=nt(),c=ot(),d=st(),p=Bt(),o=kn(),v=We();function S(w){return w.map(i).join(" | ")}function h(w,b){var T=b||S(w),x=w.every(u);function E(y,m){if(x)return y;var g=E.dispatch(y);return!g&&E.is(y)?y:c(g,y,m)}return E.meta={kind:"union",types:w,name:b,identity:x},E.displayName=T,E.is=function(y){return w.some(function(m){return d(y,m)})},E.dispatch=function(y){for(var m=0,g=w.length;m<g;m++){var a=w[m];if(o(a)){var A=a.dispatch(y);if(!v(A))return A}else if(d(y,a))return a}},E.update=function(y,m){return E(e.update(y,m))},E}h.getDefaultName=S,n.exports=h}}),kr=te({"src/lib/func.js"(f,n){var e=we(),s=qe(),t=qt(),i=nt(),u=Ln(),l=rt(),c=ot(),d=We(),p=Ut(),o=Rn(),v=Yt(),S=Oe(),h=Be();function w(E,y){return"("+E.map(S).join(", ")+") => "+S(y)}function b(E){return t.is(E)&&l(E.instrumentation)}function T(E){for(var y=E.length,m=!1,g=y-1;g>=0;g--){var a=E[g];if(!h(a)||a.meta.kind!=="maybe")return g+1;m=!0}return m?0:y}function x(E,y,m){E=i(E)?E:[E];var g=m||w(E,y),a=E.length,A=T(E);function M(j,L){return b(j)?j:M.of(j)}return M.meta={kind:"func",domain:E,codomain:y,name:m,identity:!0},M.displayName=g,M.is=function(j){return b(j)&&j.instrumentation.domain.length===a&&j.instrumentation.domain.every(function(L,I){return L===E[I]})&&j.instrumentation.codomain===y},M.of=function(j,L){if(M.is(j))return j;function I(){var C=Array.prototype.slice.call(arguments),D=C.length;if(!1)var N;if(L&&D<a){var Y=Function.prototype.bind.apply(j,[this].concat(C)),F=x(E.slice(D),y);return F.of(Y,!0)}else return c(y,j.apply(this,C))}return I.instrumentation={domain:E,codomain:y,f:j},I.displayName=v(j),I},M}x.getDefaultName=w,x.getOptionalArgumentsIndex=T,n.exports=x}}),Lr=te({"src/lib/intersection.js"(f,n){var e=we(),s=qe(),t=Ye(),i=nt(),u=it(),l=st(),c=Oe(),d=it();function p(v){return v.map(c).join(" & ")}function o(v,S){var h=S||p(v),w=v.every(d);function b(T,x){return T}return b.meta={kind:"intersection",types:v,name:S,identity:w},b.displayName=h,b.is=function(T){return v.every(function(x){return l(T,x)})},b.update=function(T,x){return b(e.update(T,x))},b}o.getDefaultName=p,n.exports=o}}),Hn=te({"src/lib/assign.js"(f,n){function e(s,t){for(var i in t)t.hasOwnProperty(i)&&(s[i]=t[i]);return s}n.exports=e}}),Pr=te({"src/lib/interface.js"(f,n){var e=we(),s=qe(),t=en(),i=qt(),u=Ut(),l=rt(),c=We(),d=ot(),p=Oe(),o=tn(),v=Pn(),S=it(),h=st(),w=Fn(),b=Hn();function T(y,m){return w(E,y,m)}function x(y){return l(y)||(y=c(y)?{}:{name:y}),y.hasOwnProperty("strict")||(y.strict=E.strict),y}function E(y,m){m=x(m);var g=m.name,a=m.strict,A=g||v(y),M=Object.keys(y).map(function(L){return y[L]}).every(S);function j(L,I){if(M)return L;if(!1&&a)for(var C in L);var D=!0,N=M?{}:b({},L);for(var Y in y){var F=y[Y],k=L[Y],B=d(F,k,null);D=D&&k===B,N[Y]=B}return D&&(N=L),N}return j.meta={kind:"interface",props:y,name:g,identity:M,strict:a},j.displayName=A,j.is=function(L){if(c(L))return!1;if(a){for(var I in L)if(!y.hasOwnProperty(I))return!1}for(var C in y)if(!h(L[C],y[C]))return!1;return!0},j.update=function(L,I){return j(e.update(L,I))},j.extend=function(L,I){return T([j].concat(L),I)},j}E.strict=!1,E.getOptions=x,E.getDefaultName=v,E.extend=T,n.exports=E}}),Fr=te({"src/lib/update.js"(f,n){var e=we(),s=rt(),t=Ye(),i=nt(),u=Zt(),l=Hn();function c(y){return s(y)?y instanceof Date||y instanceof RegExp?y:l({},y):i(y)?y.concat():y}function d(y){return o.commands.hasOwnProperty(y)}function p(y){return o.commands[y]}function o(y,m){var g=y,a=!1,A;for(var M in m)m.hasOwnProperty(M)&&(d(M)?(A=p(M)(m[M],g),A!==y?(a=!0,g=A):g=y):(g===y&&(g=c(y)),A=o(g[M],m[M]),a=a||A!==g[M],g[M]=A));return a?g:y}function v(y,m){return y(m)}function S(y,m){return y.length>0?m.concat(y):m}function h(y,m){if(y.length>0){m=c(m);for(var g=0,a=y.length;g<a;g++)delete m[y[g]]}return m}function w(y){return y}function b(y,m){return y.length>0?(m=c(m),y.reduce(function(g,a){return g.splice.apply(g,a),g},m)):m}function T(y,m){if(y.from!==y.to){m=c(m);var g=m[y.to];m[y.to]=m[y.from],m[y.from]=g}return m}function x(y,m){return y.length>0?y.concat(m):m}function E(y,m){var g=!1,a=c(m);for(var A in y)y.hasOwnProperty(A)&&(a[A]=y[A],g=g||a[A]!==m[A]);return g?a:m}o.commands={$apply:v,$push:S,$remove:h,$set:w,$splice:b,$swap:T,$unshift:x,$merge:E},n.exports=o}}),Rr=te({"src/lib/match.js"(f,n){var e=we(),s=Ye(),t=Be(),i=Jt();n.exports=function(l){for(var c,d,p,o,v=1,S=arguments.length;v<S;)if(c=arguments[v],d=arguments[v+1],p=arguments[v+2],s(p)&&!t(p)?v=v+3:(p=d,d=i.is,v=v+2),c.is(l)&&d(l))return p(l);e.fail("Match error")}}}),Hr=te({"src/index.js"(f,n){var e=we();e.Any=Jt(),e.Array=wr(),e.Boolean=$n(),e.Date=Ar(),e.Error=Sr(),e.Function=qt(),e.Nil=Yn(),e.Number=Bn(),e.Integer=xr(),e.IntegerT=e.Integer,e.Object=Er(),e.RegExp=Cr(),e.String=en(),e.Type=Tr(),e.TypeT=e.Type,e.Arr=e.Array,e.Bool=e.Boolean,e.Dat=e.Date,e.Err=e.Error,e.Func=e.Function,e.Num=e.Number,e.Obj=e.Object,e.Re=e.RegExp,e.Str=e.String,e.dict=tn(),e.declare=Dr(),e.enums=Mr(),e.irreducible=Fe(),e.list=Ln(),e.maybe=Or(),e.refinement=Xt(),e.struct=Yr(),e.tuple=Rn(),e.union=Br(),e.func=kr(),e.intersection=Lr(),e.subtype=e.refinement,e.inter=Pr(),e.interface=e.inter,e.assert=e,e.update=Fr(),e.mixin=nn(),e.isType=Be(),e.is=st(),e.getTypeName=Oe(),e.match=Rr(),n.exports=e}}),Ee=Hr();var Ur=Ee.struct({id:Ee.String,fullname:Ee.String,path:Ee.String,funding:Ee.String,created:Ee.String},"StudentData"),fe=class{static modifyFunding(n,e,s){typeof e=="string"&&(e=dayjs(e)),se(created instanceof dayjs,"modifyFunding date must be a string, a dayjs instance or null.",TypeError);let t=fe.getFunding(n,e);if(s.toLower()===t.toLower()){console.log(`%cFundingMode ${s} is identical as current: ${sCurrent}, nothing to do`,O);return}(s!==et||s!=$e||s!==pt)&&console.log(`%cWarning this state is unknown ${s}`,Xe);let i=V.Cfg.dbase,u=dayjs().format("YYYY-MM-DDTHH:mm:ssZZ");if(e===null&&(e=u),oLastHistory=Ue.find(n,Ue.getType("FUNDING"),e),i.get(fe.tbl_name).find({id:n}).assign({funding:s}).write(),Ue.addFunding(n,t,u),e.isSameOrAfter(xe.getOldModeDate()))var l=i.get("sessions").filter(function(d){return d.who_id===n&&dayjs(d.when).isSameOrAfter(e,"day")});else var l=i.get("sessions").filter(function(p){p.who_id===n&&dayjs(p.when).isSameOrAfter(xe.getOldModeDate(),"day")});for(var c=l.value().length;c-=1;)console.log(`There is ${c} elements left to update`,O),l.get(c).assign({funding:s}).write()}},_e=fe;q(_e,"tbl_name","students"),q(_e,"ocmapper",async function(n){let e=!1;try{let s=await fe.getFundingFomDashboard(n.id);e===!0&&console.log("%cocmapper() funding is %o",O,s);let t=n.id.toString(10),i=n.displayName,u=n.followedLearningPath.learningPathTitle,l;u.length==0?l="non d\xE9fini":l=u;let c=s.toLowerCase(),d=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");return Ur({id:t,fullname:i,path:l,funding:c,created:d})}catch(s){console.error("%c,IRRECOVERABLE ERROR in StudentData.ocmapper: %o",le,s)}}),q(_e,"add",function(n,e="noname",s="nopath",t="unknown",i){let u=V.Cfg.dbase;var l=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let c={id:n,fullname:e,path:s,funding:t,created:l};fe._save(c)}),q(_e,"_checkObject",function(n){!1===!0&&console.log("%cChecking object student:%o ",O,n),se(typeof n.id=="string","Student object id need to be a string.",TypeError),se(typeof n.fullname=="string","Student object fullname need to be a number.",TypeError),se(typeof n.path=="string","Student object path need to be a string.",TypeError),se(typeof n.funding=="string","Student object funding need to be a string.",TypeError),se(typeof n.created=="string","Student object created need to be a string.",TypeError)}),q(_e,"_save",function(n){let e=!1;fe._checkObject(n),e===!0&&console.log("%cSaving student %o to DB",O,n),V.Cfg.dbase.get(fe.tbl_name).push(JSON.parse(JSON.stringify(n))).write()}),q(_e,"exists",function(n,e=null){let s=!1,t=fe.findById(n,e);return s===!0&&console.log(`%cStudent ${n} exists in db ? ${t!==void 0}`,O),t!==void 0}),q(_e,"findById",function(n,e=null){let s=GM_config.get("use_student_cache");return s===!1&&console.log("%cache \xE9tudiant desactiv\xE9 dans les options",O),typeof n=="number"&&(n=n.toString(10)),se(typeof n=="string","You must provide a string.",TypeError),typeof e=="string"&&(e=dayjs(e)),e==null?s===!1?fe._findById(n,e):fe.m_findById(n,"null"):s===!1?fe._findById(n,e.toISOString()):fe.m_findById(n,e.toISOString())}),q(_e,"_findById",function(n,e=null){let s=!1,t=V.Cfg.dbase;typeof e=="string"&&(e=dayjs(e)),s===!0&&console.log(`%c_findById() searching student with id:(${typeof n})${n} in db`,O);var i=t.get(fe.tbl_name).find({id:n}).value();if(s===!0&&console.log("%c_findById() student %o is found",O,i),i!==void 0){if(e!==null){var u={...i},l=Ue.find(n,Ue.getType("FUNDING"),e);l!==void 0&&(u.funding=l.value);var c=Ue.find(n,Ue.getType("PATH"),e);return c!==void 0&&(u.path=c.value),u}return s===!0&&console.log("%c_findById() student final %o is found",O,i),i}}),q(_e,"m_findById",moize.default(fe._findById,{maxAge:6e5,isSerialized:!0})),q(_e,"getFunding",async function(n,e=null){return typeof e=="string"&&(e=dayjs(e)),await fe.m_getFunding(n,e)}),q(_e,"_getFunding",async function(n,e=null){let s=fe.findById(n,e);return s===void 0?(console.log('%c[Student._getFunding()]Student %s is not in db, fetching data:"funded mode" from webpage',O,n),s=await fe.getFundingFomDashboard(n),console.log("%c[Student._getFunding()]Student %s funding is %o",O,n,s),s.toLowerCase()):s.funding.toLowerCase()}),q(_e,"m_getFunding",moize.default(fe._getFunding,{maxAge:6e5,isSerialized:!0,isPromise:!0})),q(_e,"isAutoFunded",function(n){return console.log("%cFUNCTION DEPRECATED !!!!!!!!!!!!!!!!!!!!!! ",le),fe.getFunded(n).toLowerCase()===et}),q(_e,"getFundingFomDashboard",async function(n){return(await Rt(`https://openclassrooms.com/fr/mentorship/students/${n}/dashboard`,".mentorshipStudent__details > p")).innerText.trim()}),q(_e,"getPath",async function(n,e=null){let s=fe.findById(n,e);if(s==null){console.log(`%cStudent ${n} is not in db, fetching data: 'path' from webpage ....`,O);let t=await Rt(`https://openclassrooms.com/fr/mentorship/students/${n}/dashboard`,"a[href*='paths/']");return t.innerText.length==0&&console.error(`%cStudent path is not readable from url : https://openclassrooms.com/fr/mentorship/students/${n}/dashboard`,le),t.innerText.trim()}else return s.path}),q(_e,"delete",function(n=null,e=null){let s=V.Cfg.dbase;if(typeof n=="string"&&(n=n.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),n===null&&e==null){console.log("%cWanna suppress ALL Students from DB",O),s.get(fe.tbl_name).remove().write();return}if(e==null){s.get(fe.tbl_name).remove(function(t){return dayjs(t.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBefore(e,"day")}).write();return}if(n==null){s.get(fe.tbl_name).remove(function(t){return dayjs(t.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isAfter(n,"day")}).write();return}s.get(fe.tbl_name).remove(function(t){return dayjs(t.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBetween(n,e,"day","[]")}).write()}),q(_e,"deleteById",function(n,e=null){V.Cfg.dbase.get("students").remove(t=>t.id===n).write(),console.log(`%cAll students with id:${n} are removed from DataBase`,O)}),q(_e,"getAll",async(n,e)=>{let s=!0;var t=!1;let i=V.Cfg.dbase;var u="table.crud-list tbody";bDebug===!0&&console.log("%c[getAll()] Enter function",O);let l=await Tt.getUserStudents();var c=JSON.parse(l);bDebug===!0&&console.log("%cgetAll() collect this array of stundent %o",O,c);let d=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var p=performance.now();await fe.ocmapper(c[0]),bDebug===!0&&console.log(`%cEstimated time for updating : ${(performance.now()-p)*c.length} ms`,O),Swal.fire({position:"top-end",icon:"info",toast:!0,title:`mise \xE0 jour de la base de donn\xE9e des \xE9tudiants...
cela peut prendre du temps ~ ${(performance.now()-p)*c.length/1e3} s`,showConfirmButton:!1,timer:1e3}),await Qe(1e3),bDebug===!0&&console.log("%cWill process all students of board",O);for(let v of c){let S=await fe.ocmapper(v);bDebug===!0&&console.log('%c Working on student "%s"',O,S.fullname),Ct(`Collecte les donn\xE9es de l'\xE9tudiant : ${S.fullname}`);var o=fe.m_findById(S.id,null);if(o===void 0){bDebug===!0&&console.log(`%cStudent ${S.fullname} (id:${S.id}) not present in student database will create it`,O),fe.add(S.id,S.fullname,S.path,S.funding,S.created);continue}S.funding.toLowerCase()!==o.funding.toLowerCase()&&(i.get(fe.tbl_name).find({id:S.id}).assign({funding:S.funding}).write(),Ue.addFunding(S.id,o.funding,dayjs()),console.log(`%c[Student.getAll]Student ${S.fullname}(id:${S.id}) was already present in database but change of funding was detected (from ${o.funding.toLowerCase()} to ${S.funding.toLowerCase()})`,O)),S.path!==o.path&&(i.get(fe.tbl_name).find({id:S.id}).assign({path:S.path}).write(),Ue.addPath(S.id,o.path,dayjs()),console.log(`%c[Student.getAll]Student ${S.fullname}(id:${S.id}) was already present in database but change of path was detected (from ${o.path} to ${S.path})`,O))}}),q(_e,"showList",function(){let e=V.Cfg.dbase.get(fe.tbl_name).value();var s="";s+="<table>",s+="<caption>Liste des \xE9tudiant</caption>",s+="<thead>",s+="<tr>",s+="<th>Nom</th><th>Parcours</th><th>Financement</th><th>Date de cr\xE9ation</th><th>Edition</th>",s+="</tr>",s+="</thead>",s+="<tbody>";for(var t in e)s+="<tr>",s+=`<td>${e[t].fullname}</td><td>${e[t].path}</td><td>${e[t].funding}</td>`,s+=`<td>${dayjs(e[t].created,"YYYY-MM-DDTHH:mm:ssZ[Z]").format("DD/MM/YYYY \xE0 HH:mm")}</td>`,s+=`<td><a href="https://openclassrooms.com/fr/mentorship/students/${e[t].id}/dashboard">${e[t].id}</a></td>`,s+="</tr>";s+="</tbody>",s+="</table>",Swal.fire({title:"<strong>Liste des Etudiants</strong>",icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"fullscreen",onOpen:i=>{var u=i.querySelector("table"),l=new simpleDatatables.DataTable(u)}})}),q(_e,"createManually",async function(n,e,s){let t=["non pr\xE9sent dans la liste","Chef de projet digital","Chef de projet SI","D\xE9veloppeur d'application - Frontend","D\xE9veloppeur Web","Expert en strat\xE9gie marketing et communication ","Production de contenu web avec CMS et Content Marketing ","Tech lead"];var i="";i+="<style>",i+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",i+="form input {background: #fff;border: 1px solid #9c9c9c;}",i+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",i+="form button:hover {background: gold;}",i+="form label {padding: 0.5em 0.5em 0.5em 0;}",i+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",i+="form input:focus {outline: 3px solid gold;}",i+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",i+="</style>",i+='<form class="form1" action="">',i+='<label for="student_id" class="name">Reference</label>',i+='<input id="student_id" type="text" value="'+n+'">',i+='<label for="student_name" class="name">Name</label>',i+='<input id="student_name" type="text" value="'+e+'">',i+='<label for="funding">Autofinanc\xE9</label>',i+='<input id="funding" type="checkbox" value="autofunded">',i+='<label for="student_path">Parcours</label>',i+='<input id="student_path" name="student_path" type="text" list="student_path-list">',i+='<datalist id="student_path-list">';for(var u in t)i+=`<option>${t[u]}</option>`;i+="/<datalist>",i+='<label for="session_date">Date</label>',i+='<input id="session_date" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(s).format("YYYY-MM-DD")+'">',i+="</form>";let{value:l}=await Swal.fire({title:"<strong>Ajout d'un \xE9tudiant en mode manuel</strong>",icon:"info",html:i,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:`votre \xE9tudiant(e) ${e} n'a pas \xE9t\xE9 trouv\xE9`,preConfirm:()=>({student_id:document.getElementById("student_id").value,student_name:document.getElementById("student_name").value,student_path:document.getElementById("student_path").value,student_funding:document.getElementById("funding").checked,session_date:document.getElementById("session_date").value})});if(l&&l.hasOwnProperty("student_id")){var c="";l.student_funding===!0?c=et:c=$e,fe.add(l.student_id,l.student_name,l.student_path,c,l.session_date)}});var be=_e;var qr=function(){let f="refs",n=0,e=1,s=2,t={DEFAULT:0,SESSIONID_DATEREFID:1},i=function(){V.Cfg.dbase.get("refs").value()===void 0&&(console.log("%cDb dont' contain ref table create it",O),V.Cfg.dbase.assign({refs:[]}).write())},u=function(v,S,h=t.DEFAULT){let w=V.Cfg.dbase;var b=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let x=l({key1:v,key2:S,type:h,created:b,updated:b});In(50),se(Array.isArray(x)&&x.length>0,"Database insertion fail")},l=function(v){return V.Cfg.dbase.get(_t.tbl_name).push(JSON.parse(JSON.stringify(v))).write()};return Object.freeze({tbl_name:f,TYPE:t,add:u,updKey1:function(v,S,h=t.DEFAULT){let w=V.Cfg.dbase,b;b=w.get(_t.tbl_name).find(T=>T.key2===v&&T.type===h).assign({key1:S}).write(),console.log("%cNeedle  %o mValue %o sType %o",O,v,S,h),console.log("%c_r %o",O,b),se(Array.isArray(b)&&b.length>0,"Database insertion fail")},updKey2:function(v,S,h=t.DEFAULT){let w=V.Cfg.dbase,b;b=w.get(_t.tbl_name).find(T=>T.key1===v&&T.type===h).assign({key2:S}).write(),console.log("%cNeedle  %o mValue %o sType %o",O,v,S,h),console.log("%c_r %o",O,b),se(Array.isArray(b)&&b.length>0,"Database insertion fail")},checkSupport:i,exists:function(v,S,h=t.DEFAULT){let w=_t.getByKey(v,S,h);return console.log(`%cRef ${v} exists in db ? ${w!==void 0}`,O),w!==void 0},getByKey:function(v,S=1,h=t.DEFAULT){se(typeof S=="number","You must provide a number as index of key.",TypeError);let w=V.Cfg.dbase,b=null;if(S==1&&(b=w.get(_t.tbl_name).find(T=>T.key1===v&&T.type===h).value()),S==2&&(b=w.get(_t.tbl_name).find(T=>T.key2===v&&T.type===h).value()),b!=null)return b}})},_t=qr(),Te=_t;var Gr=function(){let f="meta",n=function(d){return se(typeof d=="string","You must provide a string.",TypeError),V.Cfg.dbase.get(kt.tbl_name).find({key:"dbVersion"}).assign({value:d}).write().value},e=function(){let d=V.Cfg.dbase.get(kt.tbl_name).find({key:"dbVersion"}).value();return typeof d=="undefined"?-1:d.value},s=function(){return V.Cfg.dbase.get("meta").remove(d=>!0).write()},t=function(){return console.log("%c resetDbVersion NE FONCTIONNE PAS",le),V.Cfg.dbase.get("meta").find({key:"dbVersion"}).remove(d=>!0).write()},i=function(d){return se(typeof d=="string","You must provide a string.",TypeError),V.Cfg.dbase.get(kt.tbl_name).find({key:"studentLstUpd"}).assign({value:d}).write().value},u=function(){let d=V.Cfg.dbase.get(kt.tbl_name).find({key:"studentLstUpd"}).value();return typeof d=="undefined"?-1:d.value};return Object.freeze({checkSupport:function(){V.Cfg.dbase.get("meta").value()===void 0&&(console.log("%cDb dont' contain meta table create it",O),V.Cfg.dbase.assign({meta:[]}).write()),e()==-1&&V.Cfg.dbase.get("meta").push({key:"dbVersion",value:"1.0.0"}).write(),u()==-1&&V.Cfg.dbase.get("meta").push({key:"studentLstUpd",value:dayjs("19701006").toISOString()}).write()},getDbVersion:e,setDbVersion:n,delDbVersion:t,setStudentListUpd:i,getStudentListUpd:u,remStudentListUpd:function(){return i(dayjs("19701006").toISOString())},tbl_name:f})},kt=Gr(),Ie=kt;var at=function(){let n="history_session_cache",e=!1,s=function(){e===!0&&console.log("%cDb dont' contain table history_session_cache table, will create it",O),V.Cfg.dbase.assign({history_session_cache:[]}).write()},t=function(){return V.Cfg.dbase.get(n).value()!==void 0};return{find:function(o){if(t===!1)throw new Error("%c_HistoryDb:DBFindInTable() failed reason : table is not defined",O);return e===!0&&console.log('%c_HistoryDb:DBFindInTable()  Request is App.Cfg.dbase.get("%s").find(%o).value()',O,n,o),V.Cfg.dbase.get(n).find(o).value()},getAll:function(){if(t===!1)throw new Error("%c_HistoryDb:DBGetAll() failed reason : table is not defined",O);return e===!0&&console.log('%c_HistoryDb:DBGetAll()  Request is App.Cfg.dbase.get("%s").value()',O,n),V.Cfg.dbase.get(n).value()},insert:function(o){return t===!1&&s(),e===!0&&console.log("%c_HistoryDb:DBInsertInTable table:%s data:%o)",O,n,o),V.Cfg.dbase.get(n).push(o).write()},remove:function(o={}){if(t===!1)throw new Error("%c_HistoryDb:DBRemove() failed reason : table is not defined",O);return e===!0&&console.log("%c_HistoryDb:DBRemove with filter",O),On(o)===!0&&console.log("%c_HistoryDb:DBRemove /! filter is empty",O),V.Cfg.dbase.get(n).remove(o).write()},reset:function(){return e===!0&&console.log("%c_History:DBResetTable",O),V.Cfg.dbase.get(n).remove().write()},update:function(o,v){if(t===!1)throw new Error("%c_HistoryDb:DBUpdateInTable() failed reason : table is not defined",O);return V.Cfg.dbase.get(n).find(o).assign(v).write()}}}(),Vr=function(){let f="history_session_cache",n=function(){let d=!0;V.Cfg.dbase.get("history_session_cache").value()===void 0&&(d&&console.log("%cDb dont' contain history_session_cache table create it",O),V.Cfg.dbase.assign({history_session_cache:[]}).write())},e=function(d){let p=!0;typeof d=="string"&&(d=dayjs(d)),se(d instanceof dayjs,"date must be a string or a dayjs object.",TypeError);let o=at.find({id:+d.format("YYYYMMDD")});return p&&console.log(`%cHistory:_exists ${d.format("YYYYMMDD")} in db ? ${o!==void 0}`,O),o!==void 0},s=function(d){let p=!0;if(typeof d=="string"&&(d=dayjs(d)),se(d instanceof dayjs,"date must be a string or a dayjs object.",TypeError),d.get("day")<d.daysInMonth()&&(d=d.endOf("month")),p===!0&&console.log(`%cSearch in history session cache data for id: ${d.format("DD/MM/YYYY")}`,O),e(d)===!0){if(_r=at.find({id:+d.format("YYYYMMDD")}),typeof _r.index!==void 0)return _r.index;throw new Error("_getSessionIndex() failed reason : property index is unknown")}return-1},t=function(d){let p=!1;typeof d=="string"&&(d=dayjs(d)),se(d instanceof dayjs,"date must be a string or a dayjs object.",TypeError),p===!0&&console.log(`%cSearch in history session cache NEAREST cached data for id: ${d.format("DD/MM/YYYY")}`,O);let o=+d.format("YYYYMMDD"),v=at.getAll();if(v.length===0)return p===!0&&console.log("%cHistory session cache is empty",O),-1;v=v.map(w=>+w.id-o).filter(w=>w>0);let S=w=>Math.min(...w);if(v.length==0)return p===!0&&console.log("%cAll indexes  %o are later than your date:%s",O,at.getAll(),d.format("DD/MM/YYYY")),-1;let h=S(v)+o;if(p===!0&&console.log("%cNearest data in history session cache is data with id: %o",O,h),e(h)===!0){if(v=at.find({id:+h.format("YYYYMMDD")}),typeof v.index!==void 0)return v.index;throw new Error("[History._getNearestSessionIndex()] failed reason : property index is unknown")}return-1};return Object.freeze({tbl_name:f,getSameOrNearestSessionIndex:function(d){let p=s(d);return p===-1&&(p=t(d)),p},remove:function(d=null,p=null){typeof d=="string"&&(d=dayjs(d)),typeof p=="string"&&(p=dayjs(p));let o=function(){};return d!==null&&p!==null&&(o=function(v){return dayjs(v.id.toString(10)).isBetween(d,p,"day","[]")}),d==null&&p!==null&&(o=function(v){return dayjs(v.id.toString(10)).isBefore(p,"day")}),d!=null&&p==null&&(o=function(v){return dayjs(v.id.toString(10)).isAfter(d,"day")}),at.remove(o)},reset:function(){return at.reset()},setSessionIndex:function(d,p=0){typeof d=="string"&&(d=dayjs(d)),se(d instanceof dayjs,"date must be a string or a dayjs object.",TypeError),d.get("day")<d.daysInMonth()&&(d=d.endOf("month"));let o=s(d);return o==-1?o=at.insert({id:+d.format("YYYYMMDD"),index:p}):o=at.update({id:+d.format("YYYYMMDD")},{index:p}),o}})},Qr=Vr(),wt=Qr;var zr=Ee.struct({id:Ee.String,cid:Ee.maybe(Ee.Integer),who_id:Ee.String,who_name:Ee.String,type:Ee.String,lvl:Ee.Integer,when:Ee.Date,path:Ee.String,funding:Ee.String},"SessionData");zr.prototype.ocmapper=function(f){};var Ae=class{static getBetween(n,e){return typeof n=="string"&&(n=dayjs(n)),typeof e=="string"&&(n=dayjs(e)),V.Cfg.dbase.get(Ae.tbl_name).filter(i=>dayjs(i.when).isSameOrBefore(e,"day")&&dayjs(i.when).isSameOrAfter(n,"day")).value()}},je=Ae;q(je,"tbl_name","sessions"),q(je,"_checkObject",function(n){!1===!0&&console.log("%cChecking object session:%o ",O,n),se(typeof n.id=="string","Session object id need to be a string.",TypeError),se(typeof n.cid=="number","Session object cid need to be a number.",TypeError),se(typeof n.who_id=="string","Session object who_id need to be a string.",TypeError),se(typeof n.who_name=="string","Session object who_name need to be a string.",TypeError),se(typeof n.status=="string","Session object status need to be a string.",TypeError),se(typeof n.type=="string","Session object type need to be a string.",TypeError),se(typeof n.lvl=="string","Session object lvl need to be a string.",TypeError),se(typeof n.when=="string","Session object when need to be a string.",TypeError),se(typeof n.path=="string","Session object path need to be a string.",TypeError),se(typeof n.funding=="string","Session object funding need to be a string.",TypeError)}),q(je,"add",async function(n){let e=30,s=!0;s===!0&&console.log("%cSession.add() so you wanna add a session %o to database",O,n);let t=V.Cfg.dbase;if(GM_config.get("checksessionalreadyexists")===!0)var i=!0;if(s===!0&&console.log("%cSession.add() will search if session %o is already in database",O,n),n.id.length>0){if(i===!0&&Ae.exists(n.id)===!0){s===!0&&console.info(`%cSession.add() session id:${n.id} already present in database table sessions, skip it!`,O);return}}else if(i===!0&&Ae.exists(n.cid)===!0){s===!0&&console.info(`%cSession.add() session cid:${n.cid} already present in database table sessions, skip it!`,O);return}n.type.toLowerCase()==="presentation"&&(n.type="soutenance"),xe.isInOldMode(dayjs(n.when))?(n.funding=$e,n.type.toLowerCase()==="soutenance"?n.path="n/a (defense)":n.path="n/a (old mode)"):n.type.toLowerCase()==="soutenance"?(n.funding=$e,n.path="n/a (defense)"):(be.exists(n.who_id)===!1&&(console.warn("%cStudent %s not in Db, will updating student db by fetching students list from dashboard",Xe,n.who_id),s===!0&&console.log("%cLast Update of Student BDD was %i min ago",O,dayjs(Ie.getStudentListUpd()).diff(dayjs(),"m")),dayjs(Ie.getStudentListUpd()).diff(dayjs(),"m")<-e?(await be.getAll(),Ie.setStudentListUpd(dayjs().toISOString())):(console.log("%c[Session.add()]last Update of database DB was less than %i min ago",O,e),await be.createManually(n.who_id,n.who_name,n.when),moize.default.isMoized(be.m_findById)&&be.m_findById.has([n.who_id,null])&&(be.m_findById.remove([n.who_id,null]),s===!0&&console.log("%c[Session.add()]student %s removed from the m_findById function cache",O,n.who_id))),console.log("%c[Student.add()] pr\xE9c\xE9demment notre \xE9tudiant %o  n'existait pas existe t'il maintenant ?",O,n.who_id),console.log("%c[Student.add()] la r\xE9ponse est :%o",O,be.exists(n.who_id,n.when)),be.exists(n.who_id,n.when)==!1&&(console.warn(`%c[Session.add()] Student ${n.who_id} which exists at ${n.when} still not exit in Db, have to manually create him/her`,Xe),await be.createManually(n.who_id,n.who_name,n.when),moize.default.isMoized(be.m_findById)&&be.m_findById.has([n.who_id,n.when])&&(be.m_findById.remove([n.who_id,n.when]),s===!0&&console.log("%c[Session.add()]student %s removed from the m_findById function cache",O,n.who_id)))),n.funding=await be.getFunding(n.who_id,n.when),n.path=await be.getPath(n.who_id,n.when)),n.cid===void 0&&(s===!0&&console.log("%c[Session.add()] need to calculate a cid]",O),n.cid=Ae.getHashId(n.when,n.who_id)),s===!0&&console.log("%cSession.add() calculated id:%s",O,n.cid),_r=Te.getByKey(n.cid,2,Te.TYPE.SESSIONID_DATEREFID),_r!==void 0&&(s===!0&&console.log("%cSession.add() I've found a ref %d by using key (%s)%d",O,_r.key1,typeof n.cid,n.cid),n.id=_r.key1.toString()),Ae._save(n)}),q(je,"_save",function(n){var e=!1;Ae._checkObject(n),n.lvl==""&&(n.lvl="2"),n.lvl.lvl=parseInt(n.lvl.lvl,10),bDebug===!0&&console.log(`%c[Session._save()] saving session id:${n.id} of ${n.who_name}[cid:${n.cid}](${n.who_id}) at ${n.when} to DB`,O),V.Cfg.dbase.get(Ae.tbl_name).push(JSON.parse(JSON.stringify(n))).write()}),q(je,"exists",function(n){let e=V.Cfg.dbase;var s=!1;s===!0&&console.log(`%c[Session.exist()] will search existence of session id:(${typeof n})${n} in database`,O);var t=Ae.findById(n);return t!==void 0}),q(je,"findById",function(n){let e=V.Cfg.dbase;var s=e.get(Ae.tbl_name).find({id:n}).value();return s===void 0&&(s=e.get(Ae.tbl_name).find({cid:n}).value()),s}),q(je,"delete",function(n=null,e=null){let s=V.Cfg.dbase;if(typeof n=="string"&&(n=n.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),n===null&&e==null){console.log("%cWanna suppress ALL Sessions from DB",O),s.get(Ae.tbl_name).remove().write();return}if(e==null){s.get(Ae.tbl_name).remove(function(t){return dayjs(t.when).isBefore(e),"day"}).write();return}if(n==null){s.get(Ae.tbl_name).remove(function(t){return dayjs(t.when).isAfter(n,"day")}).write();return}s.get(Ae.tbl_name).remove(function(t){return dayjs(t.when).isBetween(n,e,"day","[]")}).write()}),q(je,"deleteById",function(n){V.Cfg.dbase.get("sessions").remove(s=>s.id===n).write(),console.log(`%cSession ${n} suppressed from DB`,O)}),q(je,"parseTable",function(n){var e=n.children[0].children[0].innerText,s=ut(n.children[0]),t=n.children[1].children[0].innerText.trim(),i=ut(n.children[1],-2),u=n.children[2].innerText.trim().toLowerCase(),l=n.children[3].children.length?n.children[3].children[0].innerText.trim().toLowerCase():"session",c=-1;n.children[4].children.length>0&&(c=n.children[4].children[0].innerText.trim()),e=Cn(e);var d={id:s,when:e,who_id:i,who_name:t,status:u,type:l,lvl:c};return d}),q(je,"getHashId",function(n,e){return n instanceof dayjs&&(n=n.toISOString()),typeof e=="number"&&(e=e.toString(10)),se(typeof n=="string"&&typeof e=="string","getId need two string",TypeError),Nn(n+e)}),q(je,"parseRow",function(n){!0===!0&&console.log("%cparseRow() Row is %o",O,n);var s=n.children[0].innerText.length>0?n.children[0].innerText.trim().toLowerCase():"session",t=n.children[0].querySelector("svg").getAttribute("aria-label").trim().toLowerCase(),i=n.children[1].querySelector("time").dateTime;i=dayjs(i).toISOString();var u=ut(n.children[2],-2),l=n.children[2].innerText.trim(),c=Ae.getHashId(i,u),d=n.children[3].innerText.trim();d=d.replace(/[^\d]/gmis,"");var p={id:"",cid:c,when:i,who_id:u,who_name:l,status:t,type:s,lvl:d};return p}),q(je,"getSessionsFromAPI",async function(n,e){let s=!1,t=999,i=0,u=!0,l=0,c=20;typeof n=="string"&&(n=dayjs(n)),se(n instanceof dayjs,"dtFrom must be a string or a dayjs object.",TypeError),typeof e=="string"&&(e=dayjs(e)),se(e instanceof dayjs,"dtTo must be a string or a dayjs object.",TypeError);let d=wt.getSameOrNearestSessionIndex(e);d!==void 0&&typeof d=="number"&&d>l&&(l=d);var p=e.diff(n,"d")+1;for(NProgress.start();u===!0;){if(i>t){console.error("%c[Session.getSessionsFromAPI()] EMERGENCY EXIT LOOP",le);break}i+=1;var o=l+(c-1),v=await Tt.getHistorySession([],l,o);if(v===null)throw new Error("Api.getHistorySession is null");var S=JSON.parse(v);if(S.errors)throw Object.entries(oSession.errors).forEach(b=>console.log("%cApi.getHistorySession send us some errors : %s",Xe,b[1].message)),new Error("Api.getHistorySession send us some errors ");s===!0&&console.log("%cgetSessionsFromAPI() Sessions are %o",O,S),l=o+1,oSession=Ae.parseRowFromApi(S[S.length-1]),console.log("%c[Session.getSessionsFromAPI()]La derni\xE8re session r\xE9cuper\xE9e par api date de:%s et nous collectons les sessions entre %s et %s",O,dayjs(oSession.when).format("DD/MM/YYYY"),dayjs(n).format("DD/MM/YYYY"),dayjs(e).format("DD/MM/YYYY")),s===!0&&console.log("%cgetSessionsFromAPI() last session of loaded page is %o",O,oSession),console.log("%c[Session.getSessionsFromAPI()] compare last session date %s avec la date de d\xE9but %s est ce ant\xE9rieur  %o",O,dayjs(oSession.when).format("DD/MM/YYYY"),dayjs(n).format("DD/MM/YYYY"),dayjs(oSession.when).isBefore(n)),dayjs(oSession.when).isBefore(n)===!0&&(u=!1,s===!0&&console.log("%cgetSessionsFromAPI() last session is before start date of parsing %s STOP browsing....",O,dayjs(oSession.dtFrom).format("DD/MM/YYYY")),wt.setSessionIndex(oSession.when,l));let w=S.filter(b=>dayjs(b.sessionDate).isBetween(n,e,"day","[]"));s===!0&&console.log("%cgetSessionsFromAPI() Filtered on date Sessions are %o",O,w);for(let b of w){oSession=Ae.parseRowFromApi(b),s===!0&&console.log("%cgetSessionsFromAPI()  will call Session.add() on %o",O,oSession);let T=await Ae.add(oSession);var h=dayjs(e).diff(oSession.when,"d")+1;NProgress.set(h/p)}l=o+1}NProgress.done(),await Ct(`Collecte des sessions du ${n.format("DD/MM/YYYY")} au ${e.format("DD/MM/YYYY")} termin\xE9e`)}),q(je,"parseRowFromApi",function(n){bDebug=!1,bDebug===!0&&console.log("%cparseRowFromApi() oSession is %o",O,n);let e={};return e.id="",e.who_id=n.recipient.id,typeof e.who_id=="number"&&(e.who_id=e.who_id.toString(10)),e.who_name=n.recipient.displayableName,n.status===wn&&(e.status=mt),n.status===An&&(e.status=lt),n.status===Sn&&(e.status=gt),n.status===xn&&(e.status=ht),e.status===void 0&&(e.status=n.status),e.type=n.type,e.type.toLowerCase()==="mentoring"&&(e.type="mentorat"),e.lvl=n.projectLevel,e.lvl==null&&(e.lvl=""),e.when=dayjs(n.sessionDate).toISOString(),e.path=null,e.funding=null,e.cid=Ae.getHashId(e.when,e.who_id),e});var De=je;var Lt=class{},Dt=Lt;q(Dt,"calculateBill",function(n,e){let s=e.format("YYYYMM");return vt.exists(s)===!0?(console.log(`%cUse Archived version ${s} of accounting`,O),vt.get(s).data):(typeof n=="string"&&(n=n.format("YYYY-MM-DD")),typeof e=="string"&&(e=e.format("YYYY-MM-DD")),Lt.m_calculateBill(n,e))}),q(Dt,"_calculateBill",function(n,e){typeof n=="string"&&(n=dayjs(n)),typeof e=="string"&&(e=dayjs(e));let s=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var t=0,i=0,u=performance.now();let d=V.Cfg.dbase.get(De.tbl_name).filter(a=>dayjs(a.when).isSameOrBefore(e,"day")&&dayjs(a.when).isSameOrAfter(n,"day")).value(),p=d.length,o={from:n,to:e,created_at:null,maxLevel:yt,number:0,amount:0,errors:{funding:[],level:[],path:[],status:[],type:[]},flatFee:[]},v=0,S=0,h=[];t=performance.now();let w=Lt.getPriceList(n);i=performance.now(),console.log("%cGetPriceList took "+(i-t)+" milliseconds.",Ve);let b=Mn([yt+1,yt+1,yt+1,yt+1]);for(var T=0;T<p;T+=1){let a=d[T];var x=0;a.status===mt&&(x=Z),a.status===lt&&(x=X),a.status===gt&&(x=K),(a.status===ht||a.status===Nt)&&(x=ee);var E=0;a.type.toLowerCase()==="session"&&(E=R),a.type.toLowerCase()==="mentorat"&&(E=_n),a.type.toLowerCase()==="soutenance"&&(E=H),a.path!=null&&a.path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&a.type!=="soutenance"&&(E=U);var y=0;let A=xe.isInOldMode(n);if(A===!0&&(y=a.isFunded===!0?z:Q),a.funding===et&&(y=Q),a.funding===$e&&(y=z),a.funding===pt&&(y=W),a.lvl==""){o.errors.level.push(a);continue}if(typeof a.lvl=="string"&&(a.lvl=parseInt(a.lvl,10)),a.lvl<0){o.errors.level.push(a);continue}if(A===!1&&a.funding!==et&&a.funding!==$e&&a.funding!==pt){o.errors.funding.push(a);continue}if(a.type.toLowerCase()!=="session"&&a.type.toLowerCase()!=="mentorat"&&E!==H&&E!==U){o.errors.type.push(a);continue}if(a.status!==mt&&a.status!==lt&&a.status!==gt&&a.status!==ht&&a.status!==Nt){o.errors.status.push(a);continue}let M=b.get(E,x,y,+a.lvl);M===void 0&&(M={number:0,amount:0,data:[]}),M.number+=1,v+=1,a.lvl<0?(M.amount+=0,S+=0):(M.amount+=1*w[a.lvl][E][x][y],S+=1*w[a.lvl][E][x][y]),M.data.push(a),b.set(E,x,y,+a.lvl,M),E===R&&y===Q&&a.status!==lt&&h.push({id:+a.who_id,who_id:a.who_id,who_name:a.who_name})}var m=[];t=performance.now(),m=_.uniqBy(h,"id"),o.flatFee=m,o.number=v,o.amount=S,o.number+o.errors.funding.length+o.errors.level.length+o.errors.path.length+o.errors.status.length+o.errors.type.length<p&&(console.log(`%cError total number of sessions is ${p} and total number of sessions in bill ${v} + all errors are different`,le),console.log("errors are",o.errors),console.log("sessions are",d)),o.created_at=s,b.set(0,0,0,0,o);var g=performance.now();return console.log("%cFunction took "+(g-u)+" milliseconds.",Ve),o.errors.funding.length+o.errors.level.length+o.errors.path.length+o.errors.status.length+o.errors.type.length>0&&console.log("%cWarning some errors found %o",Xe,o.errors),b}),q(Dt,"m_calculateBill",moize.default(Lt._calculateBill,{maxAge:12e4,isSerialized:!0})),q(Dt,"getPriceList",function(n){typeof n=="string"&&(n=dayjs(n));var e=[0,mn,gn,hn,yn,bn,vn];let s=xe.isInOldMode(n);var t=new Array(7);for(let i=1;i<=yt;i+=1){let u=e[i],l=e[i]/2,c=e[i]/4;s?(t[i]=new Array(3),t[i][R]=new Array(5),t[i][R][Z]=new Array(4),t[i][R][Z][Q]=u,t[i][R][Z][z]=u,t[i][R][Z][W]=u,t[i][R][X]=new Array(4),t[i][R][X][Q]=0,t[i][R][X][z]=0,t[i][R][X][W]=0,t[i][R][K]=new Array(4),t[i][R][K][Q]=l,t[i][R][K][z]=l,t[i][R][K][W]=l,t[i][R][ee]=new Array(4),t[i][R][ee][Q]=l,t[i][R][ee][z]=l,t[i][R][ee][W]=l,t[i][H]=new Array(5),t[i][H][Z]=new Array(4),t[i][H][Z][Q]=u,t[i][H][Z][z]=u,t[i][H][Z][W]=u,t[i][H][X]=new Array(4),t[i][H][X][Q]=0,t[i][H][X][z]=0,t[i][H][X][W]=0,t[i][H][K]=new Array(4),t[i][H][K][Q]=l,t[i][H][K][z]=l,t[i][H][K][W]=l,t[i][H][ee]=new Array(4),t[i][H][ee][Q]=l,t[i][H][ee][z]=l,t[i][H][ee][W]=l,t[i][U]=new Array(5),t[i][U][Z]=new Array(4),t[i][U][Z][Q]=u,t[i][U][Z][z]=u,t[i][U][Z][W]=u,t[i][U][X]=new Array(4),t[i][U][X][Q]=0,t[i][U][X][z]=0,t[i][U][X][W]=0,t[i][U][K]=new Array(4),t[i][U][K][Q]=l,t[i][U][K][z]=l,t[i][U][K][W]=l,t[i][U][ee]=new Array(4),t[i][U][ee][Q]=l,t[i][U][ee][z]=l,t[i][U][ee][W]=l):(t[i]=new Array(3),t[i][R]=new Array(5),t[i][R][Z]=new Array(4),t[i][R][Z][Q]=l,t[i][R][Z][z]=u,t[i][R][Z][W]=u,t[i][R][X]=new Array(4),t[i][R][X][Q]=0,t[i][R][X][z]=0,t[i][R][X][W]=0,t[i][R][K]=new Array(4),t[i][R][K][Q]=0,t[i][R][K][z]=0,t[i][R][K][W]=0,t[i][R][ee]=new Array(4),t[i][R][ee][Q]=c,t[i][R][ee][z]=l,t[i][R][ee][W]=l,t[i][H]=new Array(5),t[i][H][Z]=new Array(4),t[i][H][Z][Q]=u,t[i][H][Z][z]=u,t[i][H][Z][W]=u,t[i][H][X]=new Array(4),t[i][H][X][Q]=0,t[i][H][X][z]=0,t[i][H][X][W]=0,t[i][H][K]=new Array(4),t[i][H][K][Q]=0,t[i][H][K][z]=0,t[i][H][K][W]=0,t[i][H][ee]=new Array(4),t[i][H][ee][Q]=l,t[i][H][ee][z]=l,t[i][H][ee][W]=l,t[i][U]=new Array(5),t[i][U][Z]=new Array(4),t[i][U][Z][Q]=u,t[i][U][Z][z]=u,t[i][U][Z][W]=u,t[i][U][X]=new Array(4),t[i][U][X][Q]=0,t[i][U][X][z]=0,t[i][U][X][W]=0,t[i][U][K]=new Array(4),t[i][U][K][Q]=0,t[i][U][K][z]=0,t[i][U][K][W]=0,t[i][U][ee]=new Array(4),t[i][U][ee][Q]=l,t[i][U][ee][z]=l,t[i][U][ee][W]=l)}return t});var Ke=Dt;var rn=function(f,n){let e=[[0,1,2,3,4,5,5],[5,1,2,3,4,5,5],[4,5,1,2,3,4,4],[3,4,5,1,2,3,3],[2,3,4,5,1,2,2],[1,2,3,4,5,1,1],[0,1,2,3,4,5,0]];return Math.trunc(n.diff(f,"days")/7)*5+e[f.day()][n.day()]};var Mt=class{};q(Mt,"detail_bill","truc"),q(Mt,"getListDetailBill",function(n,e){let t=V.Cfg.dbase.get(De.tbl_name).filter(T=>dayjs(T.when).isSameOrBefore(e,"day")&&dayjs(T.when).isSameOrAfter(n,"day")).sortBy(function(T){return dayjs(T.when).valueOf()}).value(),i=xe.getOldModeDate(),u=Ke.getPriceList(i.subtract(1,"day")),l=Ke.getPriceList(i),c=0;var d=_.cloneDeep(t);for(var p in d){var o=0,v=0,S=!0,h=0;d[p].status===mt&&(h=Z),d[p].status===lt&&(h=X),d[p].status===gt&&(h=K),(d[p].status===ht||d[p].status===Nt)&&(h=ee);var w=0;d[p].type.toLowerCase()==="session"&&(w=R),d[p].type.toLowerCase()==="soutenance"&&(w=H),d[p].path!=null&&d[p].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&d[p].type!=="soutenance"&&(w=U);var b=0;d[p].funding===et&&(b=Q),d[p].funding===$e&&(b=z),d[p].funding===pt&&(b=W),xe.isInOldMode(dayjs(d[p].when))?o=+d[p].lvl>0?u[+d[p].lvl][w][h][b]:0:(S=!1,o=+d[p].lvl>0?l[+d[p].lvl][w][h][b]:0),c+=o,d[p].iPu=o,d[p].oldMode=S,d[p].iCumul=c}return d}),q(Mt,"getListStatistic",function(n,e){let s=n.clone(),t=s.endOf("month"),i=[],u=[],l=0,c=e.diff(n,"month");for(var d=performance.now();s.isSameOrBefore(e,"day");)i.push(Ke.calculateBill(s,t)),s=s.add(1,"month"),t=s.endOf("month");var p=performance.now();console.log("%cComputed data between the two dates in"+(p-d)+" milliseconds.",Ve),s=n.clone(),t=s.endOf("month");let o=0,v=0,S=0,h=0,w=0,b=0,T=0;for(;l<=c;){let E=i[l].get(0,0,0,0),y=E.maxLevel;u[l]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let m=1;for(;m<y;){let a=0,A=0,M=0,j=0;o=i[l].get(R,Z,Q,m),S=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(R,Z,z,m),v=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(R,Z,W,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=typeof o=="undefined"?0:o.number,xe.isInOldMode(s)?(u[l].kpi.hrs+=(o+v+S)*(45/60),u[l].kpi.hrsp+=(o+v+S)*(GM_config.get("nbHrsS")/60)):(u[l].kpi.hrs+=S*(30/60),u[l].kpi.hrsp+=S*(GM_config.get("nbHrsAfM")/60),u[l].kpi.hrs+=(o+v)*(45/60),u[l].kpi.hrsp+=(o+v)*(GM_config.get("nbHrsfM")/60)),o=i[l].get(R,X,Q,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(R,X,z,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(R,X,W,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,xe.isInOldMode(s)?(o=i[l].get(R,K,Q,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(R,K,z,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(R,K,W,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount):(o=i[l].get(R,K,Q,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(R,K,z,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(R,K,W,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount),o=i[l].get(R,ee,Q,m),S=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(R,ee,z,m),v=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(R,ee,W,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=typeof o=="undefined"?0:o,u[l].kpi.hrs+=(o+v+S)*(15/60),u[l].kpi.hrsp+=(o+v+S)*(15/60),a=u[l].sessions.total,A=u[l].sessions.nb,M=u[l].sessions.pu,j=u[l].sessions.nbc,u[l].sessions={total:w+a,nb:h+A,pu:(w+a)/(h+A),nbc:b+j},a=0,A=0,M=0,j=0,h=0,w=0,b=0,T=0,o=i[l].get(H,Z,Q,m),S=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(H,Z,z,m),v=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(H,Z,W,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=typeof o=="undefined"?0:o.number,u[l].kpi.hrs+=(o+v+S)*(45/60),u[l].kpi.hrsp+=(o+v+S)*(GM_config.get("nbHrsD")/60),o=i[l].get(H,X,Q,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(H,X,z,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(H,X,W,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(H,K,Q,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(H,K,z,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(H,K,W,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(H,ee,Q,m),S=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(H,ee,z,m),v=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(H,ee,W,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=typeof o=="undefined"?0:o.number,u[l].kpi.hrs+=(o+v+S)*(15/60),u[l].kpi.hrsp+=(o+v+S)*(15/60),a=u[l].defenses.total,A=u[l].defenses.nb,M=u[l].defenses.pu,j=u[l].defenses.nbc,u[l].defenses={total:w+a,nb:h+A,pu:(w+a)/(h+A),nbc:b+j},a=0,a=0,A=0,M=0,j=0,h=0,w=0,b=0,T=0,o=i[l].get(U,Z,Q,m),S=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(U,Z,z,m),v=typeof o=="undefined"?0:o.number,h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(U,Z,W,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=typeof o=="undefined"?0:o.number,u[l].kpi.hrs+=(o+v+S)*(45/60),u[l].kpi.hrsp+=(o+v+S)*(GM_config.get("nbHrsC")/60),o=i[l].get(U,X,Q,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(U,X,z,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(U,X,W,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(U,K,Q,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(U,K,z,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(U,K,W,m),b=typeof o=="undefined"?b:b+o.number,T=typeof o=="undefined"?T:T+o.amount,o=i[l].get(U,ee,Q,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(U,ee,z,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,o=i[l].get(U,ee,W,m),h=typeof o=="undefined"?h:h+o.number,w=typeof o=="undefined"?w:w+o.amount,a=u[l].coaches.total,A=u[l].coaches.nb,M=u[l].coaches.pu,j=u[l].coaches.nbc,o=typeof o=="undefined"?0:o.number,u[l].kpi.hrs+=o*(15/60),u[l].kpi.hrsp+=o*(15/60),u[l].coaches={total:w+a,nb:h+A,pu:(w+a)/(h+A),nbc:b+j},m+=1}let g=E.flatFee.length;for(var x=0;x<g;x+=1)u[l].bonus+=30;t.isAfter(e,"day")&&(t=e.clone()),u[l].kpi.jrs=rn(s,t),u[l].header.dtFrom=s.format("YYYY-MM-DD"),u[l].header.dtTo=t.format("YYYY-MM-DD"),u[l].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),s=s.add(1,"month"),t=s.endOf("month"),l+=1}return u}),q(Mt,"getListStatisticOld",function(n,e){let s=n.clone(),t=s.endOf("month"),i=[],u=[],l=e.get("month")-n.get("month");for(var c=performance.now();s.isSameOrBefore(e,"day");)i.push(Ke.calculateBill(s,t)),s=s.add(1,"month"),t=s.endOf("month");var d=performance.now();console.log("%cComputed data between the two dates in"+(d-c)+" milliseconds.",Ve);let p=0;for(s=n.clone(),t=s.endOf("month"),console.log(i);p<=l;){let o=i[p][0].max_level;u[p]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let v=1;for(;v<o;){let S=[...Array(8).keys()];for(let h=0;h<S.length;h+=1)u[p].sessions.total+=i[p][v].sessions.number[h]*i[p][v].sessions.pu[h],u[p].sessions.nb+=i[p][v].sessions.number[h],u[p].defenses.total+=i[p][v].defenses.number[h]*i[p][v].defenses.pu[h],u[p].defenses.nb+=i[p][v].defenses.number[h],xe.isInOldMode(s)?[1,5].includes(h)&&(u[p].sessions.nbc+=i[p][v].sessions.number[h],u[p].defenses.nbc+=i[p][v].defenses.number[h]):[1,2,5,6].includes(h)&&(u[p].sessions.nbc+=i[p][v].sessions.number[h],u[p].defenses.nbc+=i[p][v].defenses.number[h]),xe.isInOldMode(s)?(u[p].kpi.hrs+=(i[p][v].sessions.number[h]-i[p][v].defenses.number[h])*(45/60),u[p].kpi.hrsp+=(i[p][v].sessions.number[h]-i[p][v].defenses.number[h])*(GM_config.get("nbHrsfM")/60)):([4,5,6,7].includes(h)&&(u[p].kpi.hrs+=(i[p][v].sessions.number[h]-i[p][v].defenses.number[h])*(30/60),u[p].kpi.hrsp+=(i[p][v].sessions.number[h]-i[p][v].defenses.number[h])*(GM_config.get("nbHrsAfM")/60)),[0,1,2,3].includes(h)&&(u[p].kpi.hrs+=(i[p][v].sessions.number[h]-i[p][v].defenses.number[h])*(45/60),u[p].kpi.hrsp+=(i[p][v].sessions.number[h]-i[p][v].defenses.number[h])*(GM_config.get("nbHrsfM")/60))),u[p].kpi.hrs+=i[p][v].defenses.number[h]*(45/60),u[p].kpi.hrsp+=i[p][v].defenses.number[h]*(GM_config.get("nbHrsD")/60);v+=1}u[p].sessions.pu=u[p].sessions.total/(u[p].sessions.nb-u[p].sessions.nbc),u[p].defenses.pu=u[p].defenses.total/(u[p].defenses.nb-u[p].defenses.nbc),u[p].coaches.total=u[p].sessions.total-u[p].defenses.total,u[p].coaches.nb=u[p].sessions.nb-u[p].defenses.nb,u[p].coaches.nbc=u[p].sessions.nbc-u[p].defenses.nbc,u[p].coaches.pu=u[p].coaches.total/(u[p].coaches.nb-u[p].coaches.nbc);for(let S=0;S<i[p][0].bonus.length;S+=1)u[p].bonus+=i[p][0].bonus[S].sessions>0?30:0;t.isAfter(e,"day")&&(t=e.clone()),u[p].kpi.jrs=rn(s,t),u[p].header.dtFrom=s.format("YYYY-MM-DD"),u[p].header.dtTo=t.format("YYYY-MM-DD"),u[p].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),s=s.add(1,"month"),t=s.endOf("month"),p+=1}return u});var Gt=Mt;var on=class{static changePgIfNeeded(n,e,s,t){var i=t.getPageCount(),u=t.getPages()[i-1],l=u.fontSize,c=u.getFont(),d=u.lineHeight;return n<e&&(s=1,u=t.addPage(),u.font=c,u.setFontSize(l),u.lineHeight=d),[s,u]}};q(on,"addFooter",async function(n,e,s={}){let{degrees:t,PDFDocument:i,rgb:u,StandardFonts:l}=PDFLib,c=n.getPageCount(),d="8".repeat(c),p=await n.embedFont(l.TimesRoman),o=12,v=p.widthOfTextAtSize(`page ${d} / ${d}`,o),S=10,h=10,w=1,b=u(0/255,0/255,0/255),T=u(253/255,246/255,227/255),x=5,E=5,y=3,m=3,g=!0;n.getPages().forEach((a,A)=>{if(!(g===!0&&A==0)){let{width:M,height:j}=a.getSize(),L=o+2*w+y+m;a.moveTo(S+x,o+m),a.setFont(p),a.setFontSize(o),a.setFontColor(u(1,0,0)),e!==void 0&&a.drawText(`${e}`),a.drawText(`page ${A+1} / ${c}`,{x:M-v-E}),a.drawRectangle({x:S,y:10,width:M-(S+h),height:L,color:T,opacity:.6,borderColor:b,borderWidth:w})}})});var dt=on;var Un=async function(){let f=V.Cfg.dbase;return await Swal.mixin({confirmButtonText:"Suivant &rarr;",showCancelButton:!0,progressSteps:["0","1","2","3","4","5"],onOpen:function(o){console.log("...onOpen")},onRender:function(o){console.log("....onUpdate")},onClose:function(o){console.log(".....onClose")},onAfterClose:function(o){console.log("......onAfterClose")},onDestroy:function(o){console.log(".......onDestroy")}}).queue([{title:"Migration de la base",html:"<p>Cette migration va corriger la base et ajouter les nouveaux champs n\xE9cessaires, l`interrpuption du traitement est sans danger (mais ce n' est pas une raison !)</p>"},{title:"Correction de la table \xE9tudiant",html:"<p>Correction de la liste des \xE9tudiants (who_id)",onOpen:async function(o){console.log("%cMigration table des \xE9tudiants correction du who_id",O),Swal.showLoading();var v=dayjs("2020-06-01"),S=f.get("students"),h=S.value(),w=f.get("sessions").filter(y=>dayjs(y.when).isSameOrAfter(v,"day")),b=S.size().value(),T=Swal.getContent().textContent;for(c=0;c<b;c+=1){var x=w.find(m=>m.who_name===h[c].fullname).value();x!==void 0&&S.get(c).assign({who_id:x.who_id}).write();let y=Swal.getContent();y!=null&&(y.innerHTML=`${T}<br /><p>Traitement en cours : ${c}/${h.length}</p>`),await Qe(1)}Swal.hideLoading();let E=Swal.getContent();E!=null&&(E.textContent=`Traitement termin\xE9 : ${h.length}/${h.length}`)}},{title:"Correction de la table \xE9tudiant",html:"<p>Correction de la liste des \xE9tudiants funded devient funding</p>",onOpen:async function(o){console.log("%cMigration : table des \xE9tudiants suppression de l'ancien champs et ajout du champs funding",O),Swal.showLoading();for(var v=f.get("students"),S=v.size().value(),h=Swal.getContent().textContent,w=0;w<S;w+=1){var b=v.get(w).value().fundedby;if(b===void 0){console.log("%cStudent ${oListStudents.get(i).who_name} already converted, skip it",O);continue}v.get(w).unset(["fundedby"]).assign({funding:b}).write(),console.log("%cStudent ${oListStudents.get(i).who_name} create field funding and remove fundedby",O);let x=Swal.getContent();x!=null&&(x.innerHTML=`${h}<br /><p>Traitement en cours : ${w}/${S}</p>`),await Qe(1)}Swal.hideLoading();let T=Swal.getContent();T!=null&&(T.textContent=`Traitement termin\xE9 : ${S}/${S}`)}},{title:"Correction table Etudiants",html:"<p>Correction de la liste des sessions, ajout du path dans la session</p>",onOpen:async function(o){console.log("%cMigration table des sessions correction de id_who",O),Swal.showLoading();var v=dayjs("2020-06-01"),S=f.get("students"),h=S.value(),w=f.get("sessions").filter(m=>dayjs(m.when).isSameOrAfter(v,"day")),b=w.filter(m=>m.type!="soutenance").value(),T=Swal.getContent().textContent;for(c=0;c<b.length;c+=1){var x=S.find({who_id:b[c].who_id}).value();console.log("found",x);var E=x!==void 0&&x.path.length>0?x.path:"0-unknown";f.get("sessions").find({id:b[c].id}).assign({path:E}).write();let m=Swal.getContent();m!=null&&(m.innerHTML=`${T}<br /><p>Traitement en cours : ${c}/${b.length}</p>`),await Qe(1)}Swal.hideLoading();let y=Swal.getContent();y!=null&&(y.textContent=`Traitement termin\xE9 : ${c}/${b.length}`)}},{title:"Migration de la table des Sessions",html:'<p>Correction de la liste des sessions, suppression du champs "isFunded"</p>',onOpen:async function(o){console.log("%cMigration : table des sessions suppression de isFunded",O),Swal.showLoading();for(var v=dayjs("2020-06-01"),S=f.get("students").value(),h=f.get("sessions").filter(E=>dayjs(E.when).isSameOrAfter(v,"day")),w=Swal.getContent().textContent,b=h.value().length;b-=1;){var T=h.get(b);T.value().isFunded===void 0||T.value().isFunded===void 0?console.log(`%cSkip ${T.value()} already converted`,O):T.unset(["isFunded"]).write();let E=Swal.getContent();E!=null&&(E.innerHTML=`${w}<br /><p>Traitement en cours : il reste ${b} \xE9lements \xE0 convertir</p>`),await Qe(1)}Swal.hideLoading();let x=Swal.getContent();x!=null&&(x.textContent=`Traitement en termin\xE9 : ${h.value().length}/${h.value().length}`)}},{title:"Migration de la table des Sessions",html:"<p>Correction de la liste des sessions, ajout de funding</p>",onOpen:async function(o){console.log("%cMigration : table des sessions ajout de fundedBy",O),Swal.showLoading();for(var v=dayjs("2020-06-01"),S=f.get("students").value(),h=f.get("sessions").filter(m=>dayjs(m.when).isSameOrAfter(v,"day")),w=h.filter(m=>m.type!="soutenance"),b=Swal.getContent().textContent,T=w.value().length;T-=1;){var x=w.get(T);x.value().funding!==void 0?console.log(`%cSkip ${x.value()} already converted`,O):x.assign({funding:be.getFunding(x.value().who_id)}).write();let m=Swal.getContent();m.innerHTML=`${b}<br /><p>Traitement en cours : il rest ${T}\xE9lements \xE0 convertir</p>`,await Qe(1)}for(var E=T,w=h.filter(m=>m.type=="soutenance"),T=0;T<w.value().length;T+=1){w.get(T).assign({funding:$e}).write();let g=Swal.getContent();g!=null&&(g.innerHTML=`${b}<br /><p>Traitement en cours : ${E+T}/${h.value().length}</p>`),await Qe(1)}Swal.hideLoading();let y=Swal.getContent();y!=null&&(y.textContent=`Traitement termin\xE9 :  ${h.value().length}/${h.value().length}`)}}]).then(o=>{if(o.value){let v=JSON.stringify(o.value);Swal.fire({title:"Traitement termin\xE9!",html:`
			Your answers:
			<pre><code>${v}</code></pre>
		  `,confirmButtonText:"Lovely!"})}else return console.log("%c resultat en erreur",O,o,o.dismiss===Swal.DismissReason.cancel),-1});var e,s,t;for(c=0;c<s.length;c+=1){var i;i!==void 0&&f.get("students").find({fullname:i.who_name}).assign({who_id:i.who_id}).write()}var u;for(c=0;c<u.length;c+=1){var i,l;f.get("sessions").find({id:u[c].id}).assign({path:l}).write()}for(var c;c<t.value().length;c+=1)t.get(c).unset(["isFunded"]).write();for(var d,c;c<d.value().length;c+=1){var p=d.get(c);p.assign({fundedBy:be.getFunded(p.value().who_id)}).write()}for(var d,c;c<d.value().length;c+=1)d.get(c).assign({fundedBy:$e}).write()};var Gn=mr(qn()),dn=class{},ze=dn;q(ze,"save",function(){return console.log("%cWanna save DBASE",O),JSON.stringify(V.Cfg.dbase.getState())}),q(ze,"load",function(n){return console.log(`%cWanna load ${n} in DBASE`,O),console.log("%c !!!!!! TYPE NOT CHECKED BE CARREFULL",O),V.Cfg.dbase.setState(JSON.parse(n)).write()}),q(ze,"update",async function(n){console.log(`%cIs there any update to DB to go to version ${n}`,O);let e=[{version:"1.00.0006",action:Un}];for(let t=0,i=e.length;t<i;t++)if(It(n,e[t].version)==0)if(console.log(`%cFound an update to DB version '${e[t].version}' proceed conversion...`,O),await e[t].action()==-1)console.log(`%cError something was wrong during update of database from version: ${Ie.getVersion()} to version:${e[t].version}.... you have canceled it`,le),Swal.fire({icon:"error",title:"Oops...",text:`Quelque chose s'est mal pass\xE9 ou vous avez annul\xE9 l'update 

Utiliser l'application dans ces conditions n'est pas garanti  !`,footer:'<a href="https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/issues">G\xE9n\xE9rer un bug?</a>'});else{let l=Ie.setDbVersion(n);console.log(`%cChanged DB to version ${l}`,O)}let s=Ie.setDbVersion(n);console.log(`%cChanged DB to version ${s}`,O)}),q(ze,"erase",function(n){return console.log(`%cErase all data of table: ${n}`,O),V.Cfg.dbase.get(n).remove().write()}),q(ze,"loadTable",function(n,e){if(table_exist(n))return V.Cfg.dbase.set(n,e).write();throw"Table :"+n+", not exists in DB !"}),q(ze,"table_exist",n=>V.Cfg.dbase.has(n).value),q(ze,"table_export",function(n){if(table_exist(n))return JSON.stringify(V.Cfg.dbase.get(n).value());throw"Table :"+n+", not exists id DB !"}),q(ze,"exportTblToCSV",function(n="",e,s){let t=dn.exportTblToJSON(n,e,s),i={quotes:!1,quoteChar:'"',escapeChar:'"',delimiter:",",header:!0,newline:`\r
`,skipEmptyLines:!1,columns:null};return Gn.default.unparse(t,i)}),q(ze,"exportTblToJSON",function(n="",e,s){if(n=="")return console.log("%cIrrecoverable Error: You forget to define a data table name",le),-1;if(e!==null&&e!==""&&(dtFrom=dayjs(e)),s!==null&&s!==""&&(dtTo=dayjs(s)),V.Cfg.dbase.has(n).value==!1)return console.log(`%cIrrecoverable Error: table ${n} don't exist`,le),-1;if(n===De.tbl_name){if(typeof dtFrom=="object"&&dtTo==="object")return V.Cfg.dbase.get(n).filter(t=>dayjs(t.when).isSameOrBefore(dtTo,"day")&&dayjs(t.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtFrom=="object")return V.Cfg.dbase.get(n).filter(t=>dayjs(t.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtTo=="object")return V.Cfg.dbase.get(n).filter(t=>dayjs(t.when).isSameOrBefore(dtTo,"day")).value()}return V.Cfg.dbase.get(n).value()});var At=ze;var Vt=async function(){var f="";f+="<style>div.about_content {background-color: #fed9ff;/*width: 600px;*/height: var(--heigth, 80%);overflow-x: hidden;overflow-y: auto;text-align: left;padding: 20px;}</style>",f+='<div class="about_content" style="--heigth: 600px;">',f+='<div class="about_content__wrapper">';var e=(await ft.XHR({method:"GET",url:"https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/README.md",responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"}})).responseText,s=new showdown.Converter,t=s.makeHtml(e);f+=t,f+="</div>",f+="</div>",Swal.fire({title:`<strong>A propos de ${pn}</strong>`,icon:"info",html:f,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})};var Qt=function(){var f=Ot,n=document.querySelector(f),e=!1;if(n===null)throw console.log(`%cERROR:Could'nt find the table which display sessions : ${n}`,le),new Error("!!!! IRRECOVERABLE ERROR NO TABLE OF SESSIONS FOUNDED");if(n.querySelector(".Facturier__cbox input[type=checkbox]")===null){var n=document.querySelector(`${f}`);for(let y of n.children){if(y.firstChild.nodeName!=="A")continue;let m=y.firstChild;var s=m.children[0].querySelector("svg").getAttribute("aria-label"),t=m.children[0].querySelector("p").innerText,i=m.children[1].querySelector("time").getAttribute("datetime").trim(),u=m.children[2].querySelector("a").innerText,l=ut(m.children[2],-2),c=document.createElement("input");c.type="checkbox",c.name="name";var d=dayjs(i).toISOString(),p=De.getHashId(d,l);c.value=p,c.onclick=function(A){A.stopPropagation()},e=De.exists(p),e===!0&&(c.checked=!0);let g=m.children[1].classList,a=m.lastChild.classList;m.lastChild.classList=g;var o=document.createElement("div");o.appendChild(c),o.classList.add(...a),o.classList.add("Facturier__cbox"),m.appendChild(o)}if(document.querySelector(`${f} .Facturier__cbox_all`)===null){let y=(a,A)=>A.insertAdjacentElement("beforebegin",a);var v=document.querySelector(`${f} li`);let m=v.firstChild.classList;var c=document.createElement("input");c.type="checkbox",c.name="name",c.value="value",c.id="id",c.onclick=function(){document.querySelectorAll(".Facturier__cbox input[type=checkbox]").forEach(a=>a.checked=!a.checked)},c.style="visibility: hidden;";var S=document.createElement("label");S.innerText="in DB",S.style="display:block;text-align:right;",S.onMouseOver="this.style.cursor=pointer;",S.onMouseOut="this.style.cursor=auto;",S.appendChild(c);var h=document.createElement("div");h.classList=m,h.classList.add("Facturier__cbox_all"),h.appendChild(S),y(h,document.querySelector(`${f} li`))}}else{for(var w=n.querySelectorAll(".Facturier__cbox input[type=checkbox]"),b=w.length,T=new Array(b);b--;T[b]=w[b]);for(var x in T){let E=parseInt(T[x].value,10);e=De.exists(E),e===!0?T[x].checked=!0:T[x].checked=!1}}},Vn=async function(){var[f,n]=await Et(dayjs().startOf("month"),dayjs().endOf("month"));let e=Gt.getListDetailBill(f,n),s="";s+="<table>",s+="<thead>",s+="<tr><th>Quand</th><th>Qui</th><th>Financ\xE9 ?</th><th>Type</th><th>Niveau</th><th>Ancien Mode ?</th><th>Statut</th><th>PU HT</th><th>Cumul</th></tr>",s+="<thead>",s+="<tbody>";for(let t=0;t<e.length;t+=1)s+="<tr>",s+=`<td>${dayjs(e[t].when).format("DD/MM/YYYY \xE0 HH:mm:ss")}</td>`,s+=`<td>${e[t].who_name}</td><td>${e[t].funding}</td>`,sType=e[t].type,e[t].path!=null&&e[t].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&e[t].type!=="soutenance"&&(sType="Coaching"),s+=`<td>${sType}</td><td>${e[t].lvl}</td>`,s+=`<td>${e[t].oldMode===!0?"Oui":"Non"}</td>`,s+=`<td>${e[t].status}</td>`,s+=`<td>${e[t].iPu}</td><td>${e[t].iCumul}\u20AC</td>`,s+="</tr>";s+="</tbody>",s+="</table>",Swal.fire({title:`<strong>Liste d\xE9taill\xE9es des sessions du ${f.format("DD/MM/YYYY")} au ${n.format("DD/MM/YYYY")}</strong>`,icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:t=>{var i=t.querySelector("table"),u=new simpleDatatables.DataTable(i)}})},Qn=async function(){var f=!0,[n,e]=await Et(dayjs().startOf("month"),dayjs().endOf("month"));f==!0&&console.log("%ccollectAuto() Wanna collect from %s to %s",O,n.format("DD/MM/YYYY"),e.format("DD/MM/YYYY"));var s=await De.getSessionsFromAPI(n,e);f==!0&&console.log("%ccollectAuto() Sessions are is %o",O,s)};var zn=async function(){var f=Ot,n=document.querySelectorAll(f);GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let e='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';Swal.fire({title:"Traitement en cours!",html:e,confirmButtonText:"Lovely!",onBeforeOpen:function(s){var t=new ldBar("#pbar")},onRender:function(s){},onOpen:async function(s){for(var t=document.getElementById("pbar").ldBar,i=0;i<n.length;i+=1){var u=n[i].parentElement.parentElement,l=De.parseRow(u);await De.add(l),t.set(i/n.length*100,!1)}t.set(100,!1),Swal.getTitle()&&(Swal.getTitle().innerText="Traitement termin\xE9 !")},onClose:function(s){},onAfterClose:function(s){},onDestroy:function(s){}})},Wn=function(){let f=unsafeWindow.Facturier.cfg.dbase,n=unsafeWindow.Facturier.libs.find(c=>c.id=="dayjs").ptr,e=unsafeWindow.Facturier.libs.find(c=>c.id=="fetchInject").ptr,s=unsafeWindow.Facturier.klass.find(c=>c.id=="Session").ptr,t=unsafeWindow.Facturier.klass.find(c=>c.id=="Student").ptr,i=unsafeWindow.Facturier.klass.find(c=>c.id=="History").ptr,u=unsafeWindow.Facturier.klass.find(c=>c.id=="Archive").ptr,l=unsafeWindow.Facturier.klass.find(c=>c.id=="StudentHistory").ptr;console.log("%cd_dbase, d_dayjs, d_Session, d_Student, d_History, d_Archive, d_StudentHistory are exported",O),console.log("%cfor examples write all code after $>",O),console.group("%cd_dbase",O),console.log("example : get last session in db $>d_dbase.get(d_Session.tbl_name).last().value();"),console.log("          get first student in db $>d_dbase.get(d_Student.tbl_name).first().value()"),console.log("          or d_dbase.get(d_Student.tbl_name).get(0).value()"),console.log("          get all sessions grouped by month/yyyy in db $>d_dbase.get(d_Session.tbl_name).groupBy( v => d_dayjs(v.when).format('MM/YYYY')).value()"),console.log("          get all table $> d_dbase.value()"),console.groupEnd(),console.group("%cd_fetchInject",O),console.log("same as fetchInject libs : https://habd.as/code/fetch-inject/"),console.groupEnd(),console.group("%cd_dayjs",O),console.log("same as dayjs libs"),console.groupEnd(),console.group("%cd_Student",O),console.log("find a student by id \xA4 d_Student.findById(STUDENT_ID, (DATE) ); // date is optionnal"),console.groupEnd(),console.group("%cd_Session",O),console.log("get a list of session \xA4 d_Session.getBetween('2020-08-01','2020-08-31')"),console.log("delete a session by id \xA4 d_Session.deleteById(SESSION_ID);"),console.groupEnd(),console.group("%cSome combinated example",O),console.log("Delete last saved session :  d_Session.deleteById( d_dbase.get(d_Session.tbl_name).last().value().id ); "),console.log("Find all session between 01/08/2020 and 31/08/2020 :  d_dbase.get(d_Session.tbl_name).filter( v => d_dayjs(v.when).isSameOrBefore('20200831', 'day') && d_dayjs(v.when).isSameOrAfter('20200801', 'day')).value(); "),console.groupEnd();debugger};var Kn=function(){let{degrees:f,PDFDocument:n,rgb:e,StandardFonts:s}=PDFLib;async function t(){let c=await fetch("https://pdf-lib.js.org/assets/with_update_sections.pdf").then(b=>b.arrayBuffer()),d=await n.load(c),p=await d.embedFont(s.Helvetica),v=d.getPages()[0],{width:S,height:h}=v.getSize();v.drawText("This text was added with JavaScript!",{x:5,y:h/2+300,size:50,font:p,color:e(.95,.1,.1),rotate:f(-45)});let w=await d.save();download(w,"pdf-lib_modification_example.pdf","application/pdf")}async function i(){let l=await n.create(),c=await l.embedFont(s.TimesRoman),d=l.addPage(),{width:p,height:o}=d.getSize(),v=30;d.drawText("Creating PDFs in JavaScript is awesome!",{x:50,y:o-4*v,size:v,font:c,color:e(0,.53,.71)});let S=await l.save();download(S,"pdf-lib_modification_example.pdf","application/pdf")}async function u(){var[l,c]=await Et(dayjs().startOf("month"),dayjs().endOf("month"));let d=Gt.getListDetailBill(l,c),p=await n.create(),o=await p.embedFont(s.TimesRoman),v=p.addPage(),{width:S,height:h}=v.getSize(),w=30;v.drawText(`Prestations en d\xE9tail 

 du ${l.format("DD/MM/YYYY")} au ${c.format("DD/MM/YYYY")}`,{x:50,y:h/2-w,size:w,font:o,color:e(116/255,81/255,235/255)});let b=12,T=1.25,x=p.addPage();x.setFontSize(b),x.line_space=T,x.font=o;let E=1,y=20,m=T*b+y,g=h/2,a=function(ne){let G="LOrEm ipsum DOLor sit aMet, conSEc/tetUr 25 porttitor. ";return ne*1.0925*(o.widthOfTextAtSize(G,b)/G.length)},A=[0,18,36,10,13,8,5,7],M=[A[0],a(A[1]),a(A[2]),a(A[3]),a(A[4]),a(A[5]),a(A[6]),a(A[7])],j=v.lineHeight,L=25;for(let ne=1;ne<d.length;ne+=1){if(g=h-T*b*E,g<m&&(E=1,x=p.addPage(),x.font=o,x.setFontSize(b),x.line_space=T,g=h-T*b*E),E===1){let He=["","Quand","Qui","Financ\xE9","Type-Niv.","Statut","Pu","Cumul"],Ce=L;x.moveTo(Ce,g);for(let Ge=1;Ge<He.length;Ge+=1)x.drawText(He[Ge],{x:Ce}),Ce+=M[Ge];E+=1,g=h-T*b*E}let G=L;x.drawText(dayjs(d[ne].when).format("DD/MM/YYYY \xE0 HH:mm"),{font:o,size:b,y:g,x:G,lineHeight:j}),G+=M[1],x.drawText(d[ne].who_name.trim().slice(0,A[2]),{font:o,size:b,y:g,x:G,lineHeight:j}),G+=M[2];let ge=d[ne].funding.trim().slice(0,A[3]);d[ne].funding==="auto-financ\xE9"&&(ge="Au. Fin."),d[ne].funding==="financ\xE9 par un tiers"&&(ge="Fin."),x.drawText(ge,{font:o,size:b,y:g,x:G,lineHeight:j}),G+=M[3];let Se=d[ne].type;d[ne].path!=null&&d[ne].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&d[ne].type!=="soutenance"&&(Se="Coaching");let ke=`${Se.trim().slice(0,A[4]-2)}-${d[ne].lvl.toString()}`;x.drawText(ke,{font:o,size:b,y:g,x:G,lineHeight:j}),G+=M[4];let Ne=d[ne].status;d[ne].status==="\xE9tudiant absent"&&(Ne="absent"),d[ne].status==="\xE9tudiante absente"&&(Ne="absente"),d[ne].status==="annul\xE9e tardivement"&&(Ne="an. tard."),x.drawText(Ne,{font:o,size:b,y:g,x:G,lineHeight:j}),G+=M[5],x.drawText(d[ne].iPu.toString(),{font:o,size:b,y:g,x:G,lineHeight:j}),G+=M[6],x.drawText(d[ne].iCumul.toString(),{font:o,size:b,y:g,x:G,lineHeight:j}),E+=1}var I=await Ke.calculateBill(l,c);let D=I.get(0,0,0,0).maxLevel,N=xe.getOldModeDate(),Y=Ke.getPriceList(N.subtract(1,"day")),F=Ke.getPriceList(N);var k=1;let B=!1;var $=[R,H,U],P=["Sessions","Soutenance","Coaching"],ie=[0,1,2,3],ue=["R\xE9alis\xE9e","Annul\xE9e","Annul\xE9e tardivement","Etudiant(e) absent(e)"],pe=[Q,z,W],me=["Autofinanc\xE9s","Financ\xE9s","Autres"];E=1,x=p.addPage();let ye=["","Quand","Qui","Nb","Pu","Cumul"],re=[0,18,50,3,5,7],oe=[A[0],a(A[1]),a(A[2]),a(A[3]),a(A[4]),a(A[5])],he="";for(_iSessionType=0,_iSessionTypeLength=$.length;_iSessionType<_iSessionTypeLength;_iSessionType+=1){for(;k<=D;){for([E,x]=dt.changePgIfNeeded(g,m,E,p),g=h-T*b*E,_iSessionQuality=0,_iSessionQualityLength=ie.length;_iSessionQuality<_iSessionQualityLength;_iSessionQuality+=1)for(_iFunding=0,_iFundingLength=pe.length;_iFunding<_iFundingLength;_iFunding+=1){if(_i0=I.get($[_iSessionType],ie[_iSessionQuality],pe[_iFunding],k),typeof _i0=="undefined"&&B===!1)continue;_i0.data=_i0.data.reverse();let ne=L;if(he=`${P[_iSessionType]} de Niveau ${k} Etudiants ${me[_iFunding]}`,x.moveTo(ne,g),x.drawText(he,{font:o,size:b+4,y:g,x:ne,lineHeight:j}),ne+=15,E+=1,[E,x]=dt.changePgIfNeeded(g,m,E,p),g=h-T*b*E,x.moveTo(ne,g),x.drawText(ue[_iSessionQuality],{font:o,size:b+2,y:g,x:ne,lineHeight:j}),ne+=15,E+=1,[E,x]=dt.changePgIfNeeded(g,m,E,p),g=h-T*b*E,typeof _i0=="undefined"){x.drawText(`d\xE9sol\xE9 pas de r\xE9sultat pour cette section au niveau de facturation (${k})`,{font:o,size:b,y:g,x:ne,lineHeight:j}),E+=1,[E,x]=dt.changePgIfNeeded(g,m,E,p),g=h-T*b*E;continue}let G=ne,ge=0;x.moveTo(ne,g);for(let Se=1;Se<ye.length;Se+=1)x.drawText(ye[Se],{font:o,size:b+2,y:g,x:G,lineHeight:j}),G+=oe[Se];E+=1,[E,x]=dt.changePgIfNeeded(g,m,E,p),g=h-T*b*E,G=ne;for(var ce=0,ae=_i0.data.length;ce<ae;ce+=1)G=ne,x.drawText(dayjs(_i0.data[ce].when).format("DD/MM/YYYY \xE0 HH:mm"),{font:o,size:b,y:g,x:G,lineHeight:j}),G+=oe[1],x.drawText(_i0.data[ce].who_name.trim().slice(0,re[1]),{font:o,size:b,y:g,x:G,lineHeight:j}),G+=oe[2],x.drawText((ce+1).toString(),{font:o,size:b,y:g,x:G,lineHeight:j}),G+=oe[3],xe.isInOldMode(dayjs(_i0.data[ce].when))?iPu=+_i0.data[ce].lvl>0?Y[k][$[_iSessionType]][ie[_iSessionQuality]][pe[_iFunding]]:0:iPu=+_i0.data[ce].lvl>0?F[k][$[_iSessionType]][ie[_iSessionQuality]][pe[_iFunding]]:0,x.drawText(iPu.toString(),{font:o,size:b,y:g,x:G,lineHeight:j}),G+=oe[4],ge+=iPu,x.drawText(ge.toString(),{font:o,size:b,y:g,x:G,lineHeight:j}),E+=1,[E,x]=dt.changePgIfNeeded(g,m,E,p),g=h-T*b*E}k+=1,E+=1,[E,x]=dt.changePgIfNeeded(g,m,E,p),g=h-T*b*E}k=1}dt.addFooter(p,`G\xE9n\xE9r\xE9 avec Facturier version ${xe.getAppVersion()}`);let de=await p.save();download(de,`prestations_facturees_detail_${l.format("YYYYMMDD")}-${c.format("YYYYMMDD")}.pdf`,"application/pdf")}u()},Jn=async function(){GM_addStyle('.formgrid{font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", Helvetica, Arial, sans-serif;}'),GM_addStyle(`
.swal2-styled[type=button]{background-color:#3085d6;border-radius:.75em;color:#fff;font-size:1.0625em;border-left-color:#3085d6;border-right-color:#3085d6;display:inline-block}
.formgrid{display:grid;grid-template-columns:1fr 1em 1fr;grid-gap:.3em .6em;grid-auto-flow:dense;align-items:center}
.formgrid input,.formgrid output,.formgrid textarea,.formgrid select,.formgrid button{grid-column:2 / 4;width:auto;margin:0}
.formgrid legend{font-size:1.2em;width:100%;border-bottom:1px dotted #99c}
.formgrid fieldset{max-width:40em;padding:4px;margin:2em auto;border:0 none}
`);let f="";f+="<legend>Que voulez vous faire ?</legend>",f+="<fieldset>",f+='<div class="formgrid">',f+='Epurer<button id="answer1" data-action="raz" class="swal2-styled" type="button">RAZ</button>',f+='Sauvegarder toute la base<button id="answer2" data-action="export" class="swal2-styled" type="button">Sauvegarder</button>',f+='Charger toute la base<button id="answer3" data-action="import" class="swal2-styled" type="button">Charger</button>',f+=`Exporter les tables
    <button class="swal2-styled" type="button"
    	hx-get="/views/test-swal-sauvegarde"
		hx-select="body"
        hx-target="#sttPlaceHolder"
        hx-include="[name='email']"
        hx-swap="innerHTML"> Exporter
    </button>
		`,f+="</fieldset>",f+="</div>";let{value:n}=await Swal.fire({title:"Gestion de la base de donn\xE9e",html:f,focusConfirm:!1,preConfirm:()=>[document.getElementById("answer1").value,document.getElementById("answer2").value],didOpen:e=>{console.log("%conOpen popup","color:coral"),htmx.process(document.querySelector(".swal2-container")),console.log("%cHtmx Process done","color:coral"),e.querySelector(".formgrid").addEventListener("click",_handler=function(s){let t=function(l){l.target.matches('button[data-action="raz"]')&&(Swal.close(),Jr())},i=function(l){l.target.matches('button[data-action="export"]')&&(Swal.close(),Wr())},u=function(l){l.target.matches('button[data-action="import"]')&&(Swal.close(),Kr())};t(s),i(s),u(s)})},onClose:e=>{e.querySelector(".formgrid").removeEventListener("click",_handler),console.log("%conClose popup","color:coral")}});n&&Swal.fire(JSON.stringify(n))},Wr=async function(){let f=At.save();console.log(`%cWanna save : ${f}`,O);let n=dayjs(),e="";e+=`<a id="download" href="data:text/plain;charset=utf-8,${encodeURIComponent(f)}" download="save_${n.format("YYYYMMDD")}.json">save_${n.format("YYYYMMDD")}.json</a>`,Swal.fire({title:"Sauvegarde de la base de donn\xE9e",html:e,focusConfirm:!1,onOpen:s=>{s.querySelector("#download").click()},onClose:s=>{}})};var Kr=async function(){console.log("%cWanna load DATABASE",O);let{value:f}=await Swal.fire({title:"Selection de la sauvegarde (json)",input:"file",inputAttributes:{accept:".json","aria-label":"Upload your database"}});if(f){let n=new FileReader;n.onload=e=>{At.load(e.target.result),Qt(),Ct("Chargement de la base termin\xE9")},n.readAsText(f)}},Jr=async function(){GM_addStyle(".form_addon {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}"),GM_addStyle(".form_addon input {background: #fff;border: 1px solid #9c9c9c;}"),GM_addStyle(".form_addon button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}"),GM_addStyle(".form_addon button:hover {background: gold;}"),GM_addStyle(".form_addon label {padding: 0.5em 0.5em 0.5em 0;}"),GM_addStyle(".form_addon input {padding: 0.7em;margin-bottom: 0.5rem;}"),GM_addStyle(".form_addon input:focus {outline: 3px solid gold;}"),GM_addStyle("@media (min-width: 400px) {.form_addon {grid-template-columns: 200px 1fr;grid-gap: 16px;} .form_addon label {text-align: right;grid-column: 1 / 2;} .form_addon input, .form_addon button {grid-column: 2 / 3;}}");var f="";f+='<form id="RAZ" class="form_addon" action="">',f+='<label for="students" class="cbox">Etudiants</label>',f+='<input id="students" type="checkbox" value="del_students_true" checked>',f+='<label for="sessions" class="cbox">Sessions</label>',f+='<input id="sessions" type="checkbox" value="del_sessions_true" checked>',f+='<label for="archives" class="cbox">Archives : factures</label>',f+='<input id="archives" type="checkbox" value="del_archives_true" checked>',f+='<label for="history_cache" class="cbox">Signet historique</label>',f+='<input id="history_cache" type="checkbox" value="del_history_cache_true" checked>',f+='<label for="radio1">filtrer la date</label>',f+='<input type="radio" id="radio1" name="date_filter" value="false" checked>',f+='<label for="radio2">ne pas filtrer</label>',f+='<input type="radio" id="radio2" name="date_filter" value="true">',f+='<label for="dtFrom" class="date">Date de d\xE9but</label>',f+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',f+='<label for="dtTo" class="date">Date de fin</label>',f+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',f+="<!-- Switch -->",f+='<input type="checkbox" class="switch" name="s1" id="s1">',f+='<label for="s1">Switch</label>',f+="</form>";let{value:n}=await Swal.fire({title:"<strong>RAZ des donn\xE9es</strong>",icon:"info",html:f,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez ce que vous allez supprimer de la base de donn\xE9e",preConfirm:()=>{let c=document.getElementsByName("date_filter"),d="notfound";for(var p in c)c[p].checked===!0&&(d=c[p].value);return console.log(document.getElementById("s1")),[document.getElementById("students").checked,document.getElementById("sessions").checked,document.getElementById("archives").checked,document.getElementById("history_cache").checked,document.getElementById("dtFrom").disabled===!0?null:document.getElementById("dtFrom").value,document.getElementById("dtTo").disabled===!0?null:document.getElementById("dtTo").value,d]},onOpen:c=>{c.querySelector("#radio1").addEventListener("change",function(){console.log(document.getElementById("radio1").checked);let d=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!d,document.getElementById("dtTo").disabled=!d}),c.querySelector("#radio2").addEventListener("change",function(){let d=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!d,document.getElementById("dtTo").disabled=!d}),c.querySelector("#dtFrom").addEventListener("change",function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:c=>{c.querySelector("#radio1").removeEventListener("change"),c.querySelector("#radio2").removeEventListener("change"),c.querySelector("#dtFrom").removeEventListener("change")}}),e=n[0],s=n[1],t=n[2],i=n[3];console.log(`%cWanna raz students ? ${e}, wanna raz sessions ? ${s}, wanna raz archives ? ${t}`,O);let u=n[4]?dayjs(n[4]):null,l=n[5]?dayjs(n[5]):null;e===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des \xE9tudiants",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),be.delete(u,l),Ie.remStudentListUpd()),s===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des sessions",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),De.delete(u,l),Qt()),t===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des archives (financi\xE8res)",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),vt.delete(u,l)),i===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base du cache des historique de session",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),wt.remove(u,l))};var Zn=async function(){var f="";f+="<style>",f+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",f+="form input {background: #fff;border: 1px solid #9c9c9c;}",f+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",f+="form button:hover {background: gold;}",f+="form label {padding: 0.5em 0.5em 0.5em 0;}",f+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",f+="form input:focus {outline: 3px solid gold;}",f+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",f+="</style>",f+='<form class="form1" action="">',f+='<label for="dd" class="date">Date de d\xE9but</label>',f+='<input id="dd" type="date" max="2030-12-31" min="2010-12-31">',f+='<label for="df" class="date">Date de fin</label>',f+='<input id="df" type="date" max="2030-12-31" min="2010-12-31">',f+="</form>";var[n,e]=await Et(dayjs().startOf("month"),dayjs().endOf("month")),s=await Ke.calculateBill(n,e);xe.isInOldMode(n)?Zr(n,e,s):Xr(n,e,s)};var Zr=function(f,n,e){let s=e.get(0,0,0,0),t=4;var i="",u=null,l=0,c=0,d=0,p=[[4,"Groupe"],[1,"Niveau 1"],[2,"Niveau 2"],[3,"Niveau 3"]],o=0,v=0,S=!1,h=0,w=0,b=0,T=0,x=0,E=0,y=0,m=0,g=0,a=0,A=0,M=0,j=0,L=0,I=0,C=0,D=0,N=0,Y=1;e.toConsole(),i+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",i+='<div class="wrapper">',i+="<table>",i+="<thead>",i+="<tr>",i+='<th>Type</th><th><abbr title="nombre">nb</abbr></th><th>PU(<abbr title="hors taxes">HT</abbr>)</th><th>Total(<abbr title="hors taxes">HT</abbr>)</th>',i+="</tr>",i+="</thead>",i+="<tbody>",i+="<tr>",i+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Mentorat</th>',i+="</tr>";for(var o=performance.now();Y<=t;)_i0=e.get(R,Z,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(R,Z,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(R,Z,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : r\xE9alis\xE9es</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(R,X,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(R,X,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(R,X,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : annul\xE9es</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(R,K,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(R,K,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(R,K,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : annul\xE9es tard.</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(R,ee,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(R,ee,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(R,ee,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : \xE9tudiant abs.</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),Y+=1;var v=performance.now();console.log("%cCalculate first array"+(v-o)+" milliseconds.",Ve),i+="<tr>",i+="<td>Total</td>",i+=`<td>${l}</td><td></td><td>${c}\u20AC</td>`,i+="</tr>",i+="<tr>",i+="</tr>",d+=c,l=0,c=0,i+="<tr>",i+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',i+="</tr>",Y=1;for(var o=performance.now();Y<=t;)_i0=e.get(H,Z,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(H,Z,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(H,Z,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : r\xE9alis\xE9es</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(H,X,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(H,X,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(H,X,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : annul\xE9es</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(H,K,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(H,K,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(H,K,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : annul\xE9es tard.</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(H,ee,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(H,ee,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(H,ee,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : \xE9tudiant abs.</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),Y+=1;var v=performance.now();console.log("%cCalculate second array"+(v-o)+" milliseconds.",Ve),i+="<tr>",i+="<td>Total</td>",i+=`<td>${l}</td><td></td><td>${c}\u20AC</td>`,i+="</tr>",i+="<tr>",i+="</tr>",d+=c,l=0,c=0,i+="<tr>",i+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',i+="</tr>",Y=1;for(var o=performance.now();Y<=t;)_i0=e.get(U,Z,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(U,Z,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(U,Z,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : r\xE9alis\xE9es</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(U,X,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(U,X,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(U,X,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : annul\xE9es</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(U,K,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(U,K,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(U,K,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : annul\xE9es tard.</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),_i0=e.get(U,ee,Q,Y),a=_i0===void 0?0:_i0.number,C=_i0===void 0?0:_i0.amount,_i0=e.get(U,ee,z,Y),A=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,_i0=e.get(U,ee,W,Y),M=_i0===void 0?0:_i0.number,N=_i0===void 0?0:_i0.amount,j=a>0?C/a:C,L=A>0?D/A:D,I=M>0?N/M:N,(S===!0||a+A+M>0)&&(l+=a,l+=A,l+=M,c+=C,c+=D,c+=N,i+="<tr>",i+=`<td>Niveau ${Y} : \xE9tudiant abs.</td>`,i+=`<td>${a+A+M}</td><td>${L}</td><td>${C+D+N}\u20AC</td>`,i+="</tr>"),Y+=1;var v=performance.now();console.log("%cCalculate third array"+(v-o)+" milliseconds.",Ve),i+="<tr>",i+="<td>Total</td>",i+=`<td>${l}</td><td></td><td>${c}\u20AC</td>`,i+="</tr>",i+="<tr>",i+="</tr>",d+=c,i+="<tr>",i+='<th colspan="4" class="pseudoheader" scope="colgroup">Total G\xE9n\xE9ral</th>',i+="</tr>",i+=`<td colspan="3"></td><td>${d}\u20AC</td>`,i+="</tr>",i+="<tr>",i+="</tr>",i+="</tbody>",i+="<tfoot>",i+="</tfoot>",i+="</table>",i+=`<p>Soit un total g\xE9n\xE9ral \xE0 facturer de ${d}\u20AC`,Swal.fire({title:`<strong>Liste des formations tarif\xE9es du ${f.format("DD/MM/YYYY")} au ${n.format("DD/MM/YYYY")}</strong>`,html:i,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},Xr=function(f,n,e){console.log("%cEnter computation bill",O);let s=!1;var t="",i=0,u=0,l=0,c=0,d=0,p=0,o=0,v=0,S=0,h=0,w=0,b=0;let T=e.get(0,0,0,0),x=T.maxLevel;var E=0,y=0,m=0,g=0,a=0,A=0,M=0,j=0,L=0,I=0,C=0,D=0,N=0,Y=0,F=0,k=0,B=0,$=0,P=1;t+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",t+='<div class="wrapper">',t+="<table>",t+="<thead>",t+="<tr>",t+='<th rowspan="2">Type</th><th colspan="3" scope="colgroup">Auto Financ\xE9s</th><th colspan="3" scope="colgroup">Financ\xE9s</th><th colspan="3" scope="colgroup">Autres</th><th colspan="2" scope="colgroup">Total</th>',t+="</tr>",t+="<tr>",t+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',t+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',t+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',t+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',t+="</tr>",t+="</thead>",t+="<tbody>",t+="<tr>",t+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de mentorat</th>',t+="</tr>";for(var ie=performance.now();P<=x;)_i0=e.get(R,Z,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(R,Z,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(R,Z,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : r\xE9alis\xE9es</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(R,X,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(R,X,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(R,X,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : annul\xE9es</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(R,K,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(R,K,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(R,K,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : annul\xE9es tard.</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(R,ee,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(R,ee,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(R,ee,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : \xE9tud. absent</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),P+=1;var ue=performance.now();for(console.log("%cCalculate first array"+(ue-ie)+" milliseconds.",Ve),t+="<tr>",t+="<td>Total</td>",t+=`<td>${i}</td><td></td><td>${c}\u20AC</td>`,t+=`<td>${u}</td><td></td><td>${d}\u20AC</td>`,t+=`<td>${l}</td><td></td><td>${p}\u20AC</td>`,t+=`<td>${i+u+l}</td><td>${c+d+p}\u20AC</td>`,t+="</tr>",t+="<tr>",t+="</tr>",o+=i,v+=u,S+=l,h+=c,w+=d,b+=p,i=0,u=0,l=0,c=0,d=0,p=0,t+="<tr>",t+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',t+="</tr>",P=1;P<=x;)_i0=e.get(H,Z,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(H,Z,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(H,Z,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : r\xE9alis\xE9es</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(H,X,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(H,X,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(H,X,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : annul\xE9es</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(H,K,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(H,K,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(H,K,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : annul\xE9es tard.</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(H,ee,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(H,ee,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(H,ee,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : \xE9tud. absent</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),P+=1;t+="<tr>",t+="<td>Total</td>",t+=`<td>${i}</td><td></td><td>${c}\u20AC</td>`,t+=`<td>${u}</td><td></td><td>${d}\u20AC</td>`,t+=`<td>${l}</td><td></td><td>${p}\u20AC</td>`,t+=`<td>${i+u+l}</td><td>${c+d+p}\u20AC</td>`,t+="</tr>",t+="<tr>",t+="</tr>",o+=i,v+=u,S+=l,h+=c,w+=d,b+=p,i=0,u=0,l=0,c=0,d=0,p=0,t+="<tr>",t+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',t+="</tr>";for(var P=1;P<=x;)_i0=e.get(U,Z,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(U,Z,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(U,Z,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : r\xE9alis\xE9es</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(U,X,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(U,X,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(U,X,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : annul\xE9es</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(U,K,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(U,K,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(U,K,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : annul\xE9es tard.</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),_i0=e.get(U,ee,Q,P),I=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,_i0=e.get(U,ee,z,P),C=_i0===void 0?0:_i0.number,B=_i0===void 0?0:_i0.amount,_i0=e.get(U,ee,W,P),D=_i0===void 0?0:_i0.number,$=_i0===void 0?0:_i0.amount,N=I>0?k/I:k,Y=C>0?B/C:B,F=D>0?$/D:$,(s===!0||I+C+D>0)&&(i+=I,u+=C,l+=D,c+=k,d+=B,p+=$,t+="<tr>",t+=`<td>Niveau ${P} : \xE9tud. absent</td>`,t+=`<td>${I}</td><td>${N}</td><td>${k}\u20AC</td>`,t+=`<td>${C}</td><td>${Y}</td><td>${B}\u20AC</td>`,t+=`<td>${D}</td><td>${F}</td><td>${$}\u20AC</td>`,t+=`<td>${I+C+D}</td><td>${k+B+$}\u20AC</td>`,t+="</tr>"),P+=1;o+=i,v+=u,S+=l,h+=c,w+=d,b+=p,t+="<tr>",t+="<td>Total</td>",t+=`<td>${i}</td><td></td><td>${c}\u20AC</td>`,t+=`<td>${u}</td><td></td><td>${d}\u20AC</td>`,t+=`<td>${l}</td><td></td><td>${p}\u20AC</td>`,t+=`<td>${i+u+l}</td><td>${c+d+p}\u20AC</td>`,t+="</tr>",t+="<tr>",t+="</tr>",t+="</tbody>",t+="<tfoot>",t+="</tfoot>",t+="</table>";var pe=0,me="";let ye=T.flatFee.length;for(var re=0;re<ye;re+=1)pe+=30,me+=T.flatFee[re].who_name+", ";ye>1?t+=`<p class="flat_fee">Calcul du forfait "autofinanc\xE9". Ce mois ci ${ye} \xE9tudiants ont eu au moins une session il s'agit de : ${me.slice(0,-1)}`:t+=`<p class="flat_fee">Calcul du forfait "autofinanc\xE9". Ce mois ci ${ye} \xE9tudiant a eu au moins une session il s'agit de : ${me.slice(0,-1)}`,t+=`. Le forfait est donc de ${pe}\u20AC</p>`,t+=`<p>Soit un total g\xE9n\xE9ral \xE0 facturer de ${h+w+b+pe}\u20AC</p>`,Swal.fire({title:`<strong>Liste des formations tarif\xE9es du ${f.format("DD/MM/YYYY")} au ${n.format("DD/MM/YYYY")}</strong>`,html:t,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},Xn=async function(){var[f,n]=await Et(dayjs().startOf("month"),dayjs().endOf("month"),!1);if(f===null||n===null)throw console.log("%cError need date from, date to",le),new Error;let e=Gt.getListStatistic(f,n),s="",t=new Array(22),i=Array.apply(null,Array(22)).map(Number.prototype.valueOf,0),u=f.clone(),l=u.endOf("month"),c="";t[0]="<thead><tr><th>Sessions</th>",t[1]="<tbody><tr><td>Sessions</td>",t[2]='<tr class="header"><td>Montant</td>',t[3]="<tr><td>Nb.",t[4]="<tr><td>Pu",t[5]='<tr class="header"><td>Soutenances</td>',t[6]="<tr><td>Montant</td>",t[7]="<tr><td>Nb.",t[8]="<tr><td>Pu",t[9]='<tr class="header"><td>Coaching</td>',t[10]="<tr><td>Montant</td>",t[11]="<tr><td>Nb.",t[12]="<tr><td>Pu",t[13]='<tr class="header"><td>Bonus</td>',t[14]="<tr><td>Bonus AF</td>",t[15]="<tr><td>Total G\xE9n\xE9ral</td>",t[16]='<tr class="header"><td>KPI</td>',t[17]="<tr><td>NbJrs</td>",t[18]="<tr><td>TJM</td>",t[19]="<tr><td>Nb hrs</td>",t[20]="<tr><td>THM</td>",t[21]="<tr><td>Nb hrs (p.)</td>",t[22]="<tr><td>THM (p)</td>";for(var d=0;d<e.length;d+=1){i[2]+=e[d].sessions.total,i[3]+=e[d].sessions.nb-e[d].sessions.nbc,i[4]+=e[d].sessions.pu,i[6]+=e[d].defenses.total,i[7]+=e[d].defenses.nb-e[d].defenses.nbc,i[8]+=e[d].defenses.pu,i[10]+=e[d].coaches.total,i[11]+=e[d].coaches.nb-e[d].coaches.nbc,i[12]+=e[d].coaches.pu,i[14]+=e[d].bonus;let p=e[d].sessions.total+e[d].defenses.total+e[d].coaches.total+e[d].bonus;i[15]+=p,i[16]+=e[d].kpi.jrs,i[18]+=e[d].kpi.hrs,i[20]+=e[d].kpi.hrsp,e.length==1&&(c="</tr>"),d===e.length-1&&e.length>1?l.isAfter(n,"day")?(i[2]-=e[d].sessions.total,i[3]-=e[d].sessions.nb-e[d].sessions.nbc,i[4]-=e[d].sessions.pu,i[6]-=e[d].defenses.total,i[7]-=e[d].defenses.nb-e[d].defenses.nbc,i[8]-=e[d].defenses.pu,i[10]-=e[d].coaches.total,i[11]-=e[d].coaches.nb-e[d].coaches.nbc,i[12]-=e[d].coaches.pu,i[14]-=e[d].bonus,i[15]-=p,i[16]-=e[d].kpi.jrs,i[18]-=e[d].kpi.hrs,i[20]-=e[d].kpi.hrsp,t[0]+=`<td>Total(moy)</td><td>${dayjs(e[d].header.dtTo).format("MMMM")}</td></thead></tr>`,t[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",t[2]+=`<td>${i[2]} (${(i[2]/(e.length-1)).toFixed(2)})</td><td>${e[d].sessions.total}</td></tr>`,t[3]+=`<td>${i[3]} (${(i[3]/(e.length-1)).toFixed(2)})</td><td>${e[d].sessions.nb} (${e[d].sessions.nbc})</td></tr>`,t[4]+=`<td> n/a (${(i[4]/(e.length-1)).toFixed(2)})</td><td>${e[d].sessions.pu.toFixed(2)}</td></tr>`,t[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",t[6]+=`<td>${i[6]} (${(i[6]/(e.length-1)).toFixed(2)})</td><td>${e[d].defenses.total}</td></tr>`,t[7]+=`<td>${i[7]} (${(i[7]/(e.length-1)).toFixed(2)})</td><td>${e[d].defenses.nb} (${e[d].defenses.nbc})</td></tr>`,t[8]+=`<td> n/a (${(i[8]/(e.length-1)).toFixed(2)})</td><td>${e[d].defenses.pu.toFixed(2)}</td></tr>`,t[9]+=`<td>&nbsp;</td>${c}`,t[10]+=`<td>${i[10]} (${(i[10]/(e.length-1)).toFixed(2)})</td><td>${e[d].coaches.total}</td></tr>`,t[11]+=`<td>${i[11]} (${(i[11]/(e.length-1)).toFixed(2)})</td><td>${e[d].coaches.nb} (${e[d].coaches.nbc})</td></tr>`,t[12]+=`<td> n/a (${(i[12]/(e.length-1)).toFixed(2)})</td><td>${e[d].coaches.pu.toFixed(2)}</td></tr>`,t[13]+="<td>&nbsp;</td></tr>",t[14]+=`<td>${i[14]} (${(i[14]/(e.length-1)).toFixed(2)})</td><td>${e[d].bonus}</td></tr>`,t[15]+=`<td>${i[15]} (${(i[15]/(e.length-1)).toFixed(2)})</td><td>${p}</td></tr>`,t[16]+="<td>&nbsp;</td></tr>",t[17]+=`<td>${i[16]} (${(i[16]/(e.length-1)).toFixed(2)})</td><td>${e[d].kpi.jrs}</td></tr>`,t[18]+=`<td> n/a (${(i[15]/i[16]).toFixed(2)})</td><td>${(p/e[d].kpi.jrs).toFixed(2)}</td></tr>`,t[19]+=`<td>${i[18]} (${(i[18]/(e.length-1)).toFixed(2)})</td><td>${e[d].kpi.hrs.toFixed(2)}</td></tr>`,t[20]+=`<td> n/a  (${(i[15]/i[18]).toFixed(2)})</td><td>${(p/e[d].kpi.hrs).toFixed(2)}</td></tr>`,t[21]+=`<td>${i[20].toFixed(2)} (${(i[20]/(e.length-1)).toFixed(2)})</td><td>${e[d].kpi.hrsp.toFixed(2)}</td></tr>`,t[22]+=`<td> n/a  (${(i[15]/i[20]).toFixed(2)})</td><td>${(p/e[d].kpi.hrsp).toFixed(2)}</td></tr>`):(t[0]+=`<td>${dayjs(e[d].header.dtTo).format("MMMM")}</td><td>Tot.</td></thead></tr>`,t[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",t[2]+=`<td>${e[d].sessions.total}</td><td>${i[2]} (${(i[2]/e.length).toFixed(2)})</td></tr>`,t[3]+=`<td>${e[d].sessions.nb} (${e[d].sessions.nbc})</td><td>${i[3]} (${(i[3]/e.length).toFixed(2)})</td></tr>`,t[4]+=`<td>${e[d].sessions.pu.toFixed(2)}</td><td> n/a (${(i[4]/e.length).toFixed(2)})</td></tr>`,t[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",t[6]+=`<td>${e[d].defenses.total}</td><td>${i[6]} (${(i[6]/e.length).toFixed(2)})</td></tr>`,t[7]+=`<td>${e[d].defenses.nb} (${e[d].defenses.nbc})</td><td>${i[7]} (${(i[7]/e.length).toFixed(2)})</td></tr>`,t[8]+=`<td>${e[d].defenses.pu.toFixed(2)}</td><td> n/a (${(i[8]/e.length).toFixed(2)})</td></tr>`,t[9]+=`<td>&nbsp;</td>${c}`,t[10]+=`<td>${e[d].coaches.total}</td><td>${i[10]} (${(i[10]/e.length).toFixed(2)})</td></tr>`,t[11]+=`<td>${e[d].coaches.nb} (${e[d].coaches.nbc})</td><td>${i[11]} (${(i[11]/e.length).toFixed(2)})</td></tr>`,t[12]+=`<td>${e[d].coaches.pu.toFixed(2)}</td><td> n/a (${(i[12]/e.length).toFixed(2)})</td></tr>`,t[13]+="<td>&nbsp;</td></tr>",t[14]+=`<td>${e[d].bonus}</td><td>${i[14]} (${(i[14]/e.length).toFixed(2)})</td></tr>`,t[15]+=`<td>${p}</td><td>${i[15]} (${(i[15]/e.length).toFixed(2)})</td></tr>`,t[16]+="<td>&nbsp;</td></tr>",t[17]+=`<td>${e[d].kpi.jrs}</td><td>${i[16]} (${(i[16]/e.length).toFixed(2)})</td></tr>`,t[18]+=`<td>${(p/e[d].kpi.jrs).toFixed(2)}</td><td> n/a (${(i[15]/i[16]).toFixed(2)})</td></tr>`,t[19]+=`<td>${e[d].kpi.hrs.toFixed(2)}</td><td>${i[18]} (${(i[18]/e.length).toFixed(2)})</td></tr>`,t[20]+=`<td>${(p/e[d].kpi.hrs).toFixed(2)}</td><td> n/a  (${(i[15]/i[18]).toFixed(2)})</td></tr>`,t[21]+=`<td>${e[d].kpi.hrsp.toFixed(2)}</td><td>${i[20].toFixed(2)} (${(i[20]/e.length).toFixed(2)})</td></tr>`,t[22]+=`<td>${(p/e[d].kpi.hrsp).toFixed(2)}</td><td> n/a  (${(i[15]/i[20]).toFixed(2)})</td></tr>`):(t[0]+=`<td>${dayjs(e[d].header.dtTo).format("MMMM")}</td>${c}`,t[1]+=`<td>&nbsp;</td>${c}`,t[2]+=`<td>${e[d].sessions.total}</td>${c}`,t[3]+=`<td>${e[d].sessions.nb} (${e[d].sessions.nbc})</td>${c}`,t[4]+=`<td>${e[d].sessions.pu.toFixed(2)}</td>${c}`,t[5]+=`<td>&nbsp;</td>${c}`,t[6]+=`<td>${e[d].defenses.total}</td>${c}`,t[7]+=`<td>${e[d].defenses.nb} (${e[d].defenses.nbc})</td>${c}`,t[8]+=`<td>${e[d].defenses.pu.toFixed(2)}</td>${c}`,t[9]+=`<td>&nbsp;</td>${c}`,t[10]+=`<td>${e[d].coaches.total}</td>${c}`,t[11]+=`<td>${e[d].coaches.nb} (${e[d].coaches.nbc})</td>${c}`,t[12]+=`<td>${e[d].coaches.pu.toFixed(2)}</td>${c}`,t[13]+=`<td>&nbsp;</td>${c}`,t[14]+=`<td>${e[d].bonus}</td>${c}`,t[15]+=`<td>${p}</td>${c}`,t[16]+=`<td>&nbsp;</td>${c}`,t[17]+=`<td>${e[d].kpi.jrs}</td>${c}`,t[18]+=`<td>${(p/e[d].kpi.jrs).toFixed(2)}</td>${c}`,t[19]+=`<td>${e[d].kpi.hrs.toFixed(2)}</td>${c}`,t[20]+=`<td>${(p/e[d].kpi.hrs).toFixed(2)}</td>${c}`,t[21]+=`<td>${e[d].kpi.hrsp.toFixed(2)}</td>${c}`,t[22]+=`<td>${(p/e[d].kpi.hrsp).toFixed(2)}</td>${c}`),u=u.add(1,"month"),l=u.endOf("month")}s="<table>"+t.join(" ")+`</tbody><tfoot><tr><td colspan=${e.length+1}>la valeur entre parenth\xE8se fait reference aux annul\xE9s</td></tr></tfoot></table>`,Swal.fire({title:`<strong>Statistiques du ${f.format("DD/MM/YYYY")} au ${n.format("DD/MM/YYYY")}</strong>`,icon:"info",html:s,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:p=>{}})};var Re=class{},Pt=Re;q(Pt,"init",function(){console.log("%cin initUI",O),Re.build();var n=new Draggabilly(".draggable",{handle:".handle"})}),q(Pt,"build",function(){console.log("%c in buildUI","background-color:green;color:white"),GM_addStyle(`
.flow > * + * {
  margin-top: var(--flow-space, 1em);
}
		`),GM_addStyle(".panel {/* because of stacking context : https://stackoverflow.com/questions/5218927/z-index-not-working-with-fixed-positioning */position: relative;z-index: 666; /*seems that 4 is good*/}"),GM_addStyle(".menuBar {padding:7px;/*for handler*/font-size: 1rem; pointer-events: inherit;}"),GM_addStyle(".draggable {background: transparent;border-radius: 10px;padding: 20px;}"),GM_addStyle(".draggable.is-pointer-down {background: #09F;}"),GM_addStyle(".draggable.is-dragging { opacity: 0.7; }"),GM_addStyle(".handle {background: #555;background: hsla(0, 0%, 0%, 0.4);width: 20px;height: 20px; border-radius: 10px; position: relative; top:10px; left:-10px;}"),GM_addStyle(`
.menuBar{
/*Smol Responsive CSS Grid*/
--min: 15ch;
--gap: 1rem;
display: grid;
grid-gap: var(--gap);
/* min() with 100% prevents overflow
in extra narrow spaces */
grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--min)), 1fr)); /* 20 px is size of handle*/ 
}
		`);var n=document.createElement("div"),e=document.createElement("div");e.classList.add("handle"),n.appendChild(e),n.classList.add("panel","draggable"),document.body.insertAdjacentElement("beforeend",n),n.setAttribute("style",`top:-${document.body.offsetHeight-n.offsetHeight}px`);var s=document.createElement("div");s.classList.add("menuBar"),n.appendChild(s),Re.addButton("collectChecked",zn,{},s),Re.addButton("CollectAuto",Qn,{},s),Re.addButton("showBill",Zn,{},s),Re.addButton("billInDetails",Vn,{},s),Re.addButton("PDF",Kn,{},s),Re.addButton("SList",be.showList,{},s),Re.addButton("DbgMode",Wn,{},s),Re.addButton("statistics",Xn,{},s),Re.addButton("Database",Jn,{},s),Re.addButton("about",Vt,{},s);let t=document.createElement("div"),i=t.style;t.id="sttPlaceHolder";let u={position:"absolute",bottom:"7%",left:"4%","z-index":999,display:"hidden"};document.body.insertAdjacentElement("beforeend",t),Object.keys(u).forEach(l=>i[l]=u[l])}),q(Pt,"addButton",function(n,e,s,t){t=t||document.body,s=s||{position:"absolute",bottom:"7%",left:"4%","z-index":3};let i=document.createElement("button"),u=i.style;return i.classList.add("button--primary","button"),t.appendChild(i),i.innerHTML=n,i.onclick=e,Object.keys(s).forEach(l=>u[l]=s[l]),i});var ln=class{};q(ln,"start",function(n){let e=document.getElementById(n),s=c=>e.style.transform=`translateX(${c}px)`,t=0,i=7,u=c=>{s(t),t+=i,t>100?requestAnimationFrame(l):requestAnimationFrame(u)},l=c=>{s(t),t-=i,t<-100?requestAnimationFrame(u):requestAnimationFrame(l)};return requestAnimationFrame(u)}),q(ln,"stop",function(n){window.cancelAnimationFrame(n)});var er=Pt;var ei="#OCAddonsCfg {background-color: lightblue;} #OCAddonsCfg .reset_holder {float: left; position: relative; bottom: -1em;} #OCAddonsCfg .saveclose_buttons {margin: .7em;}",ti="height: 16.7em; width: 30em; border: 1px solid; border-radius: 3px; position: fixed; z-index: 999;";var tr={id:"OCAddonsCfg",title:"Configuration du module",fields:{nbHrsAfM:{section:["Statistiques","param\xE8tres"],label:"Nombre de minutes pour une session d'\xE9tudiant auto financ\xE9",title:"Dur\xE9e moyenne d'une session AF (calcul du THM)",labelPos:"left",type:"input",default:30},nbHrsfM:{label:"Nombre de minutes pour une session d'\xE9tudiant financ\xE9",title:"Dur\xE9e moyenne d'une session Financ\xE9e (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsS:{label:"Nombre de minutes pour une session (avant 01/07/2020)",title:"Dur\xE9e moyenne d'une session avant la s\xE9paration auto financ\xE9 | financ\xE9 (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsD:{label:"Nombre de minutes pour une session de soutenance",title:"Dur\xE9e moyenne d'une sessionde soutenance AF (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsC:{label:"Nombre de minutes pour une session de coaching",title:"Dur\xE9e moyenne d'une session de coachine (calcul du THM)",labelPos:"left",type:"input",default:45},maxfetchpg:{section:["Application","optimisation"],label:"Maximum de page recherch\xE9es dans l'historique",labelPos:"left",type:"input",default:1e3},datacachelifetime:{label:"Temps de conservation des donn\xE9es dans le cache (en ms)",labelPos:"left",type:"input",default:12e4},checksessionalreadyexists:{section:["Application","Base de donn\xE9e"],label:"sessions: v\xE9rifier existence avant insertion",labelPos:"left",type:"checkbox",default:!0},sizeofcontentlist:{section:["Interface","th\xE8me"],label:"taille de la police des listes",labelPos:"left",type:"input",default:"1em;"},use_custom_css:{label:"utiliser des styles personnalis\xE9s",labelPos:"left",type:"checkbox",default:!1},custom_css_url:{label:"url de la feuille de style (si plusieurs les s\xE9parer par des virgules)",labelPos:"left",type:"input",default:""},custom_css_data:{label:"code css \xE0 injecter ?",title:"saisir ici le code css \xE0 injecter directement dans la page web g\xE9n\xE9r\xE9e",labelPos:"left",type:"input",default:""},alwaysaddcbox:{section:["Interface","Gadget"],label:"Toujours ajouter les checkbox sur l'interface",labelPos:"left",type:"checkbox",default:!0},hackheaderzindex:{section:["","Hack"],label:"Changer le zindex du bandeau haut",title:"le bandeau haut \xE0 un z-index  (1000) qui le place au dessus de tout ce qui est pr\xE9sent \xE0 l'\xE9cran, ce qui g\xEAne la barre de menu ; activer cette option r\xE9duit ce chiffre \xE0 0",labelPos:"left",type:"checkbox",default:!0},use_student_cache:{section:["Avanc\xE9es",""],label:"Utiliser le cache \xE9tudiant",title:"Lorsque l' application recherche si un \xE9tudiant est pr\xE9sent on utilise un cache pour \xE9viter de passer trop de temps dans les requ\xEAtes, d\xE9sactiver le cache permettra de toujours faire une requete en base ",labelPos:"left",type:"checkbox",default:!0},support:{section:["","Support"],label:"StephaneTy-Pro.github.io",title:"more info on https://github.com/StephaneTy-Pro",type:"button",click:()=>{GM_openInTab("https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon",{active:!0,insert:!0,setParent:!0})}}},css:ei,events:{save:function(){GM_config.close()}}},un=function(){GM_config.open(),OCAddonsCfg.style=ti};var cn=class{};q(cn,"longTaskTiming",function(){if(window.self===window.top){console.log("LongTasks: Initializing");var n=new window.PerformanceObserver(function(e){for(var s=e.getEntries(),t=0;t<s.length;t++)console.log("LongTasks: ",s[t].name,s[t].duration,s[t].attribution.length,s[t].attribution.length>0?s[t].attribution[0].containerType:null,s[t].attribution.length>0?s[t].attribution[0].containerName:null,s[t].attribution.length>0?s[t].attribution[0].containerSrc:null,s[t].attribution.length>0?s[t].attribution[0].containerId:null,s[t])});typeof window.PerformanceLongTaskTiming!="undefined"?console.log("LongTasks: Appears to be supported"):console.log("LongTasks: Not supported");try{n.observe({entryTypes:["longtask"]})}catch(e){console.log("LongTasks: Not supported")}}}),q(cn,"paintTiming",function(){if(window.self===window.top){console.log("PaintTiming: Initializing");var n=new window.PerformanceObserver(function(e){for(var s=e.getEntries(),t=0;t<s.length;t++)console.log("PaintTiming: ",s[t].name,s[t].startTime)});if(typeof window.PerformancePaintTiming!="undefined")console.log("PaintTiming: Appears to be supported");else{console.log("PaintTiming: Not supported");return}try{n.observe({entryTypes:["paint"],buffered:!0})}catch(e){console.log("PaintTiming: Not supported")}}});var fn=function(f,n,e,s,t,i,u){i=n.createElement(e),u=n.getElementsByTagName(e)[0],i.appendChild(n.createTextNode(s.text)),i.onload=t(s),u?u.parentNode.insertBefore(i,u):n.head.appendChild(i)};var ni=function(f,n){if(!arguments.length)return Promise.reject(new ReferenceError("Failed to execute 'fetchInject': 1 argument required but only 0 present."));if(arguments[0]&&arguments[0].constructor!==Array)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 1 must be of type 'Array'."));if(arguments[1]&&arguments[1].constructor!==Promise)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 2 must be of type 'Promise'."));let e=[],s=n?[].concat(n):[],t=[];return f.forEach(i=>s.push(window.fetch(i).then(u=>[u.clone().text(),u.blob()]).then(u=>Promise.all(u).then(l=>{e.push({text:l[0],blob:l[1]})})))),Promise.all(s).then(()=>(e.forEach(i=>{t.push({then:u=>{i.blob.type.includes("text/css")?fn(window,document,"style",i,u):fn(window,document,"script",i,u)}})}),Promise.all(t)))},St=ni;var ra=function(f,n,e){"use strict";if(!f.MutationObserver||typeof HTMLElement=="undefined")return;var s=0,t=function(){var h=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(w,b){return w instanceof HTMLElement&&h.call(w,b)},addMethod:function(w,b,T){var x=w[b];w[b]=function(){if(T.length==arguments.length)return T.apply(this,arguments);if(typeof x=="function")return x.apply(this,arguments)}},callCallbacks:function(w,b){b&&b.options.onceOnly&&b.firedElems.length==1&&(w=[w[0]]);for(var T=0,x;x=w[T];T++)x&&x.callback&&x.callback.call(x.elem,x.elem);b&&b.options.onceOnly&&b.firedElems.length==1&&b.me.unbindEventWithSelectorAndCallback.call(b.target,b.selector,b.callback)},checkChildNodesRecursively:function(w,b,T,x){for(var E=0,y;y=w[E];E++)T(y,b,x)&&x.push({callback:b.callback,elem:y}),y.childNodes.length>0&&t.checkChildNodesRecursively(y.childNodes,b,T,x)},mergeArrays:function(w,b){var T={},x;for(x in w)w.hasOwnProperty(x)&&(T[x]=w[x]);for(x in b)b.hasOwnProperty(x)&&(T[x]=b[x]);return T},toElementsArray:function(w){return typeof w!="undefined"&&(typeof w.length!="number"||w===f)&&(w=[w]),w}}}(),i=function(){var h=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return h.prototype.addEvent=function(w,b,T,x){var E={target:w,selector:b,options:T,callback:x,firedElems:[]};return this._beforeAdding&&this._beforeAdding(E),this._eventsBucket.push(E),E},h.prototype.removeEvent=function(w){for(var b=this._eventsBucket.length-1,T;T=this._eventsBucket[b];b--)if(w(T)){this._beforeRemoving&&this._beforeRemoving(T);var x=this._eventsBucket.splice(b,1);x&&x.length&&(x[0].callback=null)}},h.prototype.beforeAdding=function(w){this._beforeAdding=w},h.prototype.beforeRemoving=function(w){this._beforeRemoving=w},h}(),u=function(h,w){var b=new i,T=this,x={fireOnAttributesModification:!1};return b.beforeAdding(function(E){var y=E.target,m;(y===f.document||y===f)&&(y=document.getElementsByTagName("html")[0]),m=new MutationObserver(function(a){w.call(this,a,E)});var g=h(E.options);m.observe(y,g),E.observer=m,E.me=T}),b.beforeRemoving(function(E){E.observer.disconnect()}),this.bindEvent=function(E,y,m){y=t.mergeArrays(x,y);for(var g=t.toElementsArray(this),a=0;a<g.length;a++)b.addEvent(g[a],E,y,m)},this.unbindEvent=function(){var E=t.toElementsArray(this);b.removeEvent(function(y){for(var m=0;m<E.length;m++)if(this===e||y.target===E[m])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(E){var y=t.toElementsArray(this),m=E,g;typeof E=="function"?g=function(a){for(var A=0;A<y.length;A++)if((this===e||a.target===y[A])&&a.callback===m)return!0;return!1}:g=function(a){for(var A=0;A<y.length;A++)if((this===e||a.target===y[A])&&a.selector===E)return!0;return!1},b.removeEvent(g)},this.unbindEventWithSelectorAndCallback=function(E,y){var m=t.toElementsArray(this);b.removeEvent(function(g){for(var a=0;a<m.length;a++)if((this===e||g.target===m[a])&&g.selector===E&&g.callback===y)return!0;return!1})},this},l=function(){var h={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function w(E){var y={attributes:!1,childList:!0,subtree:!0};return E.fireOnAttributesModification&&(y.attributes=!0),y}function b(E,y){E.forEach(function(m){var g=m.addedNodes,a=m.target,A=[],M;g!==null&&g.length>0?t.checkChildNodesRecursively(g,y,T,A):m.type==="attributes"&&T(a,y,A)&&A.push({callback:y.callback,elem:a}),t.callCallbacks(A,y)})}function T(E,y,m){return t.matchesSelector(E,y.selector)&&(E._id===e&&(E._id=s++),y.firedElems.indexOf(E._id)==-1)?(y.firedElems.push(E._id),!0):!1}d=new u(w,b);var x=d.bindEvent;return d.bindEvent=function(E,y,m){typeof m=="undefined"?(m=y,y=h):y=t.mergeArrays(h,y);var g=t.toElementsArray(this);if(y.existing){for(var a=[],A=0;A<g.length;A++)for(var M=g[A].querySelectorAll(E),j=0;j<M.length;j++)a.push({callback:m,elem:M[j]});if(y.onceOnly&&a.length)return m.call(a[0].elem,a[0].elem);setTimeout(t.callCallbacks,1,a)}x.call(this,E,y,m)},d},c=function(){var h={};function w(){var E={childList:!0,subtree:!0};return E}function b(E,y){E.forEach(function(m){var g=m.removedNodes,a=[];g!==null&&g.length>0&&t.checkChildNodesRecursively(g,y,T,a),t.callCallbacks(a,y)})}function T(E,y){return t.matchesSelector(E,y.selector)}p=new u(w,b);var x=p.bindEvent;return p.bindEvent=function(E,y,m){typeof m=="undefined"?(m=y,y=h):y=t.mergeArrays(h,y),x.call(this,E,y,m)},p},d=new l,p=new c;function o(h,w,b){t.addMethod(w,b,h.unbindEvent),t.addMethod(w,b,h.unbindEventWithSelectorOrCallback),t.addMethod(w,b,h.unbindEventWithSelectorAndCallback)}function v(h){h.arrive=d.bindEvent,o(d,h,"unbindArrive"),h.leave=p.bindEvent,o(p,h,"unbindLeave")}n&&v(n.fn),v(HTMLElement.prototype),v(NodeList.prototype),v(HTMLCollection.prototype),v(HTMLDocument.prototype),v(Window.prototype);var S={};return o(d,S,"unbindAllArrive"),o(p,S,"unbindAllLeave"),S}(window,typeof jQuery=="undefined"?null:jQuery,void 0);var nr={data:"DwCwLgtgNgfAUKApgQwCb2BRZkAIDGIyATgM7YC8ARAK5gBmAtABxUYCEjjuADgPY1iARxp8AlrjEA7fFEGJcURKUViARitSIaAD1z1xKgPy5GMXgOIWaAN3FWlKgFYDEVxFNwQ+W3KRxSqMhQfFIKXBik+MRiPGB+xPjU4GA8pABcAPSZ+KhSAHROpFpQYjbE+WFgmVI8EJmkAO6I2MFuYABMAAIAjAAMbMAN0bFgkSNxCUlUKWlZmTS1ANYA5vn4fPVBAJ5FvfnM+R09mTtF+RDShaRUuFr0brgwQ1ExcRxcuNZWAJIAoj0eqYzAhXqMpskwKkMtlcgUiiUyhUqpkViBMsEeNJEEUMVAsWEujYOvkdKTTmJ-HiCYhGGJEIDrrd7m5nsM3mMEJxuPxBIplLhkHRiAKpMgbGIVsgwNoyMDxhyITMoXNYXlrojypVsKj0Zjsbj9YTiaTyahKdUjYgmWywe84KCwNslPA1D5trgAN5wL4GKRgRj0ZCXKDbdK4KgAeR4HlwAGVkFIbgAaUzIHg8JSMUjbfyICCpgBCpSkSwAssh8HHczKIAAxUJgVNUOOIFZ8BQAVR+VFTACU+G6wHxU5GdNsVh5GAmk6nO2pFmAaKmAMKJnAiqBQZsACUQUBs2DE+DwADltIhe7g9wejyfUwBBGLBVOkROkbNuMT0ADcuDgAC+CANE6LrASAKDoA6wBuqg2zwAg5o2AQUDIKQpDULWmbSpeGAUjYCGghMnJwI00ioHwjT5CyxAADJ8Gg0grA++LYrgFD6Is+BgGIoS4AAFCeW5qJWSwAJRenAACQUkbEmfBKPkIQrPxVA0YoDHmlIKxUGJP4+l8hlfGRgSUfkaCoH8h7+rRFoeG4-EAORNMEjmpvQXE8Xx-GIBJ3pGUZsmhKQCnWspqmINZ8TOY0rm4CK+CIGUiCoKmFEEMEUAifgSy6fpAWGUF8mKeFvn5QVAVCVlon8XpBkFQBdUVQQwWhUpfAqY5kUePE5BgI5TWGQB+lySFJUdapNH0Yx2ksTSfjYDKqB5XAHkyF5niTmAnbEFAABqJCkLVklGTYJC4GdcocZ6w31Rd508CQYAqBxJkUVRIQnht+QgCK9D5CK2GJfxmQANpGAAZAAugA1PxoMAHoUNDMNiRQ8MI9DABUYmomI7mebxUj8QWSyINsyZnXIvknRVl2kKDZPbFD7H3dT5VfI1HPxdggiePT+lAathN8VtO1QAACiQwb8Y9xDBtgbhpYgQY0FAYBUzQvn+YZl24II+LS1gMpWBx9xCurmuINz378W9ZmfdKRM-X9+TkYgOiRvQstG4rxASeYjA9GJOsFQbcsKybrNi7tB1kLVoMR8bbhQ9zRlAUZIpLsQnjh77JuCw6esURAfaQR6HFrdxRMCX50lZ3zuBhI0uAS8QmyUog-EimNh7seY3oyd+AkUfgNBYP6APl3GOAyuxHFUCEM06XXMlSaP489eZqCWVFtl5mExCqQAIpGZYro2PXTVoy2pj3CmHmJ0lSQBuD7uQklr-ft61fpMlAS-J+t04D8TQtsGQx0KAD2kqNNq4UqAAFJ8D5HyP4J6V4qAbBCMQdIGx5ZQBWlJZAsUxDxBLmXNA2xf4wNauNFSiDch8HwJIFQIpKEYKwXwHBeDgiEP4DwGgPBqFFTGmFCaDCUH5A8LfCMnDuFcN4XVKSgExLULgJkLGPosb6x4qUJ0nF1o1xoOQVAkhTFnBUJSRy-p9YmK0f+XA2ivgNxzgQQQIobFBBlKmR6O8Uq4DImAEAuA+iSHoE3FoN8tGZDgHrLaAAVCCx8cLsSrhtY6g80k118fxUgfkebZ08Lk3AwBcD9AkiYRyfRHK4Bhn4XA4ZSB-gAcXVmzdcDJJlLVeuvNXGg1QPkLadY1ZQAAJooCPhJHxaB+IDK2mWRsIBaow2DtM1AszBnYE6V3MSYkoaFHEMTRyjABqASLg9PgAieCszATIAx1dQi1UHsPfiToYx8HCXGWKUBcDsAoBxRyWTQgDUHiItqbh25HwYT8YgCU+CHnlmoJQb9YVcIwdlVY7dFioEYHI9IIpUp4qRaJQhUkXFSD-i-aS2RgR3AAJf0GkKQmuWgVD7nzD1FQGwIAQEWKQalORgq9RlGkVmoNHI9DcrgRyHQpWOQAMyOShtJJQwrECio4uKyVyYZVKpoUmXq3yACKWstYz3VazL5wQLhiB0NIfioKAD6WE44ZCbiM5MBkZJyUZcQCAhY6DDikPEj2YBwyOTjDQMo65cAQ3lrCn8bkvWyUTIlKAAaoShBDToMN0q250vwHSrQNiIaoQTUmr4MkeDtxWD3Ug5q5h+BFaQT1layXdTIIgDNQa3VgGIFrVtuAZJUzEF4omZZlBvknOGlcChCDBlFcoeIIoRBWM9TJc0qBoweHDECop3gghQFXmvWBdDVKSKtVAdIm7t1SFJTJe2VFzSkEemAQgVker8WfmvdpK5jHDggB+-0TkXJQCld+mSnpcALjUEi5Q4Y+0DruK0MQV6vS4BlDm8MUYADS+RbivwAWvKST9iNKJfqmZ+ZEty3t3SLYm2tv2nrEfQi93z0jUagLe0lAF13r1HWXQIbg6OGO8ge4IIcIPMfaqxtjwRr0CekW4e9UlH3UUpK+99UV+K-v-ZsIDYAQPfKlVBmDcHe39sQMrHAqHwxQcw7myB5gHMkBQPkK2uBCO7OfrxqjqGoArhCOQETDzibiaPaC71tCWPnskfkS9HH-OBb4OQHjfHN3JeC-c9J4XJPEek-AuLKCEsZaC5ecjvmN2juPku9uYZstExJj4CTkWwVnqoEV4r7HN01f8HVtLz9pJc2kvq-wbMtYvVwKDVOKrsBuNhT1Btf9RvxEemEKAjrGggFCpGYgrYlDcVZqCniYBkVSXDSahQdg1aIAAF4XQECoN8tg2wkC0MQJNMlwDQCMuGAABs-YAShJyBBgCubblJKTkHu2BulMpAhayGMD6R8AZLAEZfuVAfVUdSWAEhFCaEMJUAMH62to62CA+kAI+Io7qCEHEIlW4YosB04h4zjD2wYzJFHcW24VtqBSBGYMbkRBAjIoXJmzwshjxLAIGz8IIIZLxIEPED2-BiAmxgoGvitOqDvmaMQHozJpTIEYJWDa1A1dcLAI6zKtxZCE+oKBjo2ZQIpVuG8xA1AJdBrYJGHDQwfehBx3GOlUAC0bUPvyFQOBzNa8l2Y6g+u3AdGNzgM3oXLc6HVzb0Il4CfoSd98l3-hnTu451zqgQe70wH94H7XUgcdDAx1ALH2Am+ohiFBGSf2+PVsQBfKQvqIAhfScgVMahkz4GTKlGmn8ovFRi+Pyf0-Z-kakqq3Azr8w8Fdd+vtHpWvb4gLvw6rMABScZIynnyHLcgsymGb0niINw2x9uIG4lwpyoNmde8wfLqgKGAadzYILWdfKSWEaLGTVSENE-dIK8Y-U-MgdfV+L6QgHyY9GSSAxfaAv7JBP4HQRKOIGuAAEk9EQAAl72lTxR4SgB-AxVrQEECFxQUi4XxRSgGkpRkkvVQW20aAOlKDHVCAnXQmQEnH4j+wnUSAkF8Hp0hysEWAUFZWQ10FwEuQ2lID+3APJX0GCHIC4KIzaxi0v2v1v0Oi7g3gnjAHyBf2IDf3ZU-yPkch-wVlZwZ0vCALEhAOpl2S4OyFtk9w+S3xdTP3+QBWxRVmxFQBqQAB8Yjgid9XV54OJBctw8sh5vYEiT8kiwj3U0jWseDSA+CBDR0nZhDJ0xCu5JC3B8AZC50IdSAxAFCwhkNNBtA9B1CiZNDtDelPAgwoB9Dv1X5v1sDRFcCkFYCkCWFcAyDEDXVKDkxMFWD5F8F70dDPQ8weB0gehUwrZ0g5jDohZ-4+MNFn4nArtkBKRkM7AmjeAnpbjSA+RFDkMZRQs7hHI6VrIOUbE5smhSFCBHhHiHBHJFg1CaBFBHIhQ+0lCBR2UrC2jFA8AX8tY34+jQhQsziFAYxVCtBXio5UIWoDU7j1tNttslBdt39uJUxzivAupPByANc7h0TvheB25HpJwHAFBiA6VHj1ZpRcBJFcAABzvAFov0ULFox6FQZ+LGGJB9fzWjBrbyfcTAgrcROTK9Tjbjdfb9fcGwrWOwyk4cJw-IEnCAMnaIrwiyAzfeeHByRyaXHKKVR1UXVAJQU2JUhjSTKTKA8KPA-AAzXAeJEgLacMMg60DcLaBYpY7BXBBRAhcAn0okq3DXFiDbc3GuSuejHyGwMAdIteW2SKawyM7AC4aUAEo6RyavfpE3DPC3KgFMm3O3Tw-Mk9X0iaf0ggnPXAB8WiWiOXdw3vGMtg2glTLAzINbfcUknbPbBw6wg4q6aVRs23LcRyP8GlDYNWPIRyeIYxBQUhCDGSIs9YdxHqYM4gLafU1-I0r-Zw3-Nw48Dw4AjzDiEwm-PrJib8KhT0PYhs7Pa3FcghRqQ8iA04RABcFYDkrgmSIdHgx0pYQfYfYRYjIdQwmSclaC26fLIVN+f8jXSMMIW3N4rM0TBjXM1sqSQs3M-IEs6ww8iAcsiCSs6srxU3DM0ILPHPR1PPQAgaCi0CycjbLbGco0-IBcybLqPC3PMINc3ADcgQVvKQHc2xfcsAEC48seBbf0c8y82w+wg7Y07-e8--dw3irwl83AN81BPtT8+gb8385cni4C4jKSIdNUlSf0n4JMdoQUJtC1fk-gRojaBpGYz0HgraS7M1EVZZHoaMmg+Msc2C75N2byjXSKxABtH2EkrbaUZXBMQ8ZMcK7AdKzKsSFZUjFyzY0gVBTMR8-iIqsAEq6KsqnYkJVMCVNQTgkCng6QBkxq01DK6KwSx1M06UQq5KiKga0qmGDoCq4jKqmq0oYGBqpq9VZZDoVMPodqnofALqlyoybITfR1NQMATwDiBqxCpo-1BvZCteIdbIY6069YJapYW6mCqSOCl6y6v1N6l+f8YjDCiDLCteDRQUN40hRxOUteRstMoi9JMqCDRsgixAOGxrBGteYbf+IbB0ERVbRMKcnKsAPK8UBQa6Z+E7M7C7FE67JQe7a7J7IUQ8KUYgd7T7KSb7KAc7XAAHNePHMoZNKSHQRgVi6gUOIdGSWPRwOzO6NtKSHoOzMxcMfoVMMAJFdIZyJcYtZ6KVBzcNP4TWsQdcUgGpXzAqNeDoBW0dcMDoLajDNW5ySdLonW0NcNVsdCJ2zzQdQKGSeVS21AcMeVW21Wq9DWmgLW0gF0i0LhbYZ2rDaVHcKOmIF-FQOHMOw2-0Y2z2mW8WqSAAFj9vDFzqDvtpAETu2EdXIHdtCEdRPABNjtzUcgrGEBRPZIUErsaOChNq9sKhkgAFYC7cBe7i6Q7jZkB67w1j5QgpA6UWgVB0xaqvpkpM7Tae6qVZaAIqBv0cdcc1Z4BZbgBuQeYxsgisJUI54Ig7pebT6cJs614haSdqBQZR1djQDEAWZpBcBIw1BzjuIpF-QYhlBXlkBzMxJN6zaZJ0gmZqBydL6ZI96ApebSh4Hva0cqc6AK8-8ASco3QdBbh0hdcrY3ZloGljLCHg6+dX7qAKdwG0dUI1B9wGkH6qBCHydcAhaHNqAyHQ1BhMg6H9xkHV6kcxABHebMhr6ZRt7ccFhYBv0hgkIcde9n5+9vqR9a5+559QLBQY8IIRRpi8AsGlgcGAlSFgkpA+AzFJAvB-19BUMo4ddTFhw+AmMcLuLLUJrsAJZLlBFaorzDS5yuE0zv9PcKADGcGoYn7UBPCuDN8JAOJuKlIPAVgglUxbdYU2lEAW4nx5YqExA9J-qZISd+I-wxAuA-xUniAn6WZrorbuLKmiHUxf99i+A6nf8p8IIcoUomm6mDGUpMb0Lej0NNj0gNrxtEBwxymiMAEsLRo8aSSvFSb58KbEAuaqBLstwBR5mUxn4OauaebcdS8wIsDtEhJpEAGrA0B0wwA6VkNcBZgYRBVsFSg1B1hNhMhsB8BMgRQVgzSHmuEnnGAvmzTGAOhe7MhbmVR7m5EnmXmthKIpAl5UBMgegABOVFsF2U5+DRPhqAaiHCdIdIZAegKOT0OSeHXNKgAAHUQGYHlQADYqAfxArmVQhwxNwnZDwfwlAiXC6+geAdAfxhwtjB6+WfwAIMWCmuEIAvRn1sJ6sLTGWLImIlb8x6DRJGDsVwwABiegZFnVnV+grhd7JWvlvwBSUdXATV-AHa61n8Bii86Qa2kUKVqE8x0JF1215AIWsiVAIJcMWlvoXl-l3xLSFYZViAUV5+M0yQWodBz0BgrFQILV+gZNg1lm4TMpE1sac1zV5F-AXN3NiNiVv1aDBvL0eNpg-21QNEMAWtcmBVneJVkJfIAAdhVe9d9bKQDYQVTaNZCULakijer3SG2wRTLbVYTcrfbFb37ajexa9GDcbb6HyF7vzCbZXalaXfXb7aIyjbQfiE9AXe0nDCXdbfDbtZWGkEYCHAA2PeXadZnclejep3SAMDHhUE9BVxLDGdwHlUzbNdMSndQH7a6CwHNDwBJkvfbZAB5cDb8lNMldtx3j4k9AtMYHEdpCwXHiTGtoDZNZ6HoGIB-FQ6lCFZ6FpZFdfng79UQ4ok8Dnc9AczN1KBWCkFZclHACI67xYLkAgFY7KTktwA6FFYFLNJo51xjabBE4Q4sj4mry9FQ8w94+toE-lVFaIxeDdyb13dQGoD7AfAAC17dUJC9idpOkO70wb6yKdUGJOMHWcP9DG+BcHE8q8jS082LM8qA+oK65yjB7d2myZu9cc52mH8A1AjTdtTw+AwA2BQ8DKiYo9nieA6UYgfAFAjAkdgH+HAcQuuFqAfW6x24IAjPHc1IcI2BtkbnUA6UJdMv6GZGbPqcXOCuiuPdOc-95nbgGKdBqAbbA6g4Xd5UjcvBpBeu+h+gBvGAhv3O6yiYndsBHV5mRrWu7hazUJtIaBKiKBAUPsm9cviB8uia+ASuTPOuYBKvfBGUpA6vsvGv0HdcfXlc2vK9OuvBPWxv+uehBvhvLgpAxuJuvupvhvWLZuOKvOFulvhwZv1uVhNvJxtuCPHIO8zSm8X1EwYAouZRwxkVGV1ZdGgTETVu54WjShLg54X9o8Foq6kwClLBp7lAXg1sFG+8RQVHwwnMNHv01BzwUpKuzZH8rDNkwA-glArDCxtgfh1kqyjTgCemgPv0WvNhWZLCt4toRfviwBxfJenJFeIBnzX6uDHvzH+ex5Be1fReeotepfdf9f2Zv1v1bZufIk+f-kMNLNY0IYBI7gwBCulfciqBbg4jvfldkiIxdJcBWzCjijghSiNoRCp0qipDaibnSAw8P9I9Hhnj5mwT6UNgASYd9G0IYS-A0-QstDoKdD+jBiMb8nlEv4BnWshn5VKNiM9jQZDyVfJ5zeNerenJwu5zZeAuUo+M15O-rDu+xeJfrefeivgDn1gGlBTFcjEN0u8iflwwx+hf1fJ-tfHIbfzLX6R+N0BfVfsBt-Lep+deju5-KQF--Fl-3eTBUj1+mTTfT-heLf-Re+9-r+D-qYINlUGNSlJVn4xboYwfHHyEenUZi1AoepPSjeRNKicZOSlK0jvBtJ2RD4TkedNpEQDOlXS7pVmHugwIwCKouNBaGAG2S+8IAqNPiCRVCw5k8yrWSit7GPK0Uyyb6Jit-hB7sU-u4PG3EtwI6bAzKFFTfBYlZh1hzcggekBUCebVUru6yY3uYD4BEN540qCxHtWIy2wxBuRCIldxSj8V3KqkJBD8D7B9g-gK4SMHtD+B6dCwtEP4LgGsF9hIwfYXAKeD+B-Bj4PZFcCuD+Bxg4wQZSMPGDPj2CHwEsCWLRB+ArgHw8SH4NflwB7QHwfYOML2BApVlx2FbbjmwQJR-giUqEHKImhArgF+mhSaClShcraDVuuwaqnEGIAd8T+XfM-p-016X8f+yuW3iiQ4ggULED+N-g0I-498Wh+-bwmARAp-0t03sRyN4H9AgBgCo1QzFQFGSLDRkjAMsGWEYDHxj4Y5KSOQCgD-RxKYqT0IINUab8J+F-XfkMKtgq0+A16eoeP0aEDDzhv-YYRQUAEoU0K7aEoUDWgpJkxsfUB8HBjypzk+enpBgRRSorFkQypZBihwMAbOFuBnnbzjsPT5+cWyTAoyEdTUDK9bhW-Jod-374GVB+DnFKKUPXjYjThX-QYTP02A383wcGJfr8i3xqAuhZI+4Tv2n5tCvC8-OkazHYCMjDyaFYGkc0s41wIa4rNeH1EoFFcaBXpaCn8IBF8AjS2yDAmnAqjDZmoB1QVDgXgRIJQgt6CwFcg4TLE4yqxQaKqO7pGRSsKWb9pAIkhQJaY6ogKHAINL6V0+t5KjtQOQHAEnW8KRAOgIPgOR-8iYScAgVFyt43ApogKJViGx-wZmxJKcnMKOzk1SElNaVGs30CStpQbNHZv9kBxIQBaQtEWlQDFprxJa8Ge0avXlroYranbdyBmLDSOQigwKFWi7WlSNilKWdGhhbSrGVsbatYv1NKHVr4BSANgcetQWHFd1b6MkWBmvRzob0t6sjXegLQPqfAe48QE+jvjPoK4RGaOdDpOMFqBg8uVACJi-Wpjv1PAX9H+tYR6gAMjopYvJGAwQYQMoGVAGBigwEb70kGe43HHuzs7-4HOODPBgQ1fpEM8GpDYCXMIobUwqG74nOsFyy7r8mGLDYhuw1DScNgJDmHhtixgmiNPxKDIYOh0kZDBFxojeRoNh7ws8B8oQYfOz1tHQIQaYLNCBhh0b7k56cuf8U52MZBIm45jc1hIF5RjZcedjTwOa0cY-D4grjc6u4zACeMrkPjeAf42ICBNnCwTUJk53CajoomEGGJqzHiZKBtIyTLfCQA9LtIsmyAHJnkwgyFNimpTQybCkqZHYamzTMQPsmfpNwFYXTZyZUAVhtMiR-tWpp5Ll59NihjcKDEM1zonitY4zIyYYSmbLZthxqKaiKivJax4YSjfGkJTJKIAKSc5PvOlMW44R10UMLwkEg8D8QBIPcNWHmWgHPxRBjqY+CJA-gcQJB3EKQW4HyBLBjOcg8iPxEUFqEVBrvRyPVKL4aCtBdUhqaTVd66Coi+ZQwdClMHmDLB1gh8LYPsGODnBrg9wZ4IfDeDfB-g+JIEKvxlgQhYQiIVEJiFxCEhSQlIWvDSE5R1WzBPFNkJaixliUOUY2t+nXyA0saG6MaUX2V6-TyAt+PtM-BeQVT1YzwzAjSj7TvgzSjwMDIOHOKq5PA5oCUpcRFDfojqKM1mGDOsKEMCUNAYGKAmTA6BaJAkT0JInHxTYyQmxKGOGDJBWxGoqYG6BJChnywkwUbBGenwwzmMUZQaMUHYQEhMx0gmxCKWMythzVN8pAHcJACgDUApSNzbkryVngMsMZc2XXm0g9TB9jea-LgiMTBaNF+QcuBdJoBSRLpUSa-VMASWz5KUzZ8s6tJ3HNnco4giAB3uEn4iLdjwoMeVOEz6BVNXeK-TAuvCpFSspIcTFGV7PCY9AZsxGI3kOjDmezvZoMDoNHLbJaiOySCHng43MZ7kieCgMgrr1fjcB85R3BYrIiNGjkUC9vAspkQ9n4BQYUcj3l8Frn1z9kL5V3n+S4p24Q4clMFg2jKQQYaUOc0uioATH0MTwOciGrFG0YKA88KlUxB-StACQScb8MBC1B4DbA5qZAu8YmJcqVioM1Y5WnbRDr+Aw6nKUcY5H1pp0jaE4lyl2P3k9jh66tduk7WbFx0I0jtTulnRcq+1uxAdR+aHXDqR1-A0dc+QnWAVJ0JsuAVOmBwzo3ziM+dX+bgCLoq0S6ZdHztTxrqVgII58puhT1bpU8O6SYOBWvH7qIKh6KCkeq0HPmT0pA9PAUPPSWrstlAxCmcbLSOr3YOIF49Pn-RsqAM7xLMsFoU14nnjv63C68fSFvF388kIcQwXeIiZFTX4HiG4goGeIQpZQ7xd2HoD-DIpe6b8MbPLL7QCAbAdKLSb8S7LW4qGf4SyV-j1hiAKAjqW7Ak30kgAg4xTGABQD6DWTGAIg34sGTgyngFYOk27JUxbk0UkUpQ2aZxlwo54rwpAPxUoACVYAihpAcxYyRhivkr875GytpC-IOpSxws+JYgESVWZWK16AGdaEbLxIkUyuN8rkkKXFK0owcxpcrjEhBSyh4o6WdAEsUQYpZMs9JX9mAB4AHucLBFrcF+gqx8uJudIA5gnKoRpAP4edJ2jAAUA6ATAZgMmHDIyA0unYPsJEM2D8AwgwGFJVJVaXMgRlmkTigBTIIJIkkOEWqABGuChA2Ay5a5dgESSIAlRrSx5ddwxAwA-s0FbIL0ugD9LgAPAGAFc3DyLLJwVhG5i8s9BmMqIcwpyEsNGSrCNhA0B5W2MdmWBqqkiIYGCv+Vrwhib8AYgoCgw0pmgASRMGKGiXW5fKSIt4ifTv4DzeGFobGcoEqnPCyyQiPQHaIdSJgxADFNDDoEajgEaUnwUsdzNpUa5TF4k27BQGmzQVJZIqR1I2R0nhzk5Vi7CmnJUi1zN5EGNQA2H7FgA3y6qz2bnX2TyCypvU5Qb-lUENiQoKA9YEP1QAGqjV0IlcHGD2hfB45dci1aaW6lqF1GtqwJQNKHEjivCcvCDI73dXShPVe0CioUyOp2LbajqCABQE2KqqpKTipJiAB-COoxAwANNWUzEAwxUYTAowtAUzWNlQYBaoqSSNtjVqpKtagKS6v4pSQHFt+YxEslr4uVPQNTfGCBQ3RTKPAGwLQDsr2Un488wGVAOUqkRSUqlUAZXPGtyQqqa1daryVgEaVUDmlfAXZEf2IyNMm1OeFtfslaZDqpILYh0uOIvXvCZIRQ9pRjSBrRrvYhqusW+UTVf5k1HilJumuPXW4c1QSfNYWuLVb5S15akCoYP-Ua5T1D6xtWuubUbq5e7aztQIiKJlSL1-avyYOpcqj8R1Wy8dbsovhTrDlhmKyh+RyV2VZkc6ypdUr4C1LoNYAU9Zuqsze8d1Ws3ZGJAPU-p3JjG5jeetw1Hk35bYxyLeqHUPr3hAoiDD0s6WyyqAwAXeirOIxJq5sBan9VvilZxNHFek3NSWqLXhswNZanxb1DrCoYiloa7mnCocX8aFYAER1K8qJq3KukXy2YsEo3WhpKCh5IFVAH6WHkgcwjECoMua7nK0AYyv6JMpwDTLQ0syy4hSkWV9QVlDAFgBss9DWaN1rFOcYJvejwsLlVAMgqQFM0JLbNbAVzTZqwAAR+IpW9zTmmcq4bAtvyvzayr+XPr5qsm9JfJukYwAlNWNb2jwV9RdwSBEtZMd+0cimbCA0glQCsDpTT1FZ7ACtI+I5o5jmodfNHPI3y2yaAIcjMoNhKkiKNwGPqK6t2izRXr6Ih4UMHNtgZ9MpmdUV+IZGAh2hOQged0HhA5rwAgAA",method:"decompressFromEncodedURIComponent"};var rr=function(){var f=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function t(u,l){if(!s[u]){s[u]={};for(var c=0;c<u.length;c++)s[u][u.charAt(c)]=c}return s[u][l]}var i={compressToBase64:function(u){if(u==null)return"";var l=i._compress(u,6,function(c){return n.charAt(c)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(u){return u==null?"":u==""?null:i._decompress(u.length,32,function(l){return t(n,u.charAt(l))})},compressToUTF16:function(u){return u==null?"":i._compress(u,15,function(l){return f(l+32)})+" "},decompressFromUTF16:function(u){return u==null?"":u==""?null:i._decompress(u.length,16384,function(l){return u.charCodeAt(l)-32})},compressToUint8Array:function(u){for(var l=i.compress(u),c=new Uint8Array(l.length*2),d=0,p=l.length;d<p;d++){var o=l.charCodeAt(d);c[d*2]=o>>>8,c[d*2+1]=o%256}return c},decompressFromUint8Array:function(u){if(u==null)return i.decompress(u);for(var l=new Array(u.length/2),c=0,d=l.length;c<d;c++)l[c]=u[c*2]*256+u[c*2+1];var p=[];return l.forEach(function(o){p.push(f(o))}),i.decompress(p.join(""))},compressToEncodedURIComponent:function(u){return u==null?"":i._compress(u,6,function(l){return e.charAt(l)})},decompressFromEncodedURIComponent:function(u){return u==null?"":u==""?null:(u=u.replace(/ /g,"+"),i._decompress(u.length,32,function(l){return t(e,u.charAt(l))}))},compress:function(u){return i._compress(u,16,function(l){return f(l)})},_compress:function(u,l,c){if(u==null)return"";var d,p,o={},v={},S="",h="",w="",b=2,T=3,x=2,E=[],y=0,m=0,g;for(g=0;g<u.length;g+=1)if(S=u.charAt(g),Object.prototype.hasOwnProperty.call(o,S)||(o[S]=T++,v[S]=!0),h=w+S,Object.prototype.hasOwnProperty.call(o,h))w=h;else{if(Object.prototype.hasOwnProperty.call(v,w)){if(w.charCodeAt(0)<256){for(d=0;d<x;d++)y=y<<1,m==l-1?(m=0,E.push(c(y)),y=0):m++;for(p=w.charCodeAt(0),d=0;d<8;d++)y=y<<1|p&1,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=p>>1}else{for(p=1,d=0;d<x;d++)y=y<<1|p,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=0;for(p=w.charCodeAt(0),d=0;d<16;d++)y=y<<1|p&1,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=p>>1}b--,b==0&&(b=Math.pow(2,x),x++),delete v[w]}else for(p=o[w],d=0;d<x;d++)y=y<<1|p&1,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=p>>1;b--,b==0&&(b=Math.pow(2,x),x++),o[h]=T++,w=String(S)}if(w!==""){if(Object.prototype.hasOwnProperty.call(v,w)){if(w.charCodeAt(0)<256){for(d=0;d<x;d++)y=y<<1,m==l-1?(m=0,E.push(c(y)),y=0):m++;for(p=w.charCodeAt(0),d=0;d<8;d++)y=y<<1|p&1,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=p>>1}else{for(p=1,d=0;d<x;d++)y=y<<1|p,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=0;for(p=w.charCodeAt(0),d=0;d<16;d++)y=y<<1|p&1,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=p>>1}b--,b==0&&(b=Math.pow(2,x),x++),delete v[w]}else for(p=o[w],d=0;d<x;d++)y=y<<1|p&1,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=p>>1;b--,b==0&&(b=Math.pow(2,x),x++)}for(p=2,d=0;d<x;d++)y=y<<1|p&1,m==l-1?(m=0,E.push(c(y)),y=0):m++,p=p>>1;for(;;)if(y=y<<1,m==l-1){E.push(c(y));break}else m++;return E.join("")},decompress:function(u){return u==null?"":u==""?null:i._decompress(u.length,32768,function(l){return u.charCodeAt(l)})},_decompress:function(u,l,c){var d=[],p,o=4,v=4,S=3,h="",w=[],b,T,x,E,y,m,g,a={val:c(0),position:l,index:1};for(b=0;b<3;b+=1)d[b]=b;for(x=0,y=Math.pow(2,2),m=1;m!=y;)E=a.val&a.position,a.position>>=1,a.position==0&&(a.position=l,a.val=c(a.index++)),x|=(E>0?1:0)*m,m<<=1;switch(p=x){case 0:for(x=0,y=Math.pow(2,8),m=1;m!=y;)E=a.val&a.position,a.position>>=1,a.position==0&&(a.position=l,a.val=c(a.index++)),x|=(E>0?1:0)*m,m<<=1;g=f(x);break;case 1:for(x=0,y=Math.pow(2,16),m=1;m!=y;)E=a.val&a.position,a.position>>=1,a.position==0&&(a.position=l,a.val=c(a.index++)),x|=(E>0?1:0)*m,m<<=1;g=f(x);break;case 2:return""}for(d[3]=g,T=g,w.push(g);;){if(a.index>u)return"";for(x=0,y=Math.pow(2,S),m=1;m!=y;)E=a.val&a.position,a.position>>=1,a.position==0&&(a.position=l,a.val=c(a.index++)),x|=(E>0?1:0)*m,m<<=1;switch(g=x){case 0:for(x=0,y=Math.pow(2,8),m=1;m!=y;)E=a.val&a.position,a.position>>=1,a.position==0&&(a.position=l,a.val=c(a.index++)),x|=(E>0?1:0)*m,m<<=1;d[v++]=f(x),g=v-1,o--;break;case 1:for(x=0,y=Math.pow(2,16),m=1;m!=y;)E=a.val&a.position,a.position>>=1,a.position==0&&(a.position=l,a.val=c(a.index++)),x|=(E>0?1:0)*m,m<<=1;d[v++]=f(x),g=v-1,o--;break;case 2:return w.join("")}if(o==0&&(o=Math.pow(2,S),S++),d[g])h=d[g];else if(g===v)h=T+T.charAt(0);else return null;w.push(h),d[v++]=T+h.charAt(0),o--,T=h,o==0&&(o=Math.pow(2,S),S++)}}};return i}();var ri=function(){var f=[{id:"/views/test-swal-sauvegarde",path:"views",file:"test-swal-sauvegarde",ptr:nr}],n=function(e){oCurView=f.find(i=>i.id==e),oCurView===void 0&&console.log(`%cError view ${e} could't be found`,le),oCurView=oCurView.ptr;let s=oCurView.data;return rr[oCurView.method](s)};return Object.freeze({load:n})},ii=ri(),ir=ii;var J={Cfg:{dbase:null},raf:null,cssMainDataSelector:Ot,ID_MENU_FORCE_LOADING:null,ID_MENU_FORCE_ADDTOLEFTMENU:null,start:async function(){await En();let f=J.checkSupport();console.log(`%cAre all functions supported ? : ${f}`,O);var n="header [class*=MuiAvatar-img]";document.querySelector(n)===null?(console.log(`%c All condition not met, waiting element '${n}' `,O),document.arrive(n,J._warmup),J.ID_MENU_FORCE_LOADING=GM_registerMenuCommand("force - loading",J._warmup),J.ID_MENU_FORCE_ADDTOLEFTMENU=GM_registerMenuCommand("force - populate menuleft",J._addLinkToMenu)):(console.log("%c All condition already met go",O),J._warmup())},checkSupport:function(){return!0},_warmup:function(){console.log("%c in _warmup",O),document.unbindArrive(J._warmup),GM_unregisterMenuCommand(J.ID_MENU_FORCE_LOADING),GM===void 0?(console.log("%cI am not in a tamper env",O),J._userscriptless()):console.log(`%cTamper environment detected the version is ${GM.info.version}`,O),GM_addStyle(GM_getResourceText("jspanelcss")),GM_addStyle(GM_getResourceText("toastifycss")),GM_addStyle(GM_getResourceText("simpledatatablecss")),GM_addStyle(GM_getResourceText("loading_barcss")),GM_addStyle(GM_getResourceText("nprogress_css")),GM_config.init(tr),GM_registerMenuCommand("collectauto",un,"a"),GM_registerMenuCommand("configure",un,"a"),GM_config.get("hackheaderzindex")===!0&&(document.getElementById("header").style.zIndex=0),GM_addStyle(".swal2-title{font-size:1.275em)");var f=J.cssMainDataSelector;document.querySelector(f)===null?(console.log(`%c All condition not met, waiting element '${f}' `,O),document.arrive(f,J._main)):(console.log("%c All condition already met go",O),J._main())},_forceCbox:function(){J._applyInjectionForSessionsHistory()},pathname:document.location.pathname,_getOCMainClass:function(){try{let n=document.querySelector(J.cssMainDataSelector).classList.value.match(/dom-services-(\d)/);if(n.length==2)return`dom-services-${n[1]}`;throw new Error("_aOCMainSrvId.length must be 2")}catch(f){return console.error("%cError in _getOCMainClass():%s",le,f),""}},_sOCMainSrvClassName:"",_eventMonitor:function(){var f=document.querySelector("body"),n=new MutationObserver(function(s){s.forEach(function(t){t.target.classList.contains(`${J._sOCMainSrvClassName}-MuiTouchRipple-root`),t.target.nodeName==="TBODY"&&t.target.parentElement.nodeName==="TABLE"&&(console.log("%cTable data changed (TBODy,TABLE)",O),console.log("%c=============> Changed data : %o",O,t),jt(J._applyInjectionOnPathNameMutation())),t.target.nodeName==="OL"&&(console.log("%cTable data changed (OL)",O),console.log("%c=============> Changed data : %o",O,t),jt(J._applyInjectionOnPathNameMutation())),t.target.nodeName==="BUTTON"&&t.target.parentElement.parentElement.parentElement.firstElementChild.nodeName==="TABLE"&&(console.log("%cTable data changed (BUTTON, TABLE)",O),console.log("%c=============> Changed data : %o",O,t),jt(J._applyInjectionOnPathNameMutation())),t.target.ariaLabel==="Page pr\xE9c\xE9dente",J.pathname!=document.location.pathname&&(J.pathname=document.location.pathname,jt(J._applyInjectionOnPathNameMutation()))})}),e={childList:!0,subtree:!0};n.observe(f,e)},_applyInjectionOnPathNameMutation:function(){let f=!1;f===!1&&document.location.pathname.match(/\/sessions$/)&&(f=!0,J._applyInjectionForSessionsToComplete()),f===!1&&document.location.pathname.match(/\/booked-mentorship-sessions$/)&&(f=!0,J._applyInjectionForSessionsBooked()),f===!1&&document.location.pathname.match(/\/mentorship-sessions-history$/)&&(f=!0,J._applyInjectionForSessionsHistory()),f===!1&&console.log("%cUnknow Route so could't guess what to do",le)},_lastMutation:0,_applyInjectionForSessionsToComplete:function(){document.querySelector(`${J.cssMainDataSelector} .Facturier__cbox_all`)!==null&&(document.querySelector(`${J.cssMainDataSelector} .Facturier__cbox_all`).style.display="none"),console.log("%cWill Patch All Buttons corresponding to this CSS PATH %s",O,`${J.cssMainDataSelector} a a[href*=sessions]`);var f=Array.from(document.querySelectorAll(`${J.cssMainDataSelector} a a[href*=sessions]`)),n;f.forEach(function(e){console.log("%cWill Patch Button %o",O,e),e.innerText=".:"+e.innerText+":.",e.addEventListener("click",n=function(s){s.stopPropagation(),s.preventDefault();var t=e.parentElement.parentElement.parentElement,i=t.children[1].querySelector("time").getAttribute("datetime").trim(),u=ut(t.children[2],-2),l=t.children[3].querySelector("a").getAttribute("href-sav"),c=(l||"/").split("/"),d=c[c.length-1],p=dayjs(i).toISOString(),o=De.getHashId(p,u);let v=parseInt(d,10),S=Te.exists(v,1,Te.TYPE.SESSIONID_DATEREFID),h=Te.exists(o,2,Te.TYPE.SESSIONID_DATEREFID);S&&(h||(console.log(`[SESSIONID_DATEREFID] iSessionId ${v} est connu mais pas iHash${o}`),Te.updKey2(v,o,Te.TYPE.SESSIONID_DATEREFID))),h&&(S||(console.log(`[SESSIONID_DATEREFID] iHash${o} est connu mais pas iSessionId ${v}`),Te.updKey1(v,o,Te.TYPE.SESSIONID_DATEREFID))),!S&&!h&&(console.log(`[SESSIONID_DATEREFID] iHash${o} et iSessionId ${v} sont INconnus`),Te.add(v,o,Te.TYPE.SESSIONID_DATEREFID)),window.open(l,"blank").focus()}),e.setAttribute("href-sav",e.getAttribute("href")),e.removeAttribute("href")})},_applyInjectionForSessionsBooked:function(){document.querySelector(`${J.cssMainDataSelector} .Facturier__cbox_all`)!==null&&(document.querySelector(`${J.cssMainDataSelector} .Facturier__cbox_all`).style.display="none")},_applyInjectionForSessionsHistory:function(f=100){document.querySelector(`${J.cssMainDataSelector} .Facturier__cbox_all`)!==null&&(document.querySelector(`${J.cssMainDataSelector} .Facturier__cbox_all`).style.display="block"),!(dayjs().valueOf()-J._lastMutation<f)&&(Qt(),J._lastMutation=dayjs().valueOf())},_addHeader:function(){J._sOCMainSrvClassName.length===0&&(J._sOCMainSrvClassName=J._getOCMainClass()),J._sOCMainSrvClassName.length===0&&(console.error("%c[index._addHeader()] _sOCMainSrvClassName is still unknow",le),console.log("[index._addHeader()]check this %o",document.querySelector(J.cssMainDataSelector)));let f=`
<a href="" class="${J._sOCMainSrvClassName}-MuiButtonBase-root
 ${J._sOCMainSrvClassName}-MuiTab-root
 ${J._sOCMainSrvClassName}-dom-services73
 ${J._sOCMainSrvClassName}-MuiTab-textColorInherit"
 style="margin-left: auto;">
 <span class="${J._sOCMainSrvClassName}-MuiTab-wrapper">En base de donn\xE9e (21/24)</span>
 <span class="${J._sOCMainSrvClassName}-MuiTouchRipple-root"></span></a>
`,n=document.querySelector("#mainContent > :not(div:empty)").children,e=0;for(e=n.length-1;e>=0&&(console.log(e,n[e].nodeName),n[e].nodeName!=="SECTION");e--);if(e===0){console.error("IRRECOVERABLE ERROR element <section> not found");return}e=e-1;let s=n[e].querySelector("a").parentElement,t=n[e].querySelector("a[aria-selected=false]"),i=document.createElement("span");i.innerText="Facturier v."+GM.info.script.version,i.classList.add(...t.children[0].classList),i.classList.add("Facturier__header");let u=document.createElement("span");u.classList.add(...t.children[1].classList),u.classList.add("Facturier__header");let l=document.createElement("a");l.onclick=Vt,l.classList.add(...t.classList),l.classList.add("Facturier__header"),l.appendChild(i),l.appendChild(u),l.style="margin-left: auto",s.appendChild(l)},_userscriptless(){console.log("%cIm'not in a Tamper environment so i need to load js scripts",O)},_main:function(){console.log("\u200B\u200B\u200B%c[index._main()]MainLoaded\u200B\u200B\u200B",O),document.unbindArrive(J._main),J._eventMonitor();let f=new LocalStorage("db");var n=low(f);n.defaults({students:[],sessions:[],f_archives:[],history_session_cache:[],meta:[],refs:[],students_history:[]}).write(),J.Cfg.dbase=n,dayjs.extend(dayjs_plugin_isSameOrAfter),dayjs.extend(dayjs_plugin_isSameOrBefore),dayjs.extend(dayjs_plugin_isBetween),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_customParseFormat),dayjs.locale("fr"),Te.checkSupport(),Ie.checkSupport(),document.querySelector(".panel.menuBar.flex.draggable")===null&&er.init(),J._addHeader(),J._applyInjectionOnPathNameMutation(),console.log("%cWait for side menu to add element to it",O),sCSSObserved="nav:not([role])",document.arrive(sCSSObserved,J._addLinkToMenu);let e=Ie.getDbVersion();if(It(GM.info.script.version,e)==1&&(console.log(`%cDB is in version: ${Ie.getDbVersion()} need to go to version ${GM.info.script.version}`,O),At.update(GM.info.script.version)),St(["https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"]).then(async function(s){console.log("%cALPINE js fetched",O)}),St(["https://unpkg.com/htmx.org@1.1.0","https://unpkg.com/htmx.org@1.1.0/dist/ext/debug.js"]).then(async function(s){htmx.on("htmx:configRequest",function(t){}),htmx.on("htmx:beforeRequest",function(t){if(t.detail.pathInfo.finalPath&&Tn(t.detail.pathInfo.finalPath)!=="html"){t.detail.xhr.addEventListener("abort",function(){}),t.detail.xhr.onloadstart=function(d){this.abort()};let l=ir.load(t.detail.pathInfo.finalPath),c=t.detail.target;var i=t.detail.elt.getAttribute("hx-select");if(i){let d=new DOMParser().parseFromString(l,"text/html");oNode=d.querySelector(i),oNode?l=oNode.outerHTML:console.log(`%cWanna select target ${i} in data received from calling ${t.detail.pathInfo.finalPath} but this node could'nt be found so return the whole string`,le)}var u=function(d,p){var o=document.createRange(),v=o.createContextualFragment(d);console.log(v);for(var S=v.childNodes.length-1;S>=0;S--){var h=v.childNodes[S];p.appendChild(h),htmx.process(h)}return p.lastChild};u(l,t.detail.target)}}),htmx.on("htmx:xhr:loadstart",function(t){})}),St(["https://cdn.jsdelivr.net/npm/sweetalert2@10"]).then(async function(s){console.log("%cSweetAlert fetched",O)}),GM_config.get("use_custom_css")===!0){let t=GM_config.get("custom_css_url").split(",");if(t.length!==0)console.log(`%cWanna inject Custom CSS from URL:${t}`,O),St(t).then(()=>{console.log(`%cCustom CSS from URL:${t} loaded`,O)}).catch(i=>console.log(`%cError detected when loading dependencies ${i}`,le));else{let i=GM_config.get("custom_css_data");if(i.length()>0){console.log(`%cNeed to inject a custom css in application content is ${i}`,O);let u=document.createElement("style");u.innerHTML=i,document.head.insertAdjacentElement("beforeend",u)}}}unsafeWindow.Facturier={libs:[],cfg:{dbase:null},klass:[]},unsafeWindow.Facturier.cfg.dbase=J.Cfg.dbase,unsafeWindow.Facturier.libs.push({id:"fetchInject",ptr:St}),unsafeWindow.Facturier.libs.push({id:"dayjs",ptr:dayjs}),unsafeWindow.Facturier.klass.push({id:"Student",ptr:be}),unsafeWindow.Facturier.klass.push({id:"Session",ptr:De}),unsafeWindow.Facturier.klass.push({id:"Archive",ptr:vt}),unsafeWindow.Facturier.klass.push({id:"History",ptr:wt}),unsafeWindow.Facturier.klass.push({id:"StudentHistory",ptr:Ue}),unsafeWindow.Facturier.klass.push({id:"Ref",ptr:Te}),unsafeWindow.Facturier.klass.push({id:"Dbase",ptr:At}),unsafeWindow.Facturier.klass.push({id:"Meta",ptr:Ie}),unsafeWindow.Facturier.klass.push({id:"Ref",ptr:Te}),unsafeWindow.Facturier.klass.push({id:"Api",ptr:Tt}),unsafeWindow.Facturier.libs.push({id:"NProgress",ptr:NProgress}),unsafeWindow.Facturier.libs.push({id:"Moise",ptr:moize}),GM.info.script.downloadURL==="http://localhost:8000/dist/app-facturier.iife.js"?(console.log("%cALERTE .... version locale !!!!!! ","background-color:coral;color:white"),console.log("%c test readfile",O),Dn("file:////media/pwyll/USB120Go/DevStt/UserScripts/SttAddon/src/update_data_base.js",function(s){console.log(s)}),J.loadDependencies()):console.log(`%c GM.info.script.downloadURL url : ${GM.info.script.downloadURL}`,O)},_addLinkToMenu:function(){console.log("%cSide menu was added",O),document.unbindArrive(J._addLinkToMenu);try{let f=document.querySelectorAll("nav:not([role])")[0],n=f.children[0].lastChild.cloneNode(!0);n.firstChild.innerText="Facturier",elMenu=document.querySelector(".panel.draggable"),n.firstChild.href="javascript:function(){elMenu = document.querySelector('.panel.draggable');elMenu.style.display = (elMenu.style.display != 'block') ? 'block' : 'none';}";let e=f.children[0].lastChild.firstChild;n.firstChild.appendChild(e.children[0].cloneNode(!0)),n.firstChild.appendChild(e.children[1].cloneNode(!1)),n.firstChild.appendChild(e.children[2].cloneNode(!1));let s=f.children[0].cloneNode(!1);s.appendChild(n),f.appendChild(s)}catch(f){console.log("%cInjecting menu encounter an error: %o",le,f)}},loadDependencies:function(){let f=[];f.push("http://localhost:8000/src/branch01/sandbox.js"),f.push("http://localhost:8000/src/branch01/sandbox.css"),St(f).then(()=>{console.log(`dependencies ${f} loaded`)})},dbUpdate:function(){console.log("%c Need to update DB",O),It(GM.info.script.version,"1.00.0006")==0&&(console.log("%c Need to update DB to version '1.00.0006'",O),At.update("1.00.0006"))}};window.Facturier!==void 0?window.Facturier.start():J.start();var V=J;})();
/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
/*! @preserve
 *
 * tcomb.js - Type checking and DDD for JavaScript
 *
 * The MIT License (MIT)
 *
 * Copyright (c) 2014-2016 Giulio Canti
 *
 */
/**
 * Fetch Inject module.
 *
 * @module fetchInject
 * @license Zlib
 * @param {(USVString[]|Request[])} inputs Resources you wish to fetch.
 * @param {Promise} [promise] A promise to await before attempting injection.
 * @throws {Promise<ReferenceError>} Rejects with error when given no arguments.
 * @throws {Promise<TypeError>} Rejects with error on invalid arguments.
 * @throws {Promise<Error>} Whatever `fetch` decides to throw.
 * @throws {SyntaxError} Via DOM upon attempting to parse unexpected tokens.
 * @returns {Promise<Object[]>} A promise which resolves to an `Array` of
 *     Objects containing `Response` `Body` properties used by the module.
 */
//# sourceMappingURL=app.min.js.map
