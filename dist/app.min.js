// ==UserScript==
// @name         Facturier (alpha)
// @namespace    http://tampermonkey.net/
// @version      1.10.0004
// @description  Un addon pour vous aider dans votre facturation
// @author       Stéphane TORCHY
// @updateURL    https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @downloadURL  https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/dist/app.min.js
// @match        https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history*

// Start at document start https://www.tampermonkey.net/documentation.php#_run_at
// @run-at document-start   

// @grant        unsafeWindow
// @grant        GM_addStyle
// @grant        GM_getResourceText
// @grant        GM_registerMenuCommand
// @grant        GM_xmlhttpRequest
// @grant        GM.xmlHttpRequest
// @grant        GM_notification

// @require      https://cdn.jsdelivr.net/npm/lodash@4.17.19/lodash.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/low.min.js
// @require      https://unpkg.com/lowdb@0.17/dist/LocalStorage.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/dayjs.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/locale/fr.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isBetween.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrBefore.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/isSameOrAfter.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/customParseFormat.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.8.29/plugin/localeData.min.js


// GM_Config
// require      https://openuserjs.org/src/libs/sizzle/GM_config.js (cassé ce jour 28/08/2020);
// @require      https://raw.githubusercontent.com/sizzlemctwizzle/GM_config/master/gm_config.js

// sweetalert 2
// require      https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.all.min.js
// @require      https://cdn.jsdelivr.net/npm/sweetalert2@10

// draggabilly
// @require      https://cdnjs.cloudflare.com/ajax/libs/draggabilly/2.2.0/draggabilly.pkgd.min.js

// toastify
// @require     https://cdn.jsdelivr.net/npm/toastify-js@1.8.0/src/toastify.min.js
// @resource    toastifycss https://raw.githubusercontent.com/apvarun/toastify-js/master/src/toastify.css

// https://github.com/uzairfarooq/arrive --> included manually
// require     https://raw.githubusercontent.com/uzairfarooq/arrive/master/minified/arrive.min.js

// simple-datatables
// @require     https://cdn.jsdelivr.net/npm/simple-datatables@latest
// @resource    simpledatatablecss https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css

// require https://raw.githubusercontent.com/anywhichway/nano-memoize/master/dist/nano-memoize.min.js
// @require https://cdn.jsdelivr.net/npm/moize@5.4.7/dist/moize.min.js

// FETCH INJECT --> included manually
// require https://cdn.jsdelivr.net/npm/fetch-inject

// PARSER MKDOWN
// @require 	 https://cdn.jsdelivr.net/npm/showdown@1.9.1/dist/showdown.min.js

// PDF https://pdf-lib.js.org/docs/api/
// @require      https://unpkg.com/pdf-lib@1.9.0/dist/pdf-lib.min.js
// @require      https://unpkg.com/downloadjs@1.4.7/download.js

// HTMX https://htmx.org
// @require https://unpkg.com/htmx.org@1.1.0/dist/htmx.min.js

// ALPINE JS
// @require https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.js


// ProgressBar 
// https://loading.io/progress/
// require https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.js
// resource loading_barcss https://raw.githubusercontent.com/loadingio/loading-bar/master/dist/loading-bar.css
// @require https://loadingio.github.io/loading-bar/dist/loading-bar.js
// @resource loading_barcss https://loadingio.github.io/loading-bar/dist/loading-bar.min.css

// https://www.cssscript.com/demo/text-progress-bar-ascii-loader/
// https://github.com/kimmobrunfeldt/progressbar.js - fonctionne mais probleme avec le easing dans mon popup progress bar
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.min.js
// require https://raw.githubusercontent.com/kimmobrunfeldt/progressbar.js/master/dist/progressbar.js
// https://pvdlg.github.io/uprogress/js-api/#UProgress+start
// https://ricostacruz.com/nprogress

// semble cassé
// https://github.com/webosorg/Process
// https://unpkg.com/@webos/process@0.2.0/dist/process.js
// https://cdn.jsdelivr.net/npm/@webos/process@0.2.0/dist/process.min.js
// bof ... je ne parviens pas à faire fonctionner l'exemple
// https://cdn.jsdelivr.net/npm/worker-function@2.0.1/WorkerFunction.min.js
// Threading 
// @require  https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/Thread.js
// @require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadPool.js
// @require   https://raw.githubusercontent.com/gkjohnson/threading-js/master/umd/ThreadQueue.js
// semble cassé
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// https://unpkg.com/paralleljs@1.0/lib/parallel.js
// https://cdn.jsdelivr.net/npm/threads@1.6.3/dist/index.min.js
// Freelancer
// https://github.com/Wildhoney/Freelancer
// fonctionne require https://raw.githubusercontent.com/arqex/worker-function/master/WorkerFunction.js
// ne fonctonne pas https://raw.githubusercontent.com/duart38/Thread/master/Thread.bundle.js
// require      https://cdn.jsdelivr.net/npm/paralleljs@1.0.1/lib/parallel.min.js


/*
 * History
 * cf https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/blob/master/CHANGELOG.md
 */
// ==/UserScript==
(()=>{var ht=Object.defineProperty,yn=Object.prototype.hasOwnProperty,Lt=(o,d)=>()=>(d||(d={exports:{}},o(d.exports,d)),d.exports),It=o=>ht(o,"__esModule",{value:!0}),_n=(o,d)=>{It(o);for(var t in d)ht(o,t,{get:d[t],enumerable:!0})},vn=(o,d)=>{if(It(o),typeof d=="object"||typeof d=="function")for(let t in d)!yn.call(o,t)&&t!=="default"&&ht(o,t,{get:()=>d[t],enumerable:!0});return o},je=o=>o&&o.__esModule?o:vn(ht({},"default",{value:o,enumerable:!0}),o);var Ft=Lt((Mt,Yt)=>{!function(o,d){typeof define=="function"&&define.amd?define([],d):typeof Yt=="object"&&typeof Mt!="undefined"?Yt.exports=d():o.Papa=d()}(Mt,function o(){"use strict";var d=typeof self!="undefined"?self:typeof window!="undefined"?window:d!==void 0?d:{},t=!d.document&&!!d.postMessage,a=t&&/blob:/i.test((d.location||{}).protocol),e={},n=0,l={parse:function(c,u){var p=(u=u||{}).dynamicTyping||!1;if(C(p)&&(u.dynamicTypingFunction=p,p={}),u.dynamicTyping=p,u.transform=!!C(u.transform)&&u.transform,u.worker&&l.WORKERS_SUPPORTED){var x=function(){if(!l.WORKERS_SUPPORTED)return!1;var q=(A=d.URL||d.webkitURL||null,S=o.toString(),l.BLOB_URL||(l.BLOB_URL=A.createObjectURL(new Blob(["(",S,")();"],{type:"text/javascript"})))),Y=new d.Worker(q),A,S;return Y.onmessage=y,Y.id=n++,e[Y.id]=Y}();return x.userStep=u.step,x.userChunk=u.chunk,x.userComplete=u.complete,x.userError=u.error,u.step=C(u.step),u.chunk=C(u.chunk),u.complete=C(u.complete),u.error=C(u.error),delete u.worker,void x.postMessage({input:c,config:u,workerId:x.id})}var O=null;return l.NODE_STREAM_INPUT,typeof c=="string"?O=u.download?new s(u):new w(u):c.readable===!0&&C(c.read)&&C(c.on)?O=new T(u):(d.File&&c instanceof File||c instanceof Object)&&(O=new i(u)),O.stream(c)},unparse:function(c,u){var p=!1,x=!0,O=",",q=`\r
`,Y='"',A=Y+Y,S=!1,D=null,$=!1;!function(){if(typeof u!="object")return;if(typeof u.delimiter!="string"||l.BAD_DELIMITERS.filter(function(I){return u.delimiter.indexOf(I)!==-1}).length||(O=u.delimiter),(typeof u.quotes=="boolean"||typeof u.quotes=="function"||Array.isArray(u.quotes))&&(p=u.quotes),typeof u.skipEmptyLines!="boolean"&&typeof u.skipEmptyLines!="string"||(S=u.skipEmptyLines),typeof u.newline=="string"&&(q=u.newline),typeof u.quoteChar=="string"&&(Y=u.quoteChar),typeof u.header=="boolean"&&(x=u.header),Array.isArray(u.columns)){if(u.columns.length===0)throw new Error("Option columns is empty");D=u.columns}u.escapeChar!==void 0&&(A=u.escapeChar+Y),typeof u.escapeFormulae=="boolean"&&($=u.escapeFormulae)}();var H=new RegExp(b(Y),"g");if(typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(c)){if(!c.length||Array.isArray(c[0]))return P(null,c,S);if(typeof c[0]=="object")return P(D||L(c[0]),c,S)}else if(typeof c=="object")return typeof c.data=="string"&&(c.data=JSON.parse(c.data)),Array.isArray(c.data)&&(c.fields||(c.fields=c.meta&&c.meta.fields),c.fields||(c.fields=Array.isArray(c.data[0])?c.fields:L(c.data[0])),Array.isArray(c.data[0])||typeof c.data[0]=="object"||(c.data=[c.data])),P(c.fields||[],c.data||[],S);throw new Error("Unable to serialize unrecognized input");function L(I){if(typeof I!="object")return[];var oe=[];for(var ce in I)oe.push(ce);return oe}function P(I,oe,ce){var ae="";typeof I=="string"&&(I=JSON.parse(I)),typeof oe=="string"&&(oe=JSON.parse(oe));var se=Array.isArray(I)&&0<I.length,fe=!Array.isArray(oe[0]);if(se&&x){for(var X=0;X<I.length;X++)0<X&&(ae+=O),ae+=k(I[X],X);0<oe.length&&(ae+=q)}for(var ee=0;ee<oe.length;ee++){var de=se?I.length:oe[ee].length,re=!1,te=se?Object.keys(oe[ee]).length===0:oe[ee].length===0;if(ce&&!se&&(re=ce==="greedy"?oe[ee].join("").trim()==="":oe[ee].length===1&&oe[ee][0].length===0),ce==="greedy"&&se){for(var ne=[],Z=0;Z<de;Z++){var U=fe?I[Z]:Z;ne.push(oe[ee][U])}re=ne.join("").trim()===""}if(!re){for(var ie=0;ie<de;ie++){0<ie&&!te&&(ae+=O);var pe=se&&fe?I[ie]:ie;ae+=k(oe[ee][pe],ie)}ee<oe.length-1&&(!ce||0<de&&!te)&&(ae+=q)}}return ae}function k(I,oe){if(I==null)return"";if(I.constructor===Date)return JSON.stringify(I).slice(1,25);$===!0&&typeof I=="string"&&I.match(/^[=+\-@].*$/)!==null&&(I="'"+I);var ce=I.toString().replace(H,A),ae=typeof p=="boolean"&&p||typeof p=="function"&&p(I,oe)||Array.isArray(p)&&p[oe]||function(se,fe){for(var X=0;X<fe.length;X++)if(-1<se.indexOf(fe[X]))return!0;return!1}(ce,l.BAD_DELIMITERS)||-1<ce.indexOf(O)||ce.charAt(0)===" "||ce.charAt(ce.length-1)===" ";return ae?Y+ce+Y:ce}}};if(l.RECORD_SEP=String.fromCharCode(30),l.UNIT_SEP=String.fromCharCode(31),l.BYTE_ORDER_MARK="﻿",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!t&&!!d.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=v,l.ParserHandle=h,l.NetworkStreamer=s,l.FileStreamer=i,l.StringStreamer=w,l.ReadableStreamStreamer=T,d.jQuery){var m=d.jQuery;m.fn.parse=function(c){var u=c.config||{},p=[];return this.each(function(q){if(!(m(this).prop("tagName").toUpperCase()==="INPUT"&&m(this).attr("type").toLowerCase()==="file"&&d.FileReader)||!this.files||this.files.length===0)return!0;for(var Y=0;Y<this.files.length;Y++)p.push({file:this.files[Y],inputElem:this,instanceConfig:m.extend({},u)})}),x(),this;function x(){if(p.length!==0){var q,Y,A,S,D=p[0];if(C(c.before)){var $=c.before(D.file,D.inputElem);if(typeof $=="object"){if($.action==="abort")return q="AbortError",Y=D.file,A=D.inputElem,S=$.reason,void(C(c.error)&&c.error({name:q},Y,A,S));if($.action==="skip")return void O();typeof $.config=="object"&&(D.instanceConfig=m.extend(D.instanceConfig,$.config))}else if($==="skip")return void O()}var H=D.instanceConfig.complete;D.instanceConfig.complete=function(L){C(H)&&H(L,D.file,D.inputElem),O()},l.parse(D.file,D.instanceConfig)}else C(c.complete)&&c.complete()}function O(){p.splice(0,1),x()}}}function f(c){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(u){var p=M(u);p.chunkSize=parseInt(p.chunkSize),u.step||u.chunk||(p.chunkSize=null),this._handle=new h(p),(this._handle.streamer=this)._config=p}.call(this,c),this.parseChunk=function(u,p){if(this.isFirstChunk&&C(this._config.beforeFirstChunk)){var x=this._config.beforeFirstChunk(u);x!==void 0&&(u=x)}this.isFirstChunk=!1,this._halted=!1;var O=this._partialLine+u;this._partialLine="";var q=this._handle.parse(O,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var Y=q.meta.cursor;this._finished||(this._partialLine=O.substring(Y-this._baseIndex),this._baseIndex=Y),q&&q.data&&(this._rowCount+=q.data.length);var A=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(a)d.postMessage({results:q,workerId:l.WORKER_ID,finished:A});else if(C(this._config.chunk)&&!p){if(this._config.chunk(q,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);q=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(q.data),this._completeResults.errors=this._completeResults.errors.concat(q.errors),this._completeResults.meta=q.meta),this._completed||!A||!C(this._config.complete)||q&&q.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),A||q&&q.meta.paused||this._nextChunk(),q}this._halted=!0},this._sendError=function(u){C(this._config.error)?this._config.error(u):a&&this._config.error&&d.postMessage({workerId:l.WORKER_ID,error:u,finished:!1})}}function s(c){var u;(c=c||{}).chunkSize||(c.chunkSize=l.RemoteChunkSize),f.call(this,c),this._nextChunk=t?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(p){this._input=p,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(u=new XMLHttpRequest,this._config.withCredentials&&(u.withCredentials=this._config.withCredentials),t||(u.onload=g(this._chunkLoaded,this),u.onerror=g(this._chunkError,this)),u.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t),this._config.downloadRequestHeaders){var p=this._config.downloadRequestHeaders;for(var x in p)u.setRequestHeader(x,p[x])}if(this._config.chunkSize){var O=this._start+this._config.chunkSize-1;u.setRequestHeader("Range","bytes="+this._start+"-"+O)}try{u.send(this._config.downloadRequestBody)}catch(q){this._chunkError(q.message)}t&&u.status===0&&this._chunkError()}},this._chunkLoaded=function(){u.readyState===4&&(u.status<200||400<=u.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:u.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(p){var x=p.getResponseHeader("Content-Range");return x===null?-1:parseInt(x.substring(x.lastIndexOf("/")+1))}(u),this.parseChunk(u.responseText)))},this._chunkError=function(p){var x=u.statusText||p;this._sendError(new Error(x))}}function i(c){var u,p;(c=c||{}).chunkSize||(c.chunkSize=l.LocalChunkSize),f.call(this,c);var x=typeof FileReader!="undefined";this.stream=function(O){this._input=O,p=O.slice||O.webkitSlice||O.mozSlice,x?((u=new FileReader).onload=g(this._chunkLoaded,this),u.onerror=g(this._chunkError,this)):u=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var O=this._input;if(this._config.chunkSize){var q=Math.min(this._start+this._config.chunkSize,this._input.size);O=p.call(O,this._start,q)}var Y=u.readAsText(O,this._config.encoding);x||this._chunkLoaded({target:{result:Y}})},this._chunkLoaded=function(O){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(O.target.result)},this._chunkError=function(){this._sendError(u.error)}}function w(c){var u;f.call(this,c=c||{}),this.stream=function(p){return u=p,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var p,x=this._config.chunkSize;return x?(p=u.substring(0,x),u=u.substring(x)):(p=u,u=""),this._finished=!u,this.parseChunk(p)}}}function T(c){f.call(this,c=c||{});var u=[],p=!0,x=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(O){this._input=O,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){x&&u.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),u.length?this.parseChunk(u.shift()):p=!0},this._streamData=g(function(O){try{u.push(typeof O=="string"?O:O.toString(this._config.encoding)),p&&(p=!1,this._checkIsFinished(),this.parseChunk(u.shift()))}catch(q){this._streamError(q)}},this),this._streamError=g(function(O){this._streamCleanUp(),this._sendError(O)},this),this._streamEnd=g(function(){this._streamCleanUp(),x=!0,this._streamData("")},this),this._streamCleanUp=g(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(c){var u,p,x,O=Math.pow(2,53),q=-O,Y=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,A=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,S=this,D=0,$=0,H=!1,L=!1,P=[],k={data:[],errors:[],meta:{}};if(C(c.step)){var I=c.step;c.step=function(X){if(k=X,ae())ce();else{if(ce(),k.data.length===0)return;D+=X.data.length,c.preview&&D>c.preview?p.abort():(k.data=k.data[0],I(k,S))}}}function oe(X){return c.skipEmptyLines==="greedy"?X.join("").trim()==="":X.length===1&&X[0].length===0}function ce(){if(k&&x&&(fe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),x=!1),c.skipEmptyLines)for(var X=0;X<k.data.length;X++)oe(k.data[X])&&k.data.splice(X--,1);return ae()&&function(){if(!k)return;function ee(re,te){C(c.transformHeader)&&(re=c.transformHeader(re,te)),P.push(re)}if(Array.isArray(k.data[0])){for(var de=0;ae()&&de<k.data.length;de++)k.data[de].forEach(ee);k.data.splice(0,1)}else k.data.forEach(ee)}(),function(){if(!k||!c.header&&!c.dynamicTyping&&!c.transform)return k;function ee(re,te){var ne,Z=c.header?{}:[];for(ne=0;ne<re.length;ne++){var U=ne,ie=re[ne];c.header&&(U=ne>=P.length?"__parsed_extra":P[ne]),c.transform&&(ie=c.transform(ie,U)),ie=se(U,ie),U==="__parsed_extra"?(Z[U]=Z[U]||[],Z[U].push(ie)):Z[U]=ie}return c.header&&(ne>P.length?fe("FieldMismatch","TooManyFields","Too many fields: expected "+P.length+" fields but parsed "+ne,$+te):ne<P.length&&fe("FieldMismatch","TooFewFields","Too few fields: expected "+P.length+" fields but parsed "+ne,$+te)),Z}var de=1;return!k.data.length||Array.isArray(k.data[0])?(k.data=k.data.map(ee),de=k.data.length):k.data=ee(k.data,0),c.header&&k.meta&&(k.meta.fields=P),$+=de,k}()}function ae(){return c.header&&P.length===0}function se(X,ee){return de=X,c.dynamicTypingFunction&&c.dynamicTyping[de]===void 0&&(c.dynamicTyping[de]=c.dynamicTypingFunction(de)),(c.dynamicTyping[de]||c.dynamicTyping)===!0?ee==="true"||ee==="TRUE"||ee!=="false"&&ee!=="FALSE"&&(function(re){if(Y.test(re)){var te=parseFloat(re);if(q<te&&te<O)return!0}return!1}(ee)?parseFloat(ee):A.test(ee)?new Date(ee):ee===""?null:ee):ee;var de}function fe(X,ee,de,re){var te={type:X,code:ee,message:de};re!==void 0&&(te.row=re),k.errors.push(te)}this.parse=function(X,ee,de){var re=c.quoteChar||'"';if(c.newline||(c.newline=function(Z,U){Z=Z.substring(0,1048576);var ie=new RegExp(b(U)+"([^]*?)"+b(U),"gm"),pe=(Z=Z.replace(ie,"")).split("\r"),xe=Z.split(`
`),Se=1<xe.length&&xe[0].length<pe[0].length;if(pe.length===1||Se)return`
`;for(var De=0,be=0;be<pe.length;be++)pe[be][0]===`
`&&De++;return De>=pe.length/2?`\r
`:"\r"}(X,re)),x=!1,c.delimiter)C(c.delimiter)&&(c.delimiter=c.delimiter(X),k.meta.delimiter=c.delimiter);else{var te=function(Z,U,ie,pe,xe){var Se,De,be,ke;xe=xe||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var ye=0;ye<xe.length;ye++){var Ve=xe[ye],rt=0,me=0,Le=0;be=void 0;for(var Ee=new v({comments:pe,delimiter:Ve,newline:U,preview:10}).parse(Z),Ie=0;Ie<Ee.data.length;Ie++)if(ie&&oe(Ee.data[Ie]))Le++;else{var Ce=Ee.data[Ie].length;me+=Ce,be!==void 0?0<Ce&&(rt+=Math.abs(Ce-be),be=Ce):be=Ce}0<Ee.data.length&&(me/=Ee.data.length-Le),(De===void 0||rt<=De)&&(ke===void 0||ke<me)&&1.99<me&&(De=rt,Se=Ve,ke=me)}return{successful:!!(c.delimiter=Se),bestDelimiter:Se}}(X,c.newline,c.skipEmptyLines,c.comments,c.delimitersToGuess);te.successful?c.delimiter=te.bestDelimiter:(x=!0,c.delimiter=l.DefaultDelimiter),k.meta.delimiter=c.delimiter}var ne=M(c);return c.preview&&c.header&&ne.preview++,u=X,p=new v(ne),k=p.parse(u,ee,de),ce(),H?{meta:{paused:!0}}:k||{meta:{paused:!1}}},this.paused=function(){return H},this.pause=function(){H=!0,p.abort(),u=C(c.chunk)?"":u.substring(p.getCharIndex())},this.resume=function(){S.streamer._halted?(H=!1,S.streamer.parseChunk(u,!0)):setTimeout(S.resume,3)},this.aborted=function(){return L},this.abort=function(){L=!0,p.abort(),k.meta.aborted=!0,C(c.complete)&&c.complete(k),u=""}}function b(c){return c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(c){var u,p=(c=c||{}).delimiter,x=c.newline,O=c.comments,q=c.step,Y=c.preview,A=c.fastMode,S=u=c.quoteChar===void 0?'"':c.quoteChar;if(c.escapeChar!==void 0&&(S=c.escapeChar),(typeof p!="string"||-1<l.BAD_DELIMITERS.indexOf(p))&&(p=","),O===p)throw new Error("Comment character same as delimiter");O===!0?O="#":(typeof O!="string"||-1<l.BAD_DELIMITERS.indexOf(O))&&(O=!1),x!==`
`&&x!=="\r"&&x!==`\r
`&&(x=`
`);var D=0,$=!1;this.parse=function(H,L,P){if(typeof H!="string")throw new Error("Input must be a string");var k=H.length,I=p.length,oe=x.length,ce=O.length,ae=C(q),se=[],fe=[],X=[],ee=D=0;if(!H)return ye();if(A||A!==!1&&H.indexOf(u)===-1){for(var de=H.split(x),re=0;re<de.length;re++){if(X=de[re],D+=X.length,re!==de.length-1)D+=x.length;else if(P)return ye();if(!O||X.substring(0,ce)!==O){if(ae){if(se=[],Se(X.split(p)),Ve(),$)return ye()}else Se(X.split(p));if(Y&&Y<=re)return se=se.slice(0,Y),ye(!0)}}return ye()}for(var te=H.indexOf(p,D),ne=H.indexOf(x,D),Z=new RegExp(b(S)+b(u),"g"),U=H.indexOf(u,D);;)if(H[D]!==u)if(O&&X.length===0&&H.substring(D,D+ce)===O){if(ne===-1)return ye();D=ne+oe,ne=H.indexOf(x,D),te=H.indexOf(p,D)}else{if(te!==-1&&(te<ne||ne===-1)){if(!(te<U)){X.push(H.substring(D,te)),D=te+I,te=H.indexOf(p,D);continue}var ie=rt(te,U,ne);if(ie&&ie.nextDelim!==void 0){te=ie.nextDelim,U=ie.quoteSearch,X.push(H.substring(D,te)),D=te+I,te=H.indexOf(p,D);continue}}if(ne===-1)break;if(X.push(H.substring(D,ne)),ke(ne+oe),ae&&(Ve(),$))return ye();if(Y&&se.length>=Y)return ye(!0)}else for(U=D,D++;;){if((U=H.indexOf(u,U+1))===-1)return P||fe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:se.length,index:D}),be();if(U===k-1)return be(H.substring(D,U).replace(Z,u));if(u!==S||H[U+1]!==S){if(u===S||U===0||H[U-1]!==S){te!==-1&&te<U+1&&(te=H.indexOf(p,U+1)),ne!==-1&&ne<U+1&&(ne=H.indexOf(x,U+1));var pe=De(ne===-1?te:Math.min(te,ne));if(H[U+1+pe]===p){X.push(H.substring(D,U).replace(Z,u)),H[D=U+1+pe+I]!==u&&(U=H.indexOf(u,D)),te=H.indexOf(p,D),ne=H.indexOf(x,D);break}var xe=De(ne);if(H.substring(U+1+xe,U+1+xe+oe)===x){if(X.push(H.substring(D,U).replace(Z,u)),ke(U+1+xe+oe),te=H.indexOf(p,D),U=H.indexOf(u,D),ae&&(Ve(),$))return ye();if(Y&&se.length>=Y)return ye(!0);break}fe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:se.length,index:D}),U++}}else U++}return be();function Se(me){se.push(me),ee=D}function De(me){var Le=0;if(me!==-1){var Ee=H.substring(U+1,me);Ee&&Ee.trim()===""&&(Le=Ee.length)}return Le}function be(me){return P||(me===void 0&&(me=H.substring(D)),X.push(me),D=k,Se(X),ae&&Ve()),ye()}function ke(me){D=me,Se(X),X=[],ne=H.indexOf(x,D)}function ye(me){return{data:se,errors:fe,meta:{delimiter:p,linebreak:x,aborted:$,truncated:!!me,cursor:ee+(L||0)}}}function Ve(){q(ye()),se=[],fe=[]}function rt(me,Le,Ee){var Ie={nextDelim:void 0,quoteSearch:void 0},Ce=H.indexOf(u,Le+1);if(Le<me&&me<Ce&&(Ce<Ee||Ee===-1)){var Dt=H.indexOf(p,Ce);if(Dt===-1)return Ie;Ce<Dt&&(Ce=H.indexOf(u,Ce+1)),Ie=rt(Dt,Ce,Ee)}else Ie={nextDelim:me,quoteSearch:Le};return Ie}},this.abort=function(){$=!0},this.getCharIndex=function(){return D}}function y(c){var u=c.data,p=e[u.workerId],x=!1;if(u.error)p.userError(u.error,u.file);else if(u.results&&u.results.data){var O={abort:function(){x=!0,B(u.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:E,resume:E};if(C(p.userStep)){for(var q=0;q<u.results.data.length&&(p.userStep({data:u.results.data[q],errors:u.results.errors,meta:u.results.meta},O),!x);q++);delete u.results}else C(p.userChunk)&&(p.userChunk(u.results,O,u.file),delete u.results)}u.finished&&!x&&B(u.workerId,u.results)}function B(c,u){var p=e[c];C(p.userComplete)&&p.userComplete(u),p.terminate(),delete e[c]}function E(){throw new Error("Not implemented.")}function M(c){if(typeof c!="object"||c===null)return c;var u=Array.isArray(c)?[]:{};for(var p in c)u[p]=M(c[p]);return u}function g(c,u){return function(){c.apply(u,arguments)}}function C(c){return typeof c=="function"}return a&&(d.onmessage=function(c){var u=c.data;if(l.WORKER_ID===void 0&&u&&(l.WORKER_ID=u.workerId),typeof u.input=="string")d.postMessage({workerId:l.WORKER_ID,results:l.parse(u.input,u.config),finished:!0});else if(d.File&&u.input instanceof File||u.input instanceof Object){var p=l.parse(u.input,u.config);p&&d.postMessage({workerId:l.WORKER_ID,results:p,finished:!0})}}),(s.prototype=Object.create(f.prototype)).constructor=s,(i.prototype=Object.create(f.prototype)).constructor=i,(w.prototype=Object.create(w.prototype)).constructor=w,(T.prototype=Object.create(f.prototype)).constructor=T,l})});var Me=Lt(wn=>{_n(wn,{APP_AUTHOR:()=>Wt,APP_DEBUG_STYLE:()=>j,APP_ERROR_STYLE:()=>le,APP_INFO_STYLE:()=>Kt,APP_LOG_STYLE:()=>Vt,APP_NAME:()=>gt,APP_PERF_STYLE:()=>Te,APP_WARN_STYLE:()=>at,BILL_AUTOFUNDED:()=>G,BILL_BILLMODIFICATORS:()=>Jt,BILL_FUNDED:()=>z,BILL_OTHER:()=>Q,OC_AUTOFUNDED:()=>Be,OC_FUNDED:()=>we,OC_MAX_LEVEL:()=>Ne,OC_OTHER:()=>Fe,OC_PRICE1:()=>bt,OC_PRICE2:()=>yt,OC_PRICE3:()=>_t,OC_PRICE4:()=>vt,OC_PRICE5:()=>wt,OC_PRICE6:()=>St,OC_STATUS_0:()=>Xe,OC_STATUS_1:()=>et,OC_STATUS_2:()=>tt,OC_STATUS_3_F:()=>ot,OC_STATUS_3_M:()=>nt,SESSION_CANCEL:()=>K,SESSION_CANCEL_LATE:()=>W,SESSION_DONE:()=>V,SESSION_STUDENT_AWAY:()=>J,TYPE_COACHING:()=>R,TYPE_DEFENSE:()=>N,TYPE_SESSION:()=>F,default:()=>Qt});const $e={Cfg:{dbase:null},raf:null,start:async function(){await Nt();const o=$e.checkSupport();console.log(`%cAre all functions supported ? : ${o}`,j);var d=".dom-services-4-MuiAvatar-img";document.querySelector(d)===null?(console.log("%c All condition not met, waiting element '.MuiAvatar-img' ",j),document.arrive(d,$e._warmup)):(console.log("%c All condition already met go",j),$e._warmup())},checkSupport:function(){return!0},_warmup:function(){console.log("%c in _warmup",j),document.unbindArrive($e._warmup),GM===void 0?(console.log("%cI am not in a tamper env",j),$e._userscriptless()):console.log(`%cTamper environment detected the version is ${GM.info.version}`,j),GM_addStyle(GM_getResourceText("jspanelcss")),GM_addStyle(GM_getResourceText("toastifycss")),GM_addStyle(GM_getResourceText("simpledatatablecss")),GM_addStyle(GM_getResourceText("loading_barcss")),GM_config.init(Ut),GM_registerMenuCommand("OC Facturier - configure",Gt),GM_config.get("hackheaderzindex")===!0&&(document.getElementById("header").style.zIndex=0),GM_addStyle(".swal2-title{font-size:1.275em)"),$e._main()},_userscriptless(){console.log("%cIm'not in a Tamper environment so i need to load js scripts",j)},_main:function(){console.log("​​​%cMainLoaded​​​",j),kt.paintTiming(),kt.longTaskTiming();let o=new LocalStorage("db");var d=low(o);d.defaults({students:[],sessions:[],f_archives:[],history_session_cache:[],meta:[],students_history:[]}).write(),$e.Cfg.dbase=d,dayjs.extend(dayjs_plugin_isSameOrAfter),dayjs.extend(dayjs_plugin_isSameOrBefore),dayjs.extend(dayjs_plugin_isBetween),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_localeData),dayjs.extend(dayjs_plugin_customParseFormat),document.querySelector(".panel.menuBar.flex.draggable")===null&&Ht.init(),GM_config.get("alwaysaddcbox")===!0&&ut(),dayjs.locale("fr"),d.get("meta").value()===void 0&&(console.log("%cDb dont' contain meta table create it",j),d.assign({meta:[]}).write()),console.log("%cCheck DB version to find anyupdate to do",j);let t=Ge.getDbVersion();if(t===-1&&(console.log("%cDb dont' contain dbVersion field in meta table create it with value 1.0.0",j),d.get("meta").push({key:"dbVersion",value:"1.0.0"}).write(),t=Ge.getDbVersion(),t===-1))throw console.log("%cERROR:Could'nt set version on DB",le),new Error("!!!! IRRECOVERABLE ERROR");if(ct(GM.info.script.version,t)==1&&(console.log(`%cDB is in version: ${Ge.getDbVersion()} need to go to version ${GM.info.script.version}`,j),Ke.update(GM.info.script.version)),Je(["https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js"]).then(async function(a){console.log("%cALPINE js fetched",j)}),Je(["https://unpkg.com/htmx.org@1.1.0","https://unpkg.com/htmx.org@1.1.0/dist/ext/debug.js"]).then(async function(a){htmx.on("htmx:configRequest",function(e){}),htmx.on("htmx:beforeRequest",function(e){if(e.detail.pathInfo.finalPath&&qt(e.detail.pathInfo.finalPath)!=="html"){e.detail.xhr.addEventListener("abort",function(){}),e.detail.xhr.onloadstart=function(s){this.abort()};let m=zt.load(e.detail.pathInfo.finalPath),f=e.detail.target;var n=e.detail.elt.getAttribute("hx-select");if(n){let s=new DOMParser().parseFromString(m,"text/html");oNode=s.querySelector(n),oNode?m=oNode.outerHTML:console.log(`%cWanna select target ${n} in data received from calling ${e.detail.pathInfo.finalPath} but this node could'nt be found so return the whole string`,le)}var l=function(s,i){var w=document.createRange(),T=w.createContextualFragment(s);console.log(T);for(var h=T.childNodes.length-1;h>=0;h--){var b=T.childNodes[h];i.appendChild(b),htmx.process(b)}return i.lastChild};l(m,e.detail.target)}}),htmx.on("htmx:xhr:loadstart",function(e){})}),Je(["https://cdn.jsdelivr.net/npm/sweetalert2@10"]).then(async function(a){console.log("%cSweetAlert fetched",j)}),GM_config.get("use_custom_css")===!0){let a=GM_config.get("custom_css_url"),e=a.split(",");if(e.length!==0)console.log(`%cWanna inject Custom CSS from URL:${e}`,j),Je(e).then(()=>{console.log(`%cCustom CSS from URL:${e} loaded`,j)}).catch(n=>console.log(`%cError detected when loading dependencies ${n}`,le));else{let n=GM_config.get("custom_css_data");if(n.length()>0){console.log(`%cNeed to inject a custom css in application content is ${n}`,j);const l=document.createElement("style");l.innerHTML=n,document.head.insertAdjacentElement("beforeend",l)}}}unsafeWindow.Facturier={libs:[],cfg:{dbase:null},klass:[]},unsafeWindow.Facturier.cfg.dbase=$e.Cfg.dbase,unsafeWindow.Facturier.libs.push({id:"fetchInject",ptr:Je}),unsafeWindow.Facturier.libs.push({id:"dayjs",ptr:dayjs}),unsafeWindow.Facturier.klass.push({id:"Student",ptr:_e}),unsafeWindow.Facturier.klass.push({id:"Session",ptr:ve}),unsafeWindow.Facturier.klass.push({id:"Archive",ptr:Ze}),unsafeWindow.Facturier.klass.push({id:"History",ptr:it}),unsafeWindow.Facturier.klass.push({id:"StudentHistory",ptr:Ae}),unsafeWindow.Facturier.klass.push({id:"Dbase",ptr:Ke}),console.log("%cImportants values are exported in unsafeWindow.Facturier",j),GM.info.script.downloadURL==="http://localhost:8000/dist/app-facturier.iife.js"?(console.log("%cALERTE .... version locale !!!!!! ","background-color:coral;color:white"),console.log("%c test readfile",j),Rt("file:////media/pwyll/USB120Go/DevStt/UserScripts/SttAddon/src/update_data_base.js",function(a){console.log(a)}),$e.loadDependencies()):console.log(`%c GM.info.script.downloadURL url : ${GM.info.script.downloadURL}`,j)},loadDependencies:function(){let o=[];o.push("http://localhost:8000/src/branch01/sandbox.js"),o.push("http://localhost:8000/src/branch01/sandbox.css"),Je(o).then(()=>{console.log(`dependencies ${o} loaded`)})},dbUpdate:function(){console.log("%c Need to update DB",j),ct(GM.info.script.version,"1.00.0006")==0&&(console.log("%c Need to update DB to version '1.00.0006'",j),Ke.update("1.00.0006"))},overrideDebug:function(){var o=window.XMLHttpRequest.prototype.open,d=window.XMLHttpRequest.prototype.send;function t(n,l,m,f,s){return this._url=l,o.apply(this,arguments)}function a(n){return this.onreadystatechange&&(this._onreadystatechange=this.onreadystatechange),console.log(`%c Request sent : ${n}`,j),this.onreadystatechange=e,d.apply(this,arguments)}function e(){if(console.log(`%c Ready state changed to: ${this.readyState}`,j),this._onreadystatechange)return this._onreadystatechange.apply(this,arguments)}window.XMLHttpRequest.prototype.open=t,window.XMLHttpRequest.prototype.send=a}};window.Facturier!==void 0?window.Facturier.start():$e.start();var Qt=$e});var At={async XHR(o){const d=window.GM_xmlhttpRequest||(GM?GM.xmlHttpRequest:null);return d?new Promise((t,a)=>{Object.assign(o,{onabort:a,onerror:a,onload:t,ontimeout:a}),d(o)}):Promise.reject()},async getValue(o,d=null){return window.GM_getValue?Promise.resolve(GM_getValue(o)||d):await GM.getValue(o)||d},async setValue(o,d){window.GM_setValue?GM_setValue(o,d):GM.setValue(o,d)}};const gt="OC-Addons",Wt="Stéphane TORCHY",j="background-color:green;color:white",Vt="background-color:black;color:white",at="background-color:coral;color:white",Kt="background-color:cyan;color:white",le="background-color:red;color:white",Te="background-color:blue;color:white",Be="auto-financé",we="financé par un tiers",Fe="autre",Xe="réalisée",et="annulée",tt="annulée tardivement",nt="étudiant absent",ot="étudiante absente",Ne=6,bt=30,yt=35,_t=40,vt=45,wt=50,St=55,G=0,z=1,Q=2,Jt=[{pathId:158,path:"158-trouvez-lemploi-qui-vous-correspond",value:2}],V=0,K=1,W=2,J=3,F=0,N=1,R=2;var Nt=function(){return new Promise(o=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",o):o()})},ft=async function(o="",d="",t=!1){console.info(`%cfetch() waiting return from : ${o}`,j);const a=await At.XHR({method:"GET",url:o,responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"},onprogress:function(f){}}).catch(f=>{console.error(`%cError ${f}`,le)});let e=new DOMParser,n=e.parseFromString(a.responseText.replace(/\n/mg,""),"text/html"),l=n.querySelector("meta[id=captcha-bypass]");if(l!==null)throw console.error(`%cError CloudFlare CAPTCHA : ${n.querySelector("title").innerText}`,j),new Error("Must Respond to Cloudflare Captcha or waiting....");var m={};return t===!0?m=n.querySelectorAll(d):m=n.querySelector(d),m},qe=function(o,d=-1){try{var t=(o.children[0].href||"/").split("/");return t[t.length+d]}catch(a){console.error(`%cError in getkey${a.stack||a}`,le)}},jt=function(o){var d=o.trim().split(" ");try{var t=dayjs_locale_fr.months.findIndex(a=>a===d[1])+1}catch(a){console.error(`%cError in extractDate${a.stack||a}`,le)}return`${d[2]}-${t}-${d[0]}T${d[4]}`},$t=function(o,d=0){d===-1&&(d=o.children.length-1);var t=o.children[d].children[0].innerText;let a=jt(t);var e=dayjs(a);return e},Oe=function(o){return new Promise(d=>setTimeout(d,o))};const qt=function(o){return o.substring(o.lastIndexOf(".")+1,o.length)||o};var ct=function(o,d){for(var t=o.split("."),a=d.split("."),e=0;e<3;e++){var n=Number(t[e]),l=Number(a[e]);if(n>l)return 1;if(l>n)return-1;if(!isNaN(n)&&isNaN(l))return 1;if(isNaN(n)&&!isNaN(l))return-1}return 0},Rt=function(d,t){return console.info("Reading:",d),fetch(d,{mode:"same-origin"}).then(function(a){return a.blob()}).then(function(a){var e=new FileReader;e.addEventListener("loadend",function(){t(this.result)}),e.readAsText(a)})},Zt=function(o){const d=o,t=o.reduce(function(i,w){return i*w});var a=new Array(t);const e=function(...i){const w=i.pop();if(i.length!==o.length)throw"Wrong matrix dimensions, need "+o.length+", you provide "+w.length+"!";if(s(i)===0)throw"Wrong type for set need one or more int has dimension, check type of!";const T=f(i);return a[T]=w,w},n=function(...i){if(i.length!==o.length)throw"Wrong matrix dimensions, need "+o.length+", you provide "+i.length+"!";if(s(i)===0)throw"Wrong type for set need one or more int has dimension, check type of!";const w=f(i);return a[w]},l=function(...i){const w=f(i);return a[w]=void 0,a[w]===void 0},m=function(){console.group("dump table"),console.table(a),console.groupEnd("dump table")},f=function(i){return i.reduce(function(w,T,h,b){let v=d.slice(h+1),y=v.length>0?v.reduce(function(B,E){return B*E}):1;return w+T*y},0)},s=function(i){return i.reduce((w,T)=>w&typeof T=="number",1)};return Object.freeze({set:e,get:n,del:l,toConsole:m})},ze=function(o,d,t=Error){if(!o)throw new t(d)};HTMLElement.prototype.appendFirst=function(o){this.firstChild?this.insertBefore(o,this.firstChild):this.appendChild(o)};var st=async function(o=null,d=null,t=!0){var a="";a+="<style>",a+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",a+="form input {background: #fff;border: 1px solid #9c9c9c;}",a+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",a+="form button:hover {background: gold;}",a+="form label {padding: 0.5em 0.5em 0.5em 0;}",a+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",a+="form input:focus {outline: 3px solid gold;}",a+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",a+="</style>",a+='<form class="form1" action="">',a+='<label for="dtFrom" class="date">Date de début</label>',o?a+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(o).format("YYYY-MM-DD")+'">':a+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',a+='<label for="dtTo" class="date">Date de fin</label>',o?a+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(d).format("YYYY-MM-DD")+'">':a+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',a+="</form>";const{value:e}=await Swal.fire({title:"<strong>Choix de la période</strong>",icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez la période pour la sélection des temps facturés",showLoaderOnConfirm:!0,preConfirm:()=>[document.getElementById("dtFrom").value,document.getElementById("dtTo").value],onRender:n=>{},onOpen:n=>{t===!0&&n.querySelector("#dtFrom").addEventListener("change",_handler=function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:n=>{t===!0&&n.querySelector("#dtFrom").removeEventListener("change",_handler)},onAfterClose:n=>{},onDestroy:n=>{}});return o=dayjs(e[0]),d=dayjs(e[1]),await Oe(250),[o,d]},xt=async function(o){await Swal.fire({position:"top-end",icon:"success",title:o,showConfirmButton:!1,timer:1500})};const mt=je(Me());class Qe{static tbl_name="f_archives";static add=async function(o){let d=mt.default.Cfg.dbase,t=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]"),a={id:o[0].to.format("YYYYMM"),data:o,created_at:o[0].now};console.log(`%cWill create archive for id ${o[0].to.format("YYYYMM")} (YYYYMM)`,j),d.get(Qe.tbl_name).push(JSON.parse(JSON.stringify(a))).write()};static exists=function(o){let d=mt.default.Cfg.dbase,t=d.get(Qe.tbl_name).find({id:o}).value();return!(t===void 0)};static get=function(o){let d=mt.default.Cfg.dbase;var t=d.get(Qe.tbl_name).find({id:o}).value();if(t===void 0)throw Error("Erreur qui ne devrait jamais arriver en Archive.get");return console.log(`%cWill use archive for id ${o} (YYYYMM)`,j),t};static delete=function(o=null,d=null){let t=mt.default.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof d=="string"&&(d=d.format("YYYY-MM-DD")),o===null&&d==null){console.log("%cWanna suppress ALL Archives from DB ",j),t.get(Qe.tbl_name).remove().write();return}if(d==null){t.get(Qe.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMM").isBefore(d),"month"}).write();return}if(o==null){t.get(Qe.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMM").isAfter(o,"month")}).write();return}t.get(Qe.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMM").isBetween(o,d,"month","[]")}).write()}}var Ze=Qe;class Xt{static isInOldMode=function(o){var d=null;typeof o=="string"?d=dayjs(o):d=o;try{return d.isBefore(Xt.getOldModeDate())}catch(t){throw Error("Erreur qui ne devrait jamais arriver en IsInOldMode (probablement un probleme sur la conversion de la date en objet dayjs:"+t.stack||t)}};static getOldModeDate=function(){return dayjs("2020-06-01")};static getAppVersion=function(){return GM.info.script.version}}var he=Xt;const Et=je(Me());var Sn=function(){const o="students_history",d=1,t=2,a=function(T){if(T.toUpperCase()==="FUNDING")return d;if(T.toUpperCase()==="PATH")return t;throw Error("Erreur qui ne devrait jamais arriver en getype")},e=function(T,h,b=null){return l(T,d,h,b)},n=function(T,h,b=null){return l(T,t,h,b)},l=function(T,h,b,v=null){ze(typeof T=="string","You must provide a string.",TypeError);const y=Et.default.Cfg.dbase;typeof v=="string"&&(v=dayjs(v)),v===null&&(v=dayjs()),ze(v instanceof dayjs,"created date must be a string, a dayjs instance or null.",TypeError);let B={id:T,type:0|h,value:b,date:v.valueOf(),humanDate:v.format("YYYY-MM-DDTHH:mm:ssZZ")};return console.log(`%cAdd in student history at date ${dayjs(B.date).format("YYYY-MM-DDTHH:mm:ssZZ")} data ${b} with type:${h}`,j),y.get(o).push(JSON.parse(JSON.stringify(B))).write()},m=function(T,h=null,b=null){const v=Et.default.Cfg.dbase;return T==null&&h==null&&b==null?(console.log("%cRemove all in student history",j),v.get(o).remove().write()):(typeof b=="string"&&(b=dayjs(b)),b==null?h==null?(console.log(`%cRemove for student id:${T} history for all type of event`,j),v.get(o).remove({id:T}).write()):(console.log(`%cRemove for student id:${T} history with event type:${type}`,j),v.get(o).remove({id:T,type:h}).write()):(console.log(`%cRemove for student id:${T} history at date ${b.format("DD/MM/YYYY")} with event type:${type}`,j),v.get(o).remove({id:T,type:h,date:b.valueOf()}).write()))},f=function(T,h,b=null){const v=Et.default.Cfg.dbase;typeof b=="string"&&(b=dayjs(b)),b===null&&(b=dayjs()),console.log(`%cSearching in student history at date ${b.format("DD/MM/YYYY")} any data with type:${h}`,j);var y=+b.valueOf(),B=v.get(o).filter(g=>g.id===T&&g.type&h).map(g=>g.date-y).filter(g=>g>=0).value();if(B.length==0){console.log(`%cThere is no data in student history at date ${b.format("DD/MM/YYYY")} with type:${h}`,j);return}const E=g=>Math.min(...g);let M=y+E(B);return v.get(o).filter(g=>g.id===T&&g.type&h&&g.date==M).value()[0]},s=function(T){return w(T,d)},i=function(T){return w(T,t)},w=function(T,h){return T.type&h};return Object.freeze({addFunding:e,addPath:n,getType:a,remove:m,find:f,isFunding:s,isPath:i,tbl_name:o})};const An=Sn();var Ae=An;const We=je(Me());class ue{static tbl_name="students";static add=function(o,d="noname",t="nopath",a="unknown",e){let n=We.default.Cfg.dbase;var l=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");let m={id:o,fullname:d,path:t,funding:a,created:l};n.get(ue.tbl_name).push(JSON.parse(JSON.stringify(m))).write()};static exists=function(o,d=null){let t=ue.findById(o,d);return console.log(`%cStudent ${o} exists in db ? ${!(t===void 0)}`,j),!(t===void 0)};static findById=function(o,d=null){return ze(typeof o=="string","You must provide a string.",TypeError),typeof d=="string"&&(d=dayjs(d)),d==null?ue.m_findById(o,d):ue.m_findById(o,d.format("YYYY-MM-DDTHH:mm:ssZZ"))};static _findById=function(o,d=null){let t=We.default.Cfg.dbase;typeof d=="string"&&(d=dayjs(d)),console.log(`%cSearching student with id:${o} in db`,j);var a=t.get(ue.tbl_name).find({id:o}).value();if(a===void 0)return;if(d!==null){var e={...a},n=Ae.find(o,Ae.getType("FUNDING"),d);n!==void 0&&(e.funding=n.value);var l=Ae.find(o,Ae.getType("PATH"),d);return l!==void 0&&(e.path=l.value),e}return a};static m_findById=moize.default(ue._findById,{maxAge:6e5,isSerialized:!0,onCacheHit:function(){console.log("%cGet data from cache",j)}});static getFunding=function(o,d=null){return typeof d=="string"&&(d=dayjs(d)),ue.m_getFunding(o,d)};static _getFunding=function(o,d=null){let t=ue.findById(o,d);return t===void 0?(console.log(`%cStudent ${studentId} is not in db, fetchin data:'funded mode' from webpage`,j),ue.getFundingFomDashboard(studentId).toLowerCase()):t.funding.toLowerCase()};static m_getFunding=moize.default(ue._getFunding,{maxAge:6e5,isSerialized:!0});static isAutoFunded=function(o){return console.log("%cFUNCTION DEPRECATED !!!!!!!!!!!!!!!!!!!!!! ",le),ue.getFunded(o).toLowerCase()===Be};static getFundingFomDashboard=async function(o){const d=await ft(`https://openclassrooms.com/fr/mentorship/students/${o}/dashboard`,".mentorshipStudent__details > p");return d.innerText.trim()};static getPath=async function(o,d=null){let t=ue.findById(o,d);if(t==null){console.log(`%cStudent ${o} is not in db, fetching data: 'path' from webpage ....`,j);const a=await ft(`https://openclassrooms.com/fr/mentorship/students/${o}/dashboard`,"a[href*='paths/']");return a.innerText.length==0&&console.error(`%cStudent path is not readable from url : https://openclassrooms.com/fr/mentorship/students/${o}/dashboard`,le),a.innerText.trim()}else return t.path};static delete=function(o=null,d=null){let t=We.default.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof d=="string"&&(d=d.format("YYYY-MM-DD")),o===null&&d==null){console.log("%cWanna suppress ALL Students from DB",j),t.get(ue.tbl_name).remove().write();return}if(d==null){t.get(ue.tbl_name).remove(function(a){return dayjs(a.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBefore(d),"day"}).write();return}if(o==null){t.get(ue.tbl_name).remove(function(a){return dayjs(a.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isAfter(o,"day")}).write();return}t.get(ue.tbl_name).remove(function(a){return dayjs(a.created,"YYYY-MM-DDTHH:mm:ssZ[Z]").isBetween(o,d,"day","[]")}).write()};static deleteById=function(o,d=null){let t=We.default.Cfg.dbase;t.get("students").remove(a=>a.id===o).write(),console.log(`%cAll students with id:${o} are removed from DataBase`,j)};static modifyFunding(o,d,t){typeof d=="string"&&(d=dayjs(d)),ze(created instanceof dayjs,"modifyFunding date must be a string, a dayjs instance or null.",TypeError);const a=ue.getFunding(o,d);if(t.toLower()===a.toLower()){console.log(`%cFundingMode ${t} is identical as current: ${sCurrent}, nothing to do`,j);return}(t!==Be||t!=we||t!==Fe)&&console.log(`%cWarning this state is unknown ${t}`,at);const e=We.default.Cfg.dbase,n=dayjs().format("YYYY-MM-DDTHH:mm:ssZZ");if(d===null&&(d=n),oLastHistory=Ae.find(o,Ae.getType("FUNDING"),d),e.get(ue.tbl_name).find({id:o}).assign({funding:t}).write(),Ae.addFunding(o,a,n),d.isSameOrAfter(he.getOldModeDate()))var l=e.get("sessions").filter(f=>f.who_id===o&&(s=>dayjs(s.when).isSameOrAfter(d,"day")));else var l=e.get("sessions").filter(s=>s.who_id===o&&(i=>dayjs(i.when).isSameOrAfter(he.getOldModeDate(),"day")));for(var m=l.value().length;m-=1;)console.log(`There is ${m} elements left to update`,j),l.get(m).assign({funding:t}).write()}static getAll=async(o,d)=>{var t=!1;let a=We.default.Cfg.dbase;var e="table.crud-list tbody",n=document.querySelectorAll(e)[1];const l=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var m=performance.now(),f=qe(n.children[0].children[0],-2);await ue.getFundingFomDashboard(f),console.log(`%cEstimated time for updating : ${(performance.now()-m)*n.children.length} ms`,j),Swal.fire({position:"top-end",icon:"info",toast:!0,title:`mise à jour de la base de donnée des étudiants...
cela peut prendre du temps ~ ${(performance.now()-m)*n.children.length/1e3} s`,showConfirmButton:!1,timer:1e3}),await Oe(1e3);for(const h of n.children){xt(`Collecte les données de l'étudiant : ${h.children[0].innerText}`);var s=qe(h.children[0],-2),i=h.children[0].innerText,w="non défini";h.children[1].firstElementChild&&(w=h.children[1].firstElementChild.href.split("/").pop());let b=await ue.getFundingFomDashboard(s);var T=ue.m_findById(s,null);if(T===void 0)return console.log(`%cStudent ${i}(id:${s}) not present in database will create it`,j),ue.add(s,i,w,b,l);b.toLowerCase()!==T.funding.toLowerCase()&&(a.get(ue.tbl_name).find({id:s}).assign({funding:b.toLowerCase()}).write(),Ae.add(s,Ae.getType("FUNDING"),T.funding.toLowerCase(),dayjs()),console.log(`%cStudent ${i}(id:${s}) was already present in database but change of funding was detected (from ${T.funding.toLowerCase()} to ${b.toLowerCase()})`,j)),w!==T.path&&(a.get(ue.tbl_name).find({id:s}).assign({path:w}).write(),Ae.add(s,Ae.getType("PATH"),T.path,dayjs()),console.log(`%cStudent ${i}(id:${s}) was already present in database but change of path was detected (from ${T.path} to ${w})`,j))}};static showList=function(){let o=We.default.Cfg.dbase,d=o.get(ue.tbl_name).value();var t="";t+="<table>",t+="<caption>Liste des étudiant</caption>",t+="<thead>",t+="<tr>",t+="<th>Nom</th><th>Parcours</th><th>Financement</th><th>Date de création</th><th>Edition</th>",t+="</tr>",t+="</thead>",t+="<tbody>";for(var a in d)t+="<tr>",t+=`<td>${d[a].fullname}</td><td>${d[a].path}</td><td>${d[a].funding}</td>`,t+=`<td>${dayjs(d[a].created,"YYYY-MM-DDTHH:mm:ssZ[Z]").format("DD/MM/YYYY à HH:mm")}</td>`,t+=`<td><a href="https://openclassrooms.com/fr/mentorship/students/${d[a].id}/dashboard">${d[a].id}</a></td>`,t+="</tr>";t+="</tbody>",t+="</table>",Swal.fire({title:"<strong>Liste des Etudiants</strong>",icon:"info",html:t,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"fullscreen",onOpen:e=>{var n=e.querySelector("table"),l=new simpleDatatables.DataTable(n)}})};static createManually=async function(o,d,t){let a=["non présent dans la liste","Chef de projet digital","Chef de projet SI","Développeur d'application - Frontend","Développeur Web","Expert en stratégie marketing et communication ","Production de contenu web avec CMS et Content Marketing ","Tech lead"];var e="";e+="<style>",e+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",e+="form input {background: #fff;border: 1px solid #9c9c9c;}",e+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",e+="form button:hover {background: gold;}",e+="form label {padding: 0.5em 0.5em 0.5em 0;}",e+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",e+="form input:focus {outline: 3px solid gold;}",e+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",e+="</style>",e+='<form class="form1" action="">',e+='<label for="student_id" class="name">Reference</label>',e+='<input id="student_id" type="text" value="'+o+'">',e+='<label for="student_name" class="name">Name</label>',e+='<input id="student_name" type="text" value="'+d+'">',e+='<label for="funding">Autofinancé</label>',e+='<input id="funding" type="checkbox" value="autofunded">',e+='<label for="student_path">Parcours</label>',e+='<input id="student_path" name="student_path" type="text" list="student_path-list">',e+='<datalist id="student_path-list">';for(var n in a)e+=`<option>${a[n]}</option>`;e+="/<datalist>",e+='<label for="session_date">Date</label>',e+='<input id="session_date" type="date" max="2030-12-31" min="2010-12-31" value="'+dayjs(t).format("YYYY-MM-DD")+'">',e+="</form>";const{value:l}=await Swal.fire({title:"<strong>Ajout d'un étudiant en mode manuel</strong>",icon:"info",html:e,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:`votre étudiant(e) ${d} n'a pas été trouvé`,preConfirm:()=>({student_id:document.getElementById("student_id").value,student_name:document.getElementById("student_name").value,student_path:document.getElementById("student_path").value,student_funding:document.getElementById("funding").checked,session_date:document.getElementById("session_date").value})});if(l&&l.hasOwnProperty("student_id")){var m="";l.student_funding===!0?m=Be:m=we,ue.add(l.student_id,l.student_name,l.student_path,m,l.session_date)}}}var _e=ue;const dt=je(Me());class Re{static tbl_name="sessions";static add=async function(o){let d=dt.default.Cfg.dbase;if(GM_config.get("checksessionalreadyexists")===!0)var t=!0;if(t===!0&&Re.exists(o.id)===!0)return;if(he.isInOldMode(dayjs(o.when)))console.log("%cWe are in old mode",j),o.funding=we,o.type.toLowerCase()==="soutenance"?(console.log("%cThis is a defense, we DON't need to add the path to the session",j),o.path="this ia a defense no need for path"):o.path="old mode no need for path";else if(o.type.toLowerCase()==="soutenance")console.log("%cThis is a defense nothing to do specially for now",j),o.funding=we;else{if(_e.exists(o.who_id)===!1&&(await _e.getAll(),_e.exists(o.who_id,o.when)==!1))return console.warn(`%cStudent {oSession.who_id} which exists at ${o.when} still not exit in Db, have to manually create him/her`,j),_e.createManually(o.who_id,o.who_name,o.when);o.funding=await _e.getFunding(o.who_id,o.when),o.path=await _e.getPath(o.who_id,o.when)}console.log(`%cSaving session id:${o.id} of ${o.who_name}(${o.who_id}) at ${o.when} to DB`,j),d.get(Re.tbl_name).push(JSON.parse(JSON.stringify(o))).write()};static exists=function(o){let d=dt.default.Cfg.dbase;console.log(`%cWill search existence of session id:${o} in database`,j);var t=d.get(Re.tbl_name).find({id:o}).value();return!(t===void 0)};static delete=function(o=null,d=null){let t=dt.default.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof d=="string"&&(d=d.format("YYYY-MM-DD")),o===null&&d==null){console.log("%cWanna suppress ALL Sessions from DB",j),t.get(Re.tbl_name).remove().write();return}if(d==null){t.get(Re.tbl_name).remove(function(a){return dayjs(a.when).isBefore(d),"day"}).write();return}if(o==null){t.get(Re.tbl_name).remove(function(a){return dayjs(a.when).isAfter(o,"day")}).write();return}t.get(Re.tbl_name).remove(function(a){return dayjs(a.when).isBetween(o,d,"day","[]")}).write()};static deleteById=function(o){let d=dt.default.Cfg.dbase;d.get("sessions").remove(t=>t.id===o).write(),console.log(`%cSession ${o} suppressed from DB`,j)};static getBetween(o,d){typeof o=="string"&&(o=dayjs(o)),typeof d=="string"&&(o=dayjs(d));let t=dt.default.Cfg.dbase,a=t.get(Re.tbl_name).filter(e=>dayjs(e.when).isSameOrBefore(d,"day")&&dayjs(e.when).isSameOrAfter(o,"day")).value();return a}static parseTable=function(o){var d=o.children[0].children[0].innerText,t=qe(o.children[0]),a=o.children[1].children[0].innerText.trim(),e=qe(o.children[1],-2),n=o.children[2].innerText.trim().toLowerCase(),l=o.children[3].children.length?o.children[3].children[0].innerText.trim().toLowerCase():"session",m=-1;o.children[4].children.length>0&&(m=o.children[4].children[0].innerText.trim()),d=jt(d);var f={id:t,when:d,who_id:e,who_name:a,status:n,type:l,lvl:m};return f}}var ve=Re;const en=je(Me());class Ct{static calculateBill=function(o,d){let t=d.format("YYYYMM");if(Ze.exists(t)===!0){console.log(`%cUse Archived version ${t} of accounting`,j);let a=Ze.get(t);return a.data}return typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof d=="string"&&(d=d.format("YYYY-MM-DD")),Ct.m_calculateBill(o,d)};static _calculateBill=function(o,d){typeof o=="string"&&(o=dayjs(o)),typeof d=="string"&&(d=dayjs(d));const t=dayjs().format("YYYY-MM-DDTHH:mm:ssZ[Z]");var a=0,e=0,n=performance.now();const l=en.default.Cfg.dbase,m=l.get(ve.tbl_name).filter(c=>dayjs(c.when).isSameOrBefore(d,"day")&&dayjs(c.when).isSameOrAfter(o,"day")),f=m.value(),s=f.length;let i={from:o,to:d,created_at:null,maxLevel:Ne,number:0,amount:0,errors:{funding:[],level:[],path:[],status:[],type:[]},flatFee:[]},w=0,T=0,h=[];a=performance.now();const b=Ct.getPriceList(o);e=performance.now(),console.log("%cGetPriceList took "+(e-a)+" milliseconds.",Te);let v=Zt([Ne+1,Ne+1,Ne+1,Ne+1]);for(var y=0;y<s;y+=1){const c=f[y];var B=0;c.status===Xe&&(B=V),c.status===et&&(B=K),c.status===tt&&(B=W),(c.status===nt||c.status===ot)&&(B=J);var E=0;c.type.toLowerCase()==="session"&&(E=F),c.type.toLowerCase()==="soutenance"&&(E=N),c.path!=null&&c.path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&c.type!=="soutenance"&&(E=R);var M=0;const u=he.isInOldMode(o);if(u===!0&&(M=c.isFunded===!0?z:G),c.funding===Be&&(M=G),c.funding===we&&(M=z),c.funding===Fe&&(M=Q),c.lvl<0){i.errors.level.push(c);continue}if(u===!1&&c.funding!==Be&&c.funding!==we&&c.funding!==Fe){i.errors.funding.push(c);continue}if(c.type.toLowerCase()!=="session"&&E!==N&&E!==R){i.errors.type.push(c);continue}if(c.status!==Xe&&c.status!==et&&c.status!==tt&&c.status!==nt&&c.status!==ot){i.errors.status.push(c);continue}let p=v.get(E,B,M,+c.lvl);p===void 0&&(p={number:0,amount:0,data:[]}),p.number+=1,w+=1,c.lvl<0?(p.amount+=0,T+=0):(p.amount+=1*b[c.lvl][E][B][M],T+=1*b[c.lvl][E][B][M]),p.data.push(c),v.set(E,B,M,+c.lvl,p),E===F&&M===G&&h.push({id:+c.who_id,who_id:c.who_id,who_name:c.who_name})}var g=[];a=performance.now(),g=_.uniqBy(h,"id"),i.flatFee=g,i.number=w,i.amount=T,i.number+i.errors.funding.length+i.errors.level.length+i.errors.path.length+i.errors.status.length+i.errors.type.length<s&&(console.log(`%cError total number of sessions is ${s} and total number of sessions in bill ${w} + all errors are different`,le),console.log("errors are",i.errors),console.log("sessions are",f)),i.created_at=t,v.set(0,0,0,0,i);var C=performance.now();return console.log("%cFunction took "+(C-n)+" milliseconds.",Te),v};static m_calculateBill=moize.default(Ct._calculateBill,{maxAge:12e4,isSerialized:!0,onCacheAdd:function(o,d,t){console.log("%cAdd data to cache",j)},onCacheHit:function(){console.log("%cGet data from cache",j)}});static getPriceList=function(o){typeof o=="string"&&(o=dayjs(o));var d=[0,bt,yt,_t,vt,wt,St];const t=he.isInOldMode(o);var a=new Array(7);for(let e=1;e<=Ne;e+=1){let n=d[e],l=d[e]/2,m=d[e]/4;t?(a[e]=new Array(3),a[e][F]=new Array(5),a[e][F][V]=new Array(4),a[e][F][V][G]=n,a[e][F][V][z]=n,a[e][F][V][Q]=n,a[e][F][K]=new Array(4),a[e][F][K][G]=0,a[e][F][K][z]=0,a[e][F][K][Q]=0,a[e][F][W]=new Array(4),a[e][F][W][G]=l,a[e][F][W][z]=l,a[e][F][W][Q]=l,a[e][F][J]=new Array(4),a[e][F][J][G]=l,a[e][F][J][z]=l,a[e][F][J][Q]=l,a[e][N]=new Array(5),a[e][N][V]=new Array(4),a[e][N][V][G]=n,a[e][N][V][z]=n,a[e][N][V][Q]=n,a[e][N][K]=new Array(4),a[e][N][K][G]=0,a[e][N][K][z]=0,a[e][N][K][Q]=0,a[e][N][W]=new Array(4),a[e][N][W][G]=l,a[e][N][W][z]=l,a[e][N][W][Q]=l,a[e][N][J]=new Array(4),a[e][N][J][G]=l,a[e][N][J][z]=l,a[e][N][J][Q]=l,a[e][R]=new Array(5),a[e][R][V]=new Array(4),a[e][R][V][G]=n,a[e][R][V][z]=n,a[e][R][V][Q]=n,a[e][R][K]=new Array(4),a[e][R][K][G]=0,a[e][R][K][z]=0,a[e][R][K][Q]=0,a[e][R][W]=new Array(4),a[e][R][W][G]=l,a[e][R][W][z]=l,a[e][R][W][Q]=l,a[e][R][J]=new Array(4),a[e][R][J][G]=l,a[e][R][J][z]=l,a[e][R][J][Q]=l):(a[e]=new Array(3),a[e][F]=new Array(5),a[e][F][V]=new Array(4),a[e][F][V][G]=l,a[e][F][V][z]=n,a[e][F][V][Q]=n,a[e][F][K]=new Array(4),a[e][F][K][G]=0,a[e][F][K][z]=0,a[e][F][K][Q]=0,a[e][F][W]=new Array(4),a[e][F][W][G]=0,a[e][F][W][z]=0,a[e][F][W][Q]=0,a[e][F][J]=new Array(4),a[e][F][J][G]=m,a[e][F][J][z]=l,a[e][F][J][Q]=l,a[e][N]=new Array(5),a[e][N][V]=new Array(4),a[e][N][V][G]=n,a[e][N][V][z]=n,a[e][N][V][Q]=n,a[e][N][K]=new Array(4),a[e][N][K][G]=0,a[e][N][K][z]=0,a[e][N][K][Q]=0,a[e][N][W]=new Array(4),a[e][N][W][G]=0,a[e][N][W][z]=0,a[e][N][W][Q]=0,a[e][N][J]=new Array(4),a[e][N][J][G]=l,a[e][N][J][z]=l,a[e][N][J][Q]=l,a[e][R]=new Array(5),a[e][R][V]=new Array(4),a[e][R][V][G]=n,a[e][R][V][z]=n,a[e][R][V][Q]=n,a[e][R][K]=new Array(4),a[e][R][K][G]=0,a[e][R][K][z]=0,a[e][R][K][Q]=0,a[e][R][W]=new Array(4),a[e][R][W][G]=0,a[e][R][W][z]=0,a[e][R][W][Q]=0,a[e][R][J]=new Array(4),a[e][R][J][G]=l,a[e][R][J][z]=l,a[e][R][J][Q]=l)}return a}}var Pe=Ct;const lt=je(Me());class ge{static tbl_name="history_session_cache";static getSessionPage=function(o){o.get("day")<o.daysInMonth()&&(o=o.endOf("month")),console.log(`%cSearch in history session cache data for id: ${o.format("DD/MM/YYYY")}`,j);let d=lt.default.Cfg.dbase;if(!d.has(ge.tbl_name).value())throw Error(`DB ${ge.db_name} NOT FOUND`);let t=d.get(ge.tbl_name).find({id:+o.format("YYYYMMDD")}).value();return t===void 0?-1:t};static getNearestSessionPage=function(o){o.get("day")<o.daysInMonth()&&(o=o.endOf("month")),console.log(`%cSearch in history session cache NEAREST cached data for id: ${o.format("DD/MM/YYYY")}`,j);let d=lt.default.Cfg.dbase;if(!d.has(ge.tbl_name).value())throw Error(`DB ${ge.db_name} NOT FOUND`);let t=+o.format("YYYYMMDD"),a=d.get(ge.tbl_name).value().map(l=>+l.id-t).filter(l=>l>0);const e=l=>Math.min(...l);let n=e(a)+t;return console.log(`%cNearest data in history session cache is data with id: ${o.format("DD/MM/YYYY")}`,j),a=d.get(ge.tbl_name).find({id:n}).value(),a===void 0?-1:a};static getSameOrNearestSessionPage=function(o){let d=ge.getSessionPage(o);return d===-1&&(d=ge.getNearestSessionPage(o)),d};static delete=function(o=null,d=null){let t=lt.default.Cfg.dbase;if(typeof o=="string"&&(o=o.format("YYYY-MM-DD")),typeof d=="string"&&(d=d.format("YYYY-MM-DD")),o===null&&d==null){t.get(ge.tbl_name).remove().write(),console.log("%cWanna suppress ALL History from DB",j);return}if(d==null){t.get(ge.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMMDD").isBefore(d),"day"}).write();return}if(o==null){t.get(ge.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMMDD").isAfter(o,"day")}).write();return}t.get(ge.tbl_name).remove(function(a){return dayjs(a.id,"YYYYMMDD").isBetween(o,d,"day","[]")}).write()};static addOrUpdateSessionPage=function(o=1,d=dayjs("1970-10-06")){ge.getSessionPage(d)==-1?ge.addSessionPage(o,d):ge.updateSessionPage(o,d)};static updateSessionPage=function(o=1,d=dayjs("1970-10-06")){let t=lt.default.Cfg.dbase,a=ge.getSessionPage(d);if(a==-1)throw Error("session page not found in history");t.get(ge.tbl_name).find({id:+d.format("YYYYMMDD")}).assign({page:o}).write()};static addSessionPage=function(o=1,d=dayjs("1970-10-06")){let t=lt.default.Cfg.dbase;t.get(ge.tbl_name).push(JSON.parse(JSON.stringify({id:+d.format("YYYYMMDD"),page:o}))).write()}}var it=ge;var Bt=function(o,d){let t=[[0,1,2,3,4,5,5],[5,1,2,3,4,5,5],[4,5,1,2,3,4,4],[3,4,5,1,2,3,3],[2,3,4,5,1,2,2],[1,2,3,4,5,1,1],[0,1,2,3,4,5,0]];return Math.trunc(d.diff(o,"days")/7)*5+t[o.day()][d.day()]};const tn=je(Me());class xn{static detail_bill="truc";static getListDetailBill=function(o,d){let t=tn.default.Cfg.dbase,a=t.get(ve.tbl_name).filter(y=>dayjs(y.when).isSameOrBefore(d,"day")&&dayjs(y.when).isSameOrAfter(o,"day")).sortBy(function(y){return dayjs(y.when).valueOf()}).value();const e=he.getOldModeDate();let n=Pe.getPriceList(e.subtract(1,"day")),l=Pe.getPriceList(e),m=0;var f=_.cloneDeep(a);for(var s in f){var i=0,w=0,T=!0,h=0;f[s].status===Xe&&(h=V),f[s].status===et&&(h=K),f[s].status===tt&&(h=W),(f[s].status===nt||f[s].status===ot)&&(h=J);var b=0;f[s].type.toLowerCase()==="session"&&(b=F),f[s].type.toLowerCase()==="soutenance"&&(b=N),f[s].path!=null&&f[s].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&f[s].type!=="soutenance"&&(b=R);var v=0;f[s].funding===Be&&(v=G),f[s].funding===we&&(v=z),f[s].funding===Fe&&(v=Q),he.isInOldMode(dayjs(f[s].when))?i=+f[s].lvl>0?n[+f[s].lvl][b][h][v]:0:(T=!1,i=+f[s].lvl>0?l[+f[s].lvl][b][h][v]:0),m+=i,f[s].iPu=i,f[s].oldMode=T,f[s].iCumul=m}return f};static getListStatistic=function(o,d){let t=o.clone(),a=t.endOf("month"),e=[],n=[],l=0,m=d.diff(o,"month");for(var f=performance.now();t.isSameOrBefore(d,"day");)e.push(Pe.calculateBill(t,a)),t=t.add(1,"month"),a=t.endOf("month");var s=performance.now();console.log("%cComputed data between the two dates in"+(s-f)+" milliseconds.",Te),t=o.clone(),a=t.endOf("month");let i=0,w=0,T=0,h=0,b=0,v=0,y=0;for(;l<=m;){const E=e[l].get(0,0,0,0),M=E.maxLevel;n[l]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let g=1;for(;g<M;){let c=0,u=0,p=0,x=0;i=e[l].get(F,V,G,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(F,V,z,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(F,V,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,he.isInOldMode(t)?(n[l].kpi.hrs+=(i+w+T)*(45/60),n[l].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsS")/60)):(n[l].kpi.hrs+=T*(30/60),n[l].kpi.hrsp+=T*(GM_config.get("nbHrsAfM")/60),n[l].kpi.hrs+=(i+w)*(45/60),n[l].kpi.hrsp+=(i+w)*(GM_config.get("nbHrsfM")/60)),i=e[l].get(F,K,G,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(F,K,z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(F,K,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,he.isInOldMode(t)?(i=e[l].get(F,W,G,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(F,W,z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(F,W,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount):(i=e[l].get(F,W,G,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(F,W,z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(F,W,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount),i=e[l].get(F,J,G,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(F,J,z,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(F,J,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i,n[l].kpi.hrs+=(i+w+T)*(15/60),n[l].kpi.hrsp+=(i+w+T)*(15/60),c=n[l].sessions.total,u=n[l].sessions.nb,p=n[l].sessions.pu,x=n[l].sessions.nbc,n[l].sessions={total:b+c,nb:h+u,pu:(b+c)/(h+u),nbc:v+x},c=0,u=0,p=0,x=0,h=0,b=0,v=0,y=0,i=e[l].get(N,V,G,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(N,V,z,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(N,V,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,n[l].kpi.hrs+=(i+w+T)*(45/60),n[l].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsD")/60),i=e[l].get(N,K,G,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(N,K,z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(N,K,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(N,W,G,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(N,W,z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(N,W,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(N,J,G,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(N,J,z,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(N,J,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,n[l].kpi.hrs+=(i+w+T)*(15/60),n[l].kpi.hrsp+=(i+w+T)*(15/60),c=n[l].defenses.total,u=n[l].defenses.nb,p=n[l].defenses.pu,x=n[l].defenses.nbc,n[l].defenses={total:b+c,nb:h+u,pu:(b+c)/(h+u),nbc:v+x},c=0,c=0,u=0,p=0,x=0,h=0,b=0,v=0,y=0,i=e[l].get(R,V,G,g),T=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(R,V,z,g),w=typeof i=="undefined"?0:i.number,h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(R,V,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=typeof i=="undefined"?0:i.number,n[l].kpi.hrs+=(i+w+T)*(45/60),n[l].kpi.hrsp+=(i+w+T)*(GM_config.get("nbHrsC")/60),i=e[l].get(R,K,G,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(R,K,z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(R,K,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(R,W,G,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(R,W,z,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(R,W,Q,g),v=typeof i=="undefined"?v:v+i.number,y=typeof i=="undefined"?y:y+i.amount,i=e[l].get(R,J,G,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(R,J,z,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,i=e[l].get(R,J,Q,g),h=typeof i=="undefined"?h:h+i.number,b=typeof i=="undefined"?b:b+i.amount,c=n[l].coaches.total,u=n[l].coaches.nb,p=n[l].coaches.pu,x=n[l].coaches.nbc,i=typeof i=="undefined"?0:i.number,n[l].kpi.hrs+=i*(15/60),n[l].kpi.hrsp+=i*(15/60),n[l].coaches={total:b+c,nb:h+u,pu:(b+c)/(h+u),nbc:v+x},g+=1}let C=E.flatFee.length;for(var B=0;B<C;B+=1)n[l].bonus+=30;a.isAfter(d,"day")&&(a=d.clone()),n[l].kpi.jrs=Bt(t,a),n[l].header.dtFrom=t.format("YYYY-MM-DD"),n[l].header.dtTo=a.format("YYYY-MM-DD"),n[l].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),t=t.add(1,"month"),a=t.endOf("month"),l+=1}return n};static getListStatisticOld=function(o,d){let t=o.clone(),a=t.endOf("month"),e=[],n=[],l=d.get("month")-o.get("month");for(var m=performance.now();t.isSameOrBefore(d,"day");)e.push(Pe.calculateBill(t,a)),t=t.add(1,"month"),a=t.endOf("month");var f=performance.now();console.log("%cComputed data between the two dates in"+(f-m)+" milliseconds.",Te);let s=0;for(t=o.clone(),a=t.endOf("month"),console.log(e);s<=l;){let i=e[s][0].max_level;n[s]={header:{dtFrom:null,dtTo:null,created_at:null},sessions:{total:0,nb:0,pu:0,nbc:0},defenses:{total:0,nb:0,pu:0,nbc:0},coaches:{total:0,nb:0,pu:0,nbc:0},bonus:0,kpi:{jrs:0,hrs:0,hrsp:0}};let w=1;for(;w<i;){let T=[...Array(8).keys()];for(let h=0;h<T.length;h+=1)n[s].sessions.total+=e[s][w].sessions.number[h]*e[s][w].sessions.pu[h],n[s].sessions.nb+=e[s][w].sessions.number[h],n[s].defenses.total+=e[s][w].defenses.number[h]*e[s][w].defenses.pu[h],n[s].defenses.nb+=e[s][w].defenses.number[h],he.isInOldMode(t)?[1,5].includes(h)&&(n[s].sessions.nbc+=e[s][w].sessions.number[h],n[s].defenses.nbc+=e[s][w].defenses.number[h]):[1,2,5,6].includes(h)&&(n[s].sessions.nbc+=e[s][w].sessions.number[h],n[s].defenses.nbc+=e[s][w].defenses.number[h]),he.isInOldMode(t)?(n[s].kpi.hrs+=(e[s][w].sessions.number[h]-e[s][w].defenses.number[h])*(45/60),n[s].kpi.hrsp+=(e[s][w].sessions.number[h]-e[s][w].defenses.number[h])*(GM_config.get("nbHrsfM")/60)):([4,5,6,7].includes(h)&&(n[s].kpi.hrs+=(e[s][w].sessions.number[h]-e[s][w].defenses.number[h])*(30/60),n[s].kpi.hrsp+=(e[s][w].sessions.number[h]-e[s][w].defenses.number[h])*(GM_config.get("nbHrsAfM")/60)),[0,1,2,3].includes(h)&&(n[s].kpi.hrs+=(e[s][w].sessions.number[h]-e[s][w].defenses.number[h])*(45/60),n[s].kpi.hrsp+=(e[s][w].sessions.number[h]-e[s][w].defenses.number[h])*(GM_config.get("nbHrsfM")/60))),n[s].kpi.hrs+=e[s][w].defenses.number[h]*(45/60),n[s].kpi.hrsp+=e[s][w].defenses.number[h]*(GM_config.get("nbHrsD")/60);w+=1}n[s].sessions.pu=n[s].sessions.total/(n[s].sessions.nb-n[s].sessions.nbc),n[s].defenses.pu=n[s].defenses.total/(n[s].defenses.nb-n[s].defenses.nbc),n[s].coaches.total=n[s].sessions.total-n[s].defenses.total,n[s].coaches.nb=n[s].sessions.nb-n[s].defenses.nb,n[s].coaches.nbc=n[s].sessions.nbc-n[s].defenses.nbc,n[s].coaches.pu=n[s].coaches.total/(n[s].coaches.nb-n[s].coaches.nbc);for(let T=0;T<e[s][0].bonus.length;T+=1)n[s].bonus+=e[s][0].bonus[T].sessions>0?30:0;a.isAfter(d,"day")&&(a=d.clone()),n[s].kpi.jrs=Bt(t,a),n[s].header.dtFrom=t.format("YYYY-MM-DD"),n[s].header.dtTo=a.format("YYYY-MM-DD"),n[s].header.created_at=dayjs().format("YYYY-MM-DD HH:mm:ss"),t=t.add(1,"month"),a=t.endOf("month"),s+=1}return n}}var Tt=xn;class En{static addFooter=async function(o,d,t={}){const{degrees:a,PDFDocument:e,rgb:n,StandardFonts:l}=PDFLib,m=o.getPageCount(),f="8".repeat(m),s=await o.embedFont(l.TimesRoman),i=12,w=s.widthOfTextAtSize(`page ${f} / ${f}`,i),T=10,h=10,b=1,v=n(0/255,0/255,0/255),y=n(253/255,246/255,227/255),B=5,E=5,M=3,g=3,C=!0;o.getPages().forEach((c,u)=>{if(!(C===!0&&u==0)){const{width:p,height:x}=c.getSize(),O=i+2*b+M+g;c.moveTo(T+B,i+g),c.setFont(s),c.setFontSize(i),c.setFontColor(n(1,0,0)),d!==void 0&&c.drawText(`${d}`),c.drawText(`page ${u+1} / ${m}`,{x:p-w-E}),c.drawRectangle({x:T,y:10,width:p-(T+h),height:O,color:y,opacity:.6,borderColor:v,borderWidth:b})}})};static changePgIfNeeded(o,d,t,a){var e=a.getPageCount(),n=a.getPages()[e-1],l=n.fontSize,m=n.getFont(),f=n.lineHeight;return o<d&&(t=1,n=a.addPage(),n.font=m,n.setFontSize(l),n.lineHeight=f),[t,n]}}var He=En;const pt=je(Me());var Cn=function(){const o="meta",d=function(n){return ze(typeof n=="string","You must provide a string.",TypeError),pt.default.Cfg.dbase.get(Ot.tbl_name).find({key:"dbVersion"}).assign({value:n}).write().value},t=function(){let n=pt.default.Cfg.dbase.get(Ot.tbl_name).find({key:"dbVersion"}).value();return typeof n=="undefined"?-1:n.value},a=function(){return pt.default.Cfg.dbase.get("meta").remove(n=>!0).write()},e=function(){return console.log("%c resetDbVersion NE FONCTIONNE PAS",le),pt.default.Cfg.dbase.get("meta").find({key:"dbVersion"}).remove(n=>!0).write()};return Object.freeze({getDbVersion:t,setDbVersion:d,delDbVersion:e,tbl_name:o})};const Ot=Cn();var Ge=Ot;const nn=je(Me());var on=async function(){let o=nn.default.Cfg.dbase;const d=await Swal.mixin({confirmButtonText:"Suivant &rarr;",showCancelButton:!0,progressSteps:["0","1","2","3","4","5"],onOpen:function(w){console.log("...onOpen")},onRender:function(w){console.log("....onUpdate")},onClose:function(w){console.log(".....onClose")},onAfterClose:function(w){console.log("......onAfterClose")},onDestroy:function(w){console.log(".......onDestroy")}}).queue([{title:"Migration de la base",html:"<p>Cette migration va corriger la base et ajouter les nouveaux champs nécessaires, l`interrpuption du traitement est sans danger (mais ce n' est pas une raison !)</p>"},{title:"Correction de la table étudiant",html:"<p>Correction de la liste des étudiants (who_id)",onOpen:async function(w){console.log("%cMigration table des étudiants correction du who_id",j),Swal.showLoading();var T=dayjs("2020-06-01"),h=o.get("students"),b=h.value(),v=o.get("sessions").filter(g=>dayjs(g.when).isSameOrAfter(T,"day")),y=h.size().value(),B=Swal.getContent().textContent;for(f=0;f<y;f+=1){var E=v.find(C=>C.who_name===b[f].fullname).value();E!==void 0&&h.get(f).assign({who_id:E.who_id}).write();const g=Swal.getContent();g!=null&&(g.innerHTML=`${B}<br /><p>Traitement en cours : ${f}/${b.length}</p>`),await Oe(1)}Swal.hideLoading();const M=Swal.getContent();M!=null&&(M.textContent=`Traitement terminé : ${b.length}/${b.length}`)}},{title:"Correction de la table étudiant",html:"<p>Correction de la liste des étudiants funded devient funding</p>",onOpen:async function(w){console.log("%cMigration : table des étudiants suppression de l'ancien champs et ajout du champs funding",j),Swal.showLoading();for(var T=o.get("students"),h=T.size().value(),b=Swal.getContent().textContent,v=0;v<h;v+=1){var y=T.get(v).value().fundedby;if(y===void 0){console.log("%cStudent ${oListStudents.get(i).who_name} already converted, skip it",j);continue}T.get(v).unset(["fundedby"]).assign({funding:y}).write(),console.log("%cStudent ${oListStudents.get(i).who_name} create field funding and remove fundedby",j);const E=Swal.getContent();E!=null&&(E.innerHTML=`${b}<br /><p>Traitement en cours : ${v}/${h}</p>`),await Oe(1)}Swal.hideLoading();const B=Swal.getContent();B!=null&&(B.textContent=`Traitement terminé : ${h}/${h}`)}},{title:"Correction table Etudiants",html:"<p>Correction de la liste des sessions, ajout du path dans la session</p>",onOpen:async function(w){console.log("%cMigration table des sessions correction de id_who",j),Swal.showLoading();var T=dayjs("2020-06-01"),h=o.get("students"),b=h.value(),v=o.get("sessions").filter(C=>dayjs(C.when).isSameOrAfter(T,"day")),y=v.filter(C=>C.type!="soutenance").value(),B=Swal.getContent().textContent;for(f=0;f<y.length;f+=1){var E=h.find({who_id:y[f].who_id}).value();console.log("found",E);var M=E!==void 0&&E.path.length>0?E.path:"0-unknown";o.get("sessions").find({id:y[f].id}).assign({path:M}).write();const C=Swal.getContent();C!=null&&(C.innerHTML=`${B}<br /><p>Traitement en cours : ${f}/${y.length}</p>`),await Oe(1)}Swal.hideLoading();const g=Swal.getContent();g!=null&&(g.textContent=`Traitement terminé : ${f}/${y.length}`)}},{title:"Migration de la table des Sessions",html:'<p>Correction de la liste des sessions, suppression du champs "isFunded"</p>',onOpen:async function(w){console.log("%cMigration : table des sessions suppression de isFunded",j),Swal.showLoading();for(var T=dayjs("2020-06-01"),h=o.get("students").value(),b=o.get("sessions").filter(M=>dayjs(M.when).isSameOrAfter(T,"day")),v=Swal.getContent().textContent,y=b.value().length;y-=1;){var B=b.get(y);B.value().isFunded===void 0||B.value().isFunded===void 0?console.log(`%cSkip ${B.value()} already converted`,j):B.unset(["isFunded"]).write();const M=Swal.getContent();M!=null&&(M.innerHTML=`${v}<br /><p>Traitement en cours : il reste ${y} élements à convertir</p>`),await Oe(1)}Swal.hideLoading();const E=Swal.getContent();E!=null&&(E.textContent=`Traitement en terminé : ${b.value().length}/${b.value().length}`)}},{title:"Migration de la table des Sessions",html:"<p>Correction de la liste des sessions, ajout de funding</p>",onOpen:async function(w){console.log("%cMigration : table des sessions ajout de fundedBy",j),Swal.showLoading();for(var T=dayjs("2020-06-01"),h=o.get("students").value(),b=o.get("sessions").filter(C=>dayjs(C.when).isSameOrAfter(T,"day")),v=b.filter(C=>C.type!="soutenance"),y=Swal.getContent().textContent,B=v.value().length;B-=1;){var E=v.get(B);E.value().funding!==void 0?console.log(`%cSkip ${E.value()} already converted`,j):E.assign({funding:_e.getFunding(E.value().who_id)}).write();const C=Swal.getContent();C.innerHTML=`${y}<br /><p>Traitement en cours : il rest ${B}élements à convertir</p>`,await Oe(1)}for(var M=B,v=b.filter(C=>C.type=="soutenance"),B=0;B<v.value().length;B+=1){v.get(B).assign({funding:we}).write();const c=Swal.getContent();c!=null&&(c.innerHTML=`${y}<br /><p>Traitement en cours : ${M+B}/${b.value().length}</p>`),await Oe(1)}Swal.hideLoading();const g=Swal.getContent();g!=null&&(g.textContent=`Traitement terminé :  ${b.value().length}/${b.value().length}`)}}]).then(w=>{if(w.value){const T=JSON.stringify(w.value);Swal.fire({title:"Traitement terminé!",html:`
			Your answers:
			<pre><code>${T}</code></pre>
		  `,confirmButtonText:"Lovely!"})}else return console.log("%c resultat en erreur",j,w,w.dismiss===Swal.DismissReason.cancel),-1});return d;var t,a,e;for(f=0;f<a.length;f+=1){var n=e.find(w=>w.who_name===a[f].fullname).value();n!==void 0&&o.get("students").find({fullname:n.who_name}).assign({who_id:n.who_id}).write()}var l;for(f=0;f<l.length;f+=1){var n=o.get("students").find({who_id:l[f].who_id}).value(),m=n!==void 0&&n.path.length>0?n.path:"0-unknown";o.get("sessions").find({id:l[f].id}).assign({path:m}).write()}for(var f=0;f<e.value().length;f+=1)e.get(f).unset(["isFunded"]).write();for(var s,f=0;f<s.value().length;f+=1){var i=s.get(f);i.assign({fundedBy:_e.getFunded(i.value().who_id)}).write()}for(var s,f=0;f<s.value().length;f+=1)s.get(f).assign({fundedBy:we}).write()};const Ue=je(Me()),rn=je(Ft());class an{static save=function(){return console.log("%cWanna save DBASE",j),JSON.stringify(Ue.default.Cfg.dbase.getState())};static load=function(o){return console.log(`%cWanna load ${o} in DBASE`,j),console.log("%c !!!!!! TYPE NOT CHECKED BE CARREFULL",j),Ue.default.Cfg.dbase.setState(JSON.parse(o)).write()};static update=async function(o){console.log(`%cIs there any update to DB to go to version ${o}`,j);const d=[{version:"1.00.0006",action:on}];for(let a=0,e=d.length;a<e;a++)if(ct(o,d[a].version)==0){console.log(`%cFound an update to DB version '${d[a].version}' proceed conversion...`,j);let n=await d[a].action();if(n==-1)console.log(`%cError something was wrong during update of database from version: ${Ge.getVersion()} to version:${d[a].version}.... you have canceled it`,le),Swal.fire({icon:"error",title:"Oops...",text:`Quelque chose s'est mal passé ou vous avez annulé l'update 

Utiliser l'application dans ces conditions n'est pas garanti  !`,footer:'<a href="https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon/issues">Générer un bug?</a>'});else{let l=Ge.setDbVersion(o);console.log(`%cChanged DB to version ${l}`,j)}}let t=Ge.setDbVersion(o);console.log(`%cChanged DB to version ${t}`,j)};static erase=function(o){return console.log(`%cErase all data of table: ${o}`,j),Ue.default.Cfg.dbase.get(o).remove().write()};static exportTblToCSV=function(o="",d,t){const a=an.exportTblToJSON(o,d,t),e={quotes:!1,quoteChar:'"',escapeChar:'"',delimiter:",",header:!0,newline:`\r
`,skipEmptyLines:!1,columns:null};return rn.default.unparse(a,e)};static exportTblToJSON=function(o="",d,t){if(o=="")return console.log("%cIrrecoverable Error: You forget to define a data table name",le),-1;if(d!==null&&d!==""&&(dtFrom=dayjs(d)),t!==null&&t!==""&&(dtTo=dayjs(t)),Ue.default.Cfg.dbase.has(o).value==!1)return console.log(`%cIrrecoverable Error: table ${o} don't exist`,le),-1;if(o===ve.tbl_name){if(typeof dtFrom=="object"&&dtTo==="object")return Ue.default.Cfg.dbase.get(o).filter(a=>dayjs(a.when).isSameOrBefore(dtTo,"day")&&dayjs(a.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtFrom=="object")return Ue.default.Cfg.dbase.get(o).filter(a=>dayjs(a.when).isSameOrAfter(dtFrom,"day")).value();if(typeof dtTo=="object")return Ue.default.Cfg.dbase.get(o).filter(a=>dayjs(a.when).isSameOrBefore(dtTo,"day")).value()}return Ue.default.Cfg.dbase.get(o).value()}}var Ke=an;var sn=async function(){var o="";o+="<style>div.about_content {background-color: #fed9ff;/*width: 600px;*/height: var(--heigth, 80%);overflow-x: hidden;overflow-y: auto;text-align: left;padding: 20px;}</style>",o+='<div class="about_content" style="--heigth: 600px;">',o+='<div class="about_content__wrapper">';const d=await At.XHR({method:"GET",url:"https://raw.githubusercontent.com/StephaneTy-Pro/OC-Mentors-AccountAddon/master/README.md",responseType:"text/html",headers:{"User-Agent":"Mozilla/5.0"}});var t=d.responseText,a=new showdown.Converter,e=a.makeHtml(t);o+=e,o+="</div>",o+="</div>",Swal.fire({title:`<strong>A propos de ${gt}</strong>`,icon:"info",html:o,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},ut=function(){var o="table.crud-list tbody",d=document.querySelector(o),t=!1;if(d.querySelector("[type=checkbox]")===null){for(const T of d.children){var a=qe(T.children[0]),e=document.createElement("input");e.type="checkbox",e.name="name",e.value=a,e.id="id",t=ve.exists(a),t===!0&&(e.checked=!0);var n=document.createElement("td");n.style="text-align: center",n.appendChild(e),T.appendChild(n)}o="table.crud-list thead tr";var l=document.querySelector(o);e=document.createElement("input"),e.type="checkbox",e.name="name",e.value="value",e.id="id",e.onclick=function(){document.querySelectorAll("tbody input[type=checkbox]").forEach(T=>T.checked=!T.checked)},e.style="visibility: hidden;";var m=document.createElement("label");m.innerText="in DB",m.style="display:block;",m.onMouseOver="this.style.cursor=pointer;",m.onMouseOut="this.style.cursor=auto;",m.appendChild(e),n=document.createElement("td"),n.style="text-align: center",n.appendChild(m),l.appendChild(n)}else{for(var f=d.querySelectorAll("[type=checkbox]"),s=f.length,i=new Array(s);s--;i[s]=f[s]);for(var w in i)t=ve.exists(i[w].value),t===!0?i[w].checked=!0:i[w].checked=!1}},dn=async function(){var[o,d]=await st(dayjs().startOf("month"),dayjs().endOf("month"));let t=Tt.getListDetailBill(o,d),a="";a+="<table>",a+="<thead>",a+="<tr><th>Quand</th><th>Qui</th><th>Financé ?</th><th>Type</th><th>Niveau</th><th>Ancien Mode ?</th><th>Statut</th><th>PU HT</th><th>Cumul</th></tr>",a+="<thead>",a+="<tbody>";for(let e=0;e<t.length;e+=1)a+="<tr>",a+=`<td>${dayjs(t[e].when).format("DD/MM/YYYY à HH:mm:ss")}</td>`,a+=`<td>${t[e].who_name}</td><td>${t[e].funding}</td>`,sType=t[e].type,t[e].path!=null&&t[e].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&t[e].type!=="soutenance"&&(sType="Coaching"),a+=`<td>${sType}</td><td>${t[e].lvl}</td>`,a+=`<td>${t[e].oldMode===!0?"Oui":"Non"}</td>`,a+=`<td>${t[e].status}</td>`,a+=`<td>${t[e].iPu}</td><td>${t[e].iCumul}€</td>`,a+="</tr>";a+="</tbody>",a+="</table>",Swal.fire({title:`<strong>Liste détaillées des sessions du ${o.format("DD/MM/YYYY")} au ${d.format("DD/MM/YYYY")}</strong>`,icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:e=>{var n=e.querySelector("table"),l=new simpleDatatables.DataTable(n)}})},ln=async function(){var[o,d]=await st(dayjs().startOf("month"),dayjs().endOf("month"));let t=0,a=GM_config.get("maxfetchpg"),e=!0;var n={};let l=[],m=1,f=it.getSameOrNearestSessionPage(d);for(f!==void 0&&f.page>m&&(m=f.page);e;){if(t>a){console.warn("%cEMERGENCY EXIT LOOP",at);break}try{n=await Tn(o,d,m,l)}catch(w){throw console.error(`%c IRRECOVERABLE ERROR ... ${w}, will exit !!!! `,le),new Error}n.length>0&&dayjs(n[n.length-1].when).isSameOrBefore(o)===!0&&(e=!1),m+=1,t+=1}GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let s='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';var i=n.length;Swal.fire({title:"Traitement en cours!",html:s,confirmButtonText:"Lovely!",onBeforeOpen:function(w){var T=new ldBar("#pbar")},onRender:function(w){},onOpen:async function(w){var T=document.getElementById("pbar").ldBar;for(var h in n){if(dayjs(n[h].when).isBefore(o,"day")===!0)break;if(dayjs(n[h].when).isAfter(d,"day")===!0){T.set(h/i*100,!1);continue}dayjs(n[h].when).isBetween(o,d,"day","[]")&&(await ve.add(n[h]),T.set(h/i*100,!1))}T.set(100,!1),Swal.getTitle().innerText="Traitement terminé !"},onClose:function(w){},onAfterClose:function(w){},onDestroy:function(w){}}),ut()},un=async function(){var o="table.crud-list tbody input:checked",d=document.querySelectorAll(o);GM_addStyle(".ldBar path.mainline{stroke-width:10;stroke:#09f;stroke-linecap:round}"),GM_addStyle(".ldBar path.baseline{stroke-width:14;stroke:#f1f2f3;stroke-linecap:round;filter:url(#custom-shadow)}");let t='<div id="pbar" class="ldBar label-center" data-value="0" data-path="M0 0 L200 0 L200 1"></div>';Swal.fire({title:"Traitement en cours!",html:t,confirmButtonText:"Lovely!",onBeforeOpen:function(a){var e=new ldBar("#pbar")},onRender:function(a){},onOpen:async function(a){for(var e=document.getElementById("pbar").ldBar,n=0;n<d.length;n+=1){var l=d[n].parentElement.parentElement,m=ve.parseTable(l);await ve.add(m),e.set(n/d.length*100,!1)}e.set(100,!1),Swal.getTitle()&&(Swal.getTitle().innerText="Traitement terminé !")},onClose:function(a){},onAfterClose:function(a){},onDestroy:function(a){}})},cn=function(){const o=unsafeWindow.Facturier.cfg.dbase,d=unsafeWindow.Facturier.libs.find(f=>f.id=="dayjs").ptr,t=unsafeWindow.Facturier.libs.find(f=>f.id=="fetchInject").ptr,a=unsafeWindow.Facturier.klass.find(f=>f.id=="Session").ptr,e=unsafeWindow.Facturier.klass.find(f=>f.id=="Student").ptr,n=unsafeWindow.Facturier.klass.find(f=>f.id=="History").ptr,l=unsafeWindow.Facturier.klass.find(f=>f.id=="Archive").ptr,m=unsafeWindow.Facturier.klass.find(f=>f.id=="StudentHistory").ptr;console.log("%cd_dbase, d_dayjs, d_Session, d_Student, d_History, d_Archive, d_StudentHistory are exported",j),console.log("%cfor examples write all code after $>",j),console.group("%cd_dbase",j),console.log("example : get last session in db $>d_dbase.get(d_Session.tbl_name).last().value();"),console.log("          get first student in db $>d_dbase.get(d_Student.tbl_name).first().value()"),console.log("          or d_dbase.get(d_Student.tbl_name).get(0).value()"),console.log("          get all sessions grouped by month/yyyy in db $>d_dbase.get(d_Session.tbl_name).groupBy( v => d_dayjs(v.when).format('MM/YYYY')).value()"),console.log("          get all table $> d_dbase.value()"),console.groupEnd(),console.group("%cd_fetchInject",j),console.log("same as fetchInject libs : https://habd.as/code/fetch-inject/"),console.groupEnd(),console.group("%cd_dayjs",j),console.log("same as dayjs libs"),console.groupEnd(),console.group("%cd_Student",j),console.log("find a student by id ¤ d_Student.findById(STUDENT_ID, (DATE) ); // date is optionnal"),console.groupEnd(),console.group("%cd_Session",j),console.log("get a list of session ¤ d_Session.getBetween('2020-08-01','2020-08-31')"),console.log("delete a session by id ¤ d_Session.deleteById(SESSION_ID);"),console.groupEnd(),console.group("%cSome combinated example",j),console.log("Delete last saved session :  d_Session.deleteById( d_dbase.get(d_Session.tbl_name).last().value().id ); "),console.log("Find all session between 01/08/2020 and 31/08/2020 :  d_dbase.get(d_Session.tbl_name).filter( v => d_dayjs(v.when).isSameOrBefore('20200831', 'day') && d_dayjs(v.when).isSameOrAfter('20200801', 'day')).value(); "),console.groupEnd();debugger},Tn=async function(o,d,t=1,a=[]){Swal.fire({position:"top-end",icon:"info",toast:!0,title:`Collecte des sessions de l'historique
du `+o.format("DD/MM/YYYY")+" au "+d.format("DD/MM/YYYY")+` 
page : `+t+`
cela peut prendre du temps...`,showConfirmButton:!1,timer:3e3});let e=null;try{e=await ft(`https://openclassrooms.com/fr/mentorship/dashboard/mentorship-sessions-history?page=${t}`,"table.crud-list tbody")}catch(i){console.error(`%c _historyFetch : ${i}`,le)}if(e===null)throw new Error(`Something went wrong could'nt collect anything from ${o.format("DD/MM/YYYY")} to ${d.format("DD/MM/YYYY")} working on history page:${t}.... try to navigate forward and backward or click some buttons to change url`);let n=$t(e),l=$t(e,-1);if(n.get("month")!=l.get("month")){let i=l.endOf("month");it.addOrUpdateSessionPage(t,i)}if(l.isAfter(d,"day")===!0)return console.log(`%cOptimization: oldest (last) data from page are at :${l.format("DD/MM/YYYY")}, don't analyze what was before end date of extraction ${d.format("DD/MM/YYYY")}`,j),a;for(var m=0;m<e.children.length;m+=1){var f=e.children[m],s=ve.parseTable(f);a.push(s)}return a},fn=function(){const{degrees:o,PDFDocument:d,rgb:t,StandardFonts:a}=PDFLib;async function e(){const m="https://pdf-lib.js.org/assets/with_update_sections.pdf",f=await fetch(m).then(y=>y.arrayBuffer()),s=await d.load(f),i=await s.embedFont(a.Helvetica),w=s.getPages(),T=w[0],{width:h,height:b}=T.getSize();T.drawText("This text was added with JavaScript!",{x:5,y:b/2+300,size:50,font:i,color:t(.95,.1,.1),rotate:o(-45)});const v=await s.save();download(v,"pdf-lib_modification_example.pdf","application/pdf")}async function n(){const m=await d.create(),f=await m.embedFont(a.TimesRoman),s=m.addPage(),{width:i,height:w}=s.getSize(),T=30;s.drawText("Creating PDFs in JavaScript is awesome!",{x:50,y:w-4*T,size:T,font:f,color:t(0,.53,.71)});const h=await m.save();download(h,"pdf-lib_modification_example.pdf","application/pdf")}async function l(){var[m,f]=await st(dayjs().startOf("month"),dayjs().endOf("month"));let s=Tt.getListDetailBill(m,f);const i=await d.create(),w=await i.embedFont(a.TimesRoman),T=i.addPage(),{width:h,height:b}=T.getSize(),v=30;T.drawText(`Prestations en détail 

 du ${m.format("DD/MM/YYYY")} au ${f.format("DD/MM/YYYY")}`,{x:50,y:b/2-v,size:v,font:w,color:t(116/255,81/255,235/255)});let y=12,B=1.25,E=i.addPage();E.setFontSize(y),E.line_space=B,E.font=w;let M=1,g=20,C=B*y+g,c=b/2;const u=function(Z){const U="LOrEm ipsum DOLor sit aMet, conSEc/tetUr 25 porttitor. ";return Z*1.0925*(w.widthOfTextAtSize(U,y)/U.length)};let p=[0,18,36,10,13,8,5,7],x=[p[0],u(p[1]),u(p[2]),u(p[3]),u(p[4]),u(p[5]),u(p[6]),u(p[7])],O=T.lineHeight,q=25;for(let Z=1;Z<s.length;Z+=1){if(c=b-B*y*M,c<C&&(M=1,E=i.addPage(),E.font=w,E.setFontSize(y),E.line_space=B,c=b-B*y*M),M===1){let De=["","Quand","Qui","Financé","Type-Niv.","Statut","Pu","Cumul"],be=q;E.moveTo(be,c);for(let ke=1;ke<De.length;ke+=1)E.drawText(De[ke],{x:be}),be+=x[ke];M+=1,c=b-B*y*M}let U=q;E.drawText(dayjs(s[Z].when).format("DD/MM/YYYY à HH:mm"),{font:w,size:y,y:c,x:U,lineHeight:O}),U+=x[1],E.drawText(s[Z].who_name.trim().slice(0,p[2]),{font:w,size:y,y:c,x:U,lineHeight:O}),U+=x[2];let ie=s[Z].funding.trim().slice(0,p[3]);s[Z].funding==="auto-financé"&&(ie="Au. Fin."),s[Z].funding==="financé par un tiers"&&(ie="Fin."),E.drawText(ie,{font:w,size:y,y:c,x:U,lineHeight:O}),U+=x[3];let pe=s[Z].type;s[Z].path!=null&&s[Z].path.toLowerCase()==="158-trouvez-lemploi-qui-vous-correspond"&&s[Z].type!=="soutenance"&&(pe="Coaching");let xe=`${pe.trim().slice(0,p[4]-2)}-${s[Z].lvl.toString()}`;E.drawText(xe,{font:w,size:y,y:c,x:U,lineHeight:O}),U+=x[4];let Se=s[Z].status;s[Z].status==="étudiant absent"&&(Se="absent"),s[Z].status==="étudiante absente"&&(Se="absente"),s[Z].status==="annulée tardivement"&&(Se="an. tard."),E.drawText(Se,{font:w,size:y,y:c,x:U,lineHeight:O}),U+=x[5],E.drawText(s[Z].iPu.toString(),{font:w,size:y,y:c,x:U,lineHeight:O}),U+=x[6],E.drawText(s[Z].iCumul.toString(),{font:w,size:y,y:c,x:U,lineHeight:O}),M+=1}var Y=await Pe.calculateBill(m,f);const A=Y.get(0,0,0,0),S=A.maxLevel,D=he.getOldModeDate(),$=Pe.getPriceList(D.subtract(1,"day")),H=Pe.getPriceList(D);var L=1;const P=!1;var k=[F,N,R],I=["Sessions","Soutenance","Coaching"],oe=[0,1,2,3],ce=["Réalisée","Annulée","Annulée tardivement","Etudiant(e) absent(e)"],ae=[G,z,Q],se=["Autofinancés","Financés","Autres"];M=1,E=i.addPage();let fe=["","Quand","Qui","Nb","Pu","Cumul"],X=[0,18,50,3,5,7],ee=[p[0],u(p[1]),u(p[2]),u(p[3]),u(p[4]),u(p[5])],de="";for(_iSessionType=0,_iSessionTypeLength=k.length;_iSessionType<_iSessionTypeLength;_iSessionType+=1){for(;L<=S;){for([M,E]=He.changePgIfNeeded(c,C,M,i),c=b-B*y*M,_iSessionQuality=0,_iSessionQualityLength=oe.length;_iSessionQuality<_iSessionQualityLength;_iSessionQuality+=1)for(_iFunding=0,_iFundingLength=ae.length;_iFunding<_iFundingLength;_iFunding+=1){if(_i0=Y.get(k[_iSessionType],oe[_iSessionQuality],ae[_iFunding],L),typeof _i0=="undefined"&&P===!1)continue;_i0.data=_i0.data.reverse();let Z=q;if(de=`${I[_iSessionType]} de Niveau ${L} Etudiants ${se[_iFunding]}`,E.moveTo(Z,c),E.drawText(de,{font:w,size:y+4,y:c,x:Z,lineHeight:O}),Z+=15,M+=1,[M,E]=He.changePgIfNeeded(c,C,M,i),c=b-B*y*M,E.moveTo(Z,c),E.drawText(ce[_iSessionQuality],{font:w,size:y+2,y:c,x:Z,lineHeight:O}),Z+=15,M+=1,[M,E]=He.changePgIfNeeded(c,C,M,i),c=b-B*y*M,typeof _i0=="undefined"){E.drawText(`désolé pas de résultat pour cette section au niveau de facturation (${L})`,{font:w,size:y,y:c,x:Z,lineHeight:O}),M+=1,[M,E]=He.changePgIfNeeded(c,C,M,i),c=b-B*y*M;continue}let U=Z,ie=0;E.moveTo(Z,c);for(let pe=1;pe<fe.length;pe+=1)E.drawText(fe[pe],{font:w,size:y+2,y:c,x:U,lineHeight:O}),U+=ee[pe];M+=1,[M,E]=He.changePgIfNeeded(c,C,M,i),c=b-B*y*M,U=Z;for(var re=0,te=_i0.data.length;re<te;re+=1)U=Z,E.drawText(dayjs(_i0.data[re].when).format("DD/MM/YYYY à HH:mm"),{font:w,size:y,y:c,x:U,lineHeight:O}),U+=ee[1],E.drawText(_i0.data[re].who_name.trim().slice(0,X[1]),{font:w,size:y,y:c,x:U,lineHeight:O}),U+=ee[2],E.drawText((re+1).toString(),{font:w,size:y,y:c,x:U,lineHeight:O}),U+=ee[3],he.isInOldMode(dayjs(_i0.data[re].when))?iPu=+_i0.data[re].lvl>0?$[L][k[_iSessionType]][oe[_iSessionQuality]][ae[_iFunding]]:0:iPu=+_i0.data[re].lvl>0?H[L][k[_iSessionType]][oe[_iSessionQuality]][ae[_iFunding]]:0,E.drawText(iPu.toString(),{font:w,size:y,y:c,x:U,lineHeight:O}),U+=ee[4],ie+=iPu,E.drawText(ie.toString(),{font:w,size:y,y:c,x:U,lineHeight:O}),M+=1,[M,E]=He.changePgIfNeeded(c,C,M,i),c=b-B*y*M}L+=1,M+=1,[M,E]=He.changePgIfNeeded(c,C,M,i),c=b-B*y*M}L=1}He.addFooter(i,`Généré avec Facturier version ${he.getAppVersion()}`);const ne=await i.save();download(ne,`prestations_facturees_detail_${m.format("YYYYMMDD")}-${f.format("YYYYMMDD")}.pdf`,"application/pdf")}l()},mn=async function(){GM_addStyle('.formgrid{font-family: "Open Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", Helvetica, Arial, sans-serif;}'),GM_addStyle(".swal2-styled[type=button]{background-color:#3085d6;border-radius:.75em;color:#fff;font-size:1.0625em;border-left-color:#3085d6;border-right-color:#3085d6;display:inline-block}.formgrid{display:grid;grid-template-columns:1fr 1em 1fr;grid-gap:.3em .6em;grid-auto-flow:dense;align-items:center}input,output,textarea,select,button{grid-column:2 / 4;width:auto;margin:0}legend{font-size:1.2em;width:100%;border-bottom:1px dotted #99c}fieldset{max-width:40em;padding:4px;margin:2em auto;border:0 none}");let o="";o+="<legend>Que voulez vous faire ?</legend>",o+="<fieldset>",o+='<div class="formgrid">',o+='Epurer<button id="answer1" data-action="raz" class="swal2-styled" type="button">RAZ</button>',o+='Sauvegarder toute la base<button id="answer2" data-action="export" class="swal2-styled" type="button">Sauvegarder</button>',o+='Charger toute la base<button id="answer3" data-action="import" class="swal2-styled" type="button">Charger</button>',o+=`Exporter les tables
    <button class="swal2-styled" type="button"
    	hx-get="/views/test-swal-sauvegarde"
		hx-select="body"
        hx-target="#sttPlaceHolder"
        hx-include="[name='email']"
        hx-swap="innerHTML"> Exporter
    </button>
		`,o+="</fieldset>",o+="</div>";const{value:d}=await Swal.fire({title:"Gestion de la base de donnée",html:o,focusConfirm:!1,preConfirm:()=>[document.getElementById("answer1").value,document.getElementById("answer2").value],didOpen:t=>{console.log("%conOpen popup","color:coral"),htmx.process(document.querySelector(".swal2-container")),console.log("%cHtmx Process done","color:coral"),t.querySelector(".formgrid").addEventListener("click",_handler=function(a){const e=function(m){m.target.matches('button[data-action="raz"]')&&(Swal.close(),Yn());return},n=function(m){m.target.matches('button[data-action="export"]')&&(Swal.close(),Dn());return},l=function(m){m.target.matches('button[data-action="import"]')&&(Swal.close(),Mn());return};e(a),n(a),l(a)})},onClose:t=>{t.querySelector(".formgrid").removeEventListener("click",_handler),console.log("%conClose popup","color:coral")}});d&&Swal.fire(JSON.stringify(d))},Dn=async function(){let o=Ke.save();console.log(`%cWanna save : ${o}`,j);let d=dayjs(),t="";t+=`<a id="download" href="data:text/plain;charset=utf-8,${encodeURIComponent(o)}" download="save_${d.format("YYYYMMDD")}.json">save_${d.format("YYYYMMDD")}.json</a>`,Swal.fire({title:"Sauvegarde de la base de donnée",html:t,focusConfirm:!1,onOpen:a=>{a.querySelector("#download").click()},onClose:a=>{}})},Mn=async function(){console.log("%cWanna load DATABASE",j);const{value:o}=await Swal.fire({title:"Selection de la sauvegarde (json)",input:"file",inputAttributes:{accept:".json","aria-label":"Upload your database"}});if(o){const d=new FileReader;d.onload=t=>{Ke.import(t.target.result),ut(),xt("Chargement de la base terminé")},d.readAsText(o)}},Yn=async function(){GM_addStyle(".form_addon {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}"),GM_addStyle(".form_addon input {background: #fff;border: 1px solid #9c9c9c;}"),GM_addStyle(".form_addon button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}"),GM_addStyle(".form_addon button:hover {background: gold;}"),GM_addStyle(".form_addon label {padding: 0.5em 0.5em 0.5em 0;}"),GM_addStyle(".form_addon input {padding: 0.7em;margin-bottom: 0.5rem;}"),GM_addStyle(".form_addon input:focus {outline: 3px solid gold;}"),GM_addStyle("@media (min-width: 400px) {.form_addon {grid-template-columns: 200px 1fr;grid-gap: 16px;} .form_addon label {text-align: right;grid-column: 1 / 2;} .form_addon input, .form_addon button {grid-column: 2 / 3;}}");var o="";o+='<form id="RAZ" class="form_addon" action="">',o+='<label for="students" class="cbox">Etudiants</label>',o+='<input id="students" type="checkbox" value="del_students_true" checked>',o+='<label for="sessions" class="cbox">Sessions</label>',o+='<input id="sessions" type="checkbox" value="del_sessions_true" checked>',o+='<label for="archives" class="cbox">Archives : factures</label>',o+='<input id="archives" type="checkbox" value="del_archives_true" checked>',o+='<label for="history_cache" class="cbox">Signet historique</label>',o+='<input id="history_cache" type="checkbox" value="del_history_cache_true" checked>',o+='<label for="radio1">filtrer la date</label>',o+='<input type="radio" id="radio1" name="date_filter" value="false" checked>',o+='<label for="radio2">ne pas filtrer</label>',o+='<input type="radio" id="radio2" name="date_filter" value="true">',o+='<label for="dtFrom" class="date">Date de début</label>',o+='<input id="dtFrom" type="date" max="2030-12-31" min="2010-12-31">',o+='<label for="dtTo" class="date">Date de fin</label>',o+='<input id="dtTo" type="date" max="2030-12-31" min="2010-12-31">',o+="<!-- Switch -->",o+='<input type="checkbox" class="switch" name="s1" id="s1">',o+='<label for="s1">Switch</label>',o+="</form>";const{value:d}=await Swal.fire({title:"<strong>RAZ des données</strong>",icon:"info",html:o,showCloseButton:!0,focusConfirm:!1,position:"top-start",grow:"row",footer:"Choisissez ce que vous allez supprimer de la base de donnée",preConfirm:()=>{let f=document.getElementsByName("date_filter"),s="notfound";for(var i in f)f[i].checked===!0&&(s=f[i].value);return console.log(document.getElementById("s1")),[document.getElementById("students").checked,document.getElementById("sessions").checked,document.getElementById("archives").checked,document.getElementById("history_cache").checked,document.getElementById("dtFrom").disabled===!0?null:document.getElementById("dtFrom").value,document.getElementById("dtTo").disabled===!0?null:document.getElementById("dtTo").value,s]},onOpen:f=>{f.querySelector("#radio1").addEventListener("change",function(){console.log(document.getElementById("radio1").checked);let s=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!s,document.getElementById("dtTo").disabled=!s}),f.querySelector("#radio2").addEventListener("change",function(){let s=document.getElementById("radio1").checked;document.getElementById("dtFrom").disabled=!s,document.getElementById("dtTo").disabled=!s}),f.querySelector("#dtFrom").addEventListener("change",function(){document.getElementById("dtTo").value=dayjs(document.getElementById("dtFrom").value).endOf("month").format("YYYY-MM-DD")})},onClose:f=>{f.querySelector("#radio1").removeEventListener("change"),f.querySelector("#radio2").removeEventListener("change"),f.querySelector("#dtFrom").removeEventListener("change")}});let t=d[0],a=d[1],e=d[2],n=d[3];console.log(`%cWanna raz students ? ${t}, wanna raz sessions ? ${a}, wanna raz archives ? ${e}`,j);let l=d[4]?dayjs(d[4]):null,m=d[5]?dayjs(d[5]):null;t===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des étudiants",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),_e.delete(l,m)),a===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des sessions",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),ve.delete(l,m),ut()),e===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base des archives (financières)",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),Ze.delete(l,m)),n===!0&&(setTimeout(function(){Toastify({text:"Suppression de la base du cache des historique de session",gravity:"top",position:"right",close:!0,backgroundColor:"linear-gradient(to right, #ff5f6d, #ffc371)"}).showToast()},500),it.delete(l,m))},pn=async function(){var o="";o+="<style>",o+="form {display: grid;padding: 1em;background: #f9f9f9;border: 1px solid #c1c1c1;margin: 2rem auto 0 auto;max-width: 600px;padding: 1em;}",o+="form input {background: #fff;border: 1px solid #9c9c9c;}",o+="form button {background: lightgrey;padding: 0.7em;width: 100%;border: 0;}",o+="form button:hover {background: gold;}",o+="form label {padding: 0.5em 0.5em 0.5em 0;}",o+="form input {padding: 0.7em;margin-bottom: 0.5rem;}",o+="form input:focus {outline: 3px solid gold;}",o+="@media (min-width: 400px) {form {grid-template-columns: 200px 1fr;grid-gap: 16px;}label {text-align: right;grid-column: 1 / 2;}input,button {grid-column: 2 / 3;}}",o+="</style>",o+='<form class="form1" action="">',o+='<label for="dd" class="date">Date de début</label>',o+='<input id="dd" type="date" max="2030-12-31" min="2010-12-31">',o+='<label for="df" class="date">Date de fin</label>',o+='<input id="df" type="date" max="2030-12-31" min="2010-12-31">',o+="</form>";var[d,t]=await st(dayjs().startOf("month"),dayjs().endOf("month")),a=await Pe.calculateBill(d,t);he.isInOldMode(d)?kn(d,t,a):jn(d,t,a)},kn=function(o,d,t){const a=t.get(0,0,0,0),e=4;var n="",l=null,m=0,f=0,s=0,i=[[4,"Groupe"],[1,"Niveau 1"],[2,"Niveau 2"],[3,"Niveau 3"]],w=0,T=0,h=!1,b=0,v=0,y=0,B=0,E=0,M=0,g=0,C=0,c=0,u=0,p=0,x=0,O=0,q=0,Y=0,A=0,S=0,D=0,$=1;t.toConsole(),n+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",n+='<div class="wrapper">',n+="<table>",n+="<thead>",n+="<tr>",n+='<th>Type</th><th><abbr title="nombre">nb</abbr></th><th>PU(<abbr title="hors taxes">HT</abbr>)</th><th>Total(<abbr title="hors taxes">HT</abbr>)</th>',n+="</tr>",n+="</thead>",n+="<tbody>",n+="<tr>",n+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Mentorat</th>',n+="</tr>";for(var w=performance.now();$<=e;)_i0=t.get(F,V,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(F,V,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(F,V,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : réalisées</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(F,K,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(F,K,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(F,K,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : annulées</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(F,W,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(F,W,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(F,W,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : annulées tard.</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(F,J,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(F,J,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(F,J,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : étudiant abs.</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),$+=1;var T=performance.now();console.log("%cCalculate first array"+(T-w)+" milliseconds.",Te),n+="<tr>",n+="<td>Total</td>",n+=`<td>${m}</td><td></td><td>${f}€</td>`,n+="</tr>",n+="<tr>",n+="</tr>",s+=f,m=0,f=0,n+="<tr>",n+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',n+="</tr>",$=1;for(var w=performance.now();$<=e;)_i0=t.get(N,V,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(N,V,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(N,V,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : réalisées</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(N,K,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(N,K,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(N,K,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : annulées</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(N,W,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(N,W,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(N,W,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : annulées tard.</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(N,J,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(N,J,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(N,J,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : étudiant abs.</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),$+=1;var T=performance.now();console.log("%cCalculate second array"+(T-w)+" milliseconds.",Te),n+="<tr>",n+="<td>Total</td>",n+=`<td>${m}</td><td></td><td>${f}€</td>`,n+="</tr>",n+="<tr>",n+="</tr>",s+=f,m=0,f=0,n+="<tr>",n+='<th colspan="4" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',n+="</tr>",$=1;for(var w=performance.now();$<=e;)_i0=t.get(R,V,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(R,V,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(R,V,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : réalisées</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(R,K,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(R,K,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(R,K,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : annulées</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(R,W,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(R,W,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(R,W,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : annulées tard.</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),_i0=t.get(R,J,G,$),u=_i0===void 0?0:_i0.number,A=_i0===void 0?0:_i0.amount,_i0=t.get(R,J,z,$),p=_i0===void 0?0:_i0.number,S=_i0===void 0?0:_i0.amount,_i0=t.get(R,J,Q,$),x=_i0===void 0?0:_i0.number,D=_i0===void 0?0:_i0.amount,O=u>0?A/u:A,q=p>0?S/p:S,Y=x>0?D/x:D,(h===!0||u+p+x>0)&&(m+=u,m+=p,m+=x,f+=A,f+=S,f+=D,n+="<tr>",n+=`<td>Niveau ${$} : étudiant abs.</td>`,n+=`<td>${u+p+x}</td><td>${q}</td><td>${A+S+D}€</td>`,n+="</tr>"),$+=1;var T=performance.now();console.log("%cCalculate third array"+(T-w)+" milliseconds.",Te),n+="<tr>",n+="<td>Total</td>",n+=`<td>${m}</td><td></td><td>${f}€</td>`,n+="</tr>",n+="<tr>",n+="</tr>",s+=f,n+="<tr>",n+='<th colspan="4" class="pseudoheader" scope="colgroup">Total Général</th>',n+="</tr>",n+=`<td colspan="3"></td><td>${s}€</td>`,n+="</tr>",n+="<tr>",n+="</tr>",n+="</tbody>",n+="<tfoot>",n+="</tfoot>",n+="</table>",n+=`<p>Soit un total général à facturer de ${s}€`,Swal.fire({title:`<strong>Liste des formations tarifées du ${o.format("DD/MM/YYYY")} au ${d.format("DD/MM/YYYY")}</strong>`,html:n,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},jn=function(o,d,t){console.log("%cEnter computation bill",j);const a=!1;var e="",n=0,l=0,m=0,f=0,s=0,i=0,w=0,T=0,h=0,b=0,v=0,y=0;const B=t.get(0,0,0,0),E=B.maxLevel;var M=0,g=0,C=0,c=0,u=0,p=0,x=0,O=0,q=0,Y=0,A=0,S=0,D=0,$=0,H=0,L=0,P=0,k=0,I=1;e+="<style>.wrapper{  display: grid;grid-gap: 10px;grid-template-column: 1fr 1fr;}</style>",e+='<div class="wrapper">',e+="<table>",e+="<thead>",e+="<tr>",e+='<th rowspan="2">Type</th><th colspan="3" scope="colgroup">Auto Financés</th><th colspan="3" scope="colgroup">Financés</th><th colspan="3" scope="colgroup">Autres</th><th colspan="2" scope="colgroup">Total</th>',e+="</tr>",e+="<tr>",e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="prix unitaire">Pu.</abbt>(<abbr title="hors taxes">HT</abbr>)</th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+='<th><abbr title="nombre">Nb.</abbr></th><th><abbr title="montant">Mt.</abbt>(<abbr title="hors taxes">HT</abbr>)</th>',e+="</tr>",e+="</thead>",e+="<tbody>",e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de mentorat</th>',e+="</tr>";for(var oe=performance.now();I<=E;)_i0=t.get(F,V,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(F,V,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(F,V,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : réalisées</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(F,K,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(F,K,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(F,K,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : annulées</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(F,W,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(F,W,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(F,W,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : annulées tard.</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(F,J,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(F,J,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(F,J,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : étud. absent</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),I+=1;var ce=performance.now();for(console.log("%cCalculate first array"+(ce-oe)+" milliseconds.",Te),e+="<tr>",e+="<td>Total</td>",e+=`<td>${n}</td><td></td><td>${f}€</td>`,e+=`<td>${l}</td><td></td><td>${s}€</td>`,e+=`<td>${m}</td><td></td><td>${i}€</td>`,e+=`<td>${n+l+m}</td><td>${f+s+i}€</td>`,e+="</tr>",e+="<tr>",e+="</tr>",w+=n,T+=l,h+=m,b+=f,v+=s,y+=i,n=0,l=0,m=0,f=0,s=0,i=0,e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Soutenance</th>',e+="</tr>",I=1;I<=E;)_i0=t.get(N,V,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(N,V,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(N,V,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : réalisées</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(N,K,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(N,K,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(N,K,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : annulées</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(N,W,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(N,W,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(N,W,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : annulées tard.</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(N,J,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(N,J,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(N,J,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : étud. absent</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),I+=1;e+="<tr>",e+="<td>Total</td>",e+=`<td>${n}</td><td></td><td>${f}€</td>`,e+=`<td>${l}</td><td></td><td>${s}€</td>`,e+=`<td>${m}</td><td></td><td>${i}€</td>`,e+=`<td>${n+l+m}</td><td>${f+s+i}€</td>`,e+="</tr>",e+="<tr>",e+="</tr>",w+=n,T+=l,h+=m,b+=f,v+=s,y+=i,n=0,l=0,m=0,f=0,s=0,i=0,e+="<tr>",e+='<th colspan="12" class="pseudoheader" scope="colgroup">Sessions de Coaching</th>',e+="</tr>";for(var I=1;I<=E;)_i0=t.get(R,V,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(R,V,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(R,V,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : réalisées</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(R,K,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(R,K,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(R,K,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : annulées</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(R,W,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(R,W,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(R,W,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : annulées tard.</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),_i0=t.get(R,J,G,I),Y=_i0===void 0?0:_i0.number,L=_i0===void 0?0:_i0.amount,_i0=t.get(R,J,z,I),A=_i0===void 0?0:_i0.number,P=_i0===void 0?0:_i0.amount,_i0=t.get(R,J,Q,I),S=_i0===void 0?0:_i0.number,k=_i0===void 0?0:_i0.amount,D=Y>0?L/Y:L,$=A>0?P/A:P,H=S>0?k/S:k,(a===!0||Y+A+S>0)&&(n+=Y,l+=A,m+=S,f+=L,s+=P,i+=k,e+="<tr>",e+=`<td>Niveau ${I} : étud. absent</td>`,e+=`<td>${Y}</td><td>${D}</td><td>${L}€</td>`,e+=`<td>${A}</td><td>${$}</td><td>${P}€</td>`,e+=`<td>${S}</td><td>${H}</td><td>${k}€</td>`,e+=`<td>${Y+A+S}</td><td>${L+P+k}€</td>`,e+="</tr>"),I+=1;w+=n,T+=l,h+=m,b+=f,v+=s,y+=i,e+="<tr>",e+="<td>Total</td>",e+=`<td>${n}</td><td></td><td>${f}€</td>`,e+=`<td>${l}</td><td></td><td>${s}€</td>`,e+=`<td>${m}</td><td></td><td>${i}€</td>`,e+=`<td>${n+l+m}</td><td>${f+s+i}€</td>`,e+="</tr>",e+="<tr>",e+="</tr>",e+="</tbody>",e+="<tfoot>",e+="</tfoot>",e+="</table>";var ae=0,se="";let fe=B.flatFee.length;for(var X=0;X<fe;X+=1)ae+=30,se+=B.flatFee[X].who_name+", ";fe>1?e+=`<p class="flat_fee">Calcul du forfait "autofinancé". Ce mois ci ${fe} étudiants ont eu au moins une session il s'agit de : ${se.slice(0,-1)}`:e+=`<p class="flat_fee">Calcul du forfait "autofinancé". Ce mois ci ${fe} étudiant a eu au moins une session il s'agit de : ${se.slice(0,-1)}`,e+=`. Le forfait est donc de ${ae}€</p>`,e+=`<p>Soit un total général à facturer de ${b+v+y+ae}€</p>`,Swal.fire({title:`<strong>Liste des formations tarifées du ${o.format("DD/MM/YYYY")} au ${d.format("DD/MM/YYYY")}</strong>`,html:e,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen"})},hn=async function(){var[o,d]=await st(dayjs().startOf("month"),dayjs().endOf("month"),!1);if(o===null||d===null)throw console.log("%cError need date from, date to",le),new Error;const t=Tt.getListStatistic(o,d);let a="",e=new Array(22),n=Array.apply(null,Array(22)).map(Number.prototype.valueOf,0),l=o.clone(),m=l.endOf("month"),f="";e[0]="<thead><tr><th>Sessions</th>",e[1]="<tbody><tr><td>Sessions</td>",e[2]='<tr class="header"><td>Montant</td>',e[3]="<tr><td>Nb.",e[4]="<tr><td>Pu",e[5]='<tr class="header"><td>Soutenances</td>',e[6]="<tr><td>Montant</td>",e[7]="<tr><td>Nb.",e[8]="<tr><td>Pu",e[9]='<tr class="header"><td>Coaching</td>',e[10]="<tr><td>Montant</td>",e[11]="<tr><td>Nb.",e[12]="<tr><td>Pu",e[13]='<tr class="header"><td>Bonus</td>',e[14]="<tr><td>Bonus AF</td>",e[15]="<tr><td>Total Général</td>",e[16]='<tr class="header"><td>KPI</td>',e[17]="<tr><td>NbJrs</td>",e[18]="<tr><td>TJM</td>",e[19]="<tr><td>Nb hrs</td>",e[20]="<tr><td>THM</td>",e[21]="<tr><td>Nb hrs (p.)</td>",e[22]="<tr><td>THM (p)</td>";for(var s=0;s<t.length;s+=1){n[2]+=t[s].sessions.total,n[3]+=t[s].sessions.nb-t[s].sessions.nbc,n[4]+=t[s].sessions.pu,n[6]+=t[s].defenses.total,n[7]+=t[s].defenses.nb-t[s].defenses.nbc,n[8]+=t[s].defenses.pu,n[10]+=t[s].coaches.total,n[11]+=t[s].coaches.nb-t[s].coaches.nbc,n[12]+=t[s].coaches.pu,n[14]+=t[s].bonus;let i=t[s].sessions.total+t[s].defenses.total+t[s].coaches.total+t[s].bonus;n[15]+=i,n[16]+=t[s].kpi.jrs,n[18]+=t[s].kpi.hrs,n[20]+=t[s].kpi.hrsp,t.length==1&&(f="</tr>"),s===t.length-1&&t.length>1?m.isAfter(d,"day")?(n[2]-=t[s].sessions.total,n[3]-=t[s].sessions.nb-t[s].sessions.nbc,n[4]-=t[s].sessions.pu,n[6]-=t[s].defenses.total,n[7]-=t[s].defenses.nb-t[s].defenses.nbc,n[8]-=t[s].defenses.pu,n[10]-=t[s].coaches.total,n[11]-=t[s].coaches.nb-t[s].coaches.nbc,n[12]-=t[s].coaches.pu,n[14]-=t[s].bonus,n[15]-=i,n[16]-=t[s].kpi.jrs,n[18]-=t[s].kpi.hrs,n[20]-=t[s].kpi.hrsp,e[0]+=`<td>Total(moy)</td><td>${dayjs(t[s].header.dtTo).format("MMMM")}</td></thead></tr>`,e[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[2]+=`<td>${n[2]} (${(n[2]/(t.length-1)).toFixed(2)})</td><td>${t[s].sessions.total}</td></tr>`,e[3]+=`<td>${n[3]} (${(n[3]/(t.length-1)).toFixed(2)})</td><td>${t[s].sessions.nb} (${t[s].sessions.nbc})</td></tr>`,e[4]+=`<td> n/a (${(n[4]/(t.length-1)).toFixed(2)})</td><td>${t[s].sessions.pu.toFixed(2)}</td></tr>`,e[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[6]+=`<td>${n[6]} (${(n[6]/(t.length-1)).toFixed(2)})</td><td>${t[s].defenses.total}</td></tr>`,e[7]+=`<td>${n[7]} (${(n[7]/(t.length-1)).toFixed(2)})</td><td>${t[s].defenses.nb} (${t[s].defenses.nbc})</td></tr>`,e[8]+=`<td> n/a (${(n[8]/(t.length-1)).toFixed(2)})</td><td>${t[s].defenses.pu.toFixed(2)}</td></tr>`,e[9]+=`<td>&nbsp;</td>${f}`,e[10]+=`<td>${n[10]} (${(n[10]/(t.length-1)).toFixed(2)})</td><td>${t[s].coaches.total}</td></tr>`,e[11]+=`<td>${n[11]} (${(n[11]/(t.length-1)).toFixed(2)})</td><td>${t[s].coaches.nb} (${t[s].coaches.nbc})</td></tr>`,e[12]+=`<td> n/a (${(n[12]/(t.length-1)).toFixed(2)})</td><td>${t[s].coaches.pu.toFixed(2)}</td></tr>`,e[13]+="<td>&nbsp;</td></tr>",e[14]+=`<td>${n[14]} (${(n[14]/(t.length-1)).toFixed(2)})</td><td>${t[s].bonus}</td></tr>`,e[15]+=`<td>${n[15]} (${(n[15]/(t.length-1)).toFixed(2)})</td><td>${i}</td></tr>`,e[16]+="<td>&nbsp;</td></tr>",e[17]+=`<td>${n[16]} (${(n[16]/(t.length-1)).toFixed(2)})</td><td>${t[s].kpi.jrs}</td></tr>`,e[18]+=`<td> n/a (${(n[15]/n[16]).toFixed(2)})</td><td>${(i/t[s].kpi.jrs).toFixed(2)}</td></tr>`,e[19]+=`<td>${n[18]} (${(n[18]/(t.length-1)).toFixed(2)})</td><td>${t[s].kpi.hrs.toFixed(2)}</td></tr>`,e[20]+=`<td> n/a  (${(n[15]/n[18]).toFixed(2)})</td><td>${(i/t[s].kpi.hrs).toFixed(2)}</td></tr>`,e[21]+=`<td>${n[20].toFixed(2)} (${(n[20]/(t.length-1)).toFixed(2)})</td><td>${t[s].kpi.hrsp.toFixed(2)}</td></tr>`,e[22]+=`<td> n/a  (${(n[15]/n[20]).toFixed(2)})</td><td>${(i/t[s].kpi.hrsp).toFixed(2)}</td></tr>`):(e[0]+=`<td>${dayjs(t[s].header.dtTo).format("MMMM")}</td><td>Tot.</td></thead></tr>`,e[1]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[2]+=`<td>${t[s].sessions.total}</td><td>${n[2]} (${(n[2]/t.length).toFixed(2)})</td></tr>`,e[3]+=`<td>${t[s].sessions.nb} (${t[s].sessions.nbc})</td><td>${n[3]} (${(n[3]/t.length).toFixed(2)})</td></tr>`,e[4]+=`<td>${t[s].sessions.pu.toFixed(2)}</td><td> n/a (${(n[4]/t.length).toFixed(2)})</td></tr>`,e[5]+="<td>&nbsp;</td><td>&nbsp;</td></tr>",e[6]+=`<td>${t[s].defenses.total}</td><td>${n[6]} (${(n[6]/t.length).toFixed(2)})</td></tr>`,e[7]+=`<td>${t[s].defenses.nb} (${t[s].defenses.nbc})</td><td>${n[7]} (${(n[7]/t.length).toFixed(2)})</td></tr>`,e[8]+=`<td>${t[s].defenses.pu.toFixed(2)}</td><td> n/a (${(n[8]/t.length).toFixed(2)})</td></tr>`,e[9]+=`<td>&nbsp;</td>${f}`,e[10]+=`<td>${t[s].coaches.total}</td><td>${n[10]} (${(n[10]/t.length).toFixed(2)})</td></tr>`,e[11]+=`<td>${t[s].coaches.nb} (${t[s].coaches.nbc})</td><td>${n[11]} (${(n[11]/t.length).toFixed(2)})</td></tr>`,e[12]+=`<td>${t[s].coaches.pu.toFixed(2)}</td><td> n/a (${(n[12]/t.length).toFixed(2)})</td></tr>`,e[13]+="<td>&nbsp;</td></tr>",e[14]+=`<td>${t[s].bonus}</td><td>${n[14]} (${(n[14]/t.length).toFixed(2)})</td></tr>`,e[15]+=`<td>${i}</td><td>${n[15]} (${(n[15]/t.length).toFixed(2)})</td></tr>`,e[16]+="<td>&nbsp;</td></tr>",e[17]+=`<td>${t[s].kpi.jrs}</td><td>${n[16]} (${(n[16]/t.length).toFixed(2)})</td></tr>`,e[18]+=`<td>${(i/t[s].kpi.jrs).toFixed(2)}</td><td> n/a (${(n[15]/n[16]).toFixed(2)})</td></tr>`,e[19]+=`<td>${t[s].kpi.hrs.toFixed(2)}</td><td>${n[18]} (${(n[18]/t.length).toFixed(2)})</td></tr>`,e[20]+=`<td>${(i/t[s].kpi.hrs).toFixed(2)}</td><td> n/a  (${(n[15]/n[18]).toFixed(2)})</td></tr>`,e[21]+=`<td>${t[s].kpi.hrsp.toFixed(2)}</td><td>${n[20].toFixed(2)} (${(n[20]/t.length).toFixed(2)})</td></tr>`,e[22]+=`<td>${(i/t[s].kpi.hrsp).toFixed(2)}</td><td> n/a  (${(n[15]/n[20]).toFixed(2)})</td></tr>`):(e[0]+=`<td>${dayjs(t[s].header.dtTo).format("MMMM")}</td>${f}`,e[1]+=`<td>&nbsp;</td>${f}`,e[2]+=`<td>${t[s].sessions.total}</td>${f}`,e[3]+=`<td>${t[s].sessions.nb} (${t[s].sessions.nbc})</td>${f}`,e[4]+=`<td>${t[s].sessions.pu.toFixed(2)}</td>${f}`,e[5]+=`<td>&nbsp;</td>${f}`,e[6]+=`<td>${t[s].defenses.total}</td>${f}`,e[7]+=`<td>${t[s].defenses.nb} (${t[s].defenses.nbc})</td>${f}`,e[8]+=`<td>${t[s].defenses.pu.toFixed(2)}</td>${f}`,e[9]+=`<td>&nbsp;</td>${f}`,e[10]+=`<td>${t[s].coaches.total}</td>${f}`,e[11]+=`<td>${t[s].coaches.nb} (${t[s].coaches.nbc})</td>${f}`,e[12]+=`<td>${t[s].coaches.pu.toFixed(2)}</td>${f}`,e[13]+=`<td>&nbsp;</td>${f}`,e[14]+=`<td>${t[s].bonus}</td>${f}`,e[15]+=`<td>${i}</td>${f}`,e[16]+=`<td>&nbsp;</td>${f}`,e[17]+=`<td>${t[s].kpi.jrs}</td>${f}`,e[18]+=`<td>${(i/t[s].kpi.jrs).toFixed(2)}</td>${f}`,e[19]+=`<td>${t[s].kpi.hrs.toFixed(2)}</td>${f}`,e[20]+=`<td>${(i/t[s].kpi.hrs).toFixed(2)}</td>${f}`,e[21]+=`<td>${t[s].kpi.hrsp.toFixed(2)}</td>${f}`,e[22]+=`<td>${(i/t[s].kpi.hrsp).toFixed(2)}</td>${f}`),l=l.add(1,"month"),m=l.endOf("month")}a="<table>"+e.join(" ")+`</tbody><tfoot><tr><td colspan=${t.length+1}>la valeur entre parenthèse fait reference aux annulés</td></tr></tfoot></table>`,Swal.fire({title:`<strong>Statistiques du ${o.format("DD/MM/YYYY")} au ${d.format("DD/MM/YYYY")}</strong>`,icon:"info",html:a,showCloseButton:!0,focusConfirm:!1,position:"center-start",grow:"fullscreen",onOpen:i=>{}})};class Ye{static init=function(){console.log("%cin initUI",j),Ye.build();var o=new Draggabilly(".draggable",{handle:".handle"});GM_config.get("hackheaderzindex")===!0&&$n.start("animation-target")};static build=function(){console.log("%c in buildUI","background-color:green;color:white"),GM_addStyle(".flex > * { margin: 2px 1px; }"),GM_addStyle(".flex > :first-child { margin-left: 0; }"),GM_addStyle(".flex > :last-child { margin-right: 0; }"),GM_addStyle(".panel {display: flex; justify-content: center;z-index:999}"),GM_addStyle(".menuBar {border-top: 1px solid; padding: 10px; font-size: 1rem; pointer-events: inherit;position: relative;top:0px;  flex-flow: row wrap;/*align-content: space-between;justify-content: space-between;*/}"),GM_addStyle(".draggable {background: transparent;border-radius: 10px;padding: 20px;}"),GM_addStyle(".draggable.is-pointer-down {background: #09F;}"),GM_addStyle(".draggable.is-dragging { opacity: 0.7; }"),GM_addStyle(".handle {background: #555;background: hsla(0, 0%, 0%, 0.4);width: 20px;height: 20px; border-radius: 10px;}"),GM_addStyle(".flex > :nth-last-child(2) {page-break-after: always; /* CSS 2.1 syntax */break-after: always; /* New syntax */}"),GM_addStyle("#animation-target {width: 10px;height: 5px;background-color:coral;border-radius: 25%;}");var o=document.createElement("div"),d=document.createElement("div");d.classList.add("handle"),o.appendChild(d),o.classList.add("panel","menuBar","flex","draggable"),document.body.appendFirst(o),Ye.addButton("collectChecked",un,{},o),Ye.addButton("CollectAuto",ln,{},o),Ye.addButton("showBill",pn,{},o),Ye.addButton("billInDetails",dn,{},o),Ye.addButton("PDF",fn,{},o),Ye.addButton("SList",_e.showList,{},o),Ye.addButton("DbgMode",cn,{},o),Ye.addButton("statistics",hn,{},o),Ye.addButton("Database",mn,{},o),Ye.addButton("about",sn,{},o);let t=document.createElement("div"),a=t.style;t.id="sttPlaceHolder";let e={position:"absolute",bottom:"7%",left:"4%","z-index":999,display:"hidden"};if(document.body.insertAdjacentElement("beforeend",t),Object.keys(e).forEach(l=>a[l]=e[l]),GM_config.get("hackheaderzindex")===!0){var n=document.createElement("div");n.id="animation-target",o.appendChild(n)}};static addButton=function(o,d,t,a){a=a||document.body,t=t||{position:"absolute",bottom:"7%",left:"4%","z-index":3};let e=document.createElement("button"),n=e.style;return e.classList.add("button--primary","button"),a.appendChild(e),e.innerHTML=o,e.onclick=d,Object.keys(t).forEach(l=>n[l]=t[l]),e}}class $n{static start=function(o){const d=document.getElementById(o),t=m=>d.style.transform=`translateX(${m}px)`;let a=0;const e=7,n=m=>{t(a),a+=e,a>100?requestAnimationFrame(l):requestAnimationFrame(n)},l=m=>{t(a),a-=e,a<-100?requestAnimationFrame(n):requestAnimationFrame(l)};return requestAnimationFrame(n)};static stop=function(o){window.cancelAnimationFrame(o)}}var Ht=Ye;const Bn="#OCAddonsCfg {background-color: lightblue;} #OCAddonsCfg .reset_holder {float: left; position: relative; bottom: -1em;} #OCAddonsCfg .saveclose_buttons {margin: .7em;}",On="height: 16.7em; width: 30em; border: 1px solid; border-radius: 3px; position: fixed; z-index: 999;",Ut={id:"OCAddonsCfg",title:"Configuration du module",fields:{nbHrsAfM:{section:["Statistiques","paramètres"],label:"Nombre de minutes pour une session d'étudiant auto financé",title:"Durée moyenne d'une session AF (calcul du THM)",labelPos:"left",type:"input",default:30},nbHrsfM:{label:"Nombre de minutes pour une session d'étudiant financé",title:"Durée moyenne d'une session Financée (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsS:{label:"Nombre de minutes pour une session (avant 01/07/2020)",title:"Durée moyenne d'une session avant la séparation auto financé | financé (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsD:{label:"Nombre de minutes pour une session de soutenance",title:"Durée moyenne d'une sessionde soutenance AF (calcul du THM)",labelPos:"left",type:"input",default:45},nbHrsC:{label:"Nombre de minutes pour une session de coaching",title:"Durée moyenne d'une session de coachine (calcul du THM)",labelPos:"left",type:"input",default:45},maxfetchpg:{section:["Application","optimisation"],label:"Maximum de page recherchées dans l'historique",labelPos:"left",type:"input",default:1e3},datacachelifetime:{label:"Temps de conservation des données dans le cache (en ms)",labelPos:"left",type:"input",default:12e4},checksessionalreadyexists:{section:["Application","Base de donnée"],label:"sessions: vérifier existence avant insertion",labelPos:"left",type:"checkbox",default:!0},sizeofcontentlist:{section:["Interface","thème"],label:"taille de la police des listes",labelPos:"left",type:"input",default:"1em;"},use_custom_css:{label:"utiliser des styles personnalisés",labelPos:"left",type:"checkbox",default:!1},custom_css_url:{label:"url de la feuille de style (si plusieurs les séparer par des virgules)",labelPos:"left",type:"input",default:""},custom_css_data:{label:"saisir ici le code css à injecter directement dans la page",title:"Je me demande bien à quoi sert le titre",labelPos:"left",type:"input",default:""},alwaysaddcbox:{section:["Interface","Gadget"],label:"Toujours ajouter les checkbox sur l'interface",labelPos:"left",type:"checkbox",default:!0},show_throttle:{label:"Afficher le temoin d'utilisation du CPU",title:"Affiche le point rouge qui circule dans la barre de menu. Quand il s'arrête le CPU est utilisé",labelPos:"left",type:"checkbox",default:!0},hackheaderzindex:{section:["","Hack"],label:"Changer le zindex du bandeau haut",title:"le bandeau haut à un z-index  (1000) qui le place au dessus de tout ce qui est présent à l'écran, ce qui gêne la barre de menu ; activer cette option réduit ce chiffre à 0",labelPos:"left",type:"checkbox",default:!0},support:{section:["","Support"],label:"StephaneTy-Pro.github.io",title:"more info on https://github.com/StephaneTy-Pro",type:"button",click:()=>{GM_openInTab("https://github.com/StephaneTy-Pro/OC-Mentors-AccountAddon",{active:!0,insert:!0,setParent:!0})}}},css:Bn,events:{save:function(){GM_config.close()}}};var Gt=function(){GM_config.open(),OCAddonsCfg.style=On};class Pn{static longTaskTiming=function(){if(window.self!==window.top)return;console.log("LongTasks: Initializing");var o=new window.PerformanceObserver(function(d){for(var t=d.getEntries(),a=0;a<t.length;a++)console.log("LongTasks: ",t[a].name,t[a].duration,t[a].attribution.length,t[a].attribution.length>0?t[a].attribution[0].containerType:null,t[a].attribution.length>0?t[a].attribution[0].containerName:null,t[a].attribution.length>0?t[a].attribution[0].containerSrc:null,t[a].attribution.length>0?t[a].attribution[0].containerId:null,t[a])});typeof window.PerformanceLongTaskTiming!="undefined"?console.log("LongTasks: Appears to be supported"):console.log("LongTasks: Not supported");try{o.observe({entryTypes:["longtask"]})}catch(d){console.log("LongTasks: Not supported")}};static paintTiming=function(){if(window.self!==window.top)return;console.log("PaintTiming: Initializing");var o=new window.PerformanceObserver(function(d){for(var t=d.getEntries(),a=0;a<t.length;a++)console.log("PaintTiming: ",t[a].name,t[a].startTime)});if(typeof window.PerformancePaintTiming!="undefined")console.log("PaintTiming: Appears to be supported");else{console.log("PaintTiming: Not supported");return}try{o.observe({entryTypes:["paint"],buffered:!0})}catch(d){console.log("PaintTiming: Not supported")}}}var kt=Pn;const Pt=function(o,d,t,a,e,n,l){n=d.createElement(t),l=d.getElementsByTagName(t)[0],n.appendChild(d.createTextNode(a.text)),n.onload=e(a),l?l.parentNode.insertBefore(n,l):d.head.appendChild(n)};const Ln=function(o,d){if(!arguments.length)return Promise.reject(new ReferenceError("Failed to execute 'fetchInject': 1 argument required but only 0 present."));if(arguments[0]&&arguments[0].constructor!==Array)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 1 must be of type 'Array'."));if(arguments[1]&&arguments[1].constructor!==Promise)return Promise.reject(new TypeError("Failed to execute 'fetchInject': argument 2 must be of type 'Promise'."));const t=[],a=d?[].concat(d):[],e=[];return o.forEach(n=>a.push(window.fetch(n).then(l=>[l.clone().text(),l.blob()]).then(l=>Promise.all(l).then(m=>{t.push({text:m[0],blob:m[1]})})))),Promise.all(a).then(()=>(t.forEach(n=>{e.push({then:l=>{n.blob.type.includes("text/css")?Pt(window,document,"style",n,l):Pt(window,document,"script",n,l)}})}),Promise.all(e)))};var Je=Ln;var gi=function(o,d,t){"use strict";if(!o.MutationObserver||typeof HTMLElement=="undefined")return;var a=0,e=function(){var b=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(v,y){return v instanceof HTMLElement&&b.call(v,y)},addMethod:function(v,y,B){var E=v[y];v[y]=function(){if(B.length==arguments.length)return B.apply(this,arguments);if(typeof E=="function")return E.apply(this,arguments)}},callCallbacks:function(v,y){y&&y.options.onceOnly&&y.firedElems.length==1&&(v=[v[0]]);for(var B=0,E;E=v[B];B++)E&&E.callback&&E.callback.call(E.elem,E.elem);y&&y.options.onceOnly&&y.firedElems.length==1&&y.me.unbindEventWithSelectorAndCallback.call(y.target,y.selector,y.callback)},checkChildNodesRecursively:function(v,y,B,E){for(var M=0,g;g=v[M];M++)B(g,y,E)&&E.push({callback:y.callback,elem:g}),g.childNodes.length>0&&e.checkChildNodesRecursively(g.childNodes,y,B,E)},mergeArrays:function(v,y){var B={},E;for(E in v)v.hasOwnProperty(E)&&(B[E]=v[E]);for(E in y)y.hasOwnProperty(E)&&(B[E]=y[E]);return B},toElementsArray:function(v){return typeof v!="undefined"&&(typeof v.length!="number"||v===o)&&(v=[v]),v}}}(),n=function(){var b=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return b.prototype.addEvent=function(v,y,B,E){var M={target:v,selector:y,options:B,callback:E,firedElems:[]};return this._beforeAdding&&this._beforeAdding(M),this._eventsBucket.push(M),M},b.prototype.removeEvent=function(v){for(var y=this._eventsBucket.length-1,B;B=this._eventsBucket[y];y--)if(v(B)){this._beforeRemoving&&this._beforeRemoving(B);var E=this._eventsBucket.splice(y,1);E&&E.length&&(E[0].callback=null)}},b.prototype.beforeAdding=function(v){this._beforeAdding=v},b.prototype.beforeRemoving=function(v){this._beforeRemoving=v},b}(),l=function(b,v){var y=new n,B=this,E={fireOnAttributesModification:!1};return y.beforeAdding(function(M){var g=M.target,C;(g===o.document||g===o)&&(g=document.getElementsByTagName("html")[0]),C=new MutationObserver(function(u){v.call(this,u,M)});var c=b(M.options);C.observe(g,c),M.observer=C,M.me=B}),y.beforeRemoving(function(M){M.observer.disconnect()}),this.bindEvent=function(M,g,C){g=e.mergeArrays(E,g);for(var c=e.toElementsArray(this),u=0;u<c.length;u++)y.addEvent(c[u],M,g,C)},this.unbindEvent=function(){var M=e.toElementsArray(this);y.removeEvent(function(g){for(var C=0;C<M.length;C++)if(this===t||g.target===M[C])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(M){var g=e.toElementsArray(this),C=M,c;typeof M=="function"?c=function(u){for(var p=0;p<g.length;p++)if((this===t||u.target===g[p])&&u.callback===C)return!0;return!1}:c=function(u){for(var p=0;p<g.length;p++)if((this===t||u.target===g[p])&&u.selector===M)return!0;return!1},y.removeEvent(c)},this.unbindEventWithSelectorAndCallback=function(M,g){var C=e.toElementsArray(this);y.removeEvent(function(c){for(var u=0;u<C.length;u++)if((this===t||c.target===C[u])&&c.selector===M&&c.callback===g)return!0;return!1})},this},m=function(){var b={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};function v(M){var g={attributes:!1,childList:!0,subtree:!0};return M.fireOnAttributesModification&&(g.attributes=!0),g}function y(M,g){M.forEach(function(C){var c=C.addedNodes,u=C.target,p=[],x;c!==null&&c.length>0?e.checkChildNodesRecursively(c,g,B,p):C.type==="attributes"&&(B(u,g,p)&&p.push({callback:g.callback,elem:u})),e.callCallbacks(p,g)})}function B(M,g,C){return e.matchesSelector(M,g.selector)&&(M._id===t&&(M._id=a++),g.firedElems.indexOf(M._id)==-1)?(g.firedElems.push(M._id),!0):!1}s=new l(v,y);var E=s.bindEvent;return s.bindEvent=function(M,g,C){typeof C=="undefined"?(C=g,g=b):g=e.mergeArrays(b,g);var c=e.toElementsArray(this);if(g.existing){for(var u=[],p=0;p<c.length;p++)for(var x=c[p].querySelectorAll(M),O=0;O<x.length;O++)u.push({callback:C,elem:x[O]});if(g.onceOnly&&u.length)return C.call(u[0].elem,u[0].elem);setTimeout(e.callCallbacks,1,u)}E.call(this,M,g,C)},s},f=function(){var b={};function v(){var M={childList:!0,subtree:!0};return M}function y(M,g){M.forEach(function(C){var c=C.removedNodes,u=[];c!==null&&c.length>0&&e.checkChildNodesRecursively(c,g,B,u),e.callCallbacks(u,g)})}function B(M,g){return e.matchesSelector(M,g.selector)}i=new l(v,y);var E=i.bindEvent;return i.bindEvent=function(M,g,C){typeof C=="undefined"?(C=g,g=b):g=e.mergeArrays(b,g),E.call(this,M,g,C)},i},s=new m,i=new f;function w(b,v,y){e.addMethod(v,y,b.unbindEvent),e.addMethod(v,y,b.unbindEventWithSelectorOrCallback),e.addMethod(v,y,b.unbindEventWithSelectorAndCallback)}function T(b){b.arrive=s.bindEvent,w(s,b,"unbindArrive"),b.leave=i.bindEvent,w(i,b,"unbindLeave")}d&&T(d.fn),T(HTMLElement.prototype),T(NodeList.prototype),T(HTMLCollection.prototype),T(HTMLDocument.prototype),T(Window.prototype);var h={};return w(s,h,"unbindAllArrive"),w(i,h,"unbindAllLeave"),h}(window,typeof jQuery=="undefined"?null:jQuery,void 0);var gn={data:"DwCwLgtgNgfAUKApgQwCb2BRZkAIDGIyATgM7YC8ARAK5gBmAtABxUYCEjjuADgPY1iARxp8AlrjEA7fFEGJcURKUViARitSIaAD1z1xKgPy5GMXgOIWaAN3FWlKgFYDEVxFNwQ+W3KRxSqMhQfFIKXBik+MRiPGB+xPjU4GA8pABcAPSZ+KhSAHROpFpQYjbE+WFgmVI8EJmkAO6I2MFuYABMAAIAjAAMbMAN0bFgkSNxCUlUKWlZmTS1ANYA5vn4fPVBAJ5FvfnM+R09mTtF+RDShaRUuFr0brgwQ1ExcRxcuNZWAJIAoj0eqYzAhXqMpskwKkMtlcgUiiUyhUqpkViBMsEeNJEEUMVAsWEujYOvkdKTTmJ-HiCYhGGJEIDrrd7m5nsM3mMEJxuPxBIplLhkHRiAKpMgbGIVsgwNoyMDxhyITMoXNYXlrojypVsKj0Zjsbj9YTiaTyahKdUjYgmWywe84KCwNslPA1D5trgAN5wL4GKRgRj0ZCXKDbdK4KgAeR4HlwAGVkFIbgAaUzIHg8JSMUjbfyICCpgBCpSkSwAssh8HHczKIAAxUJgVNUOOIFZ8BQAVR+VFTACU+G6wHxU5GdNsVh5GAmk6nO2pFmAaKmAMKJnAiqBQZsACUQUBs2DE+DwADltIhe7g9wejyfUwBBGLBVOkROkbNuMT0ADcuDgAC+CANE6LrASAKDoA6wBuqg2zwAg5o2AQUDIKQpDULWmbSpeGAUjYCGghMnJwI00ioHwjT5CyxAADJ8Gg0grA++LYrgFD6Is+BgGIoS4AAFCeW5qJWSwAJRenAACQUkbEmfBKPkIQrPxVA0YoDHmlIKxUGJP4+l8hlfGRgSUfkaCoH8h7+rRFoeG4-EAORNMEjmpvQXE8Xx-GIBJ3pGUZsmhKQCnWspqmINZ8TOY0rm4CK+CIGUiCoKmFEEMEUAifgSy6fpAWGUF8mKeFvn5QVAVCVlon8XpBkFQBdUVQQwWhUpfAqY5kUePE5BgI5TWGQB+lySFJUdapNH0Yx2ksTSfjYDKqB5XAHkyF5niTmAnbEFAABqJCkLVklGTYJC4GdcocZ6w31Rd508CQYAqBxJkUVRIQnht+QgCK9D5CK2GJfxmQANpGAAZAAugA1PxoMAHoUNDMNiRQ8MI9DABUYmomI7mebxUj8QWSyINsyZnXIvknRVl2kKDZPbFD7H3dT5VfI1HPxdggiePT+lAathN8VtO1QAACiQwb8Y9xDBtgbhpYgQY0FAYBUzQvn+YZl24II+LS1gMpWBx9xCurmuINz378W9ZmfdKRM-X9+TkYgOiRvQstG4rxASeYjA9GJOsFQbcsKybrNi7tB1kLVoMR8bbhQ9zRlAUZIpLsQnjh77JuCw6esURAfaQR6HFrdxRMCX50lZ3zuBhI0uAS8QmyUog-EimNh7seY3oyd+AkUfgNBYP6APl3GOAyuxHFUCEM06XXMlSaP489eZqCWVFtl5mExCqQAIpGZYro2PXTVoy2pj3CmHmJ0lSQBuD7uQklr-ft61fpMlAS-J+t04D8TQtsGQx0KAD2kqNNq4UqAAFJ8D5HyP4J6V4qAbBCMQdIGx5ZQBWlJZAsUxDxBLmXNA2xf4wNauNFSiDch8HwJIFQIpKEYKwXwHBeDgiEP4DwGgPBqFFTGmFCaDCUH5A8LfCMnDuFcN4XVKSgExLULgJkLGPosb6x4qUJ0nF1o1xoOQVAkhTFnBUJSRy-p9YmK0f+XA2ivgNxzgQQQIobFBBlKmR6O8Uq4DImAEAuA+iSHoE3FoN8tGZDgHrLaAAVCCx8cLsSrhtY6g80k118fxUgfkebZ08Lk3AwBcD9AkiYRyfRHK4Bhn4XA4ZSB-gAcXVmzdcDJJlLVeuvNXGg1QPkLadY1ZQAAJooCPhJHxaB+IDK2mWRsIBaow2DtM1AszBnYE6V3MSYkoaFHEMTRyjABqASLg9PgAieCszATIAx1dQi1UHsPfiToYx8HCXGWKUBcDsAoBxRyWTQgDUHiItqbh25HwYT8YgCU+CHnlmoJQb9YVcIwdlVY7dFioEYHI9IIpUp4qRaJQhUkXFSD-i-aS2RgR3AAJf0GkKQmuWgVD7nzD1FQGwIAQEWKQalORgq9RlGkVmoNHI9DcrgRyHQpWOQAMyOShtJJQwrECio4uKyVyYZVKpoUmXq3yACKWstYz3VazL5wQLhiB0NIfioKAD6WE44ZCbiM5MBkZJyUZcQCAhY6DDikPEj2YBwyOTjDQMo65cAQ3lrCn8bkvWyUTIlKAAaoShBDToMN0q250vwHSrQNiIaoQTUmr4MkeDtxWD3Ug5q5h+BFaQT1layXdTIIgDNQa3VgGIFrVtuAZJUzEF4omZZlBvknOGlcChCDBlFcoeIIoRBWM9TJc0qBoweHDECop3gghQFXmvWBdDVKSKtVAdIm7t1SFJTJe2VFzSkEemAQgVker8WfmvdpK5jHDggB+-0TkXJQCld+mSnpcALjUEi5Q4Y+0DruK0MQV6vS4BlDm8MUYADS+RbivwAWvKST9iNKJfqmZ+ZEty3t3SLYm2tv2nrEfQi93z0jUagLe0lAF13r1HWXQIbg6OGO8ge4IIcIPMfaqxtjwRr0CekW4e9UlH3UUpK+99UV+K-v-ZsIDYAQPfKlVBmDcHe39sQMrHAqHwxQcw7myB5gHMkBQPkK2uBCO7OfrxqjqGoArhCOQETDzibiaPaC71tCWPnskfkS9HH-OBb4OQHjfHN3JeC-c9J4XJPEek-AuLKCEsZaC5ecjvmN2juPku9uYZstExJj4CTkWwVnqoEV4r7HN01f8HVtLz9pJc2kvq-wbMtYvVwKDVOKrsBuNhT1Btf9RvxEemEKAjrGggFCpGYgrYlDcVZqCniYBkVSXDSahQdg1aIAAF4XQECoN8tg2wkC0MQJNMlwDQCMuGAABs-YAShJyBBgCubblJKTkHu2BulMpAhayGMD6R8AZLAEZfuVAfVUdSWAEhFCaEMJUAMH62to62CA+kAI+Io7qCEHEIlW4YosB04h4zjD2wYzJFHcW24VtqBSBGYMbkRBAjIoXJmzwshjxLAIGz8IIIZLxIEPED2-BiAmxgoGvitOqDvmaMQHozJpTIEYJWDa1A1dcLAI6zKtxZCE+oKBjo2ZQIpVuG8xA1AJdBrYJGHDQwfehBx3GOlUAC0bUPvyFQOBzNa8l2Y6g+u3AdGNzgM3oXLc6HVzb0Il4CfoSd98l3-hnTu451zqgQe70wH94H7XUgcdDAx1ALH2Am+ohiFBGSf2+PVsQBfKQvqIAhfScgVMahkz4GTKlGmn8ovFRi+Pyf0-Z-kakqq3Azr8w8Fdd+vtHpWvb4gLvw6rMABScZIynnyHLcgsymGb0niINw2x9uIG4lwpyoNmde8wfLqgKGAadzYILWdfKSWEaLGTVSENE-dIK8Y-U-MgdfV+L6QgHyY9GSSAxfaAv7JBP4HQRKOIGuAAEk9EQAAl72lTxR4SgB-AxVrQEECFxQUi4XxRSgGkpRkkvVQW20aAOlKDHVCAnXQmQEnH4j+wnUSAkF8Hp0hysEWAUFZWQ10FwEuQ2lID+3APJX0GCHIC4KIzaxi0v2v1v0Oi7g3gnjAHyBf2IDf3ZU-yPkch-wVlZwZ0vCALEhAOpl2S4OyFtk9w+S3xdTP3+QBWxRVmxFQBqQAB8Yjgid9XV54OJBctw8sh5vYEiT8kiwj3U0jWseDSA+CBDR0nZhDJ0xCu5JC3B8AZC50IdSAxAFCwhkNNBtA9B1CiZNDtDelPAgwoB9Dv1X5v1sDRFcCkFYCkCWFcAyDEDXVKDkxMFWD5F8F70dDPQ8weB0gehUwrZ0g5jDohZ-4+MNFn4nArtkBKRkM7AmjeAnpbjSA+RFDkMZRQs7hHI6VrIOUbE5smhSFCBHhHiHBHJFg1CaBFBHIhQ+0lCBR2UrC2jFA8AX8tY34+jQhQsziFAYxVCtBXio5UIWoDU7j1tNttslBdt39uJUxzivAupPByANc7h0TvheB25HpJwHAFBiA6VHj1ZpRcBJFcAABzvAFov0ULFox6FQZ+LGGJB9fzWjBrbyfcTAgrcROTK9Tjbjdfb9fcGwrWOwyk4cJw-IEnCAMnaIrwiyAzfeeHByRyaXHKKVR1UXVAJQU2JUhjSTKTKA8KPA-AAzXAeJEgLacMMg60DcLaBYpY7BXBBRAhcAn0okq3DXFiDbc3GuSuejHyGwMAdIteW2SKawyM7AC4aUAEo6RyavfpE3DPC3KgFMm3O3Tw-Mk9X0iaf0ggnPXAB8WiWiOXdw3vGMtg2glTLAzINbfcUknbPbBw6wg4q6aVRs23LcRyP8GlDYNWPIRyeIYxBQUhCDGSIs9YdxHqYM4gLafU1-I0r-Zw3-Nw48Dw4AjzDiEwm-PrJib8KhT0PYhs7Pa3FcghRqQ8iA04RABcFYDkrgmSIdHgx0pYQfYfYRYjIdQwmSclaC26fLIVN+f8jXSMMIW3N4rM0TBjXM1sqSQs3M-IEs6ww8iAcsiCSs6srxU3DM0ILPHPR1PPQAgaCi0CycjbLbGco0-IBcybLqPC3PMINc3ADcgQVvKQHc2xfcsAEC48seBbf0c8y82w+wg7Y07-e8--dw3irwl83AN81BPtT8+gb8385cni4C4jKSIdNUlSf0n4JMdoQUJtC1fk-gRojaBpGYz0HgraS7M1EVZZHoaMmg+Msc2C75N2byjXSKxABtH2EkrbaUZXBMQ8ZMcK7AdKzKsSFZUjFyzY0gVBTMR8-iIqsAEq6KsqnYkJVMCVNQTgkCng6QBkxq01DK6KwSx1M06UQq5KiKga0qmGDoCq4jKqmq0oYGBqpq9VZZDoVMPodqnofALqlyoybITfR1NQMATwDiBqxCpo-1BvZCteIdbIY6069YJapYW6mCqSOCl6y6v1N6l+f8YjDCiDLCteDRQUN40hRxOUteRstMoi9JMqCDRsgixAOGxrBGteYbf+IbB0ERVbRMKcnKsAPK8UBQa6Z+E7M7C7FE67JQe7a7J7IUQ8KUYgd7T7KSb7KAc7XAAHNePHMoZNKSHQRgVi6gUOIdGSWPRwOzO6NtKSHoOzMxcMfoVMMAJFdIZyJcYtZ6KVBzcNP4TWsQdcUgGpXzAqNeDoBW0dcMDoLajDNW5ySdLonW0NcNVsdCJ2zzQdQKGSeVS21AcMeVW21Wq9DWmgLW0gF0i0LhbYZ2rDaVHcKOmIF-FQOHMOw2-0Y2z2mW8WqSAAFj9vDFzqDvtpAETu2EdXIHdtCEdRPABNjtzUcgrGEBRPZIUErsaOChNq9sKhkgAFYC7cBe7i6Q7jZkB67w1j5QgpA6UWgVB0xaqvpkpM7Tae6qVZaAIqBv0cdcc1Z4BZbgBuQeYxsgisJUI54Ig7pebT6cJs614haSdqBQZR1djQDEAWZpBcBIw1BzjuIpF-QYhlBXlkBzMxJN6zaZJ0gmZqBydL6ZI96ApebSh4Hva0cqc6AK8-8ASco3QdBbh0hdcrY3ZloGljLCHg6+dX7qAKdwG0dUI1B9wGkH6qBCHydcAhaHNqAyHQ1BhMg6H9xkHV6kcxABHebMhr6ZRt7ccFhYBv0hgkIcde9n5+9vqR9a5+559QLBQY8IIRRpi8AsGlgcGAlSFgkpA+AzFJAvB-19BUMo4ddTFhw+AmMcLuLLUJrsAJZLlBFaorzDS5yuE0zv9PcKADGcGoYn7UBPCuDN8JAOJuKlIPAVgglUxbdYU2lEAW4nx5YqExA9J-qZISd+I-wxAuA-xUniAn6WZrorbuLKmiHUxf99i+A6nf8p8IIcoUomm6mDGUpMb0Lej0NNj0gNrxtEBwxymiMAEsLRo8aSSvFSb58KbEAuaqBLstwBR5mUxn4OauaebcdS8wIsDtEhJpEAGrA0B0wwA6VkNcBZgYRBVsFSg1B1hNhMhsB8BMgRQVgzSHmuEnnGAvmzTGAOhe7MhbmVR7m5EnmXmthKIpAl5UBMgegABOVFsF2U5+DRPhqAaiHCdIdIZAegKOT0OSeHXNKgAAHUQGYHlQADYqAfxArmVQhwxNwnZDwfwlAiXC6+geAdAfxhwtjB6+WfwAIMWCmuEIAvRn1sJ6sLTGWLImIlb8x6DRJGDsVwwABiegZFnVnV+grhd7JWvlvwBSUdXATV-AHa61n8Bii86Qa2kUKVqE8x0JF1215AIWsiVAIJcMWlvoXl-l3xLSFYZViAUV5+M0yQWodBz0BgrFQILV+gZNg1lm4TMpE1sac1zV5F-AXN3NiNiVv1aDBvL0eNpg-21QNEMAWtcmBVneJVkJfIAAdhVe9d9bKQDYQVTaNZCULakijer3SG2wRTLbVYTcrfbFb37ajexa9GDcbb6HyF7vzCbZXalaXfXb7aIyjbQfiE9AXe0nDCXdbfDbtZWGkEYCHAA2PeXadZnclejep3SAMDHhUE9BVxLDGdwHlUzbNdMSndQH7a6CwHNDwBJkvfbZAB5cDb8lNMldtx3j4k9AtMYHEdpCwXHiTGtoDZNZ6HoGIB-FQ6lCFZ6FpZFdfng79UQ4ok8Dnc9AczN1KBWCkFZclHACI67xYLkAgFY7KTktwA6FFYFLNJo51xjabBE4Q4sj4mry9FQ8w94+toE-lVFaIxeDdyb13dQGoD7AfAAC17dUJC9idpOkO70wb6yKdUGJOMHWcP9DG+BcHE8q8jS082LM8qA+oK65yjB7d2myZu9cc52mH8A1AjTdtTw+AwA2BQ8DKiYo9nieA6UYgfAFAjAkdgH+HAcQuuFqAfW6x24IAjPHc1IcI2BtkbnUA6UJdMv6GZGbPqcXOCuiuPdOc-95nbgGKdBqAbbA6g4Xd5UjcvBpBeu+h+gBvGAhv3O6yiYndsBHV5mRrWu7hazUJtIaBKiKBAUPsm9cviB8uia+ASuTPOuYBKvfBGUpA6vsvGv0HdcfXlc2vK9OuvBPWxv+uehBvhvLgpAxuJuvupvhvWLZuOKvOFulvhwZv1uVhNvJxtuCPHIO8zSm8X1EwYAouZRwxkVGV1ZdGgTETVu54WjShLg54X9o8Foq6kwClLBp7lAXg1sFG+8RQVHwwnMNHv01BzwUpKuzZH8rDNkwA-glArDCxtgfh1kqyjTgCemgPv0WvNhWZLCt4toRfviwBxfJenJFeIBnzX6uDHvzH+ex5Be1fReeotepfdf9f2Zv1v1bZufIk+f-kMNLNY0IYBI7gwBCulfciqBbg4jvfldkiIxdJcBWzCjijghSiNoRCp0qipDaibnSAw8P9I9Hhnj5mwT6UNgASYd9G0IYS-A0-QstDoKdD+jBiMb8nlEv4BnWshn5VKNiM9jQZDyVfJ5zeNerenJwu5zZeAuUo+M15O-rDu+xeJfrefeivgDn1gGlBTFcjEN0u8iflwwx+hf1fJ-tfHIbfzLX6R+N0BfVfsBt-Lep+deju5-KQF--Fl-3eTBUj1+mTTfT-heLf-Re+9-r+D-qYINlUGNSlJVn4xboYwfHHyEenUZi1AoepPSjeRNKicZOSlK0jvBtJ2RD4TkedNpEQDOlXS7pVmHugwIwCKouNBaGAG2S+8IAqNPiCRVCw5k8yrWSit7GPK0Uyyb6Jit-hB7sU-u4PG3EtwI6bAzKFFTfBYlZh1hzcggekBUCebVUru6yY3uYD4BEN540qCxHtWIy2wxBuRCIldxSj8V3KqkJBD8D7B9g-gK4SMHtD+B6dCwtEP4LgGsF9hIwfYXAKeD+B-Bj4PZFcCuD+Bxg4wQZSMPGDPj2CHwEsCWLRB+ArgHw8SH4NflwB7QHwfYOML2BApVlx2FbbjmwQJR-giUqEHKImhArgF+mhSaClShcraDVuuwaqnEGIAd8T+XfM-p-016X8f+yuW3iiQ4ggULED+N-g0I-498Wh+-bwmARAp-0t03sRyN4H9AgBgCo1QzFQFGSLDRkjAMsGWEYDHxj4Y5KSOQCgD-RxKYqT0IINUab8J+F-XfkMKtgq0+A16eoeP0aEDDzhv-YYRQUAEoU0K7aEoUDWgpJkxsfUB8HBjypzk+enpBgRRSorFkQypZBihwMAbOFuBnnbzjsPT5+cWyTAoyEdTUDK9bhW-Jod-374GVB+DnFKKUPXjYjThX-QYTP02A383wcGJfr8i3xqAuhZI+4Tv2n5tCvC8-OkazHYCMjDyaFYGkc0s41wIa4rNeH1EoFFcaBXpaCn8IBF8AjS2yDAmnAqjDZmoB1QVDgXgRIJQgt6CwFcg4TLE4yqxQaKqO7pGRSsKWb9pAIkhQJaY6ogKHAINL6V0+t5KjtQOQHAEnW8KRAOgIPgOR-8iYScAgVFyt43ApogKJViGx-wZmxJKcnMKOzk1SElNaVGs30CStpQbNHZv9kBxIQBaQtEWlQDFprxJa8Ge0avXlroYranbdyBmLDSOQigwKFWi7WlSNilKWdGhhbSrGVsbatYv1NKHVr4BSANgcetQWHFd1b6MkWBmvRzob0t6sjXegLQPqfAe48QE+jvjPoK4RGaOdDpOMFqBg8uVACJi-Wpjv1PAX9H+tYR6gAMjopYvJGAwQYQMoGVAGBigwEb70kGe43HHuzs7-4HOODPBgQ1fpEM8GpDYCXMIobUwqG74nOsFyy7r8mGLDYhuw1DScNgJDmHhtixgmiNPxKDIYOh0kZDBFxojeRoNh7ws8B8oQYfOz1tHQIQaYLNCBhh0b7k56cuf8U52MZBIm45jc1hIF5RjZcedjTwOa0cY-D4grjc6u4zACeMrkPjeAf42ICBNnCwTUJk53CajoomEGGJqzHiZKBtIyTLfCQA9LtIsmyAHJnkwgyFNimpTQybCkqZHYamzTMQPsmfpNwFYXTZyZUAVhtMiR-tWpp5Ll59NihjcKDEM1zonitY4zIyYYSmbLZthxqKaiKivJax4YSjfGkJTJKIAKSc5PvOlMW44R10UMLwkEg8D8QBIPcNWHmWgHPxRBjqY+CJA-gcQJB3EKQW4HyBLBjOcg8iPxEUFqEVBrvRyPVKL4aCtBdUhqaTVd66Coi+ZQwdClMHmDLB1gh8LYPsGODnBrg9wZ4IfDeDfB-g+JIEKvxlgQhYQiIVEJiFxCEhSQlIWvDSE5R1WzBPFNkJaixliUOUY2t+nXyA0saG6MaUX2V6-TyAt+PtM-BeQVT1YzwzAjSj7TvgzSjwMDIOHOKq5PA5oCUpcRFDfojqKM1mGDOsKEMCUNAYGKAmTA6BaJAkT0JInHxTYyQmxKGOGDJBWxGoqYG6BJChnywkwUbBGenwwzmMUZQaMUHYQEhMx0gmxCKWMythzVN8pAHcJACgDUApSNzbkryVngMsMZc2XXm0g9TB9jea-LgiMTBaNF+QcuBdJoBSRLpUSa-VMASWz5KUzZ8s6tJ3HNnco4giAB3uEn4iLdjwoMeVOEz6BVNXeK-TAuvCpFSspIcTFGV7PCY9AZsxGI3kOjDmezvZoMDoNHLbJaiOySCHng43MZ7kieCgMgrr1fjcB85R3BYrIiNGjkUC9vAspkQ9n4BQYUcj3l8Frn1z9kL5V3n+S4p24Q4clMFg2jKQQYaUOc0uioATH0MTwOciGrFG0YKA88KlUxB-StACQScb8MBC1B4DbA5qZAu8YmJcqVioM1Y5WnbRDr+Aw6nKUcY5H1pp0jaE4lyl2P3k9jh66tduk7WbFx0I0jtTulnRcq+1uxAdR+aHXDqR1-A0dc+QnWAVJ0JsuAVOmBwzo3ziM+dX+bgCLoq0S6ZdHztTxrqVgII58puhT1bpU8O6SYOBWvH7qIKh6KCkeq0HPmT0pA9PAUPPSWrstlAxCmcbLSOr3YOIF49Pn-RsqAM7xLMsFoU14nnjv63C68fSFvF388kIcQwXeIiZFTX4HiG4goGeIQpZQ7xd2HoD-DIpe6b8MbPLL7QCAbAdKLSb8S7LW4qGf4SyV-j1hiAKAjqW7Ak30kgAg4xTGABQD6DWTGAIg34sGTgyngFYOk27JUxbk0UkUpQ2aZxlwo54rwpAPxUoACVYAihpAcxYyRhivkr875GytpC-IOpSxws+JYgESVWZWK16AGdaEbLxIkUyuN8rkkKXFK0owcxpcrjEhBSyh4o6WdAEsUQYpZMs9JX9mAB4AHucLBFrcF+gqx8uJudIA5gnKoRpAP4edJ2jAAUA6ATAZgMmHDIyA0unYPsJEM2D8AwgwGFJVJVaXMgRlmkTigBTIIJIkkOEWqABGuChA2Ay5a5dgESSIAlRrSx5ddwxAwA-s0FbIL0ugD9LgAPAGAFc3DyLLJwVhG5i8s9BmMqIcwpyEsNGSrCNhA0B5W2MdmWBqqkiIYGCv+Vrwhib8AYgoCgw0pmgASRMGKGiXW5fKSIt4ifTv4DzeGFobGcoEqnPCyyQiPQHaIdSJgxADFNDDoEajgEaUnwUsdzNpUa5TF4k27BQGmzQVJZIqR1I2R0nhzk5Vi7CmnJUi1zN5EGNQA2H7FgA3y6qz2bnX2TyCypvU5Qb-lUENiQoKA9YEP1QAGqjV0IlcHGD2hfB45dci1aaW6lqF1GtqwJQNKHEjivCcvCDI73dXShPVe0CioUyOp2LbajqCABQE2KqqpKTipJiAB-COoxAwANNWUzEAwxUYTAowtAUzWNlQYBaoqSSNtjVqpKtagKS6v4pSQHFt+YxEslr4uVPQNTfGCBQ3RTKPAGwLQDsr2Un488wGVAOUqkRSUqlUAZXPGtyQqqa1daryVgEaVUDmlfAXZEf2IyNMm1OeFtfslaZDqpILYh0uOIvXvCZIRQ9pRjSBrRrvYhqusW+UTVf5k1HilJumuPXW4c1QSfNYWuLVb5S15akCoYP-Ua5T1D6xtWuubUbq5e7aztQIiKJlSL1-avyYOpcqj8R1Wy8dbsovhTrDlhmKyh+RyV2VZkc6ypdUr4C1LoNYAU9Zuqsze8d1Ws3ZGJAPU-p3JjG5jeetw1Hk35bYxyLeqHUPr3hAoiDD0s6WyyqAwAXeirOIxJq5sBan9VvilZxNHFek3NSWqLXhswNZanxb1DrCoYiloa7mnCocX8aFYAER1K8qJq3KukXy2YsEo3WhpKCh5IFVAH6WHkgcwjECoMua7nK0AYyv6JMpwDTLQ0syy4hSkWV9QVlDAFgBss9DWaN1rFOcYJvejwsLlVAMgqQFM0JLbNbAVzTZqwAAR+IpW9zTmmcq4bAtvyvzayr+XPr5qsm9JfJukYwAlNWNb2jwV9RdwSBEtZMd+0cimbCA0glQCsDpTT1FZ7ACtI+I5o5jmodfNHPI3y2yaAIcjMoNhKkiKNwGPqK6t2izRXr6Ih4UMHNtgZ9MpmdUV+IZGAh2hOQged0HhA5rwAgAA",method:"decompressFromEncodedURIComponent"};var bn=function(){var o=String.fromCharCode,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",a={};function e(l,m){if(!a[l]){a[l]={};for(var f=0;f<l.length;f++)a[l][l.charAt(f)]=f}return a[l][m]}var n={compressToBase64:function(l){if(l==null)return"";var m=n._compress(l,6,function(f){return d.charAt(f)});switch(m.length%4){default:case 0:return m;case 1:return m+"===";case 2:return m+"==";case 3:return m+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:n._decompress(l.length,32,function(m){return e(d,l.charAt(m))})},compressToUTF16:function(l){return l==null?"":n._compress(l,15,function(m){return o(m+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:n._decompress(l.length,16384,function(m){return l.charCodeAt(m)-32})},compressToUint8Array:function(l){for(var m=n.compress(l),f=new Uint8Array(m.length*2),s=0,i=m.length;s<i;s++){var w=m.charCodeAt(s);f[s*2]=w>>>8,f[s*2+1]=w%256}return f},decompressFromUint8Array:function(l){if(l==null)return n.decompress(l);for(var m=new Array(l.length/2),f=0,s=m.length;f<s;f++)m[f]=l[f*2]*256+l[f*2+1];var i=[];return m.forEach(function(w){i.push(o(w))}),n.decompress(i.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":n._compress(l,6,function(m){return t.charAt(m)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),n._decompress(l.length,32,function(m){return e(t,l.charAt(m))}))},compress:function(l){return n._compress(l,16,function(m){return o(m)})},_compress:function(l,m,f){if(l==null)return"";var s,i,w={},T={},h="",b="",v="",y=2,B=3,E=2,M=[],g=0,C=0,c;for(c=0;c<l.length;c+=1)if(h=l.charAt(c),Object.prototype.hasOwnProperty.call(w,h)||(w[h]=B++,T[h]=!0),b=v+h,Object.prototype.hasOwnProperty.call(w,b))v=b;else{if(Object.prototype.hasOwnProperty.call(T,v)){if(v.charCodeAt(0)<256){for(s=0;s<E;s++)g=g<<1,C==m-1?(C=0,M.push(f(g)),g=0):C++;for(i=v.charCodeAt(0),s=0;s<8;s++)g=g<<1|i&1,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=i>>1}else{for(i=1,s=0;s<E;s++)g=g<<1|i,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=0;for(i=v.charCodeAt(0),s=0;s<16;s++)g=g<<1|i&1,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=i>>1}y--,y==0&&(y=Math.pow(2,E),E++),delete T[v]}else for(i=w[v],s=0;s<E;s++)g=g<<1|i&1,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=i>>1;y--,y==0&&(y=Math.pow(2,E),E++),w[b]=B++,v=String(h)}if(v!==""){if(Object.prototype.hasOwnProperty.call(T,v)){if(v.charCodeAt(0)<256){for(s=0;s<E;s++)g=g<<1,C==m-1?(C=0,M.push(f(g)),g=0):C++;for(i=v.charCodeAt(0),s=0;s<8;s++)g=g<<1|i&1,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=i>>1}else{for(i=1,s=0;s<E;s++)g=g<<1|i,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=0;for(i=v.charCodeAt(0),s=0;s<16;s++)g=g<<1|i&1,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=i>>1}y--,y==0&&(y=Math.pow(2,E),E++),delete T[v]}else for(i=w[v],s=0;s<E;s++)g=g<<1|i&1,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=i>>1;y--,y==0&&(y=Math.pow(2,E),E++)}for(i=2,s=0;s<E;s++)g=g<<1|i&1,C==m-1?(C=0,M.push(f(g)),g=0):C++,i=i>>1;for(;;)if(g=g<<1,C==m-1){M.push(f(g));break}else C++;return M.join("")},decompress:function(l){return l==null?"":l==""?null:n._decompress(l.length,32768,function(m){return l.charCodeAt(m)})},_decompress:function(l,m,f){var s=[],i,w=4,T=4,h=3,b="",v=[],y,B,E,M,g,C,c,u={val:f(0),position:m,index:1};for(y=0;y<3;y+=1)s[y]=y;for(E=0,g=Math.pow(2,2),C=1;C!=g;)M=u.val&u.position,u.position>>=1,u.position==0&&(u.position=m,u.val=f(u.index++)),E|=(M>0?1:0)*C,C<<=1;switch(i=E){case 0:for(E=0,g=Math.pow(2,8),C=1;C!=g;)M=u.val&u.position,u.position>>=1,u.position==0&&(u.position=m,u.val=f(u.index++)),E|=(M>0?1:0)*C,C<<=1;c=o(E);break;case 1:for(E=0,g=Math.pow(2,16),C=1;C!=g;)M=u.val&u.position,u.position>>=1,u.position==0&&(u.position=m,u.val=f(u.index++)),E|=(M>0?1:0)*C,C<<=1;c=o(E);break;case 2:return""}for(s[3]=c,B=c,v.push(c);;){if(u.index>l)return"";for(E=0,g=Math.pow(2,h),C=1;C!=g;)M=u.val&u.position,u.position>>=1,u.position==0&&(u.position=m,u.val=f(u.index++)),E|=(M>0?1:0)*C,C<<=1;switch(c=E){case 0:for(E=0,g=Math.pow(2,8),C=1;C!=g;)M=u.val&u.position,u.position>>=1,u.position==0&&(u.position=m,u.val=f(u.index++)),E|=(M>0?1:0)*C,C<<=1;s[T++]=o(E),c=T-1,w--;break;case 1:for(E=0,g=Math.pow(2,16),C=1;C!=g;)M=u.val&u.position,u.position>>=1,u.position==0&&(u.position=m,u.val=f(u.index++)),E|=(M>0?1:0)*C,C<<=1;s[T++]=o(E),c=T-1,w--;break;case 2:return v.join("")}if(w==0&&(w=Math.pow(2,h),h++),s[c])b=s[c];else if(c===T)b=B+B.charAt(0);else return null;v.push(b),s[T++]=B+b.charAt(0),w--,B=b,w==0&&(w=Math.pow(2,h),h++)}}};return n}();var In=function(){var o=[{id:"/views/test-swal-sauvegarde",path:"views",file:"test-swal-sauvegarde",ptr:gn}],d=function(t){oCurView=o.find(n=>n.id==t),oCurView===void 0&&console.log(`%cError view ${t} could't be found`,le),oCurView=oCurView.ptr;let a=oCurView.data,e=bn[oCurView.method](a);return e};return Object.freeze({load:d})};const Fn=In();var zt=Fn;Me();})();
/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
/**
 * Fetch Inject module.
 *
 * @module fetchInject
 * @license Zlib
 * @param {(USVString[]|Request[])} inputs Resources you wish to fetch.
 * @param {Promise} [promise] A promise to await before attempting injection.
 * @throws {Promise<ReferenceError>} Rejects with error when given no arguments.
 * @throws {Promise<TypeError>} Rejects with error on invalid arguments.
 * @throws {Promise<Error>} Whatever `fetch` decides to throw.
 * @throws {SyntaxError} Via DOM upon attempting to parse unexpected tokens.
 * @returns {Promise<Object[]>} A promise which resolves to an `Array` of
 *     Objects containing `Response` `Body` properties used by the module.
 */
//# sourceMappingURL=app-facturier.min.js.map
